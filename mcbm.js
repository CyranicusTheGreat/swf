var BrowserDetect={init:function(){this.browser=this.searchString(this.dataBrowser)||"An unknown browser";this.version=this.searchVersion(navigator.userAgent)||this.searchVersion(navigator.appVersion)||"an unknown version";this.OS=this.searchString(this.dataOS)||"an unknown OS";this.isChrome=this.browser.indexOf("Chrome")>-1;this.isIE=this.browser.indexOf("Explorer")>-1;this.isCrapIE=this.isIE&&this.version<9;this.isFirefox=this.browser.indexOf("Firefox")>-1;this.isSafari=this.browser.indexOf("Safari")>-1;this.isIOS=this.OS.indexOf("iPad")>-1||this.OS.indexOf("iPhone")>-1;this.isMac=this.OS.indexOf("Mac")>-1;this.isWindows=this.OS.indexOf("Win")>-1;this.isLinux=this.OS.indexOf("Linux")>-1},searchString:function(f){for(var b=0;b<f.length;b++){var c=f[b].string;var e=f[b].prop;this.versionSearchString=f[b].versionSearch||f[b].identity;if(c){if(c.indexOf(f[b].subString)!=-1){return f[b].identity}}else{if(e){return f[b].identity}}}},searchVersion:function(c){var b=c.indexOf(this.versionSearchString);if(b==-1){return}return parseFloat(c.substring(b+this.versionSearchString.length+1))},dataBrowser:[{string:navigator.userAgent,subString:"Chrome",identity:"Chrome"},{string:navigator.userAgent,subString:"OmniWeb",versionSearch:"OmniWeb/",identity:"OmniWeb"},{string:navigator.vendor,subString:"Apple",identity:"Safari",versionSearch:"Version"},{prop:window.opera,identity:"Opera"},{string:navigator.vendor,subString:"iCab",identity:"iCab"},{string:navigator.vendor,subString:"KDE",identity:"Konqueror"},{string:navigator.userAgent,subString:"Firefox",identity:"Firefox"},{string:navigator.vendor,subString:"Camino",identity:"Camino"},{string:navigator.userAgent,subString:"Netscape",identity:"Netscape"},{string:navigator.userAgent,subString:"MSIE",identity:"Explorer",versionSearch:"MSIE"},{string:navigator.userAgent,subString:"Gecko",identity:"Mozilla",versionSearch:"rv"},{string:navigator.userAgent,subString:"Mozilla",identity:"Netscape",versionSearch:"Mozilla"}],dataOS:[{string:navigator.platform,subString:"Win",identity:"Windows"},{string:navigator.platform,subString:"Mac",identity:"Mac"},{string:navigator.userAgent,subString:"iPad",identity:"iPhone/iPod"},{string:navigator.userAgent,subString:"iPhone",identity:"iPad"},{string:navigator.platform,subString:"Linux",identity:"Linux"}]};BrowserDetect.init();window.Modernizr=function(ar,aq,ap){function O(){an.input=function(f){for(var e=0,g=f.length;e<g;e++){T[f[e]]=f[e] in ag}return T}("autocomplete autofocus list placeholder max min multiple pattern required step".split(" ")),an.inputtypes=function(b){for(var m=0,k,j,g,c=b.length;m<c;m++){ag.setAttribute("type",j=b[m]),k=ag.type!=="text",k&&(ag.value=af,ag.style.cssText="position:absolute;visibility:hidden;",/^range$/.test(j)&&ag.style.WebkitAppearance!==ap?(al.appendChild(ag),g=aq.defaultView,k=g.getComputedStyle&&g.getComputedStyle(ag,null).WebkitAppearance!=="textfield"&&ag.offsetHeight!==0,al.removeChild(ag)):/^(search|tel)$/.test(j)||(/^(url|email)$/.test(j)?k=ag.checkValidity&&ag.checkValidity()===!1:/^color$/.test(j)?(al.appendChild(ag),al.offsetWidth,k=ag.value!=af,al.removeChild(ag)):k=ag.value!=af)),V[b[m]]=!!k}return V}("search tel url email datetime date month week time datetime-local number range color".split(" "))}function S(f,e){var h=f.charAt(0).toUpperCase()+f.substr(1),g=(f+" "+ab.join(h+" ")+h).split(" ");return U(g,e)}function U(e,c){for(var f in e){if(ah[e[f]]!==ap){return c=="pfx"?e[f]:!0}}return !1}function W(e,c){return !!~(""+e).indexOf(c)}function Y(e,c){return typeof e===c}function aa(e,c){return ac(ad.join(e+";")+(c||""))}function ac(b){ah.cssText=b}var ao="2.0.6",an={},am=!0,al=aq.documentElement,ak=aq.head||aq.getElementsByTagName("head")[0],aj="modernizr",ai=aq.createElement(aj),ah=ai.style,ag=aq.createElement("input"),af=":)",ae=Object.prototype.toString,ad=" -webkit- -moz- -o- -ms- -khtml- ".split(" "),ab="Webkit Moz O ms Khtml".split(" "),Z={svg:"http://www.w3.org/2000/svg"},X={},V={},T={},R=[],Q=function(b,u,t,p){var o,n,m,g=aq.createElement("div");if(parseInt(t,10)){while(t--){m=aq.createElement("div"),m.id=p?p[t]:aj+(t+1),g.appendChild(m)}}o=["&shy;","<style>",b,"</style>"].join(""),g.id=aj,g.innerHTML+=o,al.appendChild(g),n=u(g,b),g.parentNode.removeChild(g);return !!n},N=function(){function c(j,h){h=h||aq.createElement(b[j]||"div"),j="on"+j;var g=j in h;g||(h.setAttribute||(h=aq.createElement("div")),h.setAttribute&&h.removeAttribute&&(h.setAttribute(j,""),g=Y(h[j],"function"),Y(h[j],ap)||(h[j]=ap),h.removeAttribute(j))),h=null;return g}var b={select:"input",change:"input",submit:"form",reset:"form",error:"img",load:"img",abort:"img"};return c}(),M,K={}.hasOwnProperty,J;!Y(K,ap)&&!Y(K.call,ap)?J=function(e,c){return K.call(e,c)}:J=function(e,c){return c in e&&Y(e.constructor.prototype[c],ap)};var P=function(j,h){var e=j.join(""),b=h.length;Q(e,function(p,o){var n=aq.styleSheets[aq.styleSheets.length-1],m=n.cssRules&&n.cssRules[0]?n.cssRules[0].cssText:n.cssText||"",k=p.childNodes,g={};while(b--){g[k[b].id]=k[b]}an.touch="ontouchstart" in ar||g.touch.offsetTop===9,an.csstransforms3d=g.csstransforms3d.offsetLeft===9,an.generatedcontent=g.generatedcontent.offsetHeight>=1,an.fontface=/src/i.test(m)&&m.indexOf(o.split(" ")[0])===0},b,h)}(['@font-face {font-family:"font";src:url("https://")}',["@media (",ad.join("touch-enabled),("),aj,")","{#touch{top:9px;position:absolute}}"].join(""),["@media (",ad.join("transform-3d),("),aj,")","{#csstransforms3d{left:9px;position:absolute}}"].join(""),['#generatedcontent:after{content:"',af,'";visibility:hidden}'].join("")],["fontface","touch","csstransforms3d","generatedcontent"]);X.flexbox=function(){function k(f,e,n,m){f.style.cssText=ad.join(e+":"+n+";")+(m||"")}function b(f,e,n,m){e+=":",f.style.cssText=(e+ad.join(n+";"+e)).slice(0,-e.length)+(m||"")}var j=aq.createElement("div"),h=aq.createElement("div");b(j,"display","box","width:42px;padding:0;"),k(h,"box-flex","1","width:10px;"),j.appendChild(h),al.appendChild(j);var g=h.offsetWidth===42;j.removeChild(h),al.removeChild(j);return g},X.canvas=function(){var b=aq.createElement("canvas");return !!b.getContext&&!!b.getContext("2d")},X.canvastext=function(){return !!an.canvas&&!!Y(aq.createElement("canvas").getContext("2d").fillText,"function")},X.webgl=function(){return !!ar.WebGLRenderingContext},X.touch=function(){return an.touch},X.geolocation=function(){return !!navigator.geolocation},X.postmessage=function(){return !!ar.postMessage},X.websqldatabase=function(){var c=!!ar.openDatabase;return c},X.indexedDB=function(){for(var e=-1,f=ab.length;++e<f;){if(ar[ab[e].toLowerCase()+"IndexedDB"]){return !0}}return !!ar.indexedDB},X.hashchange=function(){return N("hashchange",ar)&&(aq.documentMode===ap||aq.documentMode>7)},X.history=function(){return !!ar.history&&!!history.pushState},X.draganddrop=function(){return N("dragstart")&&N("drop")},X.websockets=function(){for(var e=-1,f=ab.length;++e<f;){if(ar[ab[e]+"WebSocket"]){return !0}}return"WebSocket" in ar},X.rgba=function(){ac("background-color:rgba(150,255,150,.5)");return W(ah.backgroundColor,"rgba")},X.hsla=function(){ac("background-color:hsla(120,40%,100%,.5)");return W(ah.backgroundColor,"rgba")||W(ah.backgroundColor,"hsla")},X.multiplebgs=function(){ac("background:url(https://),url(https://),red url(https://)");return/(url\s*\(.*?){3}/.test(ah.background)},X.backgroundsize=function(){return S("backgroundSize")},X.borderimage=function(){return S("borderImage")},X.borderradius=function(){return S("borderRadius")},X.boxshadow=function(){return S("boxShadow")},X.textshadow=function(){return aq.createElement("div").style.textShadow===""},X.opacity=function(){aa("opacity:.55");return/^0.55$/.test(ah.opacity)},X.cssanimations=function(){return S("animationName")},X.csscolumns=function(){return S("columnCount")},X.cssgradients=function(){var f="background-image:",e="gradient(linear,left top,right bottom,from(#9f9),to(white));",g="linear-gradient(left top,#9f9, white);";ac((f+ad.join(e+f)+ad.join(g+f)).slice(0,-f.length));return W(ah.backgroundImage,"gradient")},X.cssreflections=function(){return S("boxReflect")},X.csstransforms=function(){return !!U(["transformProperty","WebkitTransform","MozTransform","OTransform","msTransform"])},X.csstransforms3d=function(){var b=!!U(["perspectiveProperty","WebkitPerspective","MozPerspective","OPerspective","msPerspective"]);b&&"webkitPerspective" in al.style&&(b=an.csstransforms3d);return b},X.csstransitions=function(){return S("transitionProperty")},X.fontface=function(){return an.fontface},X.generatedcontent=function(){return an.generatedcontent},X.video=function(){var b=aq.createElement("video"),h=!1;try{if(h=!!b.canPlayType){h=new Boolean(h),h.ogg=b.canPlayType('video/ogg; codecs="theora"');var g='video/mp4; codecs="avc1.42E01E';h.h264=b.canPlayType(g+'"')||b.canPlayType(g+', mp4a.40.2"'),h.webm=b.canPlayType('video/webm; codecs="vp8, vorbis"')}}catch(f){}return h},X.audio=function(){var b=aq.createElement("audio"),f=!1;try{if(f=!!b.canPlayType){f=new Boolean(f),f.ogg=b.canPlayType('audio/ogg; codecs="vorbis"'),f.mp3=b.canPlayType("audio/mpeg;"),f.wav=b.canPlayType('audio/wav; codecs="1"'),f.m4a=b.canPlayType("audio/x-m4a;")||b.canPlayType("audio/aac;")}}catch(e){}return f},X.localstorage=function(){try{return !!localStorage.getItem}catch(b){return !1}},X.sessionstorage=function(){try{return !!sessionStorage.getItem}catch(b){return !1}},X.webworkers=function(){return !!ar.Worker},X.applicationcache=function(){return !!ar.applicationCache},X.svg=function(){return !!aq.createElementNS&&!!aq.createElementNS(Z.svg,"svg").createSVGRect},X.inlinesvg=function(){var b=aq.createElement("div");b.innerHTML="<svg/>";return(b.firstChild&&b.firstChild.namespaceURI)==Z.svg},X.smil=function(){return !!aq.createElementNS&&/SVG/.test(ae.call(aq.createElementNS(Z.svg,"animate")))},X.svgclippaths=function(){return !!aq.createElementNS&&/SVG/.test(ae.call(aq.createElementNS(Z.svg,"clipPath")))};for(var L in X){J(X,L)&&(M=L.toLowerCase(),an[M]=X[L](),R.push((an[M]?"":"no-")+M))}an.input||O(),ac(""),ai=ag=null,ar.attachEvent&&function(){var b=aq.createElement("div");b.innerHTML="<elem></elem>";return b.childNodes.length!==1}()&&function(at,I){function c(f){var e=-1;while(++e<E){f.createElement(F[e])}}at.iepp=at.iepp||{};var H=at.iepp,G=H.html5elements||"abbr|article|aside|audio|canvas|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",F=G.split("|"),E=F.length,D=new RegExp("(^|\\s)("+G+")","gi"),C=new RegExp("<(/*)("+G+")","gi"),B=/^\s*[\{\}]\s*$/,A=new RegExp("(^|[^\\n]*?\\s)("+G+")([^\\n]*)({[\\n\\w\\W]*?})","gi"),z=I.createDocumentFragment(),y=I.documentElement,x=y.firstChild,w=I.createElement("body"),v=I.createElement("style"),u=/print|all/,t;H.getCSS=function(k,j){if(k+""===ap){return""}var p=-1,o=k.length,n,m=[];while(++p<o){n=k[p];if(n.disabled){continue}j=n.media||j,u.test(j)&&m.push(H.getCSS(n.imports,j),n.cssText),j="all"}return m.join("")},H.parseCSS=function(f){var e=[],g;while((g=A.exec(f))!=null){e.push(((B.exec(g[1])?"\n":g[1])+g[2]+g[3]).replace(D,"$1.iepp_$2")+g[4])}return e.join("\n")},H.writeHTML=function(){var b=-1;t=t||I.body;while(++b<E){var h=I.getElementsByTagName(F[b]),g=h.length,f=-1;while(++f<g){h[f].className.indexOf("iepp_")<0&&(h[f].className+=" iepp_"+F[b])}}z.appendChild(t),y.appendChild(w),w.className=t.className,w.id=t.id,w.innerHTML=t.innerHTML.replace(C,"<$1font")},H._beforePrint=function(){v.styleSheet.cssText=H.parseCSS(H.getCSS(I.styleSheets,"all")),H.writeHTML()},H.restoreHTML=function(){w.innerHTML="",y.removeChild(w),y.appendChild(t)},H._afterPrint=function(){H.restoreHTML(),v.styleSheet.cssText=""},c(I),c(z);H.disablePP||(x.insertBefore(v,x.firstChild),v.media="print",v.className="iepp-printshim",at.attachEvent("onbeforeprint",H._beforePrint),at.attachEvent("onafterprint",H._afterPrint))}(ar,aq),an._version=ao,an._prefixes=ad,an._domPrefixes=ab,an.hasEvent=N,an.testProp=function(b){return U([b])},an.testAllProps=S,an.testStyles=Q,al.className=al.className.replace(/\bno-js\b/,"")+(am?" js "+R.join(" "):"");return an}(this,this.document),function(ap,ao,an){function af(b){return !b||b=="loaded"||b=="complete"}function ag(){var e=1,c=-1;while(aa.length- ++c){if(aa[c].s&&!(e=aa[c].r)){break}}e&&aj()}function ah(b){var f=ao.createElement("script"),e;f.src=b.s,f.onreadystatechange=f.onload=function(){!e&&af(f.readyState)&&(e=1,ag(),f.onload=f.onreadystatechange=null)},ad(function(){e||(e=1,ag())},L.errorTimeout),b.e?f.onload():ac.parentNode.insertBefore(f,ac)}function ai(b){var h=ao.createElement("link"),g;h.href=b.s,h.rel="stylesheet",h.type="text/css";if(!b.e&&(M||W)){var f=function(c){ad(function(){if(!g){try{c.sheet.cssRules.length?(g=1,ag()):f(c)}catch(e){e.code==1000||e.message=="security"||e.message=="denied"?(g=1,ad(function(){ag()},0)):f(c)}}},0)};f(h)}else{h.onload=function(){g||(g=1,ad(function(){ag()},0))},b.e&&h.onload()}ad(function(){g||(g=1,ag())},L.errorTimeout),!b.e&&ac.parentNode.insertBefore(h,ac)}function aj(){var b=aa.shift();Y=1,b?b.t?ad(function(){b.t=="c"?ai(b):ah(b)},0):(b(),ag()):Y=0}function ak(v,u,t,p,n,m){function k(){!g&&af(j.readyState)&&(b.r=g=1,!Y&&ag(),j.onload=j.onreadystatechange=null,ad(function(){Q.removeChild(j)},0))}var j=ao.createElement(v),g=0,b={t:t,s:u,e:m};j.src=j.data=u,!U&&(j.style.display="none"),j.width=j.height="0",v!="object"&&(j.type=t),j.onload=j.onreadystatechange=k,v=="img"?j.onerror=k:v=="script"&&(j.onerror=function(){b.e=b.r=1,aj()}),aa.splice(p,0,b),Q.insertBefore(j,U?null:ac),ad(function(){g||(Q.removeChild(j),b.r=b.e=g=1,ag())},L.errorTimeout)}function al(f,e,h){var g=e=="c"?I:J;Y=0,e=e||"j",V(f)?ak(g,f,e,this.i++,ae,h):(aa.splice(this.i++,0,f),aa.length==1&&aj());return this}function am(){var b=L;b.loader={load:al,i:0};return b}var ae=ao.documentElement,ad=ap.setTimeout,ac=ao.getElementsByTagName("script")[0],ab={}.toString,aa=[],Y=0,W="MozAppearance" in ae.style,U=W&&!!ao.createRange().compareNode,S=W&&!U,Q=U?ae:ac.parentNode,O=ap.opera&&ab.call(ap.opera)=="[object Opera]",M="webkitAppearance" in ae.style,K=M&&"async" in ao.createElement("script"),J=W?"object":O||K?"img":"script",I=M?"img":J,Z=Array.isArray||function(b){return ab.call(b)=="[object Array]"},X=function(b){return Object(b)===b},V=function(b){return typeof b=="string"},T=function(b){return ab.call(b)=="[object Function]"},R=[],P={},N,L;L=function(j){function o(u){var t=u.split("!"),A=R.length,z=t.pop(),y=t.length,x={url:z,origUrl:z,prefixes:t},w,v;for(v=0;v<y;v++){w=P[t[v]],w&&(x=w(x))}for(v=0;v<A;v++){x=R[v](x)}return x}function p(t,f,y,x,w){var v=o(t),u=v.autoCallback;if(!v.bypass){f&&(f=T(f)?f:f[t]||f[x]||f[t.split("/").pop().split("?")[0]]);if(v.instead){return v.instead(t,f,y,x,w)}y.load(v.url,v.forceCSS||!v.forceJS&&/css$/.test(v.url)?"c":an,v.noexec),(T(f)||T(u))&&y.load(function(){am(),f&&f(v.origUrl,w,x),u&&u(v.origUrl,w,x)})}}function c(t,e){function z(b){if(V(b)){p(b,v,e,0,y)}else{if(X(b)){for(u in b){b.hasOwnProperty(u)&&p(b[u],v,e,u,y)}}}}var y=!!t.test,x=y?t.yep:t.nope,w=t.load||t.both,v=t.callback,u;z(x),z(w),t.complete&&e.load(t.complete)}var n,m,k=this.yepnope.loader;if(V(j)){p(j,0,k,0)}else{if(Z(j)){for(n=0;n<j.length;n++){m=j[n],V(m)?p(m,0,k,0):Z(m)?L(m):X(m)&&c(m,k)}}else{X(j)&&c(j,k)}}},L.addPrefix=function(e,c){P[e]=c},L.addFilter=function(b){R.push(b)},L.errorTimeout=10000,ao.readyState==null&&ao.addEventListener&&(ao.readyState="loading",ao.addEventListener("DOMContentLoaded",N=function(){ao.removeEventListener("DOMContentLoaded",N,0),ao.readyState="complete"},0)),ap.yepnope=am()}(this,this.document),Modernizr.load=function(){yepnope.apply(window,[].slice.call(arguments,0))};var THREE=THREE||{};if(!window.Int32Array){window.Int32Array=Array,window.Float32Array=Array}THREE.Color=function(c){c!==void 0&&this.setHex(c);return this};THREE.Color.prototype={constructor:THREE.Color,r:1,g:1,b:1,copy:function(c){this.r=c.r;this.g=c.g;this.b=c.b;return this},setRGB:function(f,h,g){this.r=f;this.g=h;this.b=g;return this},setHSV:function(h,p,o){var n,m,k;if(o==0){this.r=this.g=this.b=0}else{switch(n=Math.floor(h*6),m=h*6-n,h=o*(1-p),k=o*(1-p*m),p=o*(1-p*(1-m)),n){case 1:this.r=k;this.g=o;this.b=h;break;case 2:this.r=h;this.g=o;this.b=p;break;case 3:this.r=h;this.g=k;this.b=o;break;case 4:this.r=p;this.g=h;this.b=o;break;case 5:this.r=o;this.g=h;this.b=k;break;case 6:case 0:this.r=o,this.g=p,this.b=h}}return this},setHex:function(c){c=Math.floor(c);this.r=(c>>16&255)/255;this.g=(c>>8&255)/255;this.b=(c&255)/255;return this},getHex:function(){return ~~(this.r*255)<<16^~~(this.g*255)<<8^~~(this.b*255)},getContextStyle:function(){return"rgb("+Math.floor(this.r*255)+","+Math.floor(this.g*255)+","+Math.floor(this.b*255)+")"},clone:function(){return(new THREE.Color).setRGB(this.r,this.g,this.b)}};THREE.Vector2=function(e,f){this.set(e||0,f||0)};THREE.Vector2.prototype={constructor:THREE.Vector2,set:function(e,f){this.x=e;this.y=f;return this},copy:function(c){this.x=c.x;this.y=c.y;return this},clone:function(){return new THREE.Vector2(this.x,this.y)},add:function(e,f){this.x=e.x+f.x;this.y=e.y+f.y;return this},addSelf:function(c){this.x+=c.x;this.y+=c.y;return this},sub:function(e,f){this.x=e.x-f.x;this.y=e.y-f.y;return this},subSelf:function(c){this.x-=c.x;this.y-=c.y;return this},multiplyScalar:function(c){this.x*=c;this.y*=c;return this},divideScalar:function(c){c?(this.x/=c,this.y/=c):this.set(0,0);return this},negate:function(){return this.multiplyScalar(-1)},dot:function(c){return this.x*c.x+this.y*c.y},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.lengthSq())},normalize:function(){return this.divideScalar(this.length())},distanceTo:function(c){return Math.sqrt(this.distanceToSquared(c))},distanceToSquared:function(e){var f=this.x-e.x,e=this.y-e.y;return f*f+e*e},setLength:function(c){return this.normalize().multiplyScalar(c)},unit:function(){return this.normalize()},equals:function(c){return c.x==this.x&&c.y==this.y}};THREE.Vector3=function(f,h,g){this.set(f||0,h||0,g||0)};THREE.Vector3.prototype={constructor:THREE.Vector3,set:function(f,h,g){this.x=f;this.y=h;this.z=g;return this},copy:function(c){this.x=c.x;this.y=c.y;this.z=c.z;return this},clone:function(){return new THREE.Vector3(this.x,this.y,this.z)},add:function(e,f){this.x=e.x+f.x;this.y=e.y+f.y;this.z=e.z+f.z;return this},addSelf:function(c){this.x+=c.x;this.y+=c.y;this.z+=c.z;return this},addScalar:function(c){this.x+=c;this.y+=c;this.z+=c;return this},sub:function(e,f){this.x=e.x-f.x;this.y=e.y-f.y;this.z=e.z-f.z;return this},subSelf:function(c){this.x-=c.x;this.y-=c.y;this.z-=c.z;return this},multiply:function(e,f){this.x=e.x*f.x;this.y=e.y*f.y;this.z=e.z*f.z;return this},multiplySelf:function(c){this.x*=c.x;this.y*=c.y;this.z*=c.z;return this},multiplyScalar:function(c){this.x*=c;this.y*=c;this.z*=c;return this},divideSelf:function(c){return this.divide(this,c)},divideScalar:function(c){c?(this.x/=c,this.y/=c,this.z/=c):this.set(0,0,0);return this},negate:function(){return this.multiplyScalar(-1)},dot:function(c){return this.x*c.x+this.y*c.y+this.z*c.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.lengthSq())},lengthManhattan:function(){return this.x+this.y+this.z},normalize:function(){return this.divideScalar(this.length())},setLength:function(c){return this.normalize().multiplyScalar(c)},cross:function(e,f){this.x=e.y*f.z-e.z*f.y;this.y=e.z*f.x-e.x*f.z;this.z=e.x*f.y-e.y*f.x;return this},crossSelf:function(c){return this.set(this.y*c.z-this.z*c.y,this.z*c.x-this.x*c.z,this.x*c.y-this.y*c.x)},distanceTo:function(c){return Math.sqrt(this.distanceToSquared(c))},distanceToSquared:function(c){return(new THREE.Vector3).sub(this,c).lengthSq()},setPositionFromMatrix:function(c){this.x=c.n14;this.y=c.n24;this.z=c.n34},setRotationFromMatrix:function(e){var f=Math.cos(this.y);this.y=Math.asin(e.n13);Math.abs(f)>0.00001?(this.x=Math.atan2(-e.n23/f,e.n33/f),this.z=Math.atan2(-e.n12/f,e.n11/f)):(this.x=0,this.z=Math.atan2(e.n21,e.n22))},isZero:function(){return this.lengthSq()<0.0001}};THREE.Vector4=function(g,k,j,h){this.set(g||0,k||0,j||0,h||1)};THREE.Vector4.prototype={constructor:THREE.Vector4,set:function(g,k,j,h){this.x=g;this.y=k;this.z=j;this.w=h;return this},copy:function(c){return this.set(c.x,c.y,c.z,c.w||1)},clone:function(){return new THREE.Vector4(this.x,this.y,this.z,this.w)},add:function(e,f){this.x=e.x+f.x;this.y=e.y+f.y;this.z=e.z+f.z;this.w=e.w+f.w;return this},addSelf:function(c){this.x+=c.x;this.y+=c.y;this.z+=c.z;this.w+=c.w;return this},sub:function(e,f){this.x=e.x-f.x;this.y=e.y-f.y;this.z=e.z-f.z;this.w=e.w-f.w;return this},subSelf:function(c){this.x-=c.x;this.y-=c.y;this.z-=c.z;this.w-=c.w;return this},multiplyScalar:function(c){this.x*=c;this.y*=c;this.z*=c;this.w*=c;return this},divideScalar:function(c){c?(this.x/=c,this.y/=c,this.z/=c,this.w/=c):this.set(0,0,0,1);return this},negate:function(){return this.multiplyScalar(-1)},dot:function(c){return this.x*c.x+this.y*c.y+this.z*c.z+this.w*c.w},lengthSq:function(){return this.dot(this)},length:function(){return Math.sqrt(this.lengthSq())},normalize:function(){return this.divideScalar(this.length())},setLength:function(c){return this.normalize().multiplyScalar(c)},lerpSelf:function(e,f){this.x+=(e.x-this.x)*f;this.y+=(e.y-this.y)*f;this.z+=(e.z-this.z)*f;this.w+=(e.w-this.w)*f;return this}};THREE.Ray=function(e,f){this.origin=e||new THREE.Vector3;this.direction=f||new THREE.Vector3};THREE.Ray.prototype={constructor:THREE.Ray,intersectScene:function(c){return this.intersectObjects(c.objects)},intersectObjects:function(g){var k,j,h=[];k=0;for(j=g.length;k<j;k++){h=h.concat(this.intersectObject(g[k]))}h.sort(function(e,f){return e.distance-f.distance});return h},intersectObject:function(J){function I(g,k,j){var h,j=j.matrixWorld.getPosition();h=j.clone().subSelf(g).dot(k);g=g.clone().addSelf(k.clone().multiplyScalar(h));return j.distanceTo(g)}function H(j,t,p,o){var o=o.clone().subSelf(t),p=p.clone().subSelf(t),m=j.clone().subSelf(t),j=o.dot(o),t=o.dot(p),o=o.dot(m),k=p.dot(p),p=p.dot(m),m=1/(j*k-t*t),k=(k*o-t*p)*m,j=(j*p-t*o)*m;return k>0&&j>0&&k+j<1}if(J instanceof THREE.Particle){var G=I(this.origin,this.direction,J);if(!G||G>J.scale.x){return[]}return[{distance:G,point:J.position,face:null,object:J}]}else{if(J instanceof THREE.Mesh){G=I(this.origin,this.direction,J);if(!G||G>J.geometry.boundingSphere.radius*Math.max(J.scale.x,Math.max(J.scale.y,J.scale.z))){return[]}var F,D,E,C,z,A,y,N,M,O,L=J.geometry,K=L.vertices,n=[],G=0;for(F=L.faces.length;G<F;G++){if(D=L.faces[G],M=this.origin.clone(),O=this.direction.clone(),A=J.matrixWorld,E=A.multiplyVector3(K[D.a].position.clone()),C=A.multiplyVector3(K[D.b].position.clone()),z=A.multiplyVector3(K[D.c].position.clone()),A=D instanceof THREE.Face4?A.multiplyVector3(K[D.d].position.clone()):null,y=J.matrixRotationWorld.multiplyVector3(D.normal.clone()),N=O.dot(y),J.doubleSided||(J.flipSided?N>0:N<0)){if(y=y.dot((new THREE.Vector3).sub(E,M))/N,M=M.addSelf(O.multiplyScalar(y)),D instanceof THREE.Face3){H(M,E,C,z)&&(D={distance:this.origin.distanceTo(M),point:M,face:D,object:J},n.push(D))}else{if(D instanceof THREE.Face4&&(H(M,E,C,A)||H(M,C,z,A))){D={distance:this.origin.distanceTo(M),point:M,face:D,object:J},n.push(D)}}}}return n}else{return[]}}}};THREE.Rectangle=function(){function m(){o=u-w;p=t-v}var w,v,u,t,o,p,n=!0;this.getX=function(){return w};this.getY=function(){return v};this.getWidth=function(){return o};this.getHeight=function(){return p};this.getLeft=function(){return w};this.getTop=function(){return v};this.getRight=function(){return u};this.getBottom=function(){return t};this.set=function(e,c,f,b){n=!1;w=e;v=c;u=f;t=b;m()};this.addPoint=function(c,b){n?(n=!1,w=c,v=b,u=c,t=b):(w=w<c?w:c,v=v<b?v:b,u=u>c?u:c,t=t>b?t:b);m()};this.add3Points=function(g,e,k,c,b,f){n?(n=!1,w=g<k?g<b?g:b:k<b?k:b,v=e<c?e<f?e:f:c<f?c:f,u=g>k?g>b?g:b:k>b?k:b,t=e>c?e>f?e:f:c>f?c:f):(w=g<k?g<b?g<w?g:w:b<w?b:w:k<b?k<w?k:w:b<w?b:w,v=e<c?e<f?e<v?e:v:f<v?f:v:c<f?c<v?c:v:f<v?f:v,u=g>k?g>b?g>u?g:u:b>u?b:u:k>b?k>u?k:u:b>u?b:u,t=e>c?e>f?e>t?e:t:f>t?f:t:c>f?c>t?c:t:f>t?f:t);m()};this.addRectangle=function(b){n?(n=!1,w=b.getLeft(),v=b.getTop(),u=b.getRight(),t=b.getBottom()):(w=w<b.getLeft()?w:b.getLeft(),v=v<b.getTop()?v:b.getTop(),u=u>b.getRight()?u:b.getRight(),t=t>b.getBottom()?t:b.getBottom());m()};this.inflate=function(b){w-=b;v-=b;u+=b;t+=b;m()};this.minSelf=function(b){w=w>b.getLeft()?w:b.getLeft();v=v>b.getTop()?v:b.getTop();u=u<b.getRight()?u:b.getRight();t=t<b.getBottom()?t:b.getBottom();m()};this.instersects=function(c){return Math.min(u,c.getRight())-Math.max(w,c.getLeft())>=0&&Math.min(t,c.getBottom())-Math.max(v,c.getTop())>=0};this.empty=function(){n=!0;t=u=v=w=0;m()};this.isEmpty=function(){return n}};THREE.Matrix3=function(){this.m=[]};THREE.Matrix3.prototype={constructor:THREE.Matrix3,transpose:function(){var e,f=this.m;e=f[1];f[1]=f[3];f[3]=e;e=f[2];f[2]=f[6];f[6]=e;e=f[5];f[5]=f[7];f[7]=e;return this},transposeIntoArray:function(e){var f=this.m;e[0]=f[0];e[1]=f[3];e[2]=f[6];e[3]=f[1];e[4]=f[4];e[5]=f[7];e[6]=f[2];e[7]=f[5];e[8]=f[8];return this}};THREE.Matrix4=function(H,G,F,E,D,B,C,A,y,z,n,L,K,M,J,I){this.set(H||1,G||0,F||0,E||0,D||0,B||1,C||0,A||0,y||0,z||0,n||1,L||0,K||0,M||0,J||0,I||1);this.flat=Array(16);this.m33=new THREE.Matrix3};THREE.Matrix4.prototype={constructor:THREE.Matrix4,set:function(H,G,F,E,D,B,C,A,y,z,n,L,K,M,J,I){this.n11=H;this.n12=G;this.n13=F;this.n14=E;this.n21=D;this.n22=B;this.n23=C;this.n24=A;this.n31=y;this.n32=z;this.n33=n;this.n34=L;this.n41=K;this.n42=M;this.n43=J;this.n44=I;return this},identity:function(){this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1);return this},copy:function(c){this.set(c.n11,c.n12,c.n13,c.n14,c.n21,c.n22,c.n23,c.n24,c.n31,c.n32,c.n33,c.n34,c.n41,c.n42,c.n43,c.n44);return this},lookAt:function(h,p,o){var n=THREE.Matrix4.__v1,m=THREE.Matrix4.__v2,k=THREE.Matrix4.__v3;k.sub(h,p).normalize();if(k.length()===0){k.z=1}n.cross(o,k).normalize();n.length()===0&&(k.x+=0.0001,n.cross(o,k).normalize());m.cross(k,n).normalize();this.n11=n.x;this.n12=m.x;this.n13=k.x;this.n21=n.y;this.n22=m.y;this.n23=k.y;this.n31=n.z;this.n32=m.z;this.n33=k.z;return this},multiplyVector3:function(h){var n=h.x,m=h.y,k=h.z,j=1/(this.n41*n+this.n42*m+this.n43*k+this.n44);h.x=(this.n11*n+this.n12*m+this.n13*k+this.n14)*j;h.y=(this.n21*n+this.n22*m+this.n23*k+this.n24)*j;h.z=(this.n31*n+this.n32*m+this.n33*k+this.n34)*j;return h},multiplyVector4:function(h){var n=h.x,m=h.y,k=h.z,j=h.w;h.x=this.n11*n+this.n12*m+this.n13*k+this.n14*j;h.y=this.n21*n+this.n22*m+this.n23*k+this.n24*j;h.z=this.n31*n+this.n32*m+this.n33*k+this.n34*j;h.w=this.n41*n+this.n42*m+this.n43*k+this.n44*j;return h},rotateAxis:function(g){var k=g.x,j=g.y,h=g.z;g.x=k*this.n11+j*this.n12+h*this.n13;g.y=k*this.n21+j*this.n22+h*this.n23;g.z=k*this.n31+j*this.n32+h*this.n33;g.normalize();return g},crossVector:function(e){var f=new THREE.Vector4;f.x=this.n11*e.x+this.n12*e.y+this.n13*e.z+this.n14*e.w;f.y=this.n21*e.x+this.n22*e.y+this.n23*e.z+this.n24*e.w;f.z=this.n31*e.x+this.n32*e.y+this.n33*e.z+this.n34*e.w;f.w=e.w?this.n41*e.x+this.n42*e.y+this.n43*e.z+this.n44*e.w:1;return f},multiply:function(aw,av){var au=aw.n11,at=aw.n12,ar=aw.n13,ap=aw.n14,aq=aw.n21,ao=aw.n22,ak=aw.n23,an=aw.n24,aj=aw.n31,ac=aw.n32,ab=aw.n33,ae=aw.n34,Z=aw.n41,U=aw.n42,ah=aw.n43,ai=aw.n44,Y=av.n11,Q=av.n12,aa=av.n13,T=av.n14,ad=av.n21,O=av.n22,af=av.n23,P=av.n24,M=av.n31,z=av.n32,N=av.n33,ag=av.n34,am=av.n41,F=av.n42,L=av.n43,al=av.n44;this.n11=au*Y+at*ad+ar*M+ap*am;this.n12=au*Q+at*O+ar*z+ap*F;this.n13=au*aa+at*af+ar*N+ap*L;this.n14=au*T+at*P+ar*ag+ap*al;this.n21=aq*Y+ao*ad+ak*M+an*am;this.n22=aq*Q+ao*O+ak*z+an*F;this.n23=aq*aa+ao*af+ak*N+an*L;this.n24=aq*T+ao*P+ak*ag+an*al;this.n31=aj*Y+ac*ad+ab*M+ae*am;this.n32=aj*Q+ac*O+ab*z+ae*F;this.n33=aj*aa+ac*af+ab*N+ae*L;this.n34=aj*T+ac*P+ab*ag+ae*al;this.n41=Z*Y+U*ad+ah*M+ai*am;this.n42=Z*Q+U*O+ah*z+ai*F;this.n43=Z*aa+U*af+ah*N+ai*L;this.n44=Z*T+U*P+ah*ag+ai*al;return this},multiplyToArray:function(f,h,g){this.multiply(f,h);g[0]=this.n11;g[1]=this.n21;g[2]=this.n31;g[3]=this.n41;g[4]=this.n12;g[5]=this.n22;g[6]=this.n32;g[7]=this.n42;g[8]=this.n13;g[9]=this.n23;g[10]=this.n33;g[11]=this.n43;g[12]=this.n14;g[13]=this.n24;g[14]=this.n34;g[15]=this.n44;return this},multiplySelf:function(c){this.multiply(this,c);return this},multiplyScalar:function(c){this.n11*=c;this.n12*=c;this.n13*=c;this.n14*=c;this.n21*=c;this.n22*=c;this.n23*=c;this.n24*=c;this.n31*=c;this.n32*=c;this.n33*=c;this.n34*=c;this.n41*=c;this.n42*=c;this.n43*=c;this.n44*=c;return this},determinant:function(){var H=this.n11,G=this.n12,F=this.n13,E=this.n14,D=this.n21,B=this.n22,C=this.n23,A=this.n24,y=this.n31,z=this.n32,n=this.n33,L=this.n34,K=this.n41,M=this.n42,J=this.n43,I=this.n44;return E*C*z*K-F*A*z*K-E*B*n*K+G*A*n*K+F*B*L*K-G*C*L*K-E*C*y*M+F*A*y*M+E*D*n*M-H*A*n*M-F*D*L*M+H*C*L*M+E*B*y*J-G*A*y*J-E*D*z*J+H*A*z*J+G*D*L*J-H*B*L*J-F*B*y*I+G*C*y*I+F*D*z*I-H*C*z*I-G*D*n*I+H*B*n*I},transpose:function(){var c;c=this.n21;this.n21=this.n12;this.n12=c;c=this.n31;this.n31=this.n13;this.n13=c;c=this.n32;this.n32=this.n23;this.n23=c;c=this.n41;this.n41=this.n14;this.n14=c;c=this.n42;this.n42=this.n24;this.n24=c;c=this.n43;this.n43=this.n34;this.n43=c;return this},clone:function(){var c=new THREE.Matrix4;c.n11=this.n11;c.n12=this.n12;c.n13=this.n13;c.n14=this.n14;c.n21=this.n21;c.n22=this.n22;c.n23=this.n23;c.n24=this.n24;c.n31=this.n31;c.n32=this.n32;c.n33=this.n33;c.n34=this.n34;c.n41=this.n41;c.n42=this.n42;c.n43=this.n43;c.n44=this.n44;return c},flatten:function(){this.flat[0]=this.n11;this.flat[1]=this.n21;this.flat[2]=this.n31;this.flat[3]=this.n41;this.flat[4]=this.n12;this.flat[5]=this.n22;this.flat[6]=this.n32;this.flat[7]=this.n42;this.flat[8]=this.n13;this.flat[9]=this.n23;this.flat[10]=this.n33;this.flat[11]=this.n43;this.flat[12]=this.n14;this.flat[13]=this.n24;this.flat[14]=this.n34;this.flat[15]=this.n44;return this.flat},flattenToArray:function(c){c[0]=this.n11;c[1]=this.n21;c[2]=this.n31;c[3]=this.n41;c[4]=this.n12;c[5]=this.n22;c[6]=this.n32;c[7]=this.n42;c[8]=this.n13;c[9]=this.n23;c[10]=this.n33;c[11]=this.n43;c[12]=this.n14;c[13]=this.n24;c[14]=this.n34;c[15]=this.n44;return c},flattenToArrayOffset:function(e,f){e[f]=this.n11;e[f+1]=this.n21;e[f+2]=this.n31;e[f+3]=this.n41;e[f+4]=this.n12;e[f+5]=this.n22;e[f+6]=this.n32;e[f+7]=this.n42;e[f+8]=this.n13;e[f+9]=this.n23;e[f+10]=this.n33;e[f+11]=this.n43;e[f+12]=this.n14;e[f+13]=this.n24;e[f+14]=this.n34;e[f+15]=this.n44;return e},setTranslation:function(f,h,g){this.set(1,0,0,f,0,1,0,h,0,0,1,g,0,0,0,1);return this},setScale:function(f,h,g){this.set(f,0,0,0,0,h,0,0,0,0,g,0,0,0,0,1);return this},setRotationX:function(e){var f=Math.cos(e),e=Math.sin(e);this.set(1,0,0,0,0,f,-e,0,0,e,f,0,0,0,0,1);return this},setRotationY:function(e){var f=Math.cos(e),e=Math.sin(e);this.set(f,0,e,0,0,1,0,0,-e,0,f,0,0,0,0,1);return this},setRotationZ:function(e){var f=Math.cos(e),e=Math.sin(e);this.set(f,-e,0,0,e,f,0,0,0,0,1,0,0,0,0,1);return this},setRotationAxis:function(A,z){var y=Math.cos(z),x=Math.sin(z),w=1-y,u=A.x,v=A.y,t=A.z,n=w*u,p=w*v;this.set(n*u+y,n*v-x*t,n*t+x*v,0,n*v+x*t,p*v+y,p*t-x*u,0,n*t-x*v,p*t+x*u,w*t*t+y,0,0,0,0,1);return this},setPosition:function(c){this.n14=c.x;this.n24=c.y;this.n34=c.z;return this},getPosition:function(){if(!this.position){this.position=new THREE.Vector3}this.position.set(this.n14,this.n24,this.n34);return this.position},getColumnX:function(){if(!this.columnX){this.columnX=new THREE.Vector3}this.columnX.set(this.n11,this.n21,this.n31);return this.columnX},getColumnY:function(){if(!this.columnY){this.columnY=new THREE.Vector3}this.columnY.set(this.n12,this.n22,this.n32);return this.columnY},getColumnZ:function(){if(!this.columnZ){this.columnZ=new THREE.Vector3}this.columnZ.set(this.n13,this.n23,this.n33);return this.columnZ},setRotationFromEuler:function(D,C){var B=D.x,A=D.y,z=D.z,x=Math.cos(B),B=Math.sin(B),y=Math.cos(A),A=Math.sin(A),w=Math.cos(z),z=Math.sin(z);switch(C){case"YXZ":var t=y*w,v=y*z,n=A*w,E=A*z;this.n11=t+E*B;this.n12=n*B-v;this.n13=x*A;this.n21=x*z;this.n22=x*w;this.n23=-B;this.n31=v*B-n;this.n32=E+t*B;this.n33=x*y;break;case"ZXY":t=y*w;v=y*z;n=A*w;E=A*z;this.n11=t-E*B;this.n12=-x*z;this.n13=n+v*B;this.n21=v+n*B;this.n22=x*w;this.n23=E-t*B;this.n31=-x*A;this.n32=B;this.n33=x*y;break;case"ZYX":t=x*w;v=x*z;n=B*w;E=B*z;this.n11=y*w;this.n12=n*A-v;this.n13=t*A+E;this.n21=y*z;this.n22=E*A+t;this.n23=v*A-n;this.n31=-A;this.n32=B*y;this.n33=x*y;break;case"YZX":t=x*y;v=x*A;n=B*y;E=B*A;this.n11=y*w;this.n12=E-t*z;this.n13=n*z+v;this.n21=z;this.n22=x*w;this.n23=-B*w;this.n31=-A*w;this.n32=v*z+n;this.n33=t-E*z;break;case"XZY":t=x*y;v=x*A;n=B*y;E=B*A;this.n11=y*w;this.n12=-z;this.n13=A*w;this.n21=t*z+E;this.n22=x*w;this.n23=v*z-n;this.n31=n*z-v;this.n32=B*w;this.n33=E*z+t;break;default:t=x*w,v=x*z,n=B*w,E=B*z,this.n11=y*w,this.n12=-y*z,this.n13=A,this.n21=v+n*A,this.n22=t-E*A,this.n23=-B*y,this.n31=E-t*A,this.n32=n+v*A,this.n33=x*y}return this},setRotationFromQuaternion:function(A){var z=A.x,y=A.y,x=A.z,w=A.w,u=z+z,v=y+y,t=x+x,A=z*u,n=z*v;z*=t;var p=y*v;y*=t;x*=t;u*=w;v*=w;w*=t;this.n11=1-(p+x);this.n12=n-w;this.n13=z+v;this.n21=n+w;this.n22=1-(A+x);this.n23=y-u;this.n31=z-v;this.n32=y+u;this.n33=1-(A+p);return this},scale:function(f){var h=f.x,g=f.y,f=f.z;this.n11*=h;this.n12*=g;this.n13*=f;this.n21*=h;this.n22*=g;this.n23*=f;this.n31*=h;this.n32*=g;this.n33*=f;this.n41*=h;this.n42*=g;this.n43*=f;return this},extractPosition:function(c){this.n14=c.n14;this.n24=c.n24;this.n34=c.n34},extractRotation:function(h,n){var m=1/n.x,k=1/n.y,j=1/n.z;this.n11=h.n11*m;this.n21=h.n21*m;this.n31=h.n31*m;this.n12=h.n12*k;this.n22=h.n22*k;this.n32=h.n32*k;this.n13=h.n13*j;this.n23=h.n23*j;this.n33=h.n33*j}};THREE.Matrix4.makeInvert=function(Q,P){var O=Q.n11,N=Q.n12,M=Q.n13,K=Q.n14,L=Q.n21,J=Q.n22,H=Q.n23,I=Q.n24,G=Q.n31,C=Q.n32,z=Q.n33,D=Q.n34,y=Q.n41,n=Q.n42,E=Q.n43,F=Q.n44;P===void 0&&(P=new THREE.Matrix4);P.n11=H*D*n-I*z*n+I*C*E-J*D*E-H*C*F+J*z*F;P.n12=K*z*n-M*D*n-K*C*E+N*D*E+M*C*F-N*z*F;P.n13=M*I*n-K*H*n+K*J*E-N*I*E-M*J*F+N*H*F;P.n14=K*H*C-M*I*C-K*J*z+N*I*z+M*J*D-N*H*D;P.n21=I*z*y-H*D*y-I*G*E+L*D*E+H*G*F-L*z*F;P.n22=M*D*y-K*z*y+K*G*E-O*D*E-M*G*F+O*z*F;P.n23=K*H*y-M*I*y-K*L*E+O*I*E+M*L*F-O*H*F;P.n24=M*I*G-K*H*G+K*L*z-O*I*z-M*L*D+O*H*D;P.n31=J*D*y-I*C*y+I*G*n-L*D*n-J*G*F+L*C*F;P.n32=K*C*y-N*D*y-K*G*n+O*D*n+N*G*F-O*C*F;P.n33=M*I*y-K*J*y+K*L*n-O*I*n-N*L*F+O*J*F;P.n34=K*J*G-N*I*G-K*L*C+O*I*C+N*L*D-O*J*D;P.n41=H*C*y-J*z*y-H*G*n+L*z*n+J*G*E-L*C*E;P.n42=N*z*y-M*C*y+M*G*n-O*z*n-N*G*E+O*C*E;P.n43=M*J*y-N*H*y-M*L*n+O*H*n+N*L*E-O*J*E;P.n44=N*H*G-M*J*G+M*L*C-O*H*C-N*L*z+O*J*z;P.multiplyScalar(1/Q.determinant());return P};THREE.Matrix4.makeInvert3x3=function(D){var C=D.m33,B=C.m,A=D.n33*D.n22-D.n32*D.n23,z=-D.n33*D.n21+D.n31*D.n23,x=D.n32*D.n21-D.n31*D.n22,y=-D.n33*D.n12+D.n32*D.n13,w=D.n33*D.n11-D.n31*D.n13,t=-D.n32*D.n11+D.n31*D.n12,v=D.n23*D.n12-D.n22*D.n13,n=-D.n23*D.n11+D.n21*D.n13,E=D.n22*D.n11-D.n21*D.n12,D=D.n11*A+D.n21*y+D.n31*v;D==0&&console.error("THREE.Matrix4.makeInvert3x3: Matrix not invertible.");D=1/D;B[0]=D*A;B[1]=D*z;B[2]=D*x;B[3]=D*y;B[4]=D*w;B[5]=D*t;B[6]=D*v;B[7]=D*n;B[8]=D*E;return C};THREE.Matrix4.makeFrustum=function(k,u,t,p,o,m){var n;n=new THREE.Matrix4;n.n11=2*o/(u-k);n.n12=0;n.n13=(u+k)/(u-k);n.n14=0;n.n21=0;n.n22=2*o/(p-t);n.n23=(p+t)/(p-t);n.n24=0;n.n31=0;n.n32=0;n.n33=-(m+o)/(m-o);n.n34=-2*m*o/(m-o);n.n41=0;n.n42=0;n.n43=-1;n.n44=0;return n};THREE.Matrix4.makePerspective=function(h,n,m,k){var j,h=m*Math.tan(h*Math.PI/360);j=-h;return THREE.Matrix4.makeFrustum(j*n,h*n,j,h,m,k)};THREE.Matrix4.makeOrtho=function(A,z,y,x,w,u){var v,t,n,p;v=new THREE.Matrix4;t=z-A;n=y-x;p=u-w;v.n11=2/t;v.n12=0;v.n13=0;v.n14=-((z+A)/t);v.n21=0;v.n22=2/n;v.n23=0;v.n24=-((y+x)/n);v.n31=0;v.n32=0;v.n33=-2/p;v.n34=-((u+w)/p);v.n41=0;v.n42=0;v.n43=0;v.n44=1;return v};THREE.Matrix4.__v1=new THREE.Vector3;THREE.Matrix4.__v2=new THREE.Vector3;THREE.Matrix4.__v3=new THREE.Vector3;THREE.Object3D=function(){this.parent=void 0;this.children=[];this.up=new THREE.Vector3(0,1,0);this.position=new THREE.Vector3;this.rotation=new THREE.Vector3;this.eulerOrder="XYZ";this.scale=new THREE.Vector3(1,1,1);this.flipSided=this.doubleSided=this.dynamic=!1;this.renderDepth=null;this.rotationAutoUpdate=!0;this.matrix=new THREE.Matrix4;this.matrixWorld=new THREE.Matrix4;this.matrixRotationWorld=new THREE.Matrix4;this.matrixWorldNeedsUpdate=this.matrixAutoUpdate=!0;this.quaternion=new THREE.Quaternion;this.useQuaternion=!1;this.boundRadius=0;this.boundRadiusScale=1;this.visible=!0;this.receiveShadow=this.castShadow=!1;this._vector=new THREE.Vector3;this.name=""};THREE.Object3D.prototype={constructor:THREE.Object3D,translate:function(e,f){this.matrix.rotateAxis(f);this.position.addSelf(f.multiplyScalar(e))},translateX:function(c){this.translate(c,this._vector.set(1,0,0))},translateY:function(c){this.translate(c,this._vector.set(0,1,0))},translateZ:function(c){this.translate(c,this._vector.set(0,0,1))},lookAt:function(c){this.matrix.lookAt(c,this.position,this.up);this.rotationAutoUpdate&&this.rotation.setRotationFromMatrix(this.matrix)},addChild:function(e){if(this.children.indexOf(e)===-1){e.parent!==void 0&&e.parent.removeChild(e);e.parent=this;this.children.push(e);for(var f=this;f.parent!==void 0;){f=f.parent}f!==void 0&&f instanceof THREE.Scene&&f.addChildRecurse(e)}},removeChild:function(e){var f=this.children.indexOf(e);if(f!==-1){e.parent=void 0,this.children.splice(f,1)}},getChildByName:function(h,n){var m,k,j;m=0;for(k=this.children.length;m<k;m++){j=this.children[m];if(j.name===h){return j}if(n&&(j=j.getChildByName(h,n),j!==void 0)){return j}}},updateMatrix:function(){this.matrix.setPosition(this.position);this.useQuaternion?this.matrix.setRotationFromQuaternion(this.quaternion):this.matrix.setRotationFromEuler(this.rotation,this.eulerOrder);if(this.scale.x!==1||this.scale.y!==1||this.scale.z!==1){this.matrix.scale(this.scale),this.boundRadiusScale=Math.max(this.scale.x,Math.max(this.scale.y,this.scale.z))}this.matrixWorldNeedsUpdate=!0},update:function(g,k,j){this.matrixAutoUpdate&&this.updateMatrix();if(this.matrixWorldNeedsUpdate||k){g?this.matrixWorld.multiply(g,this.matrix):this.matrixWorld.copy(this.matrix),this.matrixRotationWorld.extractRotation(this.matrixWorld,this.scale),this.matrixWorldNeedsUpdate=!1,k=!0}for(var g=0,h=this.children.length;g<h;g++){this.children[g].update(this.matrixWorld,k,j)}}};THREE.Quaternion=function(g,k,j,h){this.set(g||0,k||0,j||0,h!==void 0?h:1)};THREE.Quaternion.prototype={constructor:THREE.Quaternion,set:function(g,k,j,h){this.x=g;this.y=k;this.z=j;this.w=h;return this},copy:function(c){this.x=c.x;this.y=c.y;this.z=c.z;this.w=c.w;return this},setFromEuler:function(m){var w=0.5*Math.PI/360,v=m.x*w,u=m.y*w,t=m.z*w,m=Math.cos(u),u=Math.sin(u),w=Math.cos(-t),t=Math.sin(-t),o=Math.cos(v),v=Math.sin(v),p=m*w,n=u*t;this.w=p*o-n*v;this.x=p*v+n*o;this.y=u*w*o+m*t*v;this.z=m*t*o-u*w*v;return this},setFromAxisAngle:function(g,k){var j=k/2,h=Math.sin(j);this.x=g.x*h;this.y=g.y*h;this.z=g.z*h;this.w=Math.cos(j);return this},calculateW:function(){this.w=-Math.sqrt(Math.abs(1-this.x*this.x-this.y*this.y-this.z*this.z));return this},inverse:function(){this.x*=-1;this.y*=-1;this.z*=-1;return this},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},normalize:function(){var c=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);c==0?this.w=this.z=this.y=this.x=0:(c=1/c,this.x*=c,this.y*=c,this.z*=c,this.w*=c);return this},multiplySelf:function(m){var w=this.x,v=this.y,u=this.z,t=this.w,o=m.x,p=m.y,n=m.z,m=m.w;this.x=w*m+t*o+v*n-u*p;this.y=v*m+t*p+u*o-w*n;this.z=u*m+t*n+w*p-v*o;this.w=t*m-w*o-v*p-u*n;return this},multiply:function(e,f){this.x=e.x*f.w+e.y*f.z-e.z*f.y+e.w*f.x;this.y=-e.x*f.z+e.y*f.w+e.z*f.x+e.w*f.y;this.z=e.x*f.y-e.y*f.x+e.z*f.w+e.w*f.z;this.w=-e.x*f.x-e.y*f.y-e.z*f.z+e.w*f.w;return this},multiplyVector3:function(D,C){C||(C=D);var B=D.x,A=D.y,z=D.z,x=this.x,y=this.y,w=this.z,t=this.w,v=t*B+y*z-w*A,n=t*A+w*B-x*z,E=t*z+x*A-y*B,B=-x*B-y*A-w*z;C.x=v*t+B*-x+n*-w-E*-y;C.y=n*t+B*-y+E*-x-v*-w;C.z=E*t+B*-w+v*-y-n*-x;return C}};THREE.Quaternion.slerp=function(k,u,t,p){var o=k.w*u.w+k.x*u.x+k.y*u.y+k.z*u.z;if(Math.abs(o)>=1){return t.w=k.w,t.x=k.x,t.y=k.y,t.z=k.z,t}var m=Math.acos(o),n=Math.sqrt(1-o*o);if(Math.abs(n)<0.001){return t.w=0.5*(k.w+u.w),t.x=0.5*(k.x+u.x),t.y=0.5*(k.y+u.y),t.z=0.5*(k.z+u.z),t}o=Math.sin((1-p)*m)/n;p=Math.sin(p*m)/n;t.w=k.w*o+u.w*p;t.x=k.x*o+u.x*p;t.y=k.y*o+u.y*p;t.z=k.z*o+u.z*p;return t};THREE.Vertex=function(c){this.position=c||new THREE.Vector3};THREE.Face3=function(h,p,o,n,m,k){this.a=h;this.b=p;this.c=o;this.normal=n instanceof THREE.Vector3?n:new THREE.Vector3;this.vertexNormals=n instanceof Array?n:[];this.color=m instanceof THREE.Color?m:new THREE.Color;this.vertexColors=m instanceof Array?m:[];this.vertexTangents=[];this.materials=k instanceof Array?k:[k];this.centroid=new THREE.Vector3};THREE.Face4=function(k,u,t,p,o,m,n){this.a=k;this.b=u;this.c=t;this.d=p;this.normal=o instanceof THREE.Vector3?o:new THREE.Vector3;this.vertexNormals=o instanceof Array?o:[];this.color=m instanceof THREE.Color?m:new THREE.Color;this.vertexColors=m instanceof Array?m:[];this.vertexTangents=[];this.materials=n instanceof Array?n:[n];this.centroid=new THREE.Vector3};THREE.UV=function(e,f){this.set(e||0,f||0)};THREE.UV.prototype={constructor:THREE.UV,set:function(e,f){this.u=e;this.v=f;return this},copy:function(c){this.set(c.u,c.v);return this}};THREE.Geometry=function(){this.id="Geometry"+THREE.GeometryIdCounter++;this.vertices=[];this.colors=[];this.faces=[];this.edges=[];this.faceUvs=[[]];this.faceVertexUvs=[[]];this.morphTargets=[];this.morphColors=[];this.skinWeights=[];this.skinIndices=[];this.boundingSphere=this.boundingBox=null;this.dynamic=this.hasTangents=!1};THREE.Geometry.prototype={constructor:THREE.Geometry,computeCentroids:function(){var f,h,g;f=0;for(h=this.faces.length;f<h;f++){g=this.faces[f],g.centroid.set(0,0,0),g instanceof THREE.Face3?(g.centroid.addSelf(this.vertices[g.a].position),g.centroid.addSelf(this.vertices[g.b].position),g.centroid.addSelf(this.vertices[g.c].position),g.centroid.divideScalar(3)):g instanceof THREE.Face4&&(g.centroid.addSelf(this.vertices[g.a].position),g.centroid.addSelf(this.vertices[g.b].position),g.centroid.addSelf(this.vertices[g.c].position),g.centroid.addSelf(this.vertices[g.d].position),g.centroid.divideScalar(4))}},computeFaceNormals:function(y){var x,w,v,u,p,t,n=new THREE.Vector3,m=new THREE.Vector3;v=0;for(u=this.faces.length;v<u;v++){p=this.faces[v];if(y&&p.vertexNormals.length){n.set(0,0,0);x=0;for(w=p.vertexNormals.length;x<w;x++){n.addSelf(p.vertexNormals[x])}n.divideScalar(3)}else{x=this.vertices[p.a],w=this.vertices[p.b],t=this.vertices[p.c],n.sub(t.position,w.position),m.sub(x.position,w.position),n.crossSelf(m)}n.isZero()||n.normalize();p.normal.copy(n)}},computeVertexNormals:function(){var g,k,j,h;if(this.__tmpVertices==void 0){h=this.__tmpVertices=Array(this.vertices.length);g=0;for(k=this.vertices.length;g<k;g++){h[g]=new THREE.Vector3}g=0;for(k=this.faces.length;g<k;g++){if(j=this.faces[g],j instanceof THREE.Face3){j.vertexNormals=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3]}else{if(j instanceof THREE.Face4){j.vertexNormals=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3]}}}}else{h=this.__tmpVertices;g=0;for(k=this.vertices.length;g<k;g++){h[g].set(0,0,0)}}g=0;for(k=this.faces.length;g<k;g++){j=this.faces[g],j instanceof THREE.Face3?(h[j.a].addSelf(j.normal),h[j.b].addSelf(j.normal),h[j.c].addSelf(j.normal)):j instanceof THREE.Face4&&(h[j.a].addSelf(j.normal),h[j.b].addSelf(j.normal),h[j.c].addSelf(j.normal),h[j.d].addSelf(j.normal))}g=0;for(k=this.vertices.length;g<k;g++){h[g].normalize()}g=0;for(k=this.faces.length;g<k;g++){j=this.faces[g],j instanceof THREE.Face3?(j.vertexNormals[0].copy(h[j.a]),j.vertexNormals[1].copy(h[j.b]),j.vertexNormals[2].copy(h[j.c])):j instanceof THREE.Face4&&(j.vertexNormals[0].copy(h[j.a]),j.vertexNormals[1].copy(h[j.b]),j.vertexNormals[2].copy(h[j.c]),j.vertexNormals[3].copy(h[j.d]))}},computeTangents:function(){function av(h,u,p,o,m,k,t){an=h.vertices[u].position;ak=h.vertices[p].position;am=h.vertices[o].position;aj=ap[m];ac=ap[k];ab=ap[t];ae=ak.x-an.x;Z=am.x-an.x;U=ak.y-an.y;ah=am.y-an.y;ai=ak.z-an.z;Y=am.z-an.z;Q=ac.u-aj.u;aa=ab.u-aj.u;T=ac.v-aj.v;ad=ab.v-aj.v;O=1/(Q*ad-aa*T);z.set((ad*ae-T*Z)*O,(ad*U-T*ah)*O,(ad*ai-T*Y)*O);N.set((Q*Z-aa*ae)*O,(Q*ah-aa*U)*O,(Q*Y-aa*ai)*O);P[u].addSelf(z);P[p].addSelf(z);P[o].addSelf(z);M[u].addSelf(N);M[p].addSelf(N);M[o].addSelf(N)}var au,at,ar,aq,ao,ap,an,ak,am,aj,ac,ab,ae,Z,U,ah,ai,Y,Q,aa,T,ad,O,af,P=[],M=[],z=new THREE.Vector3,N=new THREE.Vector3,ag=new THREE.Vector3,al=new THREE.Vector3,F=new THREE.Vector3;au=0;for(at=this.vertices.length;au<at;au++){P[au]=new THREE.Vector3,M[au]=new THREE.Vector3}au=0;for(at=this.faces.length;au<at;au++){ao=this.faces[au],ap=this.faceVertexUvs[0][au],ao instanceof THREE.Face3?av(this,ao.a,ao.b,ao.c,0,1,2):ao instanceof THREE.Face4&&(av(this,ao.a,ao.b,ao.c,0,1,2),av(this,ao.a,ao.b,ao.d,0,1,3))}var L=["a","b","c","d"];au=0;for(at=this.faces.length;au<at;au++){ao=this.faces[au];for(ar=0;ar<ao.vertexNormals.length;ar++){F.copy(ao.vertexNormals[ar]),aq=ao[L[ar]],af=P[aq],ag.copy(af),ag.subSelf(F.multiplyScalar(F.dot(af))).normalize(),al.cross(ao.vertexNormals[ar],af),aq=al.dot(M[aq]),aq=aq<0?-1:1,ao.vertexTangents[ar]=new THREE.Vector4(ag.x,ag.y,ag.z,aq)}}this.hasTangents=!0},computeBoundingBox:function(){var f;if(this.vertices.length>0){this.boundingBox={x:[this.vertices[0].position.x,this.vertices[0].position.x],y:[this.vertices[0].position.y,this.vertices[0].position.y],z:[this.vertices[0].position.z,this.vertices[0].position.z]};for(var h=1,g=this.vertices.length;h<g;h++){f=this.vertices[h];if(f.position.x<this.boundingBox.x[0]){this.boundingBox.x[0]=f.position.x}else{if(f.position.x>this.boundingBox.x[1]){this.boundingBox.x[1]=f.position.x}}if(f.position.y<this.boundingBox.y[0]){this.boundingBox.y[0]=f.position.y}else{if(f.position.y>this.boundingBox.y[1]){this.boundingBox.y[1]=f.position.y}}if(f.position.z<this.boundingBox.z[0]){this.boundingBox.z[0]=f.position.z}else{if(f.position.z>this.boundingBox.z[1]){this.boundingBox.z[1]=f.position.z}}}}},computeBoundingSphere:function(){for(var f=0,h=0,g=this.vertices.length;h<g;h++){f=Math.max(f,this.vertices[h].position.length())}this.boundingSphere={radius:f}},computeEdgeFaces:function(){function m(e,f){return Math.min(e,f)+"_"+Math.max(e,f)}function w(f,h,g){f[h]===void 0?(f[h]={set:{},array:[]},f[h].set[g]=1,f[h].array.push(g)):f[h].set[g]===void 0&&(f[h].set[g]=1,f[h].array.push(g))}var v,u,t,o,p,n={};v=0;for(u=this.faces.length;v<u;v++){p=this.faces[v],p instanceof THREE.Face3?(t=m(p.a,p.b),w(n,t,v),t=m(p.b,p.c),w(n,t,v),t=m(p.a,p.c),w(n,t,v)):p instanceof THREE.Face4&&(t=m(p.b,p.d),w(n,t,v),t=m(p.a,p.b),w(n,t,v),t=m(p.a,p.d),w(n,t,v),t=m(p.b,p.c),w(n,t,v),t=m(p.c,p.d),w(n,t,v))}v=0;for(u=this.edges.length;v<u;v++){p=this.edges[v];t=p.vertexIndices[0];o=p.vertexIndices[1];p.faceIndices=n[m(t,o)].array;for(t=0;t<p.faceIndices.length;t++){o=p.faceIndices[t],p.faces.push(this.faces[o])}}}};THREE.GeometryIdCounter=0;THREE.Spline=function(E){function D(k,H,v,u,o,p,m){k=(v-k)*0.5;u=(u-H)*0.5;return(2*(H-v)+k+u)*m+(-3*(H-v)-2*k-u)*p+k*o+H}this.points=E;var C=[],B={x:0,y:0,z:0},A,y,z,x,t,w,n,G,F;this.initFromArray=function(e){this.points=[];for(var f=0;f<e.length;f++){this.points[f]={x:e[f][0],y:e[f][1],z:e[f][2]}}};this.getPoint=function(c){A=(this.points.length-1)*c;y=Math.floor(A);z=A-y;C[0]=y==0?y:y-1;C[1]=y;C[2]=y>this.points.length-2?y:y+1;C[3]=y>this.points.length-3?y:y+2;w=this.points[C[0]];n=this.points[C[1]];G=this.points[C[2]];F=this.points[C[3]];x=z*z;t=z*x;B.x=D(w.x,n.x,G.x,F.x,z,x,t);B.y=D(w.y,n.y,G.y,F.y,z,x,t);B.z=D(w.z,n.z,G.z,F.z,z,x,t);return B};this.getControlPointsArray=function(){var g,k,j=this.points.length,h=[];for(g=0;g<j;g++){k=this.points[g],h[g]=[k.x,k.y,k.z]}return h};this.getLength=function(m){var J,I,H=J=J=0,u=new THREE.Vector3,v=new THREE.Vector3,p=[],o=0;p[0]=0;m||(m=100);I=this.points.length*m;u.copy(this.points[0]);for(m=1;m<I;m++){J=m/I,position=this.getPoint(J),v.copy(position),o+=v.distanceTo(u),u.copy(position),J*=this.points.length-1,J=Math.floor(J),J!=H&&(p[J]=o,H=J)}p[p.length]=o;return{chunks:p,total:o}};this.reparametrizeByArcLength=function(M){var L,K,J,H,I,v,p=[],m=new THREE.Vector3,N=this.getLength();p.push(m.copy(this.points[0]).clone());for(L=1;L<this.points.length;L++){K=N.chunks[L]-N.chunks[L-1];v=Math.ceil(M*K/N.total);H=(L-1)/(this.points.length-1);I=L/(this.points.length-1);for(K=1;K<v-1;K++){J=H+K*(1/v)*(I-H),position=this.getPoint(J),p.push(m.copy(position).clone())}p.push(m.copy(this.points[L]).clone())}this.points=p}};THREE.Edge=function(g,k,j,h){this.vertices=[g,k];this.vertexIndices=[j,h];this.faces=[];this.faceIndices=[]};THREE.Camera=function(h,n,m,k,j){THREE.Object3D.call(this);this.fov=h||50;this.aspect=n||1;this.near=m||0.1;this.far=k||2000;this.target=j||new THREE.Object3D;this.useTarget=!0;this.matrixWorldInverse=new THREE.Matrix4;this.projectionMatrix=null;this.updateProjectionMatrix()};THREE.Camera.prototype=new THREE.Object3D;THREE.Camera.prototype.constructor=THREE.Camera;THREE.Camera.prototype.supr=THREE.Object3D.prototype;THREE.Camera.prototype.translate=function(e,f){this.matrix.rotateAxis(f);f.multiplyScalar(e);this.position.addSelf(f);this.target.position.addSelf(f)};THREE.Camera.prototype.updateProjectionMatrix=function(){if(this.fullWidth){var g=this.fullWidth/this.fullHeight,k=Math.tan(this.fov*Math.PI/360)*this.near,j=-k,h=g*j,g=Math.abs(g*k-h),j=Math.abs(k-j);this.projectionMatrix=THREE.Matrix4.makeFrustum(h+this.x*g/this.fullWidth,h+(this.x+this.width)*g/this.fullWidth,k-(this.y+this.height)*j/this.fullHeight,k-this.y*j/this.fullHeight,this.near,this.far)}else{this.projectionMatrix=THREE.Matrix4.makePerspective(this.fov,this.aspect,this.near,this.far)}};THREE.Camera.prototype.setViewOffset=function(h,p,o,n,m,k){this.fullWidth=h;this.fullHeight=p;this.x=o;this.y=n;this.width=m;this.height=k;this.updateProjectionMatrix()};THREE.Camera.prototype.update=function(f,h,g){if(this.useTarget){this.matrix.lookAt(this.position,this.target.position,this.up),this.matrix.setPosition(this.position),f?this.matrixWorld.multiply(f,this.matrix):this.matrixWorld.copy(this.matrix),THREE.Matrix4.makeInvert(this.matrixWorld,this.matrixWorldInverse),h=!0}else{if(this.matrixAutoUpdate&&this.updateMatrix(),h||this.matrixWorldNeedsUpdate){f?this.matrixWorld.multiply(f,this.matrix):this.matrixWorld.copy(this.matrix),this.matrixWorldNeedsUpdate=!1,h=!0,THREE.Matrix4.makeInvert(this.matrixWorld,this.matrixWorldInverse)}}for(f=0;f<this.children.length;f++){this.children[f].update(this.matrixWorld,h,g)}};THREE.Light=function(c){THREE.Object3D.call(this);this.color=new THREE.Color(c)};THREE.Light.prototype=new THREE.Object3D;THREE.Light.prototype.constructor=THREE.Light;THREE.Light.prototype.supr=THREE.Object3D.prototype;THREE.AmbientLight=function(c){THREE.Light.call(this,c)};THREE.AmbientLight.prototype=new THREE.Light;THREE.AmbientLight.prototype.constructor=THREE.AmbientLight;THREE.DirectionalLight=function(g,k,j,h){THREE.Light.call(this,g);this.position=new THREE.Vector3(0,1,0);this.intensity=k||1;this.distance=j||0;this.castShadow=h!==void 0?h:!1};THREE.DirectionalLight.prototype=new THREE.Light;THREE.DirectionalLight.prototype.constructor=THREE.DirectionalLight;THREE.PointLight=function(f,h,g){THREE.Light.call(this,f);this.position=new THREE.Vector3;this.intensity=h||1;this.distance=g||0};THREE.PointLight.prototype=new THREE.Light;THREE.PointLight.prototype.constructor=THREE.PointLight;THREE.SpotLight=function(g,k,j,h){THREE.Light.call(this,g);this.position=new THREE.Vector3(0,1,0);this.target=new THREE.Object3D;this.intensity=k||1;this.distance=j||0;this.castShadow=h!==void 0?h:!1};THREE.SpotLight.prototype=new THREE.Light;THREE.SpotLight.prototype.constructor=THREE.SpotLight;THREE.Material=function(c){this.id=THREE.MaterialCount++;c=c||{};this.opacity=c.opacity!==void 0?c.opacity:1;this.transparent=c.transparent!==void 0?c.transparent:!1;this.blending=c.blending!==void 0?c.blending:THREE.NormalBlending;this.depthTest=c.depthTest!==void 0?c.depthTest:!0;this.polygonOffset=c.polygonOffset!==void 0?c.polygonOffset:!1;this.polygonOffsetFactor=c.polygonOffsetFactor!==void 0?c.polygonOffsetFactor:0;this.polygonOffsetUnits=c.polygonOffsetUnits!==void 0?c.polygonOffsetUnits:0;this.alphaTest=c.alphaTest!==void 0?c.alphaTest:0};THREE.MaterialCount=0;THREE.NoShading=0;THREE.FlatShading=1;THREE.SmoothShading=2;THREE.NoColors=0;THREE.FaceColors=1;THREE.VertexColors=2;THREE.NormalBlending=0;THREE.AdditiveBlending=1;THREE.SubtractiveBlending=2;THREE.MultiplyBlending=3;THREE.AdditiveAlphaBlending=4;THREE.CubeReflectionMapping=function(){};THREE.CubeRefractionMapping=function(){};THREE.LatitudeReflectionMapping=function(){};THREE.LatitudeRefractionMapping=function(){};THREE.SphericalReflectionMapping=function(){};THREE.SphericalRefractionMapping=function(){};THREE.UVMapping=function(){};THREE.LineBasicMaterial=function(c){THREE.Material.call(this,c);c=c||{};this.color=c.color!==void 0?new THREE.Color(c.color):new THREE.Color(16777215);this.linewidth=c.linewidth!==void 0?c.linewidth:1;this.linecap=c.linecap!==void 0?c.linecap:"round";this.linejoin=c.linejoin!==void 0?c.linejoin:"round";this.vertexColors=c.vertexColors?c.vertexColors:!1};THREE.LineBasicMaterial.prototype=new THREE.Material;THREE.LineBasicMaterial.prototype.constructor=THREE.LineBasicMaterial;THREE.MeshBasicMaterial=function(c){THREE.Material.call(this,c);c=c||{};this.color=c.color!==void 0?new THREE.Color(c.color):new THREE.Color(16777215);this.map=c.map!==void 0?c.map:null;this.lightMap=c.lightMap!==void 0?c.lightMap:null;this.envMap=c.envMap!==void 0?c.envMap:null;this.combine=c.combine!==void 0?c.combine:THREE.MultiplyOperation;this.reflectivity=c.reflectivity!==void 0?c.reflectivity:1;this.refractionRatio=c.refractionRatio!==void 0?c.refractionRatio:0.98;this.shading=c.shading!==void 0?c.shading:THREE.SmoothShading;this.wireframe=c.wireframe!==void 0?c.wireframe:!1;this.wireframeLinewidth=c.wireframeLinewidth!==void 0?c.wireframeLinewidth:1;this.wireframeLinecap=c.wireframeLinecap!==void 0?c.wireframeLinecap:"round";this.wireframeLinejoin=c.wireframeLinejoin!==void 0?c.wireframeLinejoin:"round";this.vertexColors=c.vertexColors!==void 0?c.vertexColors:!1;this.skinning=c.skinning!==void 0?c.skinning:!1;this.morphTargets=c.morphTargets!==void 0?c.morphTargets:!1};THREE.MeshBasicMaterial.prototype=new THREE.Material;THREE.MeshBasicMaterial.prototype.constructor=THREE.MeshBasicMaterial;THREE.MeshLambertMaterial=function(c){THREE.Material.call(this,c);c=c||{};this.color=c.color!==void 0?new THREE.Color(c.color):new THREE.Color(16777215);this.map=c.map!==void 0?c.map:null;this.lightMap=c.lightMap!==void 0?c.lightMap:null;this.envMap=c.envMap!==void 0?c.envMap:null;this.combine=c.combine!==void 0?c.combine:THREE.MultiplyOperation;this.reflectivity=c.reflectivity!==void 0?c.reflectivity:1;this.refractionRatio=c.refractionRatio!==void 0?c.refractionRatio:0.98;this.shading=c.shading!==void 0?c.shading:THREE.SmoothShading;this.wireframe=c.wireframe!==void 0?c.wireframe:!1;this.wireframeLinewidth=c.wireframeLinewidth!==void 0?c.wireframeLinewidth:1;this.wireframeLinecap=c.wireframeLinecap!==void 0?c.wireframeLinecap:"round";this.wireframeLinejoin=c.wireframeLinejoin!==void 0?c.wireframeLinejoin:"round";this.vertexColors=c.vertexColors!==void 0?c.vertexColors:!1;this.skinning=c.skinning!==void 0?c.skinning:!1;this.morphTargets=c.morphTargets!==void 0?c.morphTargets:!1};THREE.MeshLambertMaterial.prototype=new THREE.Material;THREE.MeshLambertMaterial.prototype.constructor=THREE.MeshLambertMaterial;THREE.MeshPhongMaterial=function(c){THREE.Material.call(this,c);c=c||{};this.color=c.color!==void 0?new THREE.Color(c.color):new THREE.Color(16777215);this.ambient=c.ambient!==void 0?new THREE.Color(c.ambient):new THREE.Color(328965);this.specular=c.specular!==void 0?new THREE.Color(c.specular):new THREE.Color(1118481);this.shininess=c.shininess!==void 0?c.shininess:30;this.map=c.map!==void 0?c.map:null;this.lightMap=c.lightMap!==void 0?c.lightMap:null;this.envMap=c.envMap!==void 0?c.envMap:null;this.combine=c.combine!==void 0?c.combine:THREE.MultiplyOperation;this.reflectivity=c.reflectivity!==void 0?c.reflectivity:1;this.refractionRatio=c.refractionRatio!==void 0?c.refractionRatio:0.98;this.shading=c.shading!==void 0?c.shading:THREE.SmoothShading;this.wireframe=c.wireframe!==void 0?c.wireframe:!1;this.wireframeLinewidth=c.wireframeLinewidth!==void 0?c.wireframeLinewidth:1;this.wireframeLinecap=c.wireframeLinecap!==void 0?c.wireframeLinecap:"round";this.wireframeLinejoin=c.wireframeLinejoin!==void 0?c.wireframeLinejoin:"round";this.vertexColors=c.vertexColors!==void 0?c.vertexColors:!1;this.skinning=c.skinning!==void 0?c.skinning:!1;this.morphTargets=c.morphTargets!==void 0?c.morphTargets:!1};THREE.MeshPhongMaterial.prototype=new THREE.Material;THREE.MeshPhongMaterial.prototype.constructor=THREE.MeshPhongMaterial;THREE.MeshDepthMaterial=function(c){THREE.Material.call(this,c);c=c||{};this.shading=c.shading!==void 0?c.shading:THREE.SmoothShading;this.wireframe=c.wireframe!==void 0?c.wireframe:!1;this.wireframeLinewidth=c.wireframeLinewidth!==void 0?c.wireframeLinewidth:1};THREE.MeshDepthMaterial.prototype=new THREE.Material;THREE.MeshDepthMaterial.prototype.constructor=THREE.MeshDepthMaterial;THREE.MeshNormalMaterial=function(c){THREE.Material.call(this,c);c=c||{};this.shading=c.shading?c.shading:THREE.FlatShading;this.wireframe=c.wireframe?c.wireframe:!1;this.wireframeLinewidth=c.wireframeLinewidth?c.wireframeLinewidth:1};THREE.MeshNormalMaterial.prototype=new THREE.Material;THREE.MeshNormalMaterial.prototype.constructor=THREE.MeshNormalMaterial;THREE.MeshFaceMaterial=function(){};THREE.MeshShaderMaterial=function(c){THREE.Material.call(this,c);c=c||{};this.fragmentShader=c.fragmentShader!==void 0?c.fragmentShader:"void main() {}";this.vertexShader=c.vertexShader!==void 0?c.vertexShader:"void main() {}";this.uniforms=c.uniforms!==void 0?c.uniforms:{};this.attributes=c.attributes;this.shading=c.shading!==void 0?c.shading:THREE.SmoothShading;this.wireframe=c.wireframe!==void 0?c.wireframe:!1;this.wireframeLinewidth=c.wireframeLinewidth!==void 0?c.wireframeLinewidth:1;this.fog=c.fog!==void 0?c.fog:!1;this.lights=c.lights!==void 0?c.lights:!1;this.vertexColors=c.vertexColors!==void 0?c.vertexColors:!1;this.skinning=c.skinning!==void 0?c.skinning:!1;this.morphTargets=c.morphTargets!==void 0?c.morphTargets:!1};THREE.MeshShaderMaterial.prototype=new THREE.Material;THREE.MeshShaderMaterial.prototype.constructor=THREE.MeshShaderMaterial;THREE.ParticleBasicMaterial=function(c){THREE.Material.call(this,c);c=c||{};this.color=c.color!==void 0?new THREE.Color(c.color):new THREE.Color(16777215);this.map=c.map!==void 0?c.map:null;this.size=c.size!==void 0?c.size:1;this.sizeAttenuation=c.sizeAttenuation!==void 0?c.sizeAttenuation:!0;this.vertexColors=c.vertexColors!==void 0?c.vertexColors:!1};THREE.ParticleBasicMaterial.prototype=new THREE.Material;THREE.ParticleBasicMaterial.prototype.constructor=THREE.ParticleBasicMaterial;THREE.ParticleCanvasMaterial=function(c){THREE.Material.call(this,c);c=c||{};this.color=c.color!==void 0?new THREE.Color(c.color):new THREE.Color(16777215);this.program=c.program!==void 0?c.program:function(){}};THREE.ParticleCanvasMaterial.prototype=new THREE.Material;THREE.ParticleCanvasMaterial.prototype.constructor=THREE.ParticleCanvasMaterial;THREE.ParticleDOMMaterial=function(c){THREE.Material.call(this);this.domElement=c};THREE.Texture=function(h,p,o,n,m,k){this.id=THREE.TextureCount++;this.image=h;this.mapping=p!==void 0?p:new THREE.UVMapping;this.wrapS=o!==void 0?o:THREE.ClampToEdgeWrapping;this.wrapT=n!==void 0?n:THREE.ClampToEdgeWrapping;this.magFilter=m!==void 0?m:THREE.LinearFilter;this.minFilter=k!==void 0?k:THREE.LinearMipMapLinearFilter;this.offset=new THREE.Vector2(0,0);this.repeat=new THREE.Vector2(1,1);this.needsUpdate=!1};THREE.Texture.prototype={constructor:THREE.Texture,clone:function(){var c=new THREE.Texture(this.image,this.mapping,this.wrapS,this.wrapT,this.magFilter,this.minFilter);c.offset.copy(this.offset);c.repeat.copy(this.repeat);return c}};THREE.TextureCount=0;THREE.MultiplyOperation=0;THREE.MixOperation=1;THREE.RepeatWrapping=0;THREE.ClampToEdgeWrapping=1;THREE.MirroredRepeatWrapping=2;THREE.NearestFilter=3;THREE.NearestMipMapNearestFilter=4;THREE.NearestMipMapLinearFilter=5;THREE.LinearFilter=6;THREE.LinearMipMapNearestFilter=7;THREE.LinearMipMapLinearFilter=8;THREE.ByteType=9;THREE.UnsignedByteType=10;THREE.ShortType=11;THREE.UnsignedShortType=12;THREE.IntType=13;THREE.UnsignedIntType=14;THREE.FloatType=15;THREE.AlphaFormat=16;THREE.RGBFormat=17;THREE.RGBAFormat=18;THREE.LuminanceFormat=19;THREE.LuminanceAlphaFormat=20;THREE.DataTexture=function(y,x,w,v,u,p,t,n,m){THREE.Texture.call(this,null,u,p,t,n,m);this.image={data:y,width:x,height:w};this.format=v!==void 0?v:THREE.RGBAFormat};THREE.DataTexture.prototype=new THREE.Texture;THREE.DataTexture.prototype.constructor=THREE.DataTexture;THREE.DataTexture.prototype={clone:function(){var c=new THREE.DataTexture(this.data.slice(0),this.mapping,this.wrapS,this.wrapT,this.magFilter,this.minFilter);c.offset.copy(this.offset);c.repeat.copy(this.repeat);return c}};THREE.Particle=function(c){THREE.Object3D.call(this);this.materials=c instanceof Array?c:[c]};THREE.Particle.prototype=new THREE.Object3D;THREE.Particle.prototype.constructor=THREE.Particle;THREE.ParticleSystem=function(e,f){THREE.Object3D.call(this);this.geometry=e;this.materials=f instanceof Array?f:[f];this.sortParticles=!1};THREE.ParticleSystem.prototype=new THREE.Object3D;THREE.ParticleSystem.prototype.constructor=THREE.ParticleSystem;THREE.Line=function(f,h,g){THREE.Object3D.call(this);this.geometry=f;this.materials=h instanceof Array?h:[h];this.type=g!=void 0?g:THREE.LineStrip};THREE.LineStrip=0;THREE.LinePieces=1;THREE.Line.prototype=new THREE.Object3D;THREE.Line.prototype.constructor=THREE.Line;THREE.Mesh=function(f,h){THREE.Object3D.call(this);this.geometry=f;this.materials=h&&h.length?h:[h];this.overdraw=!1;if(this.geometry&&(this.geometry.boundingSphere||this.geometry.computeBoundingSphere(),this.boundRadius=f.boundingSphere.radius,this.geometry.morphTargets.length)){this.morphTargetBase=-1;this.morphTargetForcedOrder=[];this.morphTargetInfluences=[];this.morphTargetDictionary={};for(var g=0;g<this.geometry.morphTargets.length;g++){this.morphTargetInfluences.push(0),this.morphTargetDictionary[this.geometry.morphTargets[g].name]=g}}};THREE.Mesh.prototype=new THREE.Object3D;THREE.Mesh.prototype.constructor=THREE.Mesh;THREE.Mesh.prototype.supr=THREE.Object3D.prototype;THREE.Mesh.prototype.getMorphTargetIndexByName=function(c){if(this.morphTargetDictionary[c]!==void 0){return this.morphTargetDictionary[c]}console.log("THREE.Mesh.getMorphTargetIndexByName: morph target "+c+" does not exist. Returning 0.");return 0};THREE.Bone=function(c){THREE.Object3D.call(this);this.skin=c;this.skinMatrix=new THREE.Matrix4;this.hasNoneBoneChildren=!1};THREE.Bone.prototype=new THREE.Object3D;THREE.Bone.prototype.constructor=THREE.Bone;THREE.Bone.prototype.supr=THREE.Object3D.prototype;THREE.Bone.prototype.update=function(h,n,m){this.matrixAutoUpdate&&(n|=this.updateMatrix());if(n||this.matrixWorldNeedsUpdate){h?this.skinMatrix.multiply(h,this.matrix):this.skinMatrix.copy(this.matrix),this.matrixWorldNeedsUpdate=!1,n=!0}var k,j=this.children.length;if(this.hasNoneBoneChildren){this.matrixWorld.multiply(this.skin.matrixWorld,this.skinMatrix);for(k=0;k<j;k++){h=this.children[k],h instanceof THREE.Bone?h.update(this.skinMatrix,n,m):h.update(this.matrixWorld,!0,m)}}else{for(k=0;k<j;k++){this.children[k].update(this.skinMatrix,n,m)}}};THREE.Bone.prototype.addChild=function(c){if(this.children.indexOf(c)===-1&&(c.parent!==void 0&&c.parent.removeChild(c),c.parent=this,this.children.push(c),!(c instanceof THREE.Bone))){this.hasNoneBoneChildren=!0}};THREE.SkinnedMesh=function(m,w){THREE.Mesh.call(this,m,w);this.identityMatrix=new THREE.Matrix4;this.bones=[];this.boneMatrices=[];var v,u,t,o,p,n;if(this.geometry.bones!==void 0){for(v=0;v<this.geometry.bones.length;v++){t=this.geometry.bones[v],o=t.pos,p=t.rotq,n=t.scl,u=this.addBone(),u.name=t.name,u.position.set(o[0],o[1],o[2]),u.quaternion.set(p[0],p[1],p[2],p[3]),u.useQuaternion=!0,n!==void 0?u.scale.set(n[0],n[1],n[2]):u.scale.set(1,1,1)}for(v=0;v<this.bones.length;v++){t=this.geometry.bones[v],u=this.bones[v],t.parent===-1?this.addChild(u):this.bones[t.parent].addChild(u)}this.boneMatrices=new Float32Array(16*this.bones.length);this.pose()}};THREE.SkinnedMesh.prototype=new THREE.Mesh;THREE.SkinnedMesh.prototype.constructor=THREE.SkinnedMesh;THREE.SkinnedMesh.prototype.update=function(h,n,m){if(this.visible){this.matrixAutoUpdate&&(n|=this.updateMatrix());if(n||this.matrixWorldNeedsUpdate){h?this.matrixWorld.multiply(h,this.matrix):this.matrixWorld.copy(this.matrix),this.matrixWorldNeedsUpdate=!1,n=!0}var k,j=this.children.length;for(k=0;k<j;k++){h=this.children[k],h instanceof THREE.Bone?h.update(this.identityMatrix,!1,m):h.update(this.matrixWorld,n,m)}m=this.bones.length;ba=this.bones;bm=this.boneMatrices;for(n=0;n<m;n++){ba[n].skinMatrix.flattenToArrayOffset(bm,n*16)}}};THREE.SkinnedMesh.prototype.addBone=function(c){c===void 0&&(c=new THREE.Bone(this));this.bones.push(c);return c};THREE.SkinnedMesh.prototype.pose=function(){this.update(void 0,!0);for(var h,p=[],o=0;o<this.bones.length;o++){h=this.bones[o],p.push(THREE.Matrix4.makeInvert(h.skinMatrix)),h.skinMatrix.flattenToArrayOffset(this.boneMatrices,o*16)}if(this.geometry.skinVerticesA===void 0){this.geometry.skinVerticesA=[];this.geometry.skinVerticesB=[];var n;for(h=0;h<this.geometry.skinIndices.length;h++){var o=this.geometry.vertices[h].position,m=this.geometry.skinIndices[h].x,k=this.geometry.skinIndices[h].y;n=new THREE.Vector3(o.x,o.y,o.z);this.geometry.skinVerticesA.push(p[m].multiplyVector3(n));n=new THREE.Vector3(o.x,o.y,o.z);this.geometry.skinVerticesB.push(p[k].multiplyVector3(n));this.geometry.skinWeights[h].x+this.geometry.skinWeights[h].y!==1&&(o=(1-(this.geometry.skinWeights[h].x+this.geometry.skinWeights[h].y))*0.5,this.geometry.skinWeights[h].x+=o,this.geometry.skinWeights[h].y+=o)}}};THREE.Ribbon=function(e,f){THREE.Object3D.call(this);this.geometry=e;this.materials=f instanceof Array?f:[f]};THREE.Ribbon.prototype=new THREE.Object3D;THREE.Ribbon.prototype.constructor=THREE.Ribbon;THREE.LOD=function(){THREE.Object3D.call(this);this.LODs=[]};THREE.LOD.prototype=new THREE.Object3D;THREE.LOD.prototype.constructor=THREE.LOD;THREE.LOD.prototype.supr=THREE.Object3D.prototype;THREE.LOD.prototype.add=function(f,h){h===void 0&&(h=0);for(var h=Math.abs(h),g=0;g<this.LODs.length;g++){if(h<this.LODs[g].visibleAtDistance){break}}this.LODs.splice(g,0,{visibleAtDistance:h,object3D:f});this.addChild(f)};THREE.LOD.prototype.update=function(g,k,j){this.matrixAutoUpdate&&(k|=this.updateMatrix());if(k||this.matrixWorldNeedsUpdate){g?this.matrixWorld.multiply(g,this.matrix):this.matrixWorld.copy(this.matrix),this.matrixWorldNeedsUpdate=!1,k=!0}if(this.LODs.length>1){g=j.matrixWorldInverse;g=-(g.n31*this.position.x+g.n32*this.position.y+g.n33*this.position.z+g.n34);this.LODs[0].object3D.visible=!0;for(var h=1;h<this.LODs.length;h++){if(g>=this.LODs[h].visibleAtDistance){this.LODs[h-1].object3D.visible=!1,this.LODs[h].object3D.visible=!0}else{break}}for(;h<this.LODs.length;h++){this.LODs[h].object3D.visible=!1}}for(g=0;g<this.children.length;g++){this.children[g].update(this.matrixWorld,k,j)}};THREE.Sprite=function(c){THREE.Object3D.call(this);if(c.material!==void 0){this.material=c.material,this.map=void 0,this.blending=material.blending}else{if(c.map!==void 0){this.map=c.map instanceof THREE.Texture?c.map:THREE.ImageUtils.loadTexture(c.map),this.material=void 0,this.blending=c.blending!==void 0?c.blending:THREE.NormalBlending}}this.useScreenCoordinates=c.useScreenCoordinates!==void 0?c.useScreenCoordinates:!0;this.mergeWith3D=c.mergeWith3D!==void 0?c.mergeWith3D:!this.useScreenCoordinates;this.affectedByDistance=c.affectedByDistance!==void 0?c.affectedByDistance:!this.useScreenCoordinates;this.scaleByViewport=c.scaleByViewport!==void 0?c.scaleByViewport:!this.affectedByDistance;this.alignment=c.alignment instanceof THREE.Vector2?c.alignment:THREE.SpriteAlignment.center;this.rotation3d=this.rotation;this.rotation=0;this.opacity=1;this.uvOffset=new THREE.Vector2(0,0);this.uvScale=new THREE.Vector2(1,1)};THREE.Sprite.prototype=new THREE.Object3D;THREE.Sprite.prototype.constructor=THREE.Sprite;THREE.Sprite.prototype.supr=THREE.Object3D.prototype;THREE.Sprite.prototype.updateMatrix=function(){this.matrix.setPosition(this.position);this.rotation3d.set(0,0,this.rotation);this.matrix.setRotationFromEuler(this.rotation3d);if(this.scale.x!==1||this.scale.y!==1){this.matrix.scale(this.scale),this.boundRadiusScale=Math.max(this.scale.x,this.scale.y)}this.matrixWorldNeedsUpdate=!0};THREE.SpriteAlignment={};THREE.SpriteAlignment.topLeft=new THREE.Vector2(1,-1);THREE.SpriteAlignment.topCenter=new THREE.Vector2(0,-1);THREE.SpriteAlignment.topRight=new THREE.Vector2(-1,-1);THREE.SpriteAlignment.centerLeft=new THREE.Vector2(1,0);THREE.SpriteAlignment.center=new THREE.Vector2(0,0);THREE.SpriteAlignment.centerRight=new THREE.Vector2(-1,0);THREE.SpriteAlignment.bottomLeft=new THREE.Vector2(1,1);THREE.SpriteAlignment.bottomCenter=new THREE.Vector2(0,1);THREE.SpriteAlignment.bottomRight=new THREE.Vector2(-1,1);THREE.Scene=function(){THREE.Object3D.call(this);this.matrixAutoUpdate=!1;this.collisions=this.overrideMaterial=this.fog=null;this.objects=[];this.lights=[];this.__objectsAdded=[];this.__objectsRemoved=[]};THREE.Scene.prototype=new THREE.Object3D;THREE.Scene.prototype.constructor=THREE.Scene;THREE.Scene.prototype.supr=THREE.Object3D.prototype;THREE.Scene.prototype.addChild=function(c){this.supr.addChild.call(this,c);this.addChildRecurse(c)};THREE.Scene.prototype.addChildRecurse=function(e){if(e instanceof THREE.Light){this.lights.indexOf(e)===-1&&this.lights.push(e)}else{if(!(e instanceof THREE.Camera||e instanceof THREE.Bone)&&this.objects.indexOf(e)===-1){this.objects.push(e),this.__objectsAdded.push(e)}}for(var f=0;f<e.children.length;f++){this.addChildRecurse(e.children[f])}};THREE.Scene.prototype.removeChild=function(c){this.supr.removeChild.call(this,c);this.removeChildRecurse(c)};THREE.Scene.prototype.removeChildRecurse=function(e){if(e instanceof THREE.Light){var f=this.lights.indexOf(e);f!==-1&&this.lights.splice(f,1)}else{e instanceof THREE.Camera||(f=this.objects.indexOf(e),f!==-1&&(this.objects.splice(f,1),this.__objectsRemoved.push(e)))}for(f=0;f<e.children.length;f++){this.removeChildRecurse(e.children[f])}};THREE.Scene.prototype.addObject=THREE.Scene.prototype.addChild;THREE.Scene.prototype.removeObject=THREE.Scene.prototype.removeChild;THREE.Scene.prototype.addLight=THREE.Scene.prototype.addChild;THREE.Scene.prototype.removeLight=THREE.Scene.prototype.removeChild;THREE.Fog=function(f,h,g){this.color=new THREE.Color(f);this.near=h||1;this.far=g||1000};THREE.FogExp2=function(e,f){this.color=new THREE.Color(e);this.density=f!==void 0?f:0.00025};THREE.Projector=function(){function ai(){var c=Z[ab]=Z[ab]||new THREE.RenderableVertex;ab++;return c}function ah(e,f){return f.z-e.z}function ag(m,x){var w=0,v=1,t=m.z+m.w,u=x.z+x.w,p=-m.z+m.w,o=-x.z+x.w;return t>=0&&u>=0&&p>=0&&o>=0?!0:t<0&&u<0||p<0&&o<0?!1:(t<0?w=Math.max(w,t/(t-u)):u<0&&(v=Math.min(v,t/(t-u))),p<0?w=Math.max(w,p/(p-o)):o<0&&(v=Math.min(v,p/(p-o))),v<w?!1:(m.lerpSelf(x,w),x.lerpSelf(m,1-v),!0))}var af,ae,ac=[],ad,ab,Z=[],aa,Y,R=[],Q,U=[],O,M,W=[],X,N,F=[],P=new THREE.Vector4,L=new THREE.Vector4,T=new THREE.Matrix4,z=new THREE.Matrix4,V=[new THREE.Vector4,new THREE.Vector4,new THREE.Vector4,new THREE.Vector4,new THREE.Vector4,new THREE.Vector4],C=new THREE.Vector4,n=new THREE.Vector4;this.projectVector=function(e,f){T.multiply(f.projectionMatrix,f.matrixWorldInverse);T.multiplyVector3(e);return e};this.unprojectVector=function(e,f){T.multiply(f.matrixWorld,THREE.Matrix4.makeInvert(f.projectionMatrix));T.multiplyVector3(e);return e};this.projectObjects=function(y,x,w){var x=[],j,f,B;ae=0;f=y.objects;y=0;for(j=f.length;y<j;y++){B=f[y];var g;if(!(g=!B.visible)){if(g=B instanceof THREE.Mesh){a:{g=void 0;for(var D=B.matrixWorld,c=-B.geometry.boundingSphere.radius*Math.max(B.scale.x,Math.max(B.scale.y,B.scale.z)),A=0;A<6;A++){if(g=V[A].x*D.n14+V[A].y*D.n24+V[A].z*D.n34+V[A].w,g<=c){g=!1;break a}}g=!0}g=!g}}if(!g){g=ac[ae]=ac[ae]||new THREE.RenderableObject,ae++,af=g,P.copy(B.position),T.multiplyVector3(P),af.object=B,af.z=P.z,x.push(af)}}w&&x.sort(ah);return x};this.projectScene=function(J,I,H){var B=[],x=I.near,h=I.far,A,w,p,m,k,S,t,D,v,o,K,e,c,y,b,E,u;N=M=Q=Y=0;I.matrixAutoUpdate&&I.update(void 0,!0);J.update(void 0,!1,I);T.multiply(I.projectionMatrix,I.matrixWorldInverse);V[0].set(T.n41-T.n11,T.n42-T.n12,T.n43-T.n13,T.n44-T.n14);V[1].set(T.n41+T.n11,T.n42+T.n12,T.n43+T.n13,T.n44+T.n14);V[2].set(T.n41+T.n21,T.n42+T.n22,T.n43+T.n23,T.n44+T.n24);V[3].set(T.n41-T.n21,T.n42-T.n22,T.n43-T.n23,T.n44-T.n24);V[4].set(T.n41-T.n31,T.n42-T.n32,T.n43-T.n33,T.n44-T.n34);V[5].set(T.n41+T.n31,T.n42+T.n32,T.n43+T.n33,T.n44+T.n34);for(A=0;A<6;A++){v=V[A],v.divideScalar(Math.sqrt(v.x*v.x+v.y*v.y+v.z*v.z))}v=this.projectObjects(J,I,!0);J=0;for(A=v.length;J<A;J++){if(o=v[J].object,o.visible){if(K=o.matrixWorld,e=o.matrixRotationWorld,c=o.materials,y=o.overdraw,ab=0,o instanceof THREE.Mesh){b=o.geometry;m=b.vertices;E=b.faces;b=b.faceVertexUvs;w=0;for(p=m.length;w<p;w++){ad=ai(),ad.positionWorld.copy(m[w].position),K.multiplyVector3(ad.positionWorld),ad.positionScreen.copy(ad.positionWorld),T.multiplyVector4(ad.positionScreen),ad.positionScreen.x/=ad.positionScreen.w,ad.positionScreen.y/=ad.positionScreen.w,ad.visible=ad.positionScreen.z>x&&ad.positionScreen.z<h}m=0;for(w=E.length;m<w;m++){p=E[m];if(p instanceof THREE.Face3){if(k=Z[p.a],S=Z[p.b],t=Z[p.c],k.visible&&S.visible&&t.visible&&(o.doubleSided||o.flipSided!=(t.positionScreen.x-k.positionScreen.x)*(S.positionScreen.y-k.positionScreen.y)-(t.positionScreen.y-k.positionScreen.y)*(S.positionScreen.x-k.positionScreen.x)<0)){D=R[Y]=R[Y]||new THREE.RenderableFace3,Y++,aa=D,aa.v1.copy(k),aa.v2.copy(S),aa.v3.copy(t)}else{continue}}else{if(p instanceof THREE.Face4){if(k=Z[p.a],S=Z[p.b],t=Z[p.c],D=Z[p.d],k.visible&&S.visible&&t.visible&&D.visible&&(o.doubleSided||o.flipSided!=((D.positionScreen.x-k.positionScreen.x)*(S.positionScreen.y-k.positionScreen.y)-(D.positionScreen.y-k.positionScreen.y)*(S.positionScreen.x-k.positionScreen.x)<0||(S.positionScreen.x-t.positionScreen.x)*(D.positionScreen.y-t.positionScreen.y)-(S.positionScreen.y-t.positionScreen.y)*(D.positionScreen.x-t.positionScreen.x)<0))){u=U[Q]=U[Q]||new THREE.RenderableFace4,Q++,aa=u,aa.v1.copy(k),aa.v2.copy(S),aa.v3.copy(t),aa.v4.copy(D)}else{continue}}}aa.normalWorld.copy(p.normal);e.multiplyVector3(aa.normalWorld);aa.centroidWorld.copy(p.centroid);K.multiplyVector3(aa.centroidWorld);aa.centroidScreen.copy(aa.centroidWorld);T.multiplyVector3(aa.centroidScreen);t=p.vertexNormals;k=0;for(S=t.length;k<S;k++){D=aa.vertexNormalsWorld[k],D.copy(t[k]),e.multiplyVector3(D)}k=0;for(S=b.length;k<S;k++){if(u=b[k][m]){t=0;for(D=u.length;t<D;t++){aa.uvs[k][t]=u[t]}}}aa.meshMaterials=c;aa.faceMaterials=p.materials;aa.overdraw=y;aa.z=aa.centroidScreen.z;B.push(aa)}}else{if(o instanceof THREE.Line){z.multiply(T,K);m=o.geometry.vertices;k=ai();k.positionScreen.copy(m[0].position);z.multiplyVector4(k.positionScreen);w=1;for(p=m.length;w<p;w++){if(k=ai(),k.positionScreen.copy(m[w].position),z.multiplyVector4(k.positionScreen),S=Z[ab-2],C.copy(k.positionScreen),n.copy(S.positionScreen),ag(C,n)){C.multiplyScalar(1/C.w),n.multiplyScalar(1/n.w),K=W[M]=W[M]||new THREE.RenderableLine,M++,O=K,O.v1.positionScreen.copy(C),O.v2.positionScreen.copy(n),O.z=Math.max(C.z,n.z),O.materials=o.materials,B.push(O)}}}else{if(o instanceof THREE.Particle&&(L.set(o.matrixWorld.n14,o.matrixWorld.n24,o.matrixWorld.n34,1),T.multiplyVector4(L),L.z/=L.w,L.z>0&&L.z<1)){K=F[N]=F[N]||new THREE.RenderableParticle,N++,X=K,X.x=L.x/L.w,X.y=L.y/L.w,X.z=L.z,X.rotation=o.rotation.z,X.scale.x=o.scale.x*Math.abs(X.x-(L.x+I.projectionMatrix.n11)/(L.w+I.projectionMatrix.n14)),X.scale.y=o.scale.y*Math.abs(X.y-(L.y+I.projectionMatrix.n22)/(L.w+I.projectionMatrix.n24)),X.materials=o.materials,B.push(X)}}}}}H&&B.sort(ah);return B}};THREE.DOMRenderer=function(){THREE.Renderer.call(this);var h=null,p=new THREE.Projector,o,n,m,k;this.domElement=document.createElement("div");this.setSize=function(e,f){o=e;n=f;m=o/2;k=n/2};this.render=function(y,j){var c,g,b,C,B,D,A,z;h=p.projectScene(y,j);c=0;for(g=h.length;c<g;c++){if(B=h[c],B instanceof THREE.RenderableParticle){A=B.x*m+m;z=B.y*k+k;b=0;for(C=B.material.length;b<C;b++){if(D=B.material[b],D instanceof THREE.ParticleDOMMaterial){D=D.domElement,D.style.left=A+"px",D.style.top=z+"px"}}}}}};THREE.CanvasRenderer=function(aD){function aB(c){if(a3!=c){al.globalAlpha=a3=c}}function az(c){if(a4!=c){switch(c){case THREE.NormalBlending:al.globalCompositeOperation="source-over";break;case THREE.AdditiveBlending:al.globalCompositeOperation="lighter";break;case THREE.SubtractiveBlending:al.globalCompositeOperation="darker"}a4=c}}function ay(c){if(aX!=c){al.strokeStyle=aX=c}}function ax(c){if(ag!=c){al.fillStyle=ag=c}}var at=this,av=null,ar=new THREE.Projector,aD=aD||{},an=aD.canvas!==void 0?aD.canvas:document.createElement("canvas"),aq,am,ak,aj,al=an.getContext("2d"),ai=new THREE.Color(0),ah=0,a3=1,a4=0,aX=null,ag=null,aY=null,aW=null,aZ=null,aT,a0,aU,aN,aI=new THREE.RenderableVertex,aO=new THREE.RenderableVertex,a2,ao,aJ,aK,bf,aS,F,aM,aL,Q,aV,au,aR=new THREE.Color(0),aP=new THREE.Color(0),a7=new THREE.Color(0),aH=new THREE.Color(0),aF=new THREE.Color(0),ap=[],ab,bh,O,ad,bd,aE,a1,aC,ae,af,be=new THREE.Rectangle,bc=new THREE.Rectangle,a5=new THREE.Rectangle,ac=!1,aA=new THREE.Color,bb=new THREE.Color,bi=new THREE.Color,aw=new THREE.Color,aQ=new THREE.Vector3,a6,a8,z,bg,a9,aG,aD=16;a6=document.createElement("canvas");a6.width=a6.height=2;a8=a6.getContext("2d");a8.fillStyle="rgba(0,0,0,1)";a8.fillRect(0,0,2,2);z=a8.getImageData(0,0,2,2);bg=z.data;a9=document.createElement("canvas");a9.width=a9.height=aD;aG=a9.getContext("2d");aG.translate(-aD/2,-aD/2);aG.scale(aD,aD);aD--;this.domElement=an;this.sortElements=this.sortObjects=this.autoClear=!0;this.data={vertices:0,faces:0};this.setSize=function(e,f){aq=e;am=f;ak=Math.floor(aq/2);aj=Math.floor(am/2);an.width=aq;an.height=am;be.set(-ak,-aj,ak,aj);bc.set(-ak,-aj,ak,aj);a3=1;a4=0;aZ=aW=aY=ag=aX=null};this.setClearColor=function(e,f){ai.copy(e);ah=f;bc.set(-ak,-aj,ak,aj)};this.setClearColorHex=function(e,f){ai.setHex(e);ah=f;bc.set(-ak,-aj,ak,aj)};this.clear=function(){al.setTransform(1,0,0,-1,ak,aj);bc.isEmpty()||(bc.minSelf(be),bc.inflate(2),ah<1&&al.clearRect(Math.floor(bc.getX()),Math.floor(bc.getY()),Math.floor(bc.getWidth()),Math.floor(bc.getHeight())),ah>0&&(az(THREE.NormalBlending),aB(1),ax("rgba("+Math.floor(ai.r*255)+","+Math.floor(ai.g*255)+","+Math.floor(ai.b*255)+","+ah+")"),al.fillRect(Math.floor(bc.getX()),Math.floor(bc.getY()),Math.floor(bc.getWidth()),Math.floor(bc.getHeight()))),bc.empty())};this.render=function(U,L){function M(m){var x,w,p,o=m.lights;bb.setRGB(0,0,0);bi.setRGB(0,0,0);aw.setRGB(0,0,0);m=0;for(x=o.length;m<x;m++){w=o[m],p=w.color,w instanceof THREE.AmbientLight?(bb.r+=p.r,bb.g+=p.g,bb.b+=p.b):w instanceof THREE.DirectionalLight?(bi.r+=p.r,bi.g+=p.g,bi.b+=p.b):w instanceof THREE.PointLight&&(aw.r+=p.r,aw.g+=p.g,aw.b+=p.b)}}function K(H,B,A,y){var w,x,p,o,m=H.lights,H=0;for(w=m.length;H<w;H++){x=m[H],p=x.color,x instanceof THREE.DirectionalLight?(o=A.dot(x.position),o<=0||(o*=x.intensity,y.r+=p.r*o,y.g+=p.g*o,y.b+=p.b*o)):x instanceof THREE.PointLight&&(o=A.dot(aQ.sub(x.position,B).normalize()),o<=0||(o*=x.distance==0?1:1-Math.min(B.distanceTo(x.position)/x.distance,1),o!=0&&(o*=x.intensity,y.r+=p.r*o,y.g+=p.g*o,y.b+=p.b*o)))}}function u(W,V,H){aB(H.opacity);az(H.blending);var B,y,x,A,w,X;if(H instanceof THREE.ParticleBasicMaterial){if(H.map){A=H.map.image,w=A.width>>1,X=A.height>>1,H=V.scale.x*ak,x=V.scale.y*aj,B=H*w,y=x*X,a5.set(W.x-B,W.y-y,W.x+B,W.y+y),be.instersects(a5)&&(al.save(),al.translate(W.x,W.y),al.rotate(-V.rotation),al.scale(H,-x),al.translate(-w,-X),al.drawImage(A,0,0),al.restore())}}else{H instanceof THREE.ParticleCanvasMaterial&&(B=V.scale.x*ak,y=V.scale.y*aj,a5.set(W.x-B,W.y-y,W.x+B,W.y+y),be.instersects(a5)&&(ay(H.color.getContextStyle()),ax(H.color.getContextStyle()),al.save(),al.translate(W.x,W.y),al.rotate(-V.rotation),al.scale(B,y),H.program(al),al.restore()))}}function n(m,p,w,o){aB(o.opacity);az(o.blending);al.beginPath();al.moveTo(m.positionScreen.x,m.positionScreen.y);al.lineTo(p.positionScreen.x,p.positionScreen.y);al.closePath();if(o instanceof THREE.LineBasicMaterial){m=o.linewidth;if(aY!=m){al.lineWidth=aY=m}m=o.linecap;if(aW!=m){al.lineCap=aW=m}m=o.linejoin;if(aZ!=m){al.lineJoin=aZ=m}ay(o.color.getContextStyle());al.stroke();a5.inflate(o.linewidth*2)}}function J(A,y,w,x,p,o,B,V,H){at.data.vertices+=3;at.data.faces++;aB(V.opacity);az(V.blending);a2=A.positionScreen.x;ao=A.positionScreen.y;aJ=y.positionScreen.x;aK=y.positionScreen.y;bf=w.positionScreen.x;aS=w.positionScreen.y;j(a2,ao,aJ,aK,bf,aS);if(V instanceof THREE.MeshBasicMaterial){if(V.map){V.map.mapping instanceof THREE.UVMapping&&(ad=B.uvs[0],G(a2,ao,aJ,aK,bf,aS,ad[x].u,ad[x].v,ad[p].u,ad[p].v,ad[o].u,ad[o].v,V.map))}else{if(V.envMap){if(V.envMap.mapping instanceof THREE.SphericalReflectionMapping){A=L.matrixWorldInverse,aQ.copy(B.vertexNormalsWorld[0]),bd=(aQ.x*A.n11+aQ.y*A.n12+aQ.z*A.n13)*0.5+0.5,aE=-(aQ.x*A.n21+aQ.y*A.n22+aQ.z*A.n23)*0.5+0.5,aQ.copy(B.vertexNormalsWorld[1]),a1=(aQ.x*A.n11+aQ.y*A.n12+aQ.z*A.n13)*0.5+0.5,aC=-(aQ.x*A.n21+aQ.y*A.n22+aQ.z*A.n23)*0.5+0.5,aQ.copy(B.vertexNormalsWorld[2]),ae=(aQ.x*A.n11+aQ.y*A.n12+aQ.z*A.n13)*0.5+0.5,af=-(aQ.x*A.n21+aQ.y*A.n22+aQ.z*A.n23)*0.5+0.5,G(a2,ao,aJ,aK,bf,aS,bd,aE,a1,aC,ae,af,V.envMap)}}else{V.wireframe?P(V.color,V.wireframeLinewidth,V.wireframeLinecap,V.wireframeLinejoin):c(V.color)}}}else{if(V instanceof THREE.MeshLambertMaterial){V.map&&!V.wireframe&&(V.map.mapping instanceof THREE.UVMapping&&(ad=B.uvs[0],G(a2,ao,aJ,aK,bf,aS,ad[x].u,ad[x].v,ad[p].u,ad[p].v,ad[o].u,ad[o].v,V.map)),az(THREE.SubtractiveBlending)),ac?!V.wireframe&&V.shading==THREE.SmoothShading&&B.vertexNormalsWorld.length==3?(aP.r=a7.r=aH.r=bb.r,aP.g=a7.g=aH.g=bb.g,aP.b=a7.b=aH.b=bb.b,K(H,B.v1.positionWorld,B.vertexNormalsWorld[0],aP),K(H,B.v2.positionWorld,B.vertexNormalsWorld[1],a7),K(H,B.v3.positionWorld,B.vertexNormalsWorld[2],aH),aF.r=(a7.r+aH.r)*0.5,aF.g=(a7.g+aH.g)*0.5,aF.b=(a7.b+aH.b)*0.5,O=E(aP,a7,aH,aF),D(a2,ao,aJ,aK,bf,aS,0,0,1,0,0,1,O)):(aA.r=bb.r,aA.g=bb.g,aA.b=bb.b,K(H,B.centroidWorld,B.normalWorld,aA),aR.r=Math.max(0,Math.min(V.color.r*aA.r,1)),aR.g=Math.max(0,Math.min(V.color.g*aA.g,1)),aR.b=Math.max(0,Math.min(V.color.b*aA.b,1)),V.wireframe?P(aR,V.wireframeLinewidth,V.wireframeLinecap,V.wireframeLinejoin):c(aR)):V.wireframe?P(V.color,V.wireframeLinewidth,V.wireframeLinecap,V.wireframeLinejoin):c(V.color)}else{if(V instanceof THREE.MeshDepthMaterial){ab=L.near,bh=L.far,aP.r=aP.g=aP.b=1-R(A.positionScreen.z,ab,bh),a7.r=a7.g=a7.b=1-R(y.positionScreen.z,ab,bh),aH.r=aH.g=aH.b=1-R(w.positionScreen.z,ab,bh),aF.r=(a7.r+aH.r)*0.5,aF.g=(a7.g+aH.g)*0.5,aF.b=(a7.b+aH.b)*0.5,O=E(aP,a7,aH,aF),D(a2,ao,aJ,aK,bf,aS,0,0,1,0,0,1,O)}else{if(V instanceof THREE.MeshNormalMaterial){aR.r=S(B.normalWorld.x),aR.g=S(B.normalWorld.y),aR.b=S(B.normalWorld.z),V.wireframe?P(aR,V.wireframeLinewidth,V.wireframeLinecap,V.wireframeLinejoin):c(aR)}}}}}function I(A,y,w,x,p,B,V,o,H){at.data.vertices+=4;at.data.faces++;aB(o.opacity);az(o.blending);if(o.map||o.envMap){J(A,y,x,0,1,3,V,o,H),J(p,w,B,1,2,3,V,o,H)}else{if(a2=A.positionScreen.x,ao=A.positionScreen.y,aJ=y.positionScreen.x,aK=y.positionScreen.y,bf=w.positionScreen.x,aS=w.positionScreen.y,F=x.positionScreen.x,aM=x.positionScreen.y,aL=p.positionScreen.x,Q=p.positionScreen.y,aV=B.positionScreen.x,au=B.positionScreen.y,o instanceof THREE.MeshBasicMaterial){t(a2,ao,aJ,aK,bf,aS,F,aM),o.wireframe?P(o.color,o.wireframeLinewidth,o.wireframeLinecap,o.wireframeLinejoin):c(o.color)}else{if(o instanceof THREE.MeshLambertMaterial){ac?!o.wireframe&&o.shading==THREE.SmoothShading&&V.vertexNormalsWorld.length==4?(aP.r=a7.r=aH.r=aF.r=bb.r,aP.g=a7.g=aH.g=aF.g=bb.g,aP.b=a7.b=aH.b=aF.b=bb.b,K(H,V.v1.positionWorld,V.vertexNormalsWorld[0],aP),K(H,V.v2.positionWorld,V.vertexNormalsWorld[1],a7),K(H,V.v4.positionWorld,V.vertexNormalsWorld[3],aH),K(H,V.v3.positionWorld,V.vertexNormalsWorld[2],aF),O=E(aP,a7,aH,aF),j(a2,ao,aJ,aK,F,aM),D(a2,ao,aJ,aK,F,aM,0,0,1,0,0,1,O),j(aL,Q,bf,aS,aV,au),D(aL,Q,bf,aS,aV,au,1,0,1,1,0,1,O)):(aA.r=bb.r,aA.g=bb.g,aA.b=bb.b,K(H,V.centroidWorld,V.normalWorld,aA),aR.r=Math.max(0,Math.min(o.color.r*aA.r,1)),aR.g=Math.max(0,Math.min(o.color.g*aA.g,1)),aR.b=Math.max(0,Math.min(o.color.b*aA.b,1)),t(a2,ao,aJ,aK,bf,aS,F,aM),o.wireframe?P(aR,o.wireframeLinewidth,o.wireframeLinecap,o.wireframeLinejoin):c(aR)):(t(a2,ao,aJ,aK,bf,aS,F,aM),o.wireframe?P(o.color,o.wireframeLinewidth,o.wireframeLinecap,o.wireframeLinejoin):c(o.color))}else{if(o instanceof THREE.MeshNormalMaterial){aR.r=S(V.normalWorld.x),aR.g=S(V.normalWorld.y),aR.b=S(V.normalWorld.z),t(a2,ao,aJ,aK,bf,aS,F,aM),o.wireframe?P(aR,o.wireframeLinewidth,o.wireframeLinecap,o.wireframeLinejoin):c(aR)}else{if(o instanceof THREE.MeshDepthMaterial){ab=L.near,bh=L.far,aP.r=aP.g=aP.b=1-R(A.positionScreen.z,ab,bh),a7.r=a7.g=a7.b=1-R(y.positionScreen.z,ab,bh),aH.r=aH.g=aH.b=1-R(x.positionScreen.z,ab,bh),aF.r=aF.g=aF.b=1-R(w.positionScreen.z,ab,bh),O=E(aP,a7,aH,aF),j(a2,ao,aJ,aK,F,aM),D(a2,ao,aJ,aK,F,aM,0,0,1,0,0,1,O),j(aL,Q,bf,aS,aV,au),D(aL,Q,bf,aS,aV,au,1,0,1,1,0,1,O)}}}}}}function j(m,y,x,w,o,p){al.beginPath();al.moveTo(m,y);al.lineTo(x,w);al.lineTo(o,p);al.lineTo(m,y);al.closePath()}function t(m,B,A,y,w,x,p,o){al.beginPath();al.moveTo(m,B);al.lineTo(A,y);al.lineTo(w,x);al.lineTo(p,o);al.lineTo(m,B);al.closePath()}function P(m,w,p,o){if(aY!=w){al.lineWidth=aY=w}if(aW!=p){al.lineCap=aW=p}if(aZ!=o){al.lineJoin=aZ=o}ay(m.getContextStyle());al.stroke();a5.inflate(w*2)}function c(m){ax(m.getContextStyle());al.fill()}function G(aa,Z,Y,X,W,V,H,A,y,B,bn,x,bo){if(bo.image.width!=0){if(bo.needsUpdate==!0||ap[bo.id]==void 0){var bl=bo.wrapS==THREE.RepeatWrapping,bk=bo.wrapT==THREE.RepeatWrapping;ap[bo.id]=al.createPattern(bo.image,bl&&bk?"repeat":bl&&!bk?"repeat-x":!bl&&bk?"repeat-y":"no-repeat");bo.needsUpdate=!1}ax(ap[bo.id]);var bl=bo.offset.x/bo.repeat.x,bk=bo.offset.y/bo.repeat.y,bj=(bo.image.width-1)*bo.repeat.x,bo=(bo.image.height-1)*bo.repeat.y,H=(H+bl)*bj,A=(A+bk)*bo,y=(y+bl)*bj,B=(B+bk)*bo,bn=(bn+bl)*bj,x=(x+bk)*bo;Y-=aa;X-=Z;W-=aa;V-=Z;y-=H;B-=A;bn-=H;x-=A;bl=1/(y*x-bn*B);bo=(x*Y-B*W)*bl;B=(x*X-B*V)*bl;Y=(y*W-bn*Y)*bl;X=(y*V-bn*X)*bl;aa=aa-bo*H-Y*A;Z=Z-B*H-X*A;al.save();al.transform(bo,B,Y,X,aa,Z);al.fill();al.restore()}}function D(aa,Z,Y,X,V,W,H,B,y,x,A,bk,bl){var w,bj;w=bl.width-1;bj=bl.height-1;H*=w;B*=bj;y*=w;x*=bj;A*=w;bk*=bj;Y-=aa;X-=Z;V-=aa;W-=Z;y-=H;x-=B;A-=H;bk-=B;bj=1/(y*bk-A*x);w=(bk*Y-x*V)*bj;x=(bk*X-x*W)*bj;Y=(y*V-A*Y)*bj;X=(y*W-A*X)*bj;aa=aa-w*H-Y*B;Z=Z-x*H-X*B;al.save();al.transform(w,x,Y,X,aa,Z);al.clip();al.drawImage(bl,0,0);al.restore()}function E(Y,X,W,V){var B=~~(Y.r*255),H=~~(Y.g*255),Y=~~(Y.b*255),A=~~(X.r*255),y=~~(X.g*255),X=~~(X.b*255),w=~~(W.r*255),p=~~(W.g*255),W=~~(W.b*255),x=~~(V.r*255),Z=~~(V.g*255),V=~~(V.b*255);bg[0]=B<0?0:B>255?255:B;bg[1]=H<0?0:H>255?255:H;bg[2]=Y<0?0:Y>255?255:Y;bg[4]=A<0?0:A>255?255:A;bg[5]=y<0?0:y>255?255:y;bg[6]=X<0?0:X>255?255:X;bg[8]=w<0?0:w>255?255:w;bg[9]=p<0?0:p>255?255:p;bg[10]=W<0?0:W>255?255:W;bg[12]=x<0?0:x>255?255:x;bg[13]=Z<0?0:Z>255?255:Z;bg[14]=V<0?0:V>255?255:V;a8.putImageData(z,0,0);aG.drawImage(a6,0,0);return a9}function R(m,p,o){m=(m-p)/(o-p);return m*m*(3-2*m)}function S(m){m=(m+1)*0.5;return m<0?0:m>1?1:m}function v(m,x){var w=x.x-m.x,p=x.y-m.y,o=w*w+p*p;o!=0&&(o=1/Math.sqrt(o),w*=o,p*=o,x.x+=w,x.y+=p,m.x-=w,m.y-=p)}var T,e,g,N,C,h,f,k;this.autoClear?this.clear():al.setTransform(1,0,0,-1,ak,aj);at.data.vertices=0;at.data.faces=0;av=ar.projectScene(U,L,this.sortElements);(ac=U.lights.length>0)&&M(U);T=0;for(e=av.length;T<e;T++){g=av[T];a5.empty();if(g instanceof THREE.RenderableParticle){aT=g;aT.x*=ak;aT.y*=aj;N=0;for(C=g.materials.length;N<C;){k=g.materials[N++],k.opacity!=0&&u(aT,g,k,U)}}else{if(g instanceof THREE.RenderableLine){if(aT=g.v1,a0=g.v2,aT.positionScreen.x*=ak,aT.positionScreen.y*=aj,a0.positionScreen.x*=ak,a0.positionScreen.y*=aj,a5.addPoint(aT.positionScreen.x,aT.positionScreen.y),a5.addPoint(a0.positionScreen.x,a0.positionScreen.y),be.instersects(a5)){N=0;for(C=g.materials.length;N<C;){k=g.materials[N++],k.opacity!=0&&n(aT,a0,g,k,U)}}}else{if(g instanceof THREE.RenderableFace3){if(aT=g.v1,a0=g.v2,aU=g.v3,aT.positionScreen.x*=ak,aT.positionScreen.y*=aj,a0.positionScreen.x*=ak,a0.positionScreen.y*=aj,aU.positionScreen.x*=ak,aU.positionScreen.y*=aj,g.overdraw&&(v(aT.positionScreen,a0.positionScreen),v(a0.positionScreen,aU.positionScreen),v(aU.positionScreen,aT.positionScreen)),a5.add3Points(aT.positionScreen.x,aT.positionScreen.y,a0.positionScreen.x,a0.positionScreen.y,aU.positionScreen.x,aU.positionScreen.y),be.instersects(a5)){N=0;for(C=g.meshMaterials.length;N<C;){if(k=g.meshMaterials[N++],k instanceof THREE.MeshFaceMaterial){h=0;for(f=g.faceMaterials.length;h<f;){(k=g.faceMaterials[h++])&&k.opacity!=0&&J(aT,a0,aU,0,1,2,g,k,U)}}else{k.opacity!=0&&J(aT,a0,aU,0,1,2,g,k,U)}}}}else{if(g instanceof THREE.RenderableFace4&&(aT=g.v1,a0=g.v2,aU=g.v3,aN=g.v4,aT.positionScreen.x*=ak,aT.positionScreen.y*=aj,a0.positionScreen.x*=ak,a0.positionScreen.y*=aj,aU.positionScreen.x*=ak,aU.positionScreen.y*=aj,aN.positionScreen.x*=ak,aN.positionScreen.y*=aj,aI.positionScreen.copy(a0.positionScreen),aO.positionScreen.copy(aN.positionScreen),g.overdraw&&(v(aT.positionScreen,a0.positionScreen),v(a0.positionScreen,aN.positionScreen),v(aN.positionScreen,aT.positionScreen),v(aU.positionScreen,aI.positionScreen),v(aU.positionScreen,aO.positionScreen)),a5.addPoint(aT.positionScreen.x,aT.positionScreen.y),a5.addPoint(a0.positionScreen.x,a0.positionScreen.y),a5.addPoint(aU.positionScreen.x,aU.positionScreen.y),a5.addPoint(aN.positionScreen.x,aN.positionScreen.y),be.instersects(a5))){N=0;for(C=g.meshMaterials.length;N<C;){if(k=g.meshMaterials[N++],k instanceof THREE.MeshFaceMaterial){h=0;for(f=g.faceMaterials.length;h<f;){(k=g.faceMaterials[h++])&&k.opacity!=0&&I(aT,a0,aU,aN,aI,aO,g,k,U)}}else{k.opacity!=0&&I(aT,a0,aU,aN,aI,aO,g,k,U)}}}}}}bc.addRectangle(a5)}al.setTransform(1,0,0,1,0,0)}};THREE.SVGRenderer=function(){function av(k,u,t){var p,n,o,m;p=0;for(n=k.lights.length;p<n;p++){o=k.lights[p],o instanceof THREE.DirectionalLight?(m=u.normalWorld.dot(o.position)*o.intensity,m>0&&(t.r+=o.color.r*m,t.g+=o.color.g*m,t.b+=o.color.b*m)):o instanceof THREE.PointLight&&(M.sub(o.position,u.centroidWorld),M.normalize(),m=u.normalWorld.dot(M)*o.intensity,m>0&&(t.r+=o.color.r*m,t.g+=o.color.g*m,t.b+=o.color.b*m))}}function au(o,n,j,f,b,g){ao.data.vertices+=3;ao.data.faces++;ag=ar(al++);ag.setAttribute("d","M "+o.positionScreen.x+" "+o.positionScreen.y+" L "+n.positionScreen.x+" "+n.positionScreen.y+" L "+j.positionScreen.x+","+j.positionScreen.y+"z");b instanceof THREE.MeshBasicMaterial?aa.copy(b.color):b instanceof THREE.MeshLambertMaterial?Q?(T.r=ad.r,T.g=ad.g,T.b=ad.b,av(g,f,T),aa.r=Math.max(0,Math.min(b.color.r*T.r,1)),aa.g=Math.max(0,Math.min(b.color.g*T.g,1)),aa.b=Math.max(0,Math.min(b.color.b*T.b,1))):aa.copy(b.color):b instanceof THREE.MeshDepthMaterial?(P=1-b.__2near/(b.__farPlusNear-f.z*b.__farMinusNear),aa.setRGB(P,P,P)):b instanceof THREE.MeshNormalMaterial&&aa.setRGB(aq(f.normalWorld.x),aq(f.normalWorld.y),aq(f.normalWorld.z));b.wireframe?ag.setAttribute("style","fill: none; stroke: "+aa.getContextStyle()+"; stroke-width: "+b.wireframeLinewidth+"; stroke-opacity: "+b.opacity+"; stroke-linecap: "+b.wireframeLinecap+"; stroke-linejoin: "+b.wireframeLinejoin):ag.setAttribute("style","fill: "+aa.getContextStyle()+"; fill-opacity: "+b.opacity);ak.appendChild(ag)}function at(p,o,n,f,b,g,j){ao.data.vertices+=4;ao.data.faces++;ag=ar(al++);ag.setAttribute("d","M "+p.positionScreen.x+" "+p.positionScreen.y+" L "+o.positionScreen.x+" "+o.positionScreen.y+" L "+n.positionScreen.x+","+n.positionScreen.y+" L "+f.positionScreen.x+","+f.positionScreen.y+"z");g instanceof THREE.MeshBasicMaterial?aa.copy(g.color):g instanceof THREE.MeshLambertMaterial?Q?(T.r=ad.r,T.g=ad.g,T.b=ad.b,av(j,b,T),aa.r=Math.max(0,Math.min(g.color.r*T.r,1)),aa.g=Math.max(0,Math.min(g.color.g*T.g,1)),aa.b=Math.max(0,Math.min(g.color.b*T.b,1))):aa.copy(g.color):g instanceof THREE.MeshDepthMaterial?(P=1-g.__2near/(g.__farPlusNear-b.z*g.__farMinusNear),aa.setRGB(P,P,P)):g instanceof THREE.MeshNormalMaterial&&aa.setRGB(aq(b.normalWorld.x),aq(b.normalWorld.y),aq(b.normalWorld.z));g.wireframe?ag.setAttribute("style","fill: none; stroke: "+aa.getContextStyle()+"; stroke-width: "+g.wireframeLinewidth+"; stroke-opacity: "+g.opacity+"; stroke-linecap: "+g.wireframeLinecap+"; stroke-linejoin: "+g.wireframeLinejoin):ag.setAttribute("style","fill: "+aa.getContextStyle()+"; fill-opacity: "+g.opacity);ak.appendChild(ag)}function ar(c){z[c]==null&&(z[c]=document.createElementNS("http://www.w3.org/2000/svg","path"),L==0&&z[c].setAttribute("shape-rendering","crispEdges"));return z[c]}function aq(c){c=(c+1)*0.5;return c<0?0:c>1?1:c}var ao=this,ap=null,an=new THREE.Projector,ak=document.createElementNS("http://www.w3.org/2000/svg","svg"),am,aj,ac,ab,ae,Z,U,ah,ai=new THREE.Rectangle,Y=new THREE.Rectangle,Q=!1,aa=new THREE.Color(16777215),T=new THREE.Color(16777215),ad=new THREE.Color(0),O=new THREE.Color(0),af=new THREE.Color(0),P,M=new THREE.Vector3,z=[],N=[],ag,al,F,L=1;this.domElement=ak;this.sortElements=this.sortObjects=this.autoClear=!0;this.data={vertices:0,faces:0};this.setQuality=function(c){switch(c){case"high":L=1;break;case"low":L=0}};this.setSize=function(e,f){am=e;aj=f;ac=am/2;ab=aj/2;ak.setAttribute("viewBox",-ac+" "+-ab+" "+am+" "+aj);ak.setAttribute("width",am);ak.setAttribute("height",aj);ai.set(-ac,-ab,ac,ab)};this.clear=function(){for(;ak.childNodes.length>0;){ak.removeChild(ak.childNodes[0])}};this.render=function(t,n){var k,e,c,w,v,u,o,j;this.autoClear&&this.clear();ao.data.vertices=0;ao.data.faces=0;ap=an.projectScene(t,n,this.sortElements);F=al=0;if(Q=t.lights.length>0){o=t.lights;ad.setRGB(0,0,0);O.setRGB(0,0,0);af.setRGB(0,0,0);k=0;for(e=o.length;k<e;k++){c=o[k],w=c.color,c instanceof THREE.AmbientLight?(ad.r+=w.r,ad.g+=w.g,ad.b+=w.b):c instanceof THREE.DirectionalLight?(O.r+=w.r,O.g+=w.g,O.b+=w.b):c instanceof THREE.PointLight&&(af.r+=w.r,af.g+=w.g,af.b+=w.b)}}k=0;for(e=ap.length;k<e;k++){if(o=ap[k],Y.empty(),o instanceof THREE.RenderableParticle){ae=o;ae.x*=ac;ae.y*=-ab;c=0;for(w=o.materials.length;c<w;){c++}}else{if(o instanceof THREE.RenderableLine){if(ae=o.v1,Z=o.v2,ae.positionScreen.x*=ac,ae.positionScreen.y*=-ab,Z.positionScreen.x*=ac,Z.positionScreen.y*=-ab,Y.addPoint(ae.positionScreen.x,ae.positionScreen.y),Y.addPoint(Z.positionScreen.x,Z.positionScreen.y),ai.instersects(Y)){c=0;for(w=o.materials.length;c<w;){if((j=o.materials[c++])&&j.opacity!=0){v=ae;u=Z;var h=F++;N[h]==null&&(N[h]=document.createElementNS("http://www.w3.org/2000/svg","line"),L==0&&N[h].setAttribute("shape-rendering","crispEdges"));ag=N[h];ag.setAttribute("x1",v.positionScreen.x);ag.setAttribute("y1",v.positionScreen.y);ag.setAttribute("x2",u.positionScreen.x);ag.setAttribute("y2",u.positionScreen.y);j instanceof THREE.LineBasicMaterial&&(ag.setAttribute("style","fill: none; stroke: "+j.color.getContextStyle()+"; stroke-width: "+j.linewidth+"; stroke-opacity: "+j.opacity+"; stroke-linecap: "+j.linecap+"; stroke-linejoin: "+j.linejoin),ak.appendChild(ag))}}}}else{if(o instanceof THREE.RenderableFace3){if(ae=o.v1,Z=o.v2,U=o.v3,ae.positionScreen.x*=ac,ae.positionScreen.y*=-ab,Z.positionScreen.x*=ac,Z.positionScreen.y*=-ab,U.positionScreen.x*=ac,U.positionScreen.y*=-ab,Y.addPoint(ae.positionScreen.x,ae.positionScreen.y),Y.addPoint(Z.positionScreen.x,Z.positionScreen.y),Y.addPoint(U.positionScreen.x,U.positionScreen.y),ai.instersects(Y)){c=0;for(w=o.meshMaterials.length;c<w;){if(j=o.meshMaterials[c++],j instanceof THREE.MeshFaceMaterial){v=0;for(u=o.faceMaterials.length;v<u;){(j=o.faceMaterials[v++])&&j.opacity!=0&&au(ae,Z,U,o,j,t)}}else{j&&j.opacity!=0&&au(ae,Z,U,o,j,t)}}}}else{if(o instanceof THREE.RenderableFace4&&(ae=o.v1,Z=o.v2,U=o.v3,ah=o.v4,ae.positionScreen.x*=ac,ae.positionScreen.y*=-ab,Z.positionScreen.x*=ac,Z.positionScreen.y*=-ab,U.positionScreen.x*=ac,U.positionScreen.y*=-ab,ah.positionScreen.x*=ac,ah.positionScreen.y*=-ab,Y.addPoint(ae.positionScreen.x,ae.positionScreen.y),Y.addPoint(Z.positionScreen.x,Z.positionScreen.y),Y.addPoint(U.positionScreen.x,U.positionScreen.y),Y.addPoint(ah.positionScreen.x,ah.positionScreen.y),ai.instersects(Y))){c=0;for(w=o.meshMaterials.length;c<w;){if(j=o.meshMaterials[c++],j instanceof THREE.MeshFaceMaterial){v=0;for(u=o.faceMaterials.length;v<u;){(j=o.faceMaterials[v++])&&j.opacity!=0&&at(ae,Z,U,ah,o,j,t)}}else{j&&j.opacity!=0&&at(ae,Z,U,ah,o,j,t)}}}}}}}}};THREE.ShaderChunk={fog_pars_fragment:"#ifdef USE_FOG\nuniform vec3 fogColor;\n#ifdef FOG_EXP2\nuniform float fogDensity;\n#else\nuniform float fogNear;\nuniform float fogFar;\n#endif\n#endif",fog_fragment:"#ifdef USE_FOG\nfloat depth = gl_FragCoord.z / gl_FragCoord.w;\n#ifdef FOG_EXP2\nconst float LOG2 = 1.442695;\nfloat fogFactor = exp2( - fogDensity * fogDensity * depth * depth * LOG2 );\nfogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );\n#else\nfloat fogFactor = smoothstep( fogNear, fogFar, depth );\n#endif\ngl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\nvarying vec3 vReflect;\nuniform float reflectivity;\nuniform samplerCube envMap;\nuniform int combine;\n#endif",envmap_fragment:"#ifdef USE_ENVMAP\nvec4 cubeColor = textureCube( envMap, vec3( -vReflect.x, vReflect.yz ) );\nif ( combine == 1 ) {\ngl_FragColor = vec4( mix( gl_FragColor.xyz, cubeColor.xyz, reflectivity ), opacity );\n} else {\ngl_FragColor = gl_FragColor * cubeColor;\n}\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\nvarying vec3 vReflect;\nuniform float refractionRatio;\nuniform bool useRefract;\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\nvec4 mPosition = objectMatrix * vec4( position, 1.0 );\nvec3 nWorld = mat3( objectMatrix[ 0 ].xyz, objectMatrix[ 1 ].xyz, objectMatrix[ 2 ].xyz ) * normal;\nif ( useRefract ) {\nvReflect = refract( normalize( mPosition.xyz - cameraPosition ), normalize( nWorld.xyz ), refractionRatio );\n} else {\nvReflect = reflect( normalize( mPosition.xyz - cameraPosition ), normalize( nWorld.xyz ) );\n}\n#endif",map_particle_pars_fragment:"#ifdef USE_MAP\nuniform sampler2D map;\n#endif",map_particle_fragment:"#ifdef USE_MAP\ngl_FragColor = gl_FragColor * texture2D( map, gl_PointCoord );\n#endif",map_pars_vertex:"#ifdef USE_MAP\nvarying vec2 vUv;\nuniform vec4 offsetRepeat;\n#endif",map_pars_fragment:"#ifdef USE_MAP\nvarying vec2 vUv;\nuniform sampler2D map;\n#endif",map_vertex:"#ifdef USE_MAP\nvUv = uv * offsetRepeat.zw + offsetRepeat.xy;\n#endif",map_fragment:"#ifdef USE_MAP\ngl_FragColor = gl_FragColor * texture2D( map, vUv );\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\nvarying vec2 vUv2;\nuniform sampler2D lightMap;\n#endif",lightmap_pars_vertex:"#ifdef USE_LIGHTMAP\nvarying vec2 vUv2;\n#endif",lightmap_fragment:"#ifdef USE_LIGHTMAP\ngl_FragColor = gl_FragColor * texture2D( lightMap, vUv2 );\n#endif",lightmap_vertex:"#ifdef USE_LIGHTMAP\nvUv2 = uv2;\n#endif",lights_pars_vertex:"uniform bool enableLighting;\nuniform vec3 ambientLightColor;\n#if MAX_DIR_LIGHTS > 0\nuniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];\nuniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];\n#endif\n#if MAX_POINT_LIGHTS > 0\nuniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];\nuniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\nuniform float pointLightDistance[ MAX_POINT_LIGHTS ];\n#ifdef PHONG\nvarying vec4 vPointLight[ MAX_POINT_LIGHTS ];\n#endif\n#endif",lights_vertex:"if ( !enableLighting ) {\nvLightWeighting = vec3( 1.0 );\n} else {\nvLightWeighting = ambientLightColor;\n#if MAX_DIR_LIGHTS > 0\nfor( int i = 0; i < MAX_DIR_LIGHTS; i ++ ) {\nvec4 lDirection = viewMatrix * vec4( directionalLightDirection[ i ], 0.0 );\nfloat directionalLightWeighting = max( dot( transformedNormal, normalize( lDirection.xyz ) ), 0.0 );\nvLightWeighting += directionalLightColor[ i ] * directionalLightWeighting;\n}\n#endif\n#if MAX_POINT_LIGHTS > 0\nfor( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\nvec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );\nvec3 lVector = lPosition.xyz - mvPosition.xyz;\nfloat lDistance = 1.0;\nif ( pointLightDistance[ i ] > 0.0 )\nlDistance = 1.0 - min( ( length( lVector ) / pointLightDistance[ i ] ), 1.0 );\nlVector = normalize( lVector );\nfloat pointLightWeighting = max( dot( transformedNormal, lVector ), 0.0 );\nvLightWeighting += pointLightColor[ i ] * pointLightWeighting * lDistance;\n#ifdef PHONG\nvPointLight[ i ] = vec4( lVector, lDistance );\n#endif\n}\n#endif\n}",lights_pars_fragment:"#if MAX_DIR_LIGHTS > 0\nuniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];\n#endif\n#if MAX_POINT_LIGHTS > 0\nvarying vec4 vPointLight[ MAX_POINT_LIGHTS ];\n#endif\nvarying vec3 vViewPosition;\nvarying vec3 vNormal;",lights_fragment:"vec3 normal = normalize( vNormal );\nvec3 viewPosition = normalize( vViewPosition );\nvec4 mColor = vec4( diffuse, opacity );\nvec4 mSpecular = vec4( specular, opacity );\n#if MAX_POINT_LIGHTS > 0\nvec4 pointDiffuse  = vec4( vec3( 0.0 ), 1.0 );\nvec4 pointSpecular = vec4( vec3( 0.0 ), 1.0 );\nfor ( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\nvec3 pointVector = normalize( vPointLight[ i ].xyz );\nvec3 pointHalfVector = normalize( vPointLight[ i ].xyz + viewPosition );\nfloat pointDistance = vPointLight[ i ].w;\nfloat pointDotNormalHalf = dot( normal, pointHalfVector );\nfloat pointDiffuseWeight = max( dot( normal, pointVector ), 0.0 );\nfloat pointSpecularWeight = 0.0;\nif ( pointDotNormalHalf >= 0.0 )\npointSpecularWeight = pow( pointDotNormalHalf, shininess );\npointDiffuse  += mColor * pointDiffuseWeight * pointDistance;\npointSpecular += mSpecular * pointSpecularWeight * pointDistance;\n}\n#endif\n#if MAX_DIR_LIGHTS > 0\nvec4 dirDiffuse  = vec4( vec3( 0.0 ), 1.0 );\nvec4 dirSpecular = vec4( vec3( 0.0 ), 1.0 );\nfor( int i = 0; i < MAX_DIR_LIGHTS; i ++ ) {\nvec4 lDirection = viewMatrix * vec4( directionalLightDirection[ i ], 0.0 );\nvec3 dirVector = normalize( lDirection.xyz );\nvec3 dirHalfVector = normalize( lDirection.xyz + viewPosition );\nfloat dirDotNormalHalf = dot( normal, dirHalfVector );\nfloat dirDiffuseWeight = max( dot( normal, dirVector ), 0.0 );\nfloat dirSpecularWeight = 0.0;\nif ( dirDotNormalHalf >= 0.0 )\ndirSpecularWeight = pow( dirDotNormalHalf, shininess );\ndirDiffuse  += mColor * dirDiffuseWeight;\ndirSpecular += mSpecular * dirSpecularWeight;\n}\n#endif\nvec4 totalLight = vec4( ambient, opacity );\n#if MAX_DIR_LIGHTS > 0\ntotalLight += dirDiffuse + dirSpecular;\n#endif\n#if MAX_POINT_LIGHTS > 0\ntotalLight += pointDiffuse + pointSpecular;\n#endif\ngl_FragColor = gl_FragColor * totalLight;",color_pars_fragment:"#ifdef USE_COLOR\nvarying vec3 vColor;\n#endif",color_fragment:"#ifdef USE_COLOR\ngl_FragColor = gl_FragColor * vec4( vColor, opacity );\n#endif",color_pars_vertex:"#ifdef USE_COLOR\nvarying vec3 vColor;\n#endif",color_vertex:"#ifdef USE_COLOR\nvColor = color;\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\nuniform mat4 boneGlobalMatrices[ MAX_BONES ];\n#endif",skinning_vertex:"#ifdef USE_SKINNING\ngl_Position  = ( boneGlobalMatrices[ int( skinIndex.x ) ] * skinVertexA ) * skinWeight.x;\ngl_Position += ( boneGlobalMatrices[ int( skinIndex.y ) ] * skinVertexB ) * skinWeight.y;\ngl_Position  = projectionMatrix * viewMatrix * objectMatrix * gl_Position;\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\nuniform float morphTargetInfluences[ 8 ];\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\nvec3 morphed = vec3( 0.0, 0.0, 0.0 );\nmorphed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];\nmorphed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];\nmorphed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];\nmorphed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];\nmorphed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];\nmorphed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];\nmorphed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];\nmorphed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];\nmorphed += position;\ngl_Position = projectionMatrix * modelViewMatrix * vec4( morphed, 1.0 );\n#endif",default_vertex:"#ifndef USE_MORPHTARGETS\n#ifndef USE_SKINNING\ngl_Position = projectionMatrix * mvPosition;\n#endif\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\nuniform sampler2D shadowMap[ MAX_SHADOWS ];\nuniform float shadowDarkness;\nuniform float shadowBias;\nvarying vec4 vShadowCoord[ MAX_SHADOWS ];\nfloat unpackDepth( const in vec4 rgba_depth ) {\nconst vec4 bit_shift = vec4( 1.0 / ( 256.0 * 256.0 * 256.0 ), 1.0 / ( 256.0 * 256.0 ), 1.0 / 256.0, 1.0 );\nfloat depth = dot( rgba_depth, bit_shift );\nreturn depth;\n}\n#endif",shadowmap_fragment:"#ifdef USE_SHADOWMAP\n#ifdef SHADOWMAP_SOFT\nconst float xPixelOffset = 1.0 / SHADOWMAP_WIDTH;\nconst float yPixelOffset = 1.0 / SHADOWMAP_HEIGHT;\n#endif\nvec4 shadowColor = vec4( 1.0 );\nfor( int i = 0; i < MAX_SHADOWS; i ++ ) {\nvec3 shadowCoord = vShadowCoord[ i ].xyz / vShadowCoord[ i ].w;\nif ( shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0 ) {\n#ifdef SHADOWMAP_SOFT\nfloat shadow = 0.0;\nfor ( float y = -1.25; y <= 1.25; y += 1.25 )\nfor ( float x = -1.25; x <= 1.25; x += 1.25 ) {\nvec4 rgbaDepth = texture2D( shadowMap[ i ], vec2( x * xPixelOffset, y * yPixelOffset ) + shadowCoord.xy );\nfloat fDepth = unpackDepth( rgbaDepth );\nif ( fDepth < ( shadowCoord.z + shadowBias ) )\nshadow += 1.0;\n}\nshadow /= 9.0;\nshadowColor = shadowColor * vec4( vec3( ( 1.0 - shadowDarkness * shadow ) ), 1.0 );\n#else\nvec4 rgbaDepth = texture2D( shadowMap[ i ], shadowCoord.xy );\nfloat fDepth = unpackDepth( rgbaDepth );\nif ( fDepth < ( shadowCoord.z + shadowBias ) )\nshadowColor = shadowColor * vec4( vec3( shadowDarkness ), 1.0 );\n#endif\n}\n}\ngl_FragColor = gl_FragColor * shadowColor;\n#endif",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\nvarying vec4 vShadowCoord[ MAX_SHADOWS ];\nuniform mat4 shadowMatrix[ MAX_SHADOWS ];\n#endif",shadowmap_vertex:"#ifdef USE_SHADOWMAP\nfor( int i = 0; i < MAX_SHADOWS; i ++ ) {\nvShadowCoord[ i ] = shadowMatrix[ i ] * objectMatrix * vec4( position, 1.0 );\n}\n#endif",alphatest_fragment:"#ifdef ALPHATEST\nif ( gl_FragColor.a < ALPHATEST ) discard;\n#endif"};THREE.UniformsUtils={merge:function(h){var n,m,k,j={};for(n=0;n<h.length;n++){for(m in k=this.clone(h[n]),k){j[m]=k[m]}}return j},clone:function(h){var n,m,k,j={};for(n in h){for(m in j[n]={},h[n]){k=h[n][m],j[n][m]=k instanceof THREE.Color||k instanceof THREE.Vector2||k instanceof THREE.Vector3||k instanceof THREE.Vector4||k instanceof THREE.Matrix4||k instanceof THREE.Texture?k.clone():k instanceof Array?k.slice():k}}return j}};THREE.UniformsLib={common:{diffuse:{type:"c",value:new THREE.Color(15658734)},opacity:{type:"f",value:1},map:{type:"t",value:0,texture:null},offsetRepeat:{type:"v4",value:new THREE.Vector4(0,0,1,1)},lightMap:{type:"t",value:2,texture:null},envMap:{type:"t",value:1,texture:null},useRefract:{type:"i",value:0},reflectivity:{type:"f",value:1},refractionRatio:{type:"f",value:0.98},combine:{type:"i",value:0},morphTargetInfluences:{type:"f",value:0}},fog:{fogDensity:{type:"f",value:0.00025},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2000},fogColor:{type:"c",value:new THREE.Color(16777215)}},lights:{enableLighting:{type:"i",value:1},ambientLightColor:{type:"fv",value:[]},directionalLightDirection:{type:"fv",value:[]},directionalLightColor:{type:"fv",value:[]},pointLightColor:{type:"fv",value:[]},pointLightPosition:{type:"fv",value:[]},pointLightDistance:{type:"fv1",value:[]}},particle:{psColor:{type:"c",value:new THREE.Color(15658734)},opacity:{type:"f",value:1},size:{type:"f",value:1},scale:{type:"f",value:1},map:{type:"t",value:0,texture:null},fogDensity:{type:"f",value:0.00025},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2000},fogColor:{type:"c",value:new THREE.Color(16777215)}},shadowmap:{shadowMap:{type:"tv",value:3,texture:[]},shadowMatrix:{type:"m4v",value:[]},shadowBias:{type:"f",value:0.0039},shadowDarkness:{type:"f",value:0.2}}};THREE.ShaderLib={lensFlareVertexTexture:{vertexShader:"uniform vec3 screenPosition;\nuniform vec2 scale;\nuniform float rotation;\nuniform int renderType;\nuniform sampler2D occlusionMap;\nattribute vec2 position;\nattribute vec2 UV;\nvarying vec2 vUV;\nvarying float vVisibility;\nvoid main() {\nvUV = UV;\nvec2 pos = position;\nif( renderType == 2 ) {\nvec4 visibility = texture2D( occlusionMap, vec2( 0.1, 0.1 ) ) +\ntexture2D( occlusionMap, vec2( 0.5, 0.1 ) ) +\ntexture2D( occlusionMap, vec2( 0.9, 0.1 ) ) +\ntexture2D( occlusionMap, vec2( 0.9, 0.5 ) ) +\ntexture2D( occlusionMap, vec2( 0.9, 0.9 ) ) +\ntexture2D( occlusionMap, vec2( 0.5, 0.9 ) ) +\ntexture2D( occlusionMap, vec2( 0.1, 0.9 ) ) +\ntexture2D( occlusionMap, vec2( 0.1, 0.5 ) ) +\ntexture2D( occlusionMap, vec2( 0.5, 0.5 ) );\nvVisibility = (       visibility.r / 9.0 ) *\n( 1.0 - visibility.g / 9.0 ) *\n(       visibility.b / 9.0 ) *\n( 1.0 - visibility.a / 9.0 );\npos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;\npos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;\n}\ngl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );\n}",fragmentShader:"#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D map;\nuniform float opacity;\nuniform int renderType;\nvarying vec2 vUV;\nvarying float vVisibility;\nvoid main() {\nif( renderType == 0 ) {\ngl_FragColor = vec4( 1.0, 0.0, 1.0, 0.0 );\n} else if( renderType == 1 ) {\ngl_FragColor = texture2D( map, vUV );\n} else {\nvec4 color = texture2D( map, vUV );\ncolor.a *= opacity * vVisibility;\ngl_FragColor = color;\n}\n}"},lensFlare:{vertexShader:"uniform vec3 screenPosition;\nuniform vec2 scale;\nuniform float rotation;\nuniform int renderType;\nattribute vec2 position;\nattribute vec2 UV;\nvarying vec2 vUV;\nvoid main() {\nvUV = UV;\nvec2 pos = position;\nif( renderType == 2 ) {\npos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;\npos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;\n}\ngl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );\n}",fragmentShader:"#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D map;\nuniform sampler2D occlusionMap;\nuniform float opacity;\nuniform int renderType;\nvarying vec2 vUV;\nvoid main() {\nif( renderType == 0 ) {\ngl_FragColor = vec4( texture2D( map, vUV ).rgb, 0.0 );\n} else if( renderType == 1 ) {\ngl_FragColor = texture2D( map, vUV );\n} else {\nfloat visibility = texture2D( occlusionMap, vec2( 0.5, 0.1 ) ).a +\ntexture2D( occlusionMap, vec2( 0.9, 0.5 ) ).a +\ntexture2D( occlusionMap, vec2( 0.5, 0.9 ) ).a +\ntexture2D( occlusionMap, vec2( 0.1, 0.5 ) ).a;\nvisibility = ( 1.0 - visibility / 4.0 );\nvec4 color = texture2D( map, vUV );\ncolor.a *= opacity * visibility;\ngl_FragColor = color;\n}\n}"},sprite:{vertexShader:"uniform int useScreenCoordinates;\nuniform int affectedByDistance;\nuniform vec3 screenPosition;\nuniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\nuniform float rotation;\nuniform vec2 scale;\nuniform vec2 alignment;\nuniform vec2 uvOffset;\nuniform vec2 uvScale;\nattribute vec2 position;\nattribute vec2 uv;\nvarying vec2 vUV;\nvoid main() {\nvUV = uvOffset + uv * uvScale;\nvec2 alignedPosition = position + alignment;\nvec2 rotatedPosition;\nrotatedPosition.x = ( cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y ) * scale.x;\nrotatedPosition.y = ( sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y ) * scale.y;\nvec4 finalPosition;\nif( useScreenCoordinates != 0 ) {\nfinalPosition = vec4( screenPosition.xy + rotatedPosition, screenPosition.z, 1.0 );\n} else {\nfinalPosition = projectionMatrix * modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\nfinalPosition.xy += rotatedPosition * ( affectedByDistance == 1 ? 1.0 : finalPosition.z );\n}\ngl_Position = finalPosition;\n}",fragmentShader:"#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D map;\nuniform float opacity;\nvarying vec2 vUV;\nvoid main() {\nvec4 color = texture2D( map, vUV );\ncolor.a *= opacity;\ngl_FragColor = color;\n}"},shadowPost:{vertexShader:"uniform \tmat4 \tprojectionMatrix;\nattribute \tvec3 \tposition;\nvoid main() {\ngl_Position = projectionMatrix * vec4( position, 1.0 );\n}",fragmentShader:"#ifdef GL_ES\nprecision highp float;\n#endif\nuniform \tfloat \tdarkness;\nvoid main() {\ngl_FragColor = vec4( 0, 0, 0, darkness );\n}"},shadowVolumeDynamic:{uniforms:{directionalLightDirection:{type:"fv",value:[]}},vertexShader:"uniform \tvec3 \tdirectionalLightDirection;\nvoid main() {\nvec4 pos      = objectMatrix * vec4( position, 1.0 );\nvec3 norm     = mat3( objectMatrix[ 0 ].xyz, objectMatrix[ 1 ].xyz, objectMatrix[ 2 ].xyz ) * normal;\nvec4 extruded = vec4( directionalLightDirection * 5000.0 * step( 0.0, dot( directionalLightDirection, norm ) ), 0.0 );\ngl_Position   = projectionMatrix * viewMatrix * ( pos + extruded );\n}",fragmentShader:"void main() {\ngl_FragColor = vec4( 1.0 );\n}"},depth:{uniforms:{mNear:{type:"f",value:1},mFar:{type:"f",value:2000},opacity:{type:"f",value:1}},fragmentShader:"uniform float mNear;\nuniform float mFar;\nuniform float opacity;\nvoid main() {\nfloat depth = gl_FragCoord.z / gl_FragCoord.w;\nfloat color = 1.0 - smoothstep( mNear, mFar, depth );\ngl_FragColor = vec4( vec3( color ), opacity );\n}",vertexShader:"void main() {\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}"},normal:{uniforms:{opacity:{type:"f",value:1}},fragmentShader:"uniform float opacity;\nvarying vec3 vNormal;\nvoid main() {\ngl_FragColor = vec4( 0.5 * normalize( vNormal ) + 0.5, opacity );\n}",vertexShader:"varying vec3 vNormal;\nvoid main() {\nvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\nvNormal = normalize( normalMatrix * normal );\ngl_Position = projectionMatrix * mvPosition;\n}"},basic:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.fog,THREE.UniformsLib.shadowmap]),fragmentShader:["uniform vec3 diffuse;\nuniform float opacity;",THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.map_pars_fragment,THREE.ShaderChunk.lightmap_pars_fragment,THREE.ShaderChunk.envmap_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.shadowmap_pars_fragment,"void main() {\ngl_FragColor = vec4( diffuse, opacity );",THREE.ShaderChunk.map_fragment,THREE.ShaderChunk.alphatest_fragment,THREE.ShaderChunk.lightmap_fragment,THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.envmap_fragment,THREE.ShaderChunk.shadowmap_fragment,THREE.ShaderChunk.fog_fragment,"}"].join("\n"),vertexShader:[THREE.ShaderChunk.map_pars_vertex,THREE.ShaderChunk.lightmap_pars_vertex,THREE.ShaderChunk.envmap_pars_vertex,THREE.ShaderChunk.color_pars_vertex,THREE.ShaderChunk.skinning_pars_vertex,THREE.ShaderChunk.morphtarget_pars_vertex,THREE.ShaderChunk.shadowmap_pars_vertex,"void main() {\nvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );",THREE.ShaderChunk.map_vertex,THREE.ShaderChunk.lightmap_vertex,THREE.ShaderChunk.envmap_vertex,THREE.ShaderChunk.color_vertex,THREE.ShaderChunk.skinning_vertex,THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.default_vertex,THREE.ShaderChunk.shadowmap_vertex,"}"].join("\n")},lambert:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.fog,THREE.UniformsLib.lights,THREE.UniformsLib.shadowmap]),fragmentShader:["uniform vec3 diffuse;\nuniform float opacity;\nvarying vec3 vLightWeighting;",THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.map_pars_fragment,THREE.ShaderChunk.lightmap_pars_fragment,THREE.ShaderChunk.envmap_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.shadowmap_pars_fragment,"void main() {\ngl_FragColor = vec4( diffuse, opacity );",THREE.ShaderChunk.map_fragment,THREE.ShaderChunk.alphatest_fragment,"gl_FragColor = gl_FragColor * vec4( vLightWeighting, 1.0 );",THREE.ShaderChunk.lightmap_fragment,THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.envmap_fragment,THREE.ShaderChunk.shadowmap_fragment,THREE.ShaderChunk.fog_fragment,"}"].join("\n"),vertexShader:["varying vec3 vLightWeighting;",THREE.ShaderChunk.map_pars_vertex,THREE.ShaderChunk.lightmap_pars_vertex,THREE.ShaderChunk.envmap_pars_vertex,THREE.ShaderChunk.lights_pars_vertex,THREE.ShaderChunk.color_pars_vertex,THREE.ShaderChunk.skinning_pars_vertex,THREE.ShaderChunk.morphtarget_pars_vertex,THREE.ShaderChunk.shadowmap_pars_vertex,"void main() {\nvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );",THREE.ShaderChunk.map_vertex,THREE.ShaderChunk.lightmap_vertex,THREE.ShaderChunk.envmap_vertex,THREE.ShaderChunk.color_vertex,"vec3 transformedNormal = normalize( normalMatrix * normal );",THREE.ShaderChunk.lights_vertex,THREE.ShaderChunk.skinning_vertex,THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.default_vertex,THREE.ShaderChunk.shadowmap_vertex,"}"].join("\n")},phong:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.fog,THREE.UniformsLib.lights,THREE.UniformsLib.shadowmap,{ambient:{type:"c",value:new THREE.Color(328965)},specular:{type:"c",value:new THREE.Color(1118481)},shininess:{type:"f",value:30}}]),fragmentShader:["uniform vec3 diffuse;\nuniform float opacity;\nuniform vec3 ambient;\nuniform vec3 specular;\nuniform float shininess;\nvarying vec3 vLightWeighting;",THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.map_pars_fragment,THREE.ShaderChunk.lightmap_pars_fragment,THREE.ShaderChunk.envmap_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.lights_pars_fragment,THREE.ShaderChunk.shadowmap_pars_fragment,"void main() {\ngl_FragColor = vec4( vLightWeighting, 1.0 );",THREE.ShaderChunk.map_fragment,THREE.ShaderChunk.alphatest_fragment,THREE.ShaderChunk.lights_fragment,THREE.ShaderChunk.lightmap_fragment,THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.envmap_fragment,THREE.ShaderChunk.shadowmap_fragment,THREE.ShaderChunk.fog_fragment,"}"].join("\n"),vertexShader:["#define PHONG\nvarying vec3 vLightWeighting;\nvarying vec3 vViewPosition;\nvarying vec3 vNormal;",THREE.ShaderChunk.map_pars_vertex,THREE.ShaderChunk.lightmap_pars_vertex,THREE.ShaderChunk.envmap_pars_vertex,THREE.ShaderChunk.lights_pars_vertex,THREE.ShaderChunk.color_pars_vertex,THREE.ShaderChunk.skinning_pars_vertex,THREE.ShaderChunk.morphtarget_pars_vertex,THREE.ShaderChunk.shadowmap_pars_vertex,"void main() {\nvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );",THREE.ShaderChunk.map_vertex,THREE.ShaderChunk.lightmap_vertex,THREE.ShaderChunk.envmap_vertex,THREE.ShaderChunk.color_vertex,"#ifndef USE_ENVMAP\nvec4 mPosition = objectMatrix * vec4( position, 1.0 );\n#endif\nvViewPosition = cameraPosition - mPosition.xyz;\nvec3 transformedNormal = normalize( normalMatrix * normal );\nvNormal = transformedNormal;",THREE.ShaderChunk.lights_vertex,THREE.ShaderChunk.skinning_vertex,THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.default_vertex,THREE.ShaderChunk.shadowmap_vertex,"}"].join("\n")},particle_basic:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.particle,THREE.UniformsLib.shadowmap]),fragmentShader:["uniform vec3 psColor;\nuniform float opacity;",THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.map_particle_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.shadowmap_pars_fragment,"void main() {\ngl_FragColor = vec4( psColor, opacity );",THREE.ShaderChunk.map_particle_fragment,THREE.ShaderChunk.alphatest_fragment,THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.shadowmap_fragment,THREE.ShaderChunk.fog_fragment,"}"].join("\n"),vertexShader:["uniform float size;\nuniform float scale;",THREE.ShaderChunk.color_pars_vertex,THREE.ShaderChunk.shadowmap_pars_vertex,"void main() {",THREE.ShaderChunk.color_vertex,"vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n#ifdef USE_SIZEATTENUATION\ngl_PointSize = size * ( scale / length( mvPosition.xyz ) );\n#else\ngl_PointSize = size;\n#endif\ngl_Position = projectionMatrix * mvPosition;",THREE.ShaderChunk.shadowmap_vertex,"}"].join("\n")},depthRGBA:{uniforms:{},fragmentShader:"vec4 pack_depth( const in float depth ) {\nconst vec4 bit_shift = vec4( 256.0 * 256.0 * 256.0, 256.0 * 256.0, 256.0, 1.0 );\nconst vec4 bit_mask  = vec4( 0.0, 1.0 / 256.0, 1.0 / 256.0, 1.0 / 256.0 );\nvec4 res = fract( depth * bit_shift );\nres -= res.xxyz * bit_mask;\nreturn res;\n}\nvoid main() {\ngl_FragData[ 0 ] = pack_depth( gl_FragCoord.z );\n}",vertexShader:[THREE.ShaderChunk.morphtarget_pars_vertex,"void main() {\nvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );",THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.default_vertex,"}"].join("\n")}};THREE.WebGLRenderer=function(bd){function bc(U,T,S){var R,N,P,M=U.vertices,L=M.length,K=U.colors,J=K.length,D=U.__vertexArray,E=U.__colorArray,I=U.__sortArray,C=U.__dirtyVertices,y=U.__dirtyColors,n=U.__webglCustomAttributes,H,G;if(n){for(H in n){n[H].offset=0}}if(S.sortParticles){aD.multiplySelf(S.matrixWorld);for(R=0;R<L;R++){N=M[R].position,aF.copy(N),aD.multiplyVector3(aF),I[R]=[aF.z,R]}I.sort(function(e,f){return f[0]-e[0]});for(R=0;R<L;R++){N=M[I[R][1]].position,P=R*3,D[P]=N.x,D[P+1]=N.y,D[P+2]=N.z}for(R=0;R<J;R++){P=R*3,color=K[I[R][1]],E[P]=color.r,E[P+1]=color.g,E[P+2]=color.b}if(n){for(H in n){R=n[H];K=R.value.length;for(P=0;P<K;P++){index=I[P][1];J=R.offset;if(R.size===1){if(R.boundTo===void 0||R.boundTo==="vertices"){R.array[J]=R.value[index]}}else{if(R.boundTo===void 0||R.boundTo==="vertices"){G=R.value[index]}R.size===2?(R.array[J]=G.x,R.array[J+1]=G.y):R.size===3?R.type==="c"?(R.array[J]=G.r,R.array[J+1]=G.g,R.array[J+2]=G.b):(R.array[J]=G.x,R.array[J+1]=G.y,R.array[J+2]=G.z):(R.array[J]=G.x,R.array[J+1]=G.y,R.array[J+2]=G.z,R.array[J+3]=G.w)}R.offset+=R.size}}}}else{if(C){for(R=0;R<L;R++){N=M[R].position,P=R*3,D[P]=N.x,D[P+1]=N.y,D[P+2]=N.z}}if(y){for(R=0;R<J;R++){color=K[R],P=R*3,E[P]=color.r,E[P+1]=color.g,E[P+2]=color.b}}if(n){for(H in n){if(R=n[H],R.__original.needsUpdate){K=R.value.length;for(P=0;P<K;P++){J=R.offset;if(R.size===1){if(R.boundTo===void 0||R.boundTo==="vertices"){R.array[J]=R.value[P]}}else{if(R.boundTo===void 0||R.boundTo==="vertices"){G=R.value[P]}R.size===2?(R.array[J]=G.x,R.array[J+1]=G.y):R.size===3?R.type==="c"?(R.array[J]=G.r,R.array[J+1]=G.g,R.array[J+2]=G.b):(R.array[J]=G.x,R.array[J+1]=G.y,R.array[J+2]=G.z):(R.array[J]=G.x,R.array[J+1]=G.y,R.array[J+2]=G.z,R.array[J+3]=G.w)}R.offset+=R.size}}}}}if(C||S.sortParticles){a3.bindBuffer(a3.ARRAY_BUFFER,U.__webglVertexBuffer),a3.bufferData(a3.ARRAY_BUFFER,D,T)}if(y||S.sortParticles){a3.bindBuffer(a3.ARRAY_BUFFER,U.__webglColorBuffer),a3.bufferData(a3.ARRAY_BUFFER,E,T)}if(n){for(H in n){if(R=n[H],R.__original.needsUpdate||S.sortParticles){a3.bindBuffer(a3.ARRAY_BUFFER,R.buffer),a3.bufferData(a3.ARRAY_BUFFER,R.array,T)}}}}function bb(bn,bl,bk,bj,bh){bj.program||ay.initMaterial(bj,bl,bk,bh);if(bj.morphTargets&&!bh.__webglMorphTargetInfluences){bh.__webglMorphTargetInfluences=new Float32Array(ay.maxMorphTargets);for(var bi=0,bg=ay.maxMorphTargets;bi<bg;bi++){bh.__webglMorphTargetInfluences[bi]=0}}var bi=bj.program,bg=bi.uniforms,bf=bj.uniforms;bi!=ae&&(a3.useProgram(bi),ae=bi);a3.uniformMatrix4fv(bg.projectionMatrix,!1,aQ);if(bk&&(bj instanceof THREE.MeshBasicMaterial||bj instanceof THREE.MeshLambertMaterial||bj instanceof THREE.MeshPhongMaterial||bj instanceof THREE.LineBasicMaterial||bj instanceof THREE.ParticleBasicMaterial||bj.fog)){if(bf.fogColor.value=bk.color,bk instanceof THREE.Fog){bf.fogNear.value=bk.near,bf.fogFar.value=bk.far}else{if(bk instanceof THREE.FogExp2){bf.fogDensity.value=bk.density}}}if(bj instanceof THREE.MeshPhongMaterial||bj instanceof THREE.MeshLambertMaterial||bj.lights){var be,aa,U,W=0,Z=0,T=0,R,X,N,Y=aG,K=Y.directional.colors,S=Y.directional.positions,P=Y.point.colors,M=Y.point.positions,n=Y.point.distances,V=0,D=0,bk=aa=N=0;for(be=bl.length;bk<be;bk++){if(aa=bl[bk],U=aa.color,R=aa.position,X=aa.intensity,N=aa.distance,aa instanceof THREE.AmbientLight){W+=U.r,Z+=U.g,T+=U.b}else{if(aa instanceof THREE.DirectionalLight){N=V*3,K[N]=U.r*X,K[N+1]=U.g*X,K[N+2]=U.b*X,S[N]=R.x,S[N+1]=R.y,S[N+2]=R.z,V+=1}else{if(aa instanceof THREE.SpotLight){N=V*3,K[N]=U.r*X,K[N+1]=U.g*X,K[N+2]=U.b*X,U=1/R.length(),S[N]=R.x*U,S[N+1]=R.y*U,S[N+2]=R.z*U,V+=1}else{if(aa instanceof THREE.PointLight){aa=D*3,P[aa]=U.r*X,P[aa+1]=U.g*X,P[aa+2]=U.b*X,M[aa]=R.x,M[aa+1]=R.y,M[aa+2]=R.z,n[D]=N,D+=1}}}}}for(bk=V*3;bk<K.length;bk++){K[bk]=0}for(bk=D*3;bk<P.length;bk++){P[bk]=0}Y.point.length=D;Y.directional.length=V;Y.ambient[0]=W;Y.ambient[1]=Z;Y.ambient[2]=T;bl=aG;bf.enableLighting.value=bl.directional.length+bl.point.length;bf.ambientLightColor.value=bl.ambient;bf.directionalLightColor.value=bl.directional.colors;bf.directionalLightDirection.value=bl.directional.positions;bf.pointLightColor.value=bl.point.colors;bf.pointLightPosition.value=bl.point.positions;bf.pointLightDistance.value=bl.point.distances}if(bj instanceof THREE.MeshBasicMaterial||bj instanceof THREE.MeshLambertMaterial||bj instanceof THREE.MeshPhongMaterial){bf.diffuse.value=bj.color,bf.opacity.value=bj.opacity,(bf.map.texture=bj.map)&&bf.offsetRepeat.value.set(bj.map.offset.x,bj.map.offset.y,bj.map.repeat.x,bj.map.repeat.y),bf.lightMap.texture=bj.lightMap,bf.envMap.texture=bj.envMap,bf.reflectivity.value=bj.reflectivity,bf.refractionRatio.value=bj.refractionRatio,bf.combine.value=bj.combine,bf.useRefract.value=bj.envMap&&bj.envMap.mapping instanceof THREE.CubeRefractionMapping}if(bj instanceof THREE.LineBasicMaterial){bf.diffuse.value=bj.color,bf.opacity.value=bj.opacity}else{if(bj instanceof THREE.ParticleBasicMaterial){bf.psColor.value=bj.color,bf.opacity.value=bj.opacity,bf.size.value=bj.size,bf.scale.value=aY.height/2,bf.map.texture=bj.map}else{if(bj instanceof THREE.MeshPhongMaterial){bf.ambient.value=bj.ambient,bf.specular.value=bj.specular,bf.shininess.value=bj.shininess}else{if(bj instanceof THREE.MeshDepthMaterial){bf.mNear.value=bn.near,bf.mFar.value=bn.far,bf.opacity.value=bj.opacity}else{if(bj instanceof THREE.MeshNormalMaterial){bf.opacity.value=bj.opacity}}}}}if(bh.receiveShadow&&!bj._shadowPass&&bf.shadowMatrix){for(bl=0;bl<ah.length;bl++){bf.shadowMatrix.value[bl]=ah[bl],bf.shadowMap.texture[bl]=ay.shadowMap[bl]}bf.shadowDarkness.value=ay.shadowMapDarkness;bf.shadowBias.value=ay.shadowMapBias}for(var C in bf){if(be=bi.uniforms[C]){if(bk=bf[C],W=bk.type,bl=bk.value,W=="i"){a3.uniform1i(be,bl)}else{if(W=="f"){a3.uniform1f(be,bl)}else{if(W=="fv1"){a3.uniform1fv(be,bl)}else{if(W=="fv"){a3.uniform3fv(be,bl)}else{if(W=="v2"){a3.uniform2f(be,bl.x,bl.y)}else{if(W=="v3"){a3.uniform3f(be,bl.x,bl.y,bl.z)}else{if(W=="v4"){a3.uniform4f(be,bl.x,bl.y,bl.z,bl.w)}else{if(W=="m4"){if(!bk._array){bk._array=new Float32Array(16)}bl.flattenToArray(bk._array);a3.uniformMatrix4fv(be,!1,bk._array)}else{if(W=="m4v"){if(!bk._array){bk._array=new Float32Array(16*bl.length)}W=0;for(Z=bl.length;W<Z;W++){bl[W].flattenToArrayOffset(bk._array,W*16)}a3.uniformMatrix4fv(be,!1,bk._array)}else{if(W=="c"){a3.uniform3f(be,bl.r,bl.g,bl.b)}else{if(W=="t"){if(a3.uniform1i(be,bl),be=bk.texture){if(be.image instanceof Array&&be.image.length==6){if(bk=be,bk.image.length==6){if(bk.needsUpdate){if(bk.__webglInit){a3.bindTexture(a3.TEXTURE_CUBE_MAP,bk.image.__webglTextureCube);for(be=0;be<6;++be){a3.texSubImage2D(a3.TEXTURE_CUBE_MAP_POSITIVE_X+be,0,0,0,a3.RGBA,a3.UNSIGNED_BYTE,bk.image[be])}}else{bk.image.__webglTextureCube=a3.createTexture();a3.bindTexture(a3.TEXTURE_CUBE_MAP,bk.image.__webglTextureCube);for(be=0;be<6;++be){a3.texImage2D(a3.TEXTURE_CUBE_MAP_POSITIVE_X+be,0,a3.RGBA,a3.RGBA,a3.UNSIGNED_BYTE,bk.image[be])}bk.__webglInit=!0}aq(a3.TEXTURE_CUBE_MAP,bk,bk.image[0]);a3.bindTexture(a3.TEXTURE_CUBE_MAP,null);bk.needsUpdate=!1}a3.activeTexture(a3.TEXTURE0+bl);a3.bindTexture(a3.TEXTURE_CUBE_MAP,bk.image.__webglTextureCube)}}else{ax(be,bl)}}}else{if(W=="tv"){if(!bk._array){bk._array=[];W=0;for(Z=bk.texture.length;W<Z;W++){bk._array[W]=bl+W}}a3.uniform1iv(be,bk._array);W=0;for(Z=bk.texture.length;W<Z;W++){(be=bk.texture[W])&&ax(be,bk._array[W])}}}}}}}}}}}}}}}a3.uniformMatrix4fv(bg.modelViewMatrix,!1,bh._modelViewMatrixArray);a3.uniformMatrix3fv(bg.normalMatrix,!1,bh._normalMatrixArray);(bj instanceof THREE.MeshShaderMaterial||bj instanceof THREE.MeshPhongMaterial||bj.envMap)&&bg.cameraPosition!==null&&a3.uniform3f(bg.cameraPosition,bn.position.x,bn.position.y,bn.position.z);(bj instanceof THREE.MeshShaderMaterial||bj.envMap||bj.skinning||bh.receiveShadow)&&bg.objectMatrix!==null&&a3.uniformMatrix4fv(bg.objectMatrix,!1,bh._objectMatrixArray);(bj instanceof THREE.MeshPhongMaterial||bj instanceof THREE.MeshLambertMaterial||bj instanceof THREE.MeshShaderMaterial||bj.skinning)&&bg.viewMatrix!==null&&a3.uniformMatrix4fv(bg.viewMatrix,!1,Q);bj.skinning&&(a3.uniformMatrix4fv(bg.cameraInverseMatrix,!1,Q),a3.uniformMatrix4fv(bg.boneGlobalMatrices,!1,bh.boneMatrices));return bi}function a9(E,D,C,A,B,y){if(A.opacity!=0){var x,E=bb(E,D,C,A,y).attributes;if(!A.morphTargets&&E.position>=0){a3.bindBuffer(a3.ARRAY_BUFFER,B.__webglVertexBuffer),a3.vertexAttribPointer(E.position,3,a3.FLOAT,!1,0,0)}else{if(y.morphTargetBase){D=A.program.attributes;y.morphTargetBase!==-1?(a3.bindBuffer(a3.ARRAY_BUFFER,B.__webglMorphTargetsBuffers[y.morphTargetBase]),a3.vertexAttribPointer(D.position,3,a3.FLOAT,!1,0,0)):D.position>=0&&(a3.bindBuffer(a3.ARRAY_BUFFER,B.__webglVertexBuffer),a3.vertexAttribPointer(D.position,3,a3.FLOAT,!1,0,0));if(y.morphTargetForcedOrder.length){for(var C=0,w=y.morphTargetForcedOrder,n=y.morphTargetInfluences;C<A.numSupportedMorphTargets&&C<w.length;){a3.bindBuffer(a3.ARRAY_BUFFER,B.__webglMorphTargetsBuffers[w[C]]),a3.vertexAttribPointer(D["morphTarget"+C],3,a3.FLOAT,!1,0,0),y.__webglMorphTargetInfluences[C]=n[w[C]],C++}}else{var w=[],H=-1,I=0,n=y.morphTargetInfluences,e,G=n.length,C=0;for(y.morphTargetBase!==-1&&(w[y.morphTargetBase]=!0);C<A.numSupportedMorphTargets;){for(e=0;e<G;e++){!w[e]&&n[e]>H&&(I=e,H=n[I])}a3.bindBuffer(a3.ARRAY_BUFFER,B.__webglMorphTargetsBuffers[I]);a3.vertexAttribPointer(D["morphTarget"+C],3,a3.FLOAT,!1,0,0);y.__webglMorphTargetInfluences[C]=H;w[I]=1;H=-1;C++}}A.program.uniforms.morphTargetInfluences!==null&&a3.uniform1fv(A.program.uniforms.morphTargetInfluences,y.__webglMorphTargetInfluences)}}if(B.__webglCustomAttributes){for(x in B.__webglCustomAttributes){E[x]>=0&&(D=B.__webglCustomAttributes[x],a3.bindBuffer(a3.ARRAY_BUFFER,D.buffer),a3.vertexAttribPointer(E[x],D.size,a3.FLOAT,!1,0,0))}}E.color>=0&&(a3.bindBuffer(a3.ARRAY_BUFFER,B.__webglColorBuffer),a3.vertexAttribPointer(E.color,3,a3.FLOAT,!1,0,0));E.normal>=0&&(a3.bindBuffer(a3.ARRAY_BUFFER,B.__webglNormalBuffer),a3.vertexAttribPointer(E.normal,3,a3.FLOAT,!1,0,0));E.tangent>=0&&(a3.bindBuffer(a3.ARRAY_BUFFER,B.__webglTangentBuffer),a3.vertexAttribPointer(E.tangent,4,a3.FLOAT,!1,0,0));E.uv>=0&&(B.__webglUVBuffer?(a3.bindBuffer(a3.ARRAY_BUFFER,B.__webglUVBuffer),a3.vertexAttribPointer(E.uv,2,a3.FLOAT,!1,0,0),a3.enableVertexAttribArray(E.uv)):a3.disableVertexAttribArray(E.uv));E.uv2>=0&&(B.__webglUV2Buffer?(a3.bindBuffer(a3.ARRAY_BUFFER,B.__webglUV2Buffer),a3.vertexAttribPointer(E.uv2,2,a3.FLOAT,!1,0,0),a3.enableVertexAttribArray(E.uv2)):a3.disableVertexAttribArray(E.uv2));A.skinning&&E.skinVertexA>=0&&E.skinVertexB>=0&&E.skinIndex>=0&&E.skinWeight>=0&&(a3.bindBuffer(a3.ARRAY_BUFFER,B.__webglSkinVertexABuffer),a3.vertexAttribPointer(E.skinVertexA,4,a3.FLOAT,!1,0,0),a3.bindBuffer(a3.ARRAY_BUFFER,B.__webglSkinVertexBBuffer),a3.vertexAttribPointer(E.skinVertexB,4,a3.FLOAT,!1,0,0),a3.bindBuffer(a3.ARRAY_BUFFER,B.__webglSkinIndicesBuffer),a3.vertexAttribPointer(E.skinIndex,4,a3.FLOAT,!1,0,0),a3.bindBuffer(a3.ARRAY_BUFFER,B.__webglSkinWeightsBuffer),a3.vertexAttribPointer(E.skinWeight,4,a3.FLOAT,!1,0,0));y instanceof THREE.Mesh?(A.wireframe?(a3.lineWidth(A.wireframeLinewidth),a3.bindBuffer(a3.ELEMENT_ARRAY_BUFFER,B.__webglLineBuffer),a3.drawElements(a3.LINES,B.__webglLineCount,a3.UNSIGNED_SHORT,0)):(a3.bindBuffer(a3.ELEMENT_ARRAY_BUFFER,B.__webglFaceBuffer),a3.drawElements(a3.TRIANGLES,B.__webglFaceCount,a3.UNSIGNED_SHORT,0)),ay.data.vertices+=B.__webglFaceCount,ay.data.faces+=B.__webglFaceCount/3,ay.data.drawCalls++):y instanceof THREE.Line?(y=y.type==THREE.LineStrip?a3.LINE_STRIP:a3.LINES,a3.lineWidth(A.linewidth),a3.drawArrays(y,0,B.__webglLineCount),ay.data.drawCalls++):y instanceof THREE.ParticleSystem?(a3.drawArrays(a3.POINTS,0,B.__webglParticleCount),ay.data.drawCalls++):y instanceof THREE.Ribbon&&(a3.drawArrays(a3.TRIANGLE_STRIP,0,B.__webglVertexCount),ay.data.drawCalls++)}}function a8(H,G,E){if(!H.__webglVertexBuffer){H.__webglVertexBuffer=a3.createBuffer()}if(!H.__webglNormalBuffer){H.__webglNormalBuffer=a3.createBuffer()}H.hasPos&&(a3.bindBuffer(a3.ARRAY_BUFFER,H.__webglVertexBuffer),a3.bufferData(a3.ARRAY_BUFFER,H.positionArray,a3.DYNAMIC_DRAW),a3.enableVertexAttribArray(G.attributes.position),a3.vertexAttribPointer(G.attributes.position,3,a3.FLOAT,!1,0,0));if(H.hasNormal){a3.bindBuffer(a3.ARRAY_BUFFER,H.__webglNormalBuffer);if(E==THREE.FlatShading){var D,C,B,A,y,x,w,J,K,n,I=H.count*3;for(n=0;n<I;n+=9){E=H.normalArray,D=E[n],C=E[n+1],B=E[n+2],A=E[n+3],x=E[n+4],J=E[n+5],y=E[n+6],w=E[n+7],K=E[n+8],D=(D+A+y)/3,C=(C+x+w)/3,B=(B+J+K)/3,E[n]=D,E[n+1]=C,E[n+2]=B,E[n+3]=D,E[n+4]=C,E[n+5]=B,E[n+6]=D,E[n+7]=C,E[n+8]=B}}a3.bufferData(a3.ARRAY_BUFFER,H.normalArray,a3.DYNAMIC_DRAW);a3.enableVertexAttribArray(G.attributes.normal);a3.vertexAttribPointer(G.attributes.normal,3,a3.FLOAT,!1,0,0)}a3.drawArrays(a3.TRIANGLES,0,H.count);H.count=0}function a6(c){if(z!=c.doubleSided){c.doubleSided?a3.disable(a3.CULL_FACE):a3.enable(a3.CULL_FACE),z=c.doubleSided}if(ag!=c.flipSided){c.flipSided?a3.frontFace(a3.CW):a3.frontFace(a3.CCW),ag=c.flipSided}}function a7(c){aC!=c&&(c?a3.enable(a3.DEPTH_TEST):a3.disable(a3.DEPTH_TEST),aC=c)}function a5(f,h,g){F!=f&&(f?a3.enable(a3.POLYGON_OFFSET_FILL):a3.disable(a3.POLYGON_OFFSET_FILL),F=f);if(f&&(aO!=h||ao!=g)){a3.polygonOffset(h,g),aO=h,ao=g}}function a2(e){aM[0].set(e.n41-e.n11,e.n42-e.n12,e.n43-e.n13,e.n44-e.n14);aM[1].set(e.n41+e.n11,e.n42+e.n12,e.n43+e.n13,e.n44+e.n14);aM[2].set(e.n41+e.n21,e.n42+e.n22,e.n43+e.n23,e.n44+e.n24);aM[3].set(e.n41-e.n21,e.n42-e.n22,e.n43-e.n23,e.n44-e.n24);aM[4].set(e.n41-e.n31,e.n42-e.n32,e.n43-e.n33,e.n44-e.n34);aM[5].set(e.n41+e.n31,e.n42+e.n32,e.n43+e.n33,e.n44+e.n34);for(var f,e=0;e<6;e++){f=aM[e],f.divideScalar(Math.sqrt(f.x*f.x+f.y*f.y+f.z*f.z))}}function a4(g){for(var k=g.matrixWorld,j=-g.geometry.boundingSphere.radius*Math.max(g.scale.x,Math.max(g.scale.y,g.scale.z)),h=0;h<6;h++){if(g=aM[h].x*k.n14+aM[h].y*k.n24+aM[h].z*k.n34+aM[h].w,g<=j){return !1}}return !0}function a0(e,f){e.list[e.count]=f;e.count+=1}function aV(j){var p,o,n=j.object,m=j.opaque,k=j.transparent;k.count=0;j=m.count=0;for(p=n.materials.length;j<p;j++){o=n.materials[j],o.transparent?a0(k,o):a0(m,o)}}function aU(y){var x,w,v,u,t=y.object,p=y.buffer,o=y.opaque,m=y.transparent;m.count=0;y=o.count=0;for(v=t.materials.length;y<v;y++){if(x=t.materials[y],x instanceof THREE.MeshFaceMaterial){x=0;for(w=p.materials.length;x<w;x++){(u=p.materials[x])&&(u.transparent?a0(m,u):a0(o,u))}}else{(u=x)&&(u.transparent?a0(m,u):a0(o,u))}}}function aW(e,f){return f.z-e.z}function aS(m,h){var g,C,D,e=0,B,o,n,f,j=m.lights;aL||(aL=new THREE.Camera(ay.shadowCameraFov,h.aspect,ay.shadowCameraNear,ay.shadowCameraFar));g=0;for(C=j.length;g<C;g++){if(D=j[g],D instanceof THREE.SpotLight&&D.castShadow){ay.shadowMap[e]||(ay.shadowMap[e]=new THREE.WebGLRenderTarget(ay.shadowMapWidth,ay.shadowMapHeight,{minFilter:THREE.LinearFilter,magFilter:THREE.LinearFilter,format:THREE.RGBAFormat}));ah[e]||(ah[e]=new THREE.Matrix4);B=ay.shadowMap[e];o=ah[e];aL.position.copy(D.position);aL.target.position.copy(D.target.position);aL.update(void 0,!0);m.update(void 0,!1,aL);o.set(0.5,0,0,0.5,0,0.5,0,0.5,0,0,0.5,0.5,0,0,0,1);o.multiplySelf(aL.projectionMatrix);o.multiplySelf(aL.matrixWorldInverse);aL.matrixWorldInverse.flattenToArray(Q);aL.projectionMatrix.flattenToArray(aQ);aD.multiply(aL.projectionMatrix,aL.matrixWorldInverse);a2(aD);ay.initWebGLObjects(m);ar(B);a3.clearColor(1,1,1,1);ay.clear();a3.clearColor(aI.r,aI.g,aI.b,aJ);o=m.__webglObjects.length;D=m.__webglObjectsImmediate.length;for(B=0;B<o;B++){n=m.__webglObjects[B],f=n.object,f.visible&&f.castShadow?!(f instanceof THREE.Mesh)||a4(f)?(f.matrixWorld.flattenToArray(f._objectMatrixArray),az(f,aL,!1),n.render=!0):n.render=!1:n.render=!1}a7(!0);aw(THREE.NormalBlending);for(B=0;B<o;B++){if(n=m.__webglObjects[B],n.render){f=n.object,buffer=n.buffer,a6(f),n=f.customDepthMaterial?f.customDepthMaterial:f.geometry.morphTargets.length?aE:aT,a9(aL,j,null,n,buffer,f)}}for(B=0;B<D;B++){n=m.__webglObjectsImmediate[B],f=n.object,f.visible&&f.castShadow&&(f.matrixAutoUpdate&&f.matrixWorld.flattenToArray(f._objectMatrixArray),az(f,aL,!1),a6(f),program=bb(aL,j,null,aT,f),f.render(function(c){a8(c,program,aT.shading)}))}e++}}}function aR(E,D){var C,B,A;C=an.attributes;var y=an.uniforms,x=O/ab,w,v=[],t=ab*0.5,G=O*0.5,n=!0;a3.useProgram(an.program);ae=an.program;aC=af=-1;am||(a3.enableVertexAttribArray(an.attributes.position),a3.enableVertexAttribArray(an.attributes.uv),am=!0);a3.disable(a3.CULL_FACE);a3.enable(a3.BLEND);a3.depthMask(!0);a3.bindBuffer(a3.ARRAY_BUFFER,an.vertexBuffer);a3.vertexAttribPointer(C.position,2,a3.FLOAT,!1,16,0);a3.vertexAttribPointer(C.uv,2,a3.FLOAT,!1,16,8);a3.bindBuffer(a3.ELEMENT_ARRAY_BUFFER,an.elementBuffer);a3.uniformMatrix4fv(y.projectionMatrix,!1,aQ);a3.activeTexture(a3.TEXTURE0);a3.uniform1i(y.map,0);C=0;for(B=E.__webglSprites.length;C<B;C++){A=E.__webglSprites[C],A.useScreenCoordinates?A.z=-A.position.z:(A._modelViewMatrix.multiplyToArray(D.matrixWorldInverse,A.matrixWorld,A._modelViewMatrixArray),A.z=-A._modelViewMatrix.n34)}E.__webglSprites.sort(aW);C=0;for(B=E.__webglSprites.length;C<B;C++){A=E.__webglSprites[C],A.material===void 0&&A.map&&A.map.image&&A.map.image.width&&(A.useScreenCoordinates?(a3.uniform1i(y.useScreenCoordinates,1),a3.uniform3f(y.screenPosition,(A.position.x-t)/t,(G-A.position.y)/G,Math.max(0,Math.min(1,A.position.z)))):(a3.uniform1i(y.useScreenCoordinates,0),a3.uniform1i(y.affectedByDistance,A.affectedByDistance?1:0),a3.uniformMatrix4fv(y.modelViewMatrix,!1,A._modelViewMatrixArray)),w=A.map.image.width/(A.scaleByViewport?O:1),v[0]=w*x*A.scale.x,v[1]=w*A.scale.y,a3.uniform2f(y.uvScale,A.uvScale.x,A.uvScale.y),a3.uniform2f(y.uvOffset,A.uvOffset.x,A.uvOffset.y),a3.uniform2f(y.alignment,A.alignment.x,A.alignment.y),a3.uniform1f(y.opacity,A.opacity),a3.uniform1f(y.rotation,A.rotation),a3.uniform2fv(y.scale,v),A.mergeWith3D&&!n?(a3.enable(a3.DEPTH_TEST),n=!0):!A.mergeWith3D&&n&&(a3.disable(a3.DEPTH_TEST),n=!1),aw(A.blending),ax(A.map,0),a3.drawElements(a3.TRIANGLES,6,a3.UNSIGNED_SHORT,0))}a3.enable(a3.CULL_FACE);a3.enable(a3.DEPTH_TEST);a3.depthMask(ap)}function az(f,h,g){f._modelViewMatrix.multiplyToArray(h.matrixWorldInverse,f.matrixWorld,f._modelViewMatrixArray);g&&THREE.Matrix4.makeInvert3x3(f._modelViewMatrix).transposeIntoArray(f._normalMatrixArray)}function aA(h){var n,m,k,j;j=h.__materials;h=0;for(m=j.length;h<m;h++){if(k=j[h],k.attributes){for(n in k.attributes){if(k.attributes[n].needsUpdate){return !0}}}}return !1}function au(h){var n,m,k,j;j=h.__materials;h=0;for(m=j.length;h<m;h++){if(k=j[h],k.attributes){for(n in k.attributes){k.attributes[n].needsUpdate=!1}}}}function aP(f,h){var g;for(g=f.length-1;g>=0;g--){f[g].object==h&&f.splice(g,1)}}function av(E){function D(c){var e=[];C=0;for(B=c.length;C<B;C++){c[C]==void 0?e.push("undefined"):e.push(c[C].id)}return e.join("_")}var C,B,A,y,x,w,t,v,p={},G=E.morphTargets!==void 0?E.morphTargets.length:0;E.geometryGroups={};A=0;for(y=E.faces.length;A<y;A++){x=E.faces[A],w=x.materials,t=D(w),p[t]==void 0&&(p[t]={hash:t,counter:0}),v=p[t].hash+"_"+p[t].counter,E.geometryGroups[v]==void 0&&(E.geometryGroups[v]={faces:[],materials:w,vertices:0,numMorphTargets:G}),x=x instanceof THREE.Face3?3:4,E.geometryGroups[v].vertices+x>65535&&(p[t].counter+=1,v=p[t].hash+"_"+p[t].counter,E.geometryGroups[v]==void 0&&(E.geometryGroups[v]={faces:[],materials:w,vertices:0,numMorphTargets:G})),E.geometryGroups[v].faces.push(A),E.geometryGroups[v].vertices+=x}}function at(f,h,g){f.push({buffer:h,object:g,opaque:{list:[],count:0},transparent:{list:[],count:0}})}function aw(c){if(c!=af){switch(c){case THREE.AdditiveBlending:a3.blendEquation(a3.FUNC_ADD);a3.blendFunc(a3.SRC_ALPHA,a3.ONE);break;case THREE.SubtractiveBlending:a3.blendEquation(a3.FUNC_ADD);a3.blendFunc(a3.ZERO,a3.ONE_MINUS_SRC_COLOR);break;case THREE.MultiplyBlending:a3.blendEquation(a3.FUNC_ADD);a3.blendFunc(a3.ZERO,a3.SRC_COLOR);break;default:a3.blendEquationSeparate(a3.FUNC_ADD,a3.FUNC_ADD),a3.blendFuncSeparate(a3.SRC_ALPHA,a3.ONE_MINUS_SRC_ALPHA,a3.ONE,a3.ONE_MINUS_SRC_ALPHA)}af=c}}function aq(f,h,g){(g.width&g.width-1)==0&&(g.height&g.height-1)==0?(a3.texParameteri(f,a3.TEXTURE_WRAP_S,aj(h.wrapS)),a3.texParameteri(f,a3.TEXTURE_WRAP_T,aj(h.wrapT)),a3.texParameteri(f,a3.TEXTURE_MAG_FILTER,aj(h.magFilter)),a3.texParameteri(f,a3.TEXTURE_MIN_FILTER,aj(h.minFilter)),a3.generateMipmap(f)):(a3.texParameteri(f,a3.TEXTURE_WRAP_S,a3.CLAMP_TO_EDGE),a3.texParameteri(f,a3.TEXTURE_WRAP_T,a3.CLAMP_TO_EDGE),a3.texParameteri(f,a3.TEXTURE_MAG_FILTER,ac(h.magFilter)),a3.texParameteri(f,a3.TEXTURE_MIN_FILTER,ac(h.minFilter)))}function ax(e,f){if(e.needsUpdate){if(!e.__webglInit){e.__webglTexture=a3.createTexture(),e.__webglInit=!0}a3.bindTexture(a3.TEXTURE_2D,e.__webglTexture);e.image.data?a3.texImage2D(a3.TEXTURE_2D,0,aj(e.format),e.image.width,e.image.height,0,aj(e.format),a3.UNSIGNED_BYTE,e.image.data):a3.texImage2D(a3.TEXTURE_2D,0,a3.RGBA,a3.RGBA,a3.UNSIGNED_BYTE,e.image);aq(a3.TEXTURE_2D,e,e.image);a3.bindTexture(a3.TEXTURE_2D,null);e.needsUpdate=!1}a3.activeTexture(a3.TEXTURE0+f);a3.bindTexture(a3.TEXTURE_2D,e.__webglTexture)}function ar(f){if(f&&!f.__webglFramebuffer){if(f.depthBuffer===void 0){f.depthBuffer=!0}if(f.stencilBuffer===void 0){f.stencilBuffer=!0}f.__webglFramebuffer=a3.createFramebuffer();f.__webglRenderbuffer=a3.createRenderbuffer();f.__webglTexture=a3.createTexture();a3.bindTexture(a3.TEXTURE_2D,f.__webglTexture);a3.texParameteri(a3.TEXTURE_2D,a3.TEXTURE_WRAP_S,aj(f.wrapS));a3.texParameteri(a3.TEXTURE_2D,a3.TEXTURE_WRAP_T,aj(f.wrapT));a3.texParameteri(a3.TEXTURE_2D,a3.TEXTURE_MAG_FILTER,aj(f.magFilter));a3.texParameteri(a3.TEXTURE_2D,a3.TEXTURE_MIN_FILTER,aj(f.minFilter));a3.texImage2D(a3.TEXTURE_2D,0,aj(f.format),f.width,f.height,0,aj(f.format),aj(f.type),null);a3.bindRenderbuffer(a3.RENDERBUFFER,f.__webglRenderbuffer);a3.bindFramebuffer(a3.FRAMEBUFFER,f.__webglFramebuffer);a3.framebufferTexture2D(a3.FRAMEBUFFER,a3.COLOR_ATTACHMENT0,a3.TEXTURE_2D,f.__webglTexture,0);f.depthBuffer&&!f.stencilBuffer?(a3.renderbufferStorage(a3.RENDERBUFFER,a3.DEPTH_COMPONENT16,f.width,f.height),a3.framebufferRenderbuffer(a3.FRAMEBUFFER,a3.DEPTH_ATTACHMENT,a3.RENDERBUFFER,f.__webglRenderbuffer)):f.depthBuffer&&f.stencilBuffer?(a3.renderbufferStorage(a3.RENDERBUFFER,a3.DEPTH_STENCIL,f.width,f.height),a3.framebufferRenderbuffer(a3.FRAMEBUFFER,a3.DEPTH_STENCIL_ATTACHMENT,a3.RENDERBUFFER,f.__webglRenderbuffer)):a3.renderbufferStorage(a3.RENDERBUFFER,a3.RGBA4,f.width,f.height);a3.bindTexture(a3.TEXTURE_2D,null);a3.bindRenderbuffer(a3.RENDERBUFFER,null);a3.bindFramebuffer(a3.FRAMEBUFFER,null)}var h,g;f?(h=f.__webglFramebuffer,g=f.width,f=f.height):(h=null,g=ab,f=O);h!=aN&&(a3.bindFramebuffer(a3.FRAMEBUFFER,h),a3.viewport(al,aB,g,f),aN=h)}function ai(f,h){var g;f=="fragment"?g=a3.createShader(a3.FRAGMENT_SHADER):f=="vertex"&&(g=a3.createShader(a3.VERTEX_SHADER));a3.shaderSource(g,h);a3.compileShader(g);if(!a3.getShaderParameter(g,a3.COMPILE_STATUS)){return console.error(a3.getShaderInfoLog(g)),console.error(h),null}return g}function ac(c){switch(c){case THREE.NearestFilter:case THREE.NearestMipMapNearestFilter:case THREE.NearestMipMapLinearFilter:return a3.NEAREST;default:return a3.LINEAR}}function aj(c){switch(c){case THREE.RepeatWrapping:return a3.REPEAT;case THREE.ClampToEdgeWrapping:return a3.CLAMP_TO_EDGE;case THREE.MirroredRepeatWrapping:return a3.MIRRORED_REPEAT;case THREE.NearestFilter:return a3.NEAREST;case THREE.NearestMipMapNearestFilter:return a3.NEAREST_MIPMAP_NEAREST;case THREE.NearestMipMapLinearFilter:return a3.NEAREST_MIPMAP_LINEAR;case THREE.LinearFilter:return a3.LINEAR;case THREE.LinearMipMapNearestFilter:return a3.LINEAR_MIPMAP_NEAREST;case THREE.LinearMipMapLinearFilter:return a3.LINEAR_MIPMAP_LINEAR;case THREE.ByteType:return a3.BYTE;case THREE.UnsignedByteType:return a3.UNSIGNED_BYTE;case THREE.ShortType:return a3.SHORT;case THREE.UnsignedShortType:return a3.UNSIGNED_SHORT;case THREE.IntType:return a3.INT;case THREE.UnsignedShortType:return a3.UNSIGNED_INT;case THREE.FloatType:return a3.FLOAT;case THREE.AlphaFormat:return a3.ALPHA;case THREE.RGBFormat:return a3.RGB;case THREE.RGBAFormat:return a3.RGBA;case THREE.LuminanceFormat:return a3.LUMINANCE;case THREE.LuminanceAlphaFormat:return a3.LUMINANCE_ALPHA}return 0}var ay=this,a3,ad=[],ae=null,aN=null,ap=!0,z=null,ag=null,af=null,aC=null,F=null,aO=null,ao=null,al=0,aB=0,ab=0,O=0,aM=[new THREE.Vector4,new THREE.Vector4,new THREE.Vector4,new THREE.Vector4,new THREE.Vector4,new THREE.Vector4],aD=new THREE.Matrix4,aQ=new Float32Array(16),Q=new Float32Array(16),aF=new THREE.Vector4,aG={ambient:[0,0,0],directional:{length:0,colors:[],positions:[]},point:{length:0,colors:[],positions:[],distances:[]}},bd=bd||{},aY=bd.canvas!==void 0?bd.canvas:document.createElement("canvas"),ak=bd.stencil!==void 0?bd.stencil:!0,a1=bd.preserveDrawingBuffer!==void 0?bd.preserveDrawingBuffer:!1,aK=bd.antialias!==void 0?bd.antialias:!1,aI=bd.clearColor!==void 0?new THREE.Color(bd.clearColor):new THREE.Color(0),aJ=bd.clearAlpha!==void 0?bd.clearAlpha:0;this.data={vertices:0,faces:0,drawCalls:0};this.maxMorphTargets=8;this.domElement=aY;this.sortObjects=this.autoClear=!0;this.shadowMapBias=0.0039;this.shadowMapDarkness=0.5;this.shadowMapHeight=this.shadowMapWidth=512;this.shadowCameraNear=1;this.shadowCameraFar=5000;this.shadowCameraFov=50;this.shadowMap=[];this.shadowMapEnabled=!1;this.shadowMapSoft=!0;var aL,ah=[],bd=THREE.ShaderLib.depthRGBA,aH=THREE.UniformsUtils.clone(bd.uniforms),aT=new THREE.MeshShaderMaterial({fragmentShader:bd.fragmentShader,vertexShader:bd.vertexShader,uniforms:aH}),aE=new THREE.MeshShaderMaterial({fragmentShader:bd.fragmentShader,vertexShader:bd.vertexShader,uniforms:aH,morphTargets:!0});aT._shadowPass=!0;aE._shadowPass=!0;try{if(!(a3=aY.getContext("experimental-webgl",{antialias:aK,stencil:ak,preserveDrawingBuffer:a1}))){throw"Error creating WebGL context."}console.log(navigator.userAgent+" | "+a3.getParameter(a3.VERSION)+" | "+a3.getParameter(a3.VENDOR)+" | "+a3.getParameter(a3.RENDERER)+" | "+a3.getParameter(a3.SHADING_LANGUAGE_VERSION))}catch(aZ){console.error(aZ)}a3.clearColor(0,0,0,1);a3.clearDepth(1);a3.enable(a3.DEPTH_TEST);a3.depthFunc(a3.LEQUAL);a3.frontFace(a3.CCW);a3.cullFace(a3.BACK);a3.enable(a3.CULL_FACE);a3.enable(a3.BLEND);a3.blendEquation(a3.FUNC_ADD);a3.blendFunc(a3.SRC_ALPHA,a3.ONE_MINUS_SRC_ALPHA);a3.clearColor(aI.r,aI.g,aI.b,aJ);this.context=a3;var aX=a3.getParameter(a3.MAX_VERTEX_TEXTURE_IMAGE_UNITS)>0,an={};an.vertices=new Float32Array(16);an.faces=new Uint16Array(6);i=0;an.vertices[i++]=-1;an.vertices[i++]=-1;an.vertices[i++]=0;an.vertices[i++]=1;an.vertices[i++]=1;an.vertices[i++]=-1;an.vertices[i++]=1;an.vertices[i++]=1;an.vertices[i++]=1;an.vertices[i++]=1;an.vertices[i++]=1;an.vertices[i++]=0;an.vertices[i++]=-1;an.vertices[i++]=1;an.vertices[i++]=0;i=an.vertices[i++]=0;an.faces[i++]=0;an.faces[i++]=1;an.faces[i++]=2;an.faces[i++]=0;an.faces[i++]=2;an.faces[i++]=3;an.vertexBuffer=a3.createBuffer();an.elementBuffer=a3.createBuffer();a3.bindBuffer(a3.ARRAY_BUFFER,an.vertexBuffer);a3.bufferData(a3.ARRAY_BUFFER,an.vertices,a3.STATIC_DRAW);a3.bindBuffer(a3.ELEMENT_ARRAY_BUFFER,an.elementBuffer);a3.bufferData(a3.ELEMENT_ARRAY_BUFFER,an.faces,a3.STATIC_DRAW);an.program=a3.createProgram();a3.attachShader(an.program,ai("fragment",THREE.ShaderLib.sprite.fragmentShader));a3.attachShader(an.program,ai("vertex",THREE.ShaderLib.sprite.vertexShader));a3.linkProgram(an.program);an.attributes={};an.uniforms={};an.attributes.position=a3.getAttribLocation(an.program,"position");an.attributes.uv=a3.getAttribLocation(an.program,"uv");an.uniforms.uvOffset=a3.getUniformLocation(an.program,"uvOffset");an.uniforms.uvScale=a3.getUniformLocation(an.program,"uvScale");an.uniforms.rotation=a3.getUniformLocation(an.program,"rotation");an.uniforms.scale=a3.getUniformLocation(an.program,"scale");an.uniforms.alignment=a3.getUniformLocation(an.program,"alignment");an.uniforms.map=a3.getUniformLocation(an.program,"map");an.uniforms.opacity=a3.getUniformLocation(an.program,"opacity");an.uniforms.useScreenCoordinates=a3.getUniformLocation(an.program,"useScreenCoordinates");an.uniforms.affectedByDistance=a3.getUniformLocation(an.program,"affectedByDistance");an.uniforms.screenPosition=a3.getUniformLocation(an.program,"screenPosition");an.uniforms.modelViewMatrix=a3.getUniformLocation(an.program,"modelViewMatrix");an.uniforms.projectionMatrix=a3.getUniformLocation(an.program,"projectionMatrix");var am=!1;this.setSize=function(e,f){aY.width=e;aY.height=f;this.setViewport(0,0,aY.width,aY.height)};this.setViewport=function(g,k,j,h){al=g;aB=k;ab=j;O=h;a3.viewport(al,aB,ab,O)};this.setScissor=function(g,k,j,h){a3.scissor(g,k,j,h)};this.enableScissorTest=function(c){c?a3.enable(a3.SCISSOR_TEST):a3.disable(a3.SCISSOR_TEST)};this.enableDepthBufferWrite=function(c){ap=c;a3.depthMask(c)};this.setClearColorHex=function(e,f){aI.setHex(e);aJ=f;a3.clearColor(aI.r,aI.g,aI.b,aJ)};this.setClearColor=function(e,f){aI.copy(e);aJ=f;a3.clearColor(aI.r,aI.g,aI.b,aJ)};this.clear=function(){a3.clear(a3.COLOR_BUFFER_BIT|a3.DEPTH_BUFFER_BIT|a3.STENCIL_BUFFER_BIT)};this.getContext=function(){return a3};this.initMaterial=function(I,H,G,E){var D,C,B;I instanceof THREE.MeshDepthMaterial?B="depth":I instanceof THREE.MeshNormalMaterial?B="normal":I instanceof THREE.MeshBasicMaterial?B="basic":I instanceof THREE.MeshLambertMaterial?B="lambert":I instanceof THREE.MeshPhongMaterial?B="phong":I instanceof THREE.LineBasicMaterial?B="basic":I instanceof THREE.ParticleBasicMaterial&&(B="particle_basic");if(B){var A=THREE.ShaderLib[B];I.uniforms=THREE.UniformsUtils.clone(A.uniforms);I.vertexShader=A.vertexShader;I.fragmentShader=A.fragmentShader}var y,x,L;y=L=A=0;for(x=H.length;y<x;y++){C=H[y],C instanceof THREE.SpotLight&&L++,C instanceof THREE.DirectionalLight&&L++,C instanceof THREE.PointLight&&A++}A+L<=4?y=L:(y=Math.ceil(4*L/(A+L)),A=4-y);C={directional:y,point:A};A=L=0;for(y=H.length;A<y;A++){x=H[A],x instanceof THREE.SpotLight&&x.castShadow&&L++}var M=50;if(E!==void 0&&E instanceof THREE.SkinnedMesh){M=E.bones.length}var n;a:{y=I.fragmentShader;x=I.vertexShader;var A=I.uniforms,H=I.attributes,G={map:!!I.map,envMap:!!I.envMap,lightMap:!!I.lightMap,vertexColors:I.vertexColors,fog:G,sizeAttenuation:I.sizeAttenuation,skinning:I.skinning,morphTargets:I.morphTargets,maxMorphTargets:this.maxMorphTargets,maxDirLights:C.directional,maxPointLights:C.point,maxBones:M,shadowMapEnabled:this.shadowMapEnabled&&E.receiveShadow,shadowMapSoft:this.shadowMapSoft,shadowMapWidth:this.shadowMapWidth,shadowMapHeight:this.shadowMapHeight,maxShadows:L,alphaTest:I.alphaTest},K,E=[];B?E.push(B):(E.push(y),E.push(x));for(K in G){E.push(K),E.push(G[K])}B=E.join();K=0;for(E=ad.length;K<E;K++){if(ad[K].code==B){n=ad[K].program;break a}}K=a3.createProgram();E=[aX?"#define VERTEX_TEXTURES":"","#define MAX_DIR_LIGHTS "+G.maxDirLights,"#define MAX_POINT_LIGHTS "+G.maxPointLights,"#define MAX_SHADOWS "+G.maxShadows,"#define MAX_BONES "+G.maxBones,G.map?"#define USE_MAP":"",G.envMap?"#define USE_ENVMAP":"",G.lightMap?"#define USE_LIGHTMAP":"",G.vertexColors?"#define USE_COLOR":"",G.skinning?"#define USE_SKINNING":"",G.morphTargets?"#define USE_MORPHTARGETS":"",G.shadowMapEnabled?"#define USE_SHADOWMAP":"",G.shadowMapSoft?"#define SHADOWMAP_SOFT":"",G.sizeAttenuation?"#define USE_SIZEATTENUATION":"","uniform mat4 objectMatrix;\nuniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\nuniform mat4 viewMatrix;\nuniform mat3 normalMatrix;\nuniform vec3 cameraPosition;\nuniform mat4 cameraInverseMatrix;\nattribute vec3 position;\nattribute vec3 normal;\nattribute vec2 uv;\nattribute vec2 uv2;\n#ifdef USE_COLOR\nattribute vec3 color;\n#endif\n#ifdef USE_MORPHTARGETS\nattribute vec3 morphTarget0;\nattribute vec3 morphTarget1;\nattribute vec3 morphTarget2;\nattribute vec3 morphTarget3;\nattribute vec3 morphTarget4;\nattribute vec3 morphTarget5;\nattribute vec3 morphTarget6;\nattribute vec3 morphTarget7;\n#endif\n#ifdef USE_SKINNING\nattribute vec4 skinVertexA;\nattribute vec4 skinVertexB;\nattribute vec4 skinIndex;\nattribute vec4 skinWeight;\n#endif\n"].join("\n");C=["#ifdef GL_ES\nprecision highp float;\n#endif","#define MAX_DIR_LIGHTS "+G.maxDirLights,"#define MAX_POINT_LIGHTS "+G.maxPointLights,"#define MAX_SHADOWS "+G.maxShadows,G.alphaTest?"#define ALPHATEST "+G.alphaTest:"",G.fog?"#define USE_FOG":"",G.fog instanceof THREE.FogExp2?"#define FOG_EXP2":"",G.map?"#define USE_MAP":"",G.envMap?"#define USE_ENVMAP":"",G.lightMap?"#define USE_LIGHTMAP":"",G.vertexColors?"#define USE_COLOR":"",G.shadowMapEnabled?"#define USE_SHADOWMAP":"",G.shadowMapSoft?"#define SHADOWMAP_SOFT":"",G.shadowMapSoft?"#define SHADOWMAP_WIDTH "+G.shadowMapWidth.toFixed(1):"",G.shadowMapSoft?"#define SHADOWMAP_HEIGHT "+G.shadowMapHeight.toFixed(1):"","uniform mat4 viewMatrix;\nuniform vec3 cameraPosition;\n"].join("\n");a3.attachShader(K,ai("fragment",C+y));a3.attachShader(K,ai("vertex",E+x));a3.linkProgram(K);a3.getProgramParameter(K,a3.LINK_STATUS)||console.error("Could not initialise shader\nVALIDATE_STATUS: "+a3.getProgramParameter(K,a3.VALIDATE_STATUS)+", gl error ["+a3.getError()+"]");K.uniforms={};K.attributes={};var J,E=["viewMatrix","modelViewMatrix","projectionMatrix","normalMatrix","objectMatrix","cameraPosition","cameraInverseMatrix","boneGlobalMatrices","morphTargetInfluences"];for(J in A){E.push(J)}J=E;E=0;for(A=J.length;E<A;E++){y=J[E],K.uniforms[y]=a3.getUniformLocation(K,y)}E=["position","normal","uv","uv2","tangent","color","skinVertexA","skinVertexB","skinIndex","skinWeight"];for(J=0;J<G.maxMorphTargets;J++){E.push("morphTarget"+J)}for(n in H){E.push(n)}n=E;J=0;for(H=n.length;J<H;J++){G=n[J],K.attributes[G]=a3.getAttribLocation(K,G)}ad.push({program:K,code:B});n=K}I.program=n;n=I.program.attributes;n.position>=0&&a3.enableVertexAttribArray(n.position);n.color>=0&&a3.enableVertexAttribArray(n.color);n.normal>=0&&a3.enableVertexAttribArray(n.normal);n.tangent>=0&&a3.enableVertexAttribArray(n.tangent);I.skinning&&n.skinVertexA>=0&&n.skinVertexB>=0&&n.skinIndex>=0&&n.skinWeight>=0&&(a3.enableVertexAttribArray(n.skinVertexA),a3.enableVertexAttribArray(n.skinVertexB),a3.enableVertexAttribArray(n.skinIndex),a3.enableVertexAttribArray(n.skinWeight));if(I.attributes){for(D in I.attributes){n[D]!==void 0&&n[D]>=0&&a3.enableVertexAttribArray(n[D])}}if(I.morphTargets){for(D=I.numSupportedMorphTargets=0;D<this.maxMorphTargets;D++){J="morphTarget"+D,n[J]>=0&&(a3.enableVertexAttribArray(n[J]),I.numSupportedMorphTargets++)}}};this.render=function(u,n,f,g){var t,x,w,v,e,m,o,j,k=u.lights,h=u.fog;this.shadowMapEnabled&&aS(u,n);ay.data.vertices=0;ay.data.faces=0;ay.data.drawCalls=0;n.matrixAutoUpdate&&n.update(void 0,!0);u.update(void 0,!1,n);n.matrixWorldInverse.flattenToArray(Q);n.projectionMatrix.flattenToArray(aQ);aD.multiply(n.projectionMatrix,n.matrixWorldInverse);a2(aD);this.initWebGLObjects(u);ar(f);(this.autoClear||g)&&this.clear();e=u.__webglObjects.length;for(g=0;g<e;g++){if(t=u.__webglObjects[g],o=t.object,o.visible){if(!(o instanceof THREE.Mesh)||a4(o)){if(o.matrixWorld.flattenToArray(o._objectMatrixArray),az(o,n,!0),aU(t),t.render=!0,this.sortObjects){t.object.renderDepth?t.z=t.object.renderDepth:(aF.copy(o.position),aD.multiplyVector3(aF),t.z=aF.z)}}else{t.render=!1}}else{t.render=!1}}this.sortObjects&&u.__webglObjects.sort(aW);m=u.__webglObjectsImmediate.length;for(g=0;g<m;g++){t=u.__webglObjectsImmediate[g],o=t.object,o.visible&&(o.matrixAutoUpdate&&o.matrixWorld.flattenToArray(o._objectMatrixArray),az(o,n,!0),aV(t))}if(u.overrideMaterial){a7(u.overrideMaterial.depthTest);aw(u.overrideMaterial.blending);for(g=0;g<e;g++){if(t=u.__webglObjects[g],t.render){o=t.object,j=t.buffer,a6(o),a9(n,k,h,u.overrideMaterial,j,o)}}for(g=0;g<m;g++){t=u.__webglObjectsImmediate[g],o=t.object,o.visible&&(a6(o),x=bb(n,k,h,u.overrideMaterial,o),o.render(function(b){a8(b,x,u.overrideMaterial.shading)}))}}else{aw(THREE.NormalBlending);for(g=e-1;g>=0;g--){if(t=u.__webglObjects[g],t.render){o=t.object;j=t.buffer;w=t.opaque;a6(o);for(t=0;t<w.count;t++){v=w.list[t],a7(v.depthTest),a5(v.polygonOffset,v.polygonOffsetFactor,v.polygonOffsetUnits),a9(n,k,h,v,j,o)}}}for(g=0;g<m;g++){if(t=u.__webglObjectsImmediate[g],o=t.object,o.visible){w=t.opaque;a6(o);for(t=0;t<w.count;t++){v=w.list[t],a7(v.depthTest),a5(v.polygonOffset,v.polygonOffsetFactor,v.polygonOffsetUnits),x=bb(n,k,h,v,o),o.render(function(c){a8(c,x,v.shading)})}}}for(g=0;g<e;g++){if(t=u.__webglObjects[g],t.render){o=t.object;j=t.buffer;w=t.transparent;a6(o);for(t=0;t<w.count;t++){v=w.list[t],aw(v.blending),a7(v.depthTest),a5(v.polygonOffset,v.polygonOffsetFactor,v.polygonOffsetUnits),a9(n,k,h,v,j,o)}}}for(g=0;g<m;g++){if(t=u.__webglObjectsImmediate[g],o=t.object,o.visible){w=t.transparent;a6(o);for(t=0;t<w.count;t++){v=w.list[t],aw(v.blending),a7(v.depthTest),a5(v.polygonOffset,v.polygonOffsetFactor,v.polygonOffsetUnits),x=bb(n,k,h,v,o),o.render(function(c){a8(c,x,v.shading)})}}}}u.__webglSprites.length&&aR(u,n);f&&f.minFilter!==THREE.NearestFilter&&f.minFilter!==THREE.LinearFilter&&(a3.bindTexture(a3.TEXTURE_2D,f.__webglTexture),a3.generateMipmap(a3.TEXTURE_2D),a3.bindTexture(a3.TEXTURE_2D,null))};this.initWebGLObjects=function(bH){if(!bH.__webglObjects){bH.__webglObjects=[],bH.__webglObjectsImmediate=[],bH.__webglSprites=[]}for(;bH.__objectsAdded.length;){var bE=bH.__objectsAdded[0],bD=bH,bC=void 0,bA=void 0,by=void 0;if(bE._modelViewMatrix==void 0){bE._modelViewMatrix=new THREE.Matrix4,bE._normalMatrixArray=new Float32Array(9),bE._modelViewMatrixArray=new Float32Array(16),bE._objectMatrixArray=new Float32Array(16),bE.matrixWorld.flattenToArray(bE._objectMatrixArray)}if(bE instanceof THREE.Mesh){for(bC in bA=bE.geometry,bA.geometryGroups==void 0&&av(bA),bA.geometryGroups){by=bA.geometryGroups[bC];if(!by.__webglVertexBuffer){var bx=by;bx.__webglVertexBuffer=a3.createBuffer();bx.__webglNormalBuffer=a3.createBuffer();bx.__webglTangentBuffer=a3.createBuffer();bx.__webglColorBuffer=a3.createBuffer();bx.__webglUVBuffer=a3.createBuffer();bx.__webglUV2Buffer=a3.createBuffer();bx.__webglSkinVertexABuffer=a3.createBuffer();bx.__webglSkinVertexBBuffer=a3.createBuffer();bx.__webglSkinIndicesBuffer=a3.createBuffer();bx.__webglSkinWeightsBuffer=a3.createBuffer();bx.__webglFaceBuffer=a3.createBuffer();bx.__webglLineBuffer=a3.createBuffer();if(bx.numMorphTargets){var bw=void 0,bt=void 0;bx.__webglMorphTargetsBuffers=[];bw=0;for(bt=bx.numMorphTargets;bw<bt;bw++){bx.__webglMorphTargetsBuffers.push(a3.createBuffer())}}for(var bx=by,bw=bE,bq=void 0,bs=void 0,br=void 0,bp=br=void 0,bo=void 0,bn=void 0,b8=bn=bt=0,b5=br=bs=void 0,bf=b5=bs=bq=void 0,br=void 0,bp=bw.geometry,bo=bp.faces,b5=bx.faces,bq=0,bs=b5.length;bq<bs;bq++){br=b5[bq],br=bo[br],br instanceof THREE.Face3?(bt+=3,bn+=1,b8+=3):br instanceof THREE.Face4&&(bt+=4,bn+=2,b8+=4)}for(var bq=bx,bs=bw,b4=b5=bo=void 0,b1=void 0,b4=void 0,br=[],bo=0,b5=bs.materials.length;bo<b5;bo++){if(b4=bs.materials[bo],b4 instanceof THREE.MeshFaceMaterial){b4=0;for(l=bq.materials.length;b4<l;b4++){(b1=bq.materials[b4])&&br.push(b1)}}else{(b1=b4)&&br.push(b1)}}bq=br;bx.__materials=bq;a:{bo=bs=void 0;b5=bq.length;for(bs=0;bs<b5;bs++){if(bo=bq[bs],bo.map||bo.lightMap||bo instanceof THREE.MeshShaderMaterial){bs=!0;break a}}bs=!1}a:{b5=bo=void 0;br=bq.length;for(bo=0;bo<br;bo++){if(b5=bq[bo],!(b5 instanceof THREE.MeshBasicMaterial&&!b5.envMap||b5 instanceof THREE.MeshDepthMaterial)){b5=b5&&b5.shading!=void 0&&b5.shading==THREE.SmoothShading?THREE.SmoothShading:THREE.FlatShading;break a}}b5=!1}a:{br=bo=void 0;b4=bq.length;for(bo=0;bo<b4;bo++){if(br=bq[bo],br.vertexColors){br=br.vertexColors;break a}}br=!1}bx.__vertexArray=new Float32Array(bt*3);if(b5){bx.__normalArray=new Float32Array(bt*3)}if(bp.hasTangents){bx.__tangentArray=new Float32Array(bt*4)}if(br){bx.__colorArray=new Float32Array(bt*3)}if(bs){if(bp.faceUvs.length>0||bp.faceVertexUvs.length>0){bx.__uvArray=new Float32Array(bt*2)}if(bp.faceUvs.length>1||bp.faceVertexUvs.length>1){bx.__uv2Array=new Float32Array(bt*2)}}if(bw.geometry.skinWeights.length&&bw.geometry.skinIndices.length){bx.__skinVertexAArray=new Float32Array(bt*4),bx.__skinVertexBArray=new Float32Array(bt*4),bx.__skinIndexArray=new Float32Array(bt*4),bx.__skinWeightArray=new Float32Array(bt*4)}bx.__faceArray=new Uint16Array(bn*3+(bw.geometry.edgeFaces?bw.geometry.edgeFaces.length*6:0));bx.__lineArray=new Uint16Array(b8*2);if(bx.numMorphTargets){bx.__morphTargetsArrays=[];bp=0;for(bo=bx.numMorphTargets;bp<bo;bp++){bx.__morphTargetsArrays.push(new Float32Array(bt*3))}}bx.__needsSmoothNormals=b5==THREE.SmoothShading;bx.__uvType=bs;bx.__vertexColorType=br;bx.__normalType=b5;bx.__webglFaceCount=bn*3+(bw.geometry.edgeFaces?bw.geometry.edgeFaces.length*6:0);bx.__webglLineCount=b8*2;bp=0;for(bo=bq.length;bp<bo;bp++){if(bs=bq[bp],bs.attributes){if(bx.__webglCustomAttributes===void 0){bx.__webglCustomAttributes={}}for(a in bs.attributes){br=bs.attributes[a];b5={};for(bf in br){b5[bf]=br[bf]}if(!b5.__webglInitialized||b5.createUniqueBuffers){b5.__webglInitialized=!0,bn=1,b5.type==="v2"?bn=2:b5.type==="v3"?bn=3:b5.type==="v4"?bn=4:b5.type==="c"&&(bn=3),b5.size=bn,b5.array=new Float32Array(bt*bn),b5.buffer=a3.createBuffer(),b5.buffer.belongsToAttribute=a,br.needsUpdate=!0,b5.__original=br}bx.__webglCustomAttributes[a]=b5}}}bx.__inittedArrays=!0;bA.__dirtyVertices=!0;bA.__dirtyMorphTargets=!0;bA.__dirtyElements=!0;bA.__dirtyUvs=!0;bA.__dirtyNormals=!0;bA.__dirtyTangents=!0;bA.__dirtyColors=!0}at(bD.__webglObjects,by,bE)}}else{if(bE instanceof THREE.Ribbon){bA=bE.geometry;if(!bA.__webglVertexBuffer){bC=bA,bC.__webglVertexBuffer=a3.createBuffer(),bC.__webglColorBuffer=a3.createBuffer(),bC=bA,by=bC.vertices.length,bC.__vertexArray=new Float32Array(by*3),bC.__colorArray=new Float32Array(by*3),bC.__webglVertexCount=by,bA.__dirtyVertices=!0,bA.__dirtyColors=!0}at(bD.__webglObjects,bA,bE)}else{if(bE instanceof THREE.Line){bA=bE.geometry;if(!bA.__webglVertexBuffer){bC=bA,bC.__webglVertexBuffer=a3.createBuffer(),bC.__webglColorBuffer=a3.createBuffer(),bC=bA,by=bC.vertices.length,bC.__vertexArray=new Float32Array(by*3),bC.__colorArray=new Float32Array(by*3),bC.__webglLineCount=by,bA.__dirtyVertices=!0,bA.__dirtyColors=!0}at(bD.__webglObjects,bA,bE)}else{if(bE instanceof THREE.ParticleSystem){bA=bE.geometry;if(!bA.__webglVertexBuffer){bC=bA;bC.__webglVertexBuffer=a3.createBuffer();bC.__webglColorBuffer=a3.createBuffer();bC=bA;by=bE;bx=bC.vertices.length;bC.__vertexArray=new Float32Array(bx*3);bC.__colorArray=new Float32Array(bx*3);bC.__sortArray=[];bC.__webglParticleCount=bx;bC.__materials=by.materials;bf=bt=bw=void 0;bw=0;for(bt=by.materials.length;bw<bt;bw++){if(bf=by.materials[bw],bf.attributes){if(bC.__webglCustomAttributes===void 0){bC.__webglCustomAttributes={}}for(a in bf.attributes){originalAttribute=bf.attributes[a];attribute={};for(property in originalAttribute){attribute[property]=originalAttribute[property]}if(!attribute.__webglInitialized||attribute.createUniqueBuffers){attribute.__webglInitialized=!0,size=1,attribute.type==="v2"?size=2:attribute.type==="v3"?size=3:attribute.type==="v4"?size=4:attribute.type==="c"&&(size=3),attribute.size=size,attribute.array=new Float32Array(bx*size),attribute.buffer=a3.createBuffer(),attribute.buffer.belongsToAttribute=a,originalAttribute.needsUpdate=!0,attribute.__original=originalAttribute}bC.__webglCustomAttributes[a]=attribute}}}bA.__dirtyVertices=!0;bA.__dirtyColors=!0}at(bD.__webglObjects,bA,bE)}else{THREE.MarchingCubes!==void 0&&bE instanceof THREE.MarchingCubes?bD.__webglObjectsImmediate.push({object:bE,opaque:{list:[],count:0},transparent:{list:[],count:0}}):bE instanceof THREE.Sprite&&bD.__webglSprites.push(bE)}}}}bH.__objectsAdded.splice(0,1)}for(;bH.__objectsRemoved.length;){bD=bH.__objectsRemoved[0];bE=bH;if(bD instanceof THREE.Mesh||bD instanceof THREE.ParticleSystem||bD instanceof THREE.Ribbon||bD instanceof THREE.Line){aP(bE.__webglObjects,bD)}else{if(bD instanceof THREE.Sprite){bE=bE.__webglSprites;bA=void 0;for(bA=bE.length-1;bA>=0;bA--){bE[bA]==bD&&bE.splice(bA,1)}}else{bD instanceof THREE.MarchingCubes&&aP(bE.__webglObjectsImmediate,bD)}}bH.__objectsRemoved.splice(0,1)}bE=0;for(bD=bH.__webglObjects.length;bE<bD;bE++){if(bC=bH.__webglObjects[bE].object,bw=bx=bA=by=void 0,bC instanceof THREE.Mesh){bA=bC.geometry;for(by in bA.geometryGroups){if(bx=bA.geometryGroups[by],bw=aA(bx),bA.__dirtyVertices||bA.__dirtyMorphTargets||bA.__dirtyElements||bA.__dirtyUvs||bA.__dirtyNormals||bA.__dirtyColors||bA.__dirtyTangents||bw){if(bw=bx,bt=a3.DYNAMIC_DRAW,bf=!bA.dynamic,bw.__inittedArrays){var b0=b8=bn=void 0,b7=void 0,cl=b0=void 0,bZ=void 0,bX=void 0,bY=void 0,bV=b1=b4=br=b5=bo=bs=bq=bp=void 0,b3=b7=bY=b7=bX=bZ=void 0,bl=void 0,bT=bl=b3=bZ=void 0,bR=void 0,bS=bT=bl=b3=b0=b0=cl=bY=b7=bT=bl=b3=bR=bT=bl=b3=bR=bT=bl=b3=void 0,A=0,bP=0,bh=0,bM=0,bN=0,b2=0,bQ=0,ce=0,bO=0,bW=0,bL=0,bT=b3=0,bT=void 0,bz=bw.__vertexArray,y=bw.__uvArray,ck=bw.__uv2Array,be=bw.__normalArray,bK=bw.__tangentArray,ci=bw.__colorArray,bv=bw.__skinVertexAArray,ch=bw.__skinVertexBArray,H=bw.__skinIndexArray,cn=bw.__skinWeightArray,b9=bw.__morphTargetsArrays,bI=bw.__webglCustomAttributes,bl=void 0,bF=bw.__faceArray,cf=bw.__lineArray,bj=bw.__needsSmoothNormals,bq=bw.__vertexColorType,bp=bw.__uvType,bs=bw.__normalType,c=bC.geometry,cj=c.__dirtyVertices,b6=c.__dirtyElements,cc=c.__dirtyUvs,bG=c.__dirtyNormals,bi=c.__dirtyTangents,bB=c.__dirtyColors,bg=c.__dirtyMorphTargets,bJ=c.vertices,cm=bw.faces,bu=c.faces,cd=c.faceVertexUvs[0],bU=c.faceVertexUvs[1],bk=c.skinVerticesA,I=c.skinVerticesB,n=c.skinIndices,cg=c.skinWeights,G=c.morphTargets;if(bI){for(bS in bI){bI[bS].offset=0,bI[bS].offsetSrc=0}}bn=0;for(b8=cm.length;bn<b8;bn++){if(b0=cm[bn],b7=bu[b0],cd&&(bo=cd[b0]),bU&&(b5=bU[b0]),b0=b7.vertexNormals,cl=b7.normal,bZ=b7.vertexColors,bX=b7.color,bY=b7.vertexTangents,b7 instanceof THREE.Face3){if(cj){br=bJ[b7.a].position,b4=bJ[b7.b].position,b1=bJ[b7.c].position,bz[bP]=br.x,bz[bP+1]=br.y,bz[bP+2]=br.z,bz[bP+3]=b4.x,bz[bP+4]=b4.y,bz[bP+5]=b4.z,bz[bP+6]=b1.x,bz[bP+7]=b1.y,bz[bP+8]=b1.z,bP+=9}if(bI){for(bS in bI){if(bl=bI[bS],bl.__original.needsUpdate){b3=bl.offset,bT=bl.offsetSrc,bl.size===1?(bl.boundTo===void 0||bl.boundTo==="vertices"?(bl.array[b3]=bl.value[b7.a],bl.array[b3+1]=bl.value[b7.b],bl.array[b3+2]=bl.value[b7.c]):bl.boundTo==="faces"?(bT=bl.value[bT],bl.array[b3]=bT,bl.array[b3+1]=bT,bl.array[b3+2]=bT,bl.offsetSrc++):bl.boundTo==="faceVertices"&&(bl.array[b3]=bl.value[bT],bl.array[b3+1]=bl.value[bT+1],bl.array[b3+2]=bl.value[bT+2],bl.offsetSrc+=3),bl.offset+=3):(bl.boundTo===void 0||bl.boundTo==="vertices"?(br=bl.value[b7.a],b4=bl.value[b7.b],b1=bl.value[b7.c]):bl.boundTo==="faces"?(b1=b4=br=bT=bl.value[bT],bl.offsetSrc++):bl.boundTo==="faceVertices"&&(br=bl.value[bT],b4=bl.value[bT+1],b1=bl.value[bT+2],bl.offsetSrc+=3),bl.size===2?(bl.array[b3]=br.x,bl.array[b3+1]=br.y,bl.array[b3+2]=b4.x,bl.array[b3+3]=b4.y,bl.array[b3+4]=b1.x,bl.array[b3+5]=b1.y,bl.offset+=6):bl.size===3?(bl.type==="c"?(bl.array[b3]=br.r,bl.array[b3+1]=br.g,bl.array[b3+2]=br.b,bl.array[b3+3]=b4.r,bl.array[b3+4]=b4.g,bl.array[b3+5]=b4.b,bl.array[b3+6]=b1.r,bl.array[b3+7]=b1.g,bl.array[b3+8]=b1.b):(bl.array[b3]=br.x,bl.array[b3+1]=br.y,bl.array[b3+2]=br.z,bl.array[b3+3]=b4.x,bl.array[b3+4]=b4.y,bl.array[b3+5]=b4.z,bl.array[b3+6]=b1.x,bl.array[b3+7]=b1.y,bl.array[b3+8]=b1.z),bl.offset+=9):(bl.array[b3]=br.x,bl.array[b3+1]=br.y,bl.array[b3+2]=br.z,bl.array[b3+3]=br.w,bl.array[b3+4]=b4.x,bl.array[b3+5]=b4.y,bl.array[b3+6]=b4.z,bl.array[b3+7]=b4.w,bl.array[b3+8]=b1.x,bl.array[b3+9]=b1.y,bl.array[b3+10]=b1.z,bl.array[b3+11]=b1.w,bl.offset+=12))}}}if(bg){b3=0;for(bl=G.length;b3<bl;b3++){br=G[b3].vertices[b7.a].position,b4=G[b3].vertices[b7.b].position,b1=G[b3].vertices[b7.c].position,bT=b9[b3],bT[bL]=br.x,bT[bL+1]=br.y,bT[bL+2]=br.z,bT[bL+3]=b4.x,bT[bL+4]=b4.y,bT[bL+5]=b4.z,bT[bL+6]=b1.x,bT[bL+7]=b1.y,bT[bL+8]=b1.z}bL+=9}if(cg.length){b3=cg[b7.a],bl=cg[b7.b],bT=cg[b7.c],cn[bW]=b3.x,cn[bW+1]=b3.y,cn[bW+2]=b3.z,cn[bW+3]=b3.w,cn[bW+4]=bl.x,cn[bW+5]=bl.y,cn[bW+6]=bl.z,cn[bW+7]=bl.w,cn[bW+8]=bT.x,cn[bW+9]=bT.y,cn[bW+10]=bT.z,cn[bW+11]=bT.w,b3=n[b7.a],bl=n[b7.b],bT=n[b7.c],H[bW]=b3.x,H[bW+1]=b3.y,H[bW+2]=b3.z,H[bW+3]=b3.w,H[bW+4]=bl.x,H[bW+5]=bl.y,H[bW+6]=bl.z,H[bW+7]=bl.w,H[bW+8]=bT.x,H[bW+9]=bT.y,H[bW+10]=bT.z,H[bW+11]=bT.w,b3=bk[b7.a],bl=bk[b7.b],bT=bk[b7.c],bv[bW]=b3.x,bv[bW+1]=b3.y,bv[bW+2]=b3.z,bv[bW+3]=1,bv[bW+4]=bl.x,bv[bW+5]=bl.y,bv[bW+6]=bl.z,bv[bW+7]=1,bv[bW+8]=bT.x,bv[bW+9]=bT.y,bv[bW+10]=bT.z,bv[bW+11]=1,b3=I[b7.a],bl=I[b7.b],bT=I[b7.c],ch[bW]=b3.x,ch[bW+1]=b3.y,ch[bW+2]=b3.z,ch[bW+3]=1,ch[bW+4]=bl.x,ch[bW+5]=bl.y,ch[bW+6]=bl.z,ch[bW+7]=1,ch[bW+8]=bT.x,ch[bW+9]=bT.y,ch[bW+10]=bT.z,ch[bW+11]=1,bW+=12}if(bB&&bq){bZ.length==3&&bq==THREE.VertexColors?(b7=bZ[0],b3=bZ[1],bl=bZ[2]):bl=b3=b7=bX,ci[bO]=b7.r,ci[bO+1]=b7.g,ci[bO+2]=b7.b,ci[bO+3]=b3.r,ci[bO+4]=b3.g,ci[bO+5]=b3.b,ci[bO+6]=bl.r,ci[bO+7]=bl.g,ci[bO+8]=bl.b,bO+=9}if(bi&&c.hasTangents){bZ=bY[0],bX=bY[1],b7=bY[2],bK[bQ]=bZ.x,bK[bQ+1]=bZ.y,bK[bQ+2]=bZ.z,bK[bQ+3]=bZ.w,bK[bQ+4]=bX.x,bK[bQ+5]=bX.y,bK[bQ+6]=bX.z,bK[bQ+7]=bX.w,bK[bQ+8]=b7.x,bK[bQ+9]=b7.y,bK[bQ+10]=b7.z,bK[bQ+11]=b7.w,bQ+=12}if(bG&&bs){if(b0.length==3&&bj){for(bY=0;bY<3;bY++){cl=b0[bY],be[b2]=cl.x,be[b2+1]=cl.y,be[b2+2]=cl.z,b2+=3}}else{for(bY=0;bY<3;bY++){be[b2]=cl.x,be[b2+1]=cl.y,be[b2+2]=cl.z,b2+=3}}}if(cc&&bo!==void 0&&bp){for(bY=0;bY<3;bY++){b0=bo[bY],y[bh]=b0.u,y[bh+1]=b0.v,bh+=2}}if(cc&&b5!==void 0&&bp){for(bY=0;bY<3;bY++){b0=b5[bY],ck[bM]=b0.u,ck[bM+1]=b0.v,bM+=2}}b6&&(bF[bN]=A,bF[bN+1]=A+1,bF[bN+2]=A+2,bN+=3,cf[ce]=A,cf[ce+1]=A+1,cf[ce+2]=A,cf[ce+3]=A+2,cf[ce+4]=A+1,cf[ce+5]=A+2,ce+=6,A+=3)}else{if(b7 instanceof THREE.Face4){if(cj){br=bJ[b7.a].position,b4=bJ[b7.b].position,b1=bJ[b7.c].position,bV=bJ[b7.d].position,bz[bP]=br.x,bz[bP+1]=br.y,bz[bP+2]=br.z,bz[bP+3]=b4.x,bz[bP+4]=b4.y,bz[bP+5]=b4.z,bz[bP+6]=b1.x,bz[bP+7]=b1.y,bz[bP+8]=b1.z,bz[bP+9]=bV.x,bz[bP+10]=bV.y,bz[bP+11]=bV.z,bP+=12}if(bI){for(bS in bI){if(bl=bI[bS],bl.__original.needsUpdate){b3=bl.offset,bT=bl.offsetSrc,bl.size===1?(bl.boundTo===void 0||bl.boundTo==="vertices"?(bl.array[b3]=bl.value[b7.a],bl.array[b3+1]=bl.value[b7.b],bl.array[b3+2]=bl.value[b7.c],bl.array[b3+3]=bl.value[b7.d]):bl.boundTo==="faces"?(bT=bl.value[bT],bl.array[b3]=bT,bl.array[b3+1]=bT,bl.array[b3+2]=bT,bl.array[b3+3]=bT,bl.offsetSrc++):bl.boundTo==="faceVertices"&&(bl.array[b3]=bl.value[bT],bl.array[b3+1]=bl.value[bT+1],bl.array[b3+2]=bl.value[bT+2],bl.array[b3+3]=bl.value[bT+3],bl.offsetSrc+=4),bl.offset+=4):(bl.boundTo===void 0||bl.boundTo==="vertices"?(br=bl.value[b7.a],b4=bl.value[b7.b],b1=bl.value[b7.c],bV=bl.value[b7.d]):bl.boundTo==="faces"?(bV=b1=b4=br=bT=bl.value[bT],bl.offsetSrc++):bl.boundTo==="faceVertices"&&(br=bl.value[bT],b4=bl.value[bT+1],b1=bl.value[bT+2],bV=bl.value[bT+3],bl.offsetSrc+=4),bl.size===2?(bl.array[b3]=br.x,bl.array[b3+1]=br.y,bl.array[b3+2]=b4.x,bl.array[b3+3]=b4.y,bl.array[b3+4]=b1.x,bl.array[b3+5]=b1.y,bl.array[b3+6]=bV.x,bl.array[b3+7]=bV.y,bl.offset+=8):bl.size===3?(bl.type==="c"?(bl.array[b3]=br.r,bl.array[b3+1]=br.g,bl.array[b3+2]=br.b,bl.array[b3+3]=b4.r,bl.array[b3+4]=b4.g,bl.array[b3+5]=b4.b,bl.array[b3+6]=b1.r,bl.array[b3+7]=b1.g,bl.array[b3+8]=b1.b,bl.array[b3+9]=bV.r,bl.array[b3+10]=bV.g,bl.array[b3+11]=bV.b):(bl.array[b3]=br.x,bl.array[b3+1]=br.y,bl.array[b3+2]=br.z,bl.array[b3+3]=b4.x,bl.array[b3+4]=b4.y,bl.array[b3+5]=b4.z,bl.array[b3+6]=b1.x,bl.array[b3+7]=b1.y,bl.array[b3+8]=b1.z,bl.array[b3+9]=bV.x,bl.array[b3+10]=bV.y,bl.array[b3+11]=bV.z),bl.offset+=12):(bl.array[b3]=br.x,bl.array[b3+1]=br.y,bl.array[b3+2]=br.z,bl.array[b3+3]=br.w,bl.array[b3+4]=b4.x,bl.array[b3+5]=b4.y,bl.array[b3+6]=b4.z,bl.array[b3+7]=b4.w,bl.array[b3+8]=b1.x,bl.array[b3+9]=b1.y,bl.array[b3+10]=b1.z,bl.array[b3+11]=b1.w,bl.array[b3+12]=bV.x,bl.array[b3+13]=bV.y,bl.array[b3+14]=bV.z,bl.array[b3+15]=bV.w,bl.offset+=16))}}}if(bg){b3=0;for(bl=G.length;b3<bl;b3++){br=G[b3].vertices[b7.a].position,b4=G[b3].vertices[b7.b].position,b1=G[b3].vertices[b7.c].position,bV=G[b3].vertices[b7.d].position,bT=b9[b3],bT[bL]=br.x,bT[bL+1]=br.y,bT[bL+2]=br.z,bT[bL+3]=b4.x,bT[bL+4]=b4.y,bT[bL+5]=b4.z,bT[bL+6]=b1.x,bT[bL+7]=b1.y,bT[bL+8]=b1.z,bT[bL+9]=bV.x,bT[bL+10]=bV.y,bT[bL+11]=bV.z}bL+=12}if(cg.length){b3=cg[b7.a],bl=cg[b7.b],bT=cg[b7.c],bR=cg[b7.d],cn[bW]=b3.x,cn[bW+1]=b3.y,cn[bW+2]=b3.z,cn[bW+3]=b3.w,cn[bW+4]=bl.x,cn[bW+5]=bl.y,cn[bW+6]=bl.z,cn[bW+7]=bl.w,cn[bW+8]=bT.x,cn[bW+9]=bT.y,cn[bW+10]=bT.z,cn[bW+11]=bT.w,cn[bW+12]=bR.x,cn[bW+13]=bR.y,cn[bW+14]=bR.z,cn[bW+15]=bR.w,b3=n[b7.a],bl=n[b7.b],bT=n[b7.c],bR=n[b7.d],H[bW]=b3.x,H[bW+1]=b3.y,H[bW+2]=b3.z,H[bW+3]=b3.w,H[bW+4]=bl.x,H[bW+5]=bl.y,H[bW+6]=bl.z,H[bW+7]=bl.w,H[bW+8]=bT.x,H[bW+9]=bT.y,H[bW+10]=bT.z,H[bW+11]=bT.w,H[bW+12]=bR.x,H[bW+13]=bR.y,H[bW+14]=bR.z,H[bW+15]=bR.w,b3=bk[b7.a],bl=bk[b7.b],bT=bk[b7.c],bR=bk[b7.d],bv[bW]=b3.x,bv[bW+1]=b3.y,bv[bW+2]=b3.z,bv[bW+3]=1,bv[bW+4]=bl.x,bv[bW+5]=bl.y,bv[bW+6]=bl.z,bv[bW+7]=1,bv[bW+8]=bT.x,bv[bW+9]=bT.y,bv[bW+10]=bT.z,bv[bW+11]=1,bv[bW+12]=bR.x,bv[bW+13]=bR.y,bv[bW+14]=bR.z,bv[bW+15]=1,b3=I[b7.a],bl=I[b7.b],bT=I[b7.c],b7=I[b7.d],ch[bW]=b3.x,ch[bW+1]=b3.y,ch[bW+2]=b3.z,ch[bW+3]=1,ch[bW+4]=bl.x,ch[bW+5]=bl.y,ch[bW+6]=bl.z,ch[bW+7]=1,ch[bW+8]=bT.x,ch[bW+9]=bT.y,ch[bW+10]=bT.z,ch[bW+11]=1,ch[bW+12]=b7.x,ch[bW+13]=b7.y,ch[bW+14]=b7.z,ch[bW+15]=1,bW+=16}if(bB&&bq){bZ.length==4&&bq==THREE.VertexColors?(b7=bZ[0],b3=bZ[1],bl=bZ[2],bZ=bZ[3]):bZ=bl=b3=b7=bX,ci[bO]=b7.r,ci[bO+1]=b7.g,ci[bO+2]=b7.b,ci[bO+3]=b3.r,ci[bO+4]=b3.g,ci[bO+5]=b3.b,ci[bO+6]=bl.r,ci[bO+7]=bl.g,ci[bO+8]=bl.b,ci[bO+9]=bZ.r,ci[bO+10]=bZ.g,ci[bO+11]=bZ.b,bO+=12}if(bi&&c.hasTangents){bZ=bY[0],bX=bY[1],b7=bY[2],bY=bY[3],bK[bQ]=bZ.x,bK[bQ+1]=bZ.y,bK[bQ+2]=bZ.z,bK[bQ+3]=bZ.w,bK[bQ+4]=bX.x,bK[bQ+5]=bX.y,bK[bQ+6]=bX.z,bK[bQ+7]=bX.w,bK[bQ+8]=b7.x,bK[bQ+9]=b7.y,bK[bQ+10]=b7.z,bK[bQ+11]=b7.w,bK[bQ+12]=bY.x,bK[bQ+13]=bY.y,bK[bQ+14]=bY.z,bK[bQ+15]=bY.w,bQ+=16}if(bG&&bs){if(b0.length==4&&bj){for(bY=0;bY<4;bY++){cl=b0[bY],be[b2]=cl.x,be[b2+1]=cl.y,be[b2+2]=cl.z,b2+=3}}else{for(bY=0;bY<4;bY++){be[b2]=cl.x,be[b2+1]=cl.y,be[b2+2]=cl.z,b2+=3}}}if(cc&&bo!==void 0&&bp){for(bY=0;bY<4;bY++){b0=bo[bY],y[bh]=b0.u,y[bh+1]=b0.v,bh+=2}}if(cc&&b5!==void 0&&bp){for(bY=0;bY<4;bY++){b0=b5[bY],ck[bM]=b0.u,ck[bM+1]=b0.v,bM+=2}}b6&&(bF[bN]=A,bF[bN+1]=A+1,bF[bN+2]=A+3,bF[bN+3]=A+1,bF[bN+4]=A+2,bF[bN+5]=A+3,bN+=6,cf[ce]=A,cf[ce+1]=A+1,cf[ce+2]=A,cf[ce+3]=A+3,cf[ce+4]=A+1,cf[ce+5]=A+2,cf[ce+6]=A+2,cf[ce+7]=A+3,ce+=8,A+=4)}}}cj&&(a3.bindBuffer(a3.ARRAY_BUFFER,bw.__webglVertexBuffer),a3.bufferData(a3.ARRAY_BUFFER,bz,bt));if(bI){for(bS in bI){bl=bI[bS],bl.__original.needsUpdate&&(a3.bindBuffer(a3.ARRAY_BUFFER,bl.buffer),a3.bufferData(a3.ARRAY_BUFFER,bl.array,bt))}}if(bg){b3=0;for(bl=G.length;b3<bl;b3++){a3.bindBuffer(a3.ARRAY_BUFFER,bw.__webglMorphTargetsBuffers[b3]),a3.bufferData(a3.ARRAY_BUFFER,b9[b3],bt)}}bB&&bO>0&&(a3.bindBuffer(a3.ARRAY_BUFFER,bw.__webglColorBuffer),a3.bufferData(a3.ARRAY_BUFFER,ci,bt));bG&&(a3.bindBuffer(a3.ARRAY_BUFFER,bw.__webglNormalBuffer),a3.bufferData(a3.ARRAY_BUFFER,be,bt));bi&&c.hasTangents&&(a3.bindBuffer(a3.ARRAY_BUFFER,bw.__webglTangentBuffer),a3.bufferData(a3.ARRAY_BUFFER,bK,bt));cc&&bh>0&&(a3.bindBuffer(a3.ARRAY_BUFFER,bw.__webglUVBuffer),a3.bufferData(a3.ARRAY_BUFFER,y,bt));cc&&bM>0&&(a3.bindBuffer(a3.ARRAY_BUFFER,bw.__webglUV2Buffer),a3.bufferData(a3.ARRAY_BUFFER,ck,bt));b6&&(a3.bindBuffer(a3.ELEMENT_ARRAY_BUFFER,bw.__webglFaceBuffer),a3.bufferData(a3.ELEMENT_ARRAY_BUFFER,bF,bt),a3.bindBuffer(a3.ELEMENT_ARRAY_BUFFER,bw.__webglLineBuffer),a3.bufferData(a3.ELEMENT_ARRAY_BUFFER,cf,bt));bW>0&&(a3.bindBuffer(a3.ARRAY_BUFFER,bw.__webglSkinVertexABuffer),a3.bufferData(a3.ARRAY_BUFFER,bv,bt),a3.bindBuffer(a3.ARRAY_BUFFER,bw.__webglSkinVertexBBuffer),a3.bufferData(a3.ARRAY_BUFFER,ch,bt),a3.bindBuffer(a3.ARRAY_BUFFER,bw.__webglSkinIndicesBuffer),a3.bufferData(a3.ARRAY_BUFFER,H,bt),a3.bindBuffer(a3.ARRAY_BUFFER,bw.__webglSkinWeightsBuffer),a3.bufferData(a3.ARRAY_BUFFER,cn,bt));bf&&(delete bw.__inittedArrays,delete bw.__colorArray,delete bw.__normalArray,delete bw.__tangentArray,delete bw.__uvArray,delete bw.__uv2Array,delete bw.__faceArray,delete bw.__vertexArray,delete bw.__lineArray,delete bw.__skinVertexAArray,delete bw.__skinVertexBArray,delete bw.__skinIndexArray,delete bw.__skinWeightArray)}}}bA.__dirtyVertices=!1;bA.__dirtyMorphTargets=!1;bA.__dirtyElements=!1;bA.__dirtyUvs=!1;bA.__dirtyNormals=!1;bA.__dirtyTangents=!1;bA.__dirtyColors=!1;au(bx)}else{if(bC instanceof THREE.Ribbon){bA=bC.geometry;if(bA.__dirtyVertices||bA.__dirtyColors){bC=bA;by=a3.DYNAMIC_DRAW;bx=b8=bn=bn=void 0;bp=bC.vertices;bw=bC.colors;bq=bp.length;bt=bw.length;bs=bC.__vertexArray;bf=bC.__colorArray;bo=bC.__dirtyColors;if(bC.__dirtyVertices){for(bn=0;bn<bq;bn++){b8=bp[bn].position,bx=bn*3,bs[bx]=b8.x,bs[bx+1]=b8.y,bs[bx+2]=b8.z}a3.bindBuffer(a3.ARRAY_BUFFER,bC.__webglVertexBuffer);a3.bufferData(a3.ARRAY_BUFFER,bs,by)}if(bo){for(bn=0;bn<bt;bn++){color=bw[bn],bx=bn*3,bf[bx]=color.r,bf[bx+1]=color.g,bf[bx+2]=color.b}a3.bindBuffer(a3.ARRAY_BUFFER,bC.__webglColorBuffer);a3.bufferData(a3.ARRAY_BUFFER,bf,by)}}bA.__dirtyVertices=!1;bA.__dirtyColors=!1}else{if(bC instanceof THREE.Line){bA=bC.geometry;if(bA.__dirtyVertices||bA.__dirtyColors){bC=bA;by=a3.DYNAMIC_DRAW;bx=b8=bn=bn=void 0;bp=bC.vertices;bw=bC.colors;bq=bp.length;bt=bw.length;bs=bC.__vertexArray;bf=bC.__colorArray;bo=bC.__dirtyColors;if(bC.__dirtyVertices){for(bn=0;bn<bq;bn++){b8=bp[bn].position,bx=bn*3,bs[bx]=b8.x,bs[bx+1]=b8.y,bs[bx+2]=b8.z}a3.bindBuffer(a3.ARRAY_BUFFER,bC.__webglVertexBuffer);a3.bufferData(a3.ARRAY_BUFFER,bs,by)}if(bo){for(bn=0;bn<bt;bn++){color=bw[bn],bx=bn*3,bf[bx]=color.r,bf[bx+1]=color.g,bf[bx+2]=color.b}a3.bindBuffer(a3.ARRAY_BUFFER,bC.__webglColorBuffer);a3.bufferData(a3.ARRAY_BUFFER,bf,by)}}bA.__dirtyVertices=!1;bA.__dirtyColors=!1}else{if(bC instanceof THREE.ParticleSystem){bA=bC.geometry,bw=aA(bA),(bA.__dirtyVertices||bA.__dirtyColors||bC.sortParticles||bw)&&bc(bA,a3.DYNAMIC_DRAW,bC),bA.__dirtyVertices=!1,bA.__dirtyColors=!1,au(bA)}}}}}};this.setFaceCulling=function(e,f){e?(!f||f=="ccw"?a3.frontFace(a3.CCW):a3.frontFace(a3.CW),e=="back"?a3.cullFace(a3.BACK):e=="front"?a3.cullFace(a3.FRONT):a3.cullFace(a3.FRONT_AND_BACK),a3.enable(a3.CULL_FACE)):a3.disable(a3.CULL_FACE)};this.supportsVertexTextures=function(){return aX}};THREE.WebGLRenderTarget=function(f,h,g){this.width=f;this.height=h;g=g||{};this.wrapS=g.wrapS!==void 0?g.wrapS:THREE.ClampToEdgeWrapping;this.wrapT=g.wrapT!==void 0?g.wrapT:THREE.ClampToEdgeWrapping;this.magFilter=g.magFilter!==void 0?g.magFilter:THREE.LinearFilter;this.minFilter=g.minFilter!==void 0?g.minFilter:THREE.LinearMipMapLinearFilter;this.offset=new THREE.Vector2(0,0);this.repeat=new THREE.Vector2(1,1);this.format=g.format!==void 0?g.format:THREE.RGBAFormat;this.type=g.type!==void 0?g.type:THREE.UnsignedByteType;this.depthBuffer=g.depthBuffer!==void 0?g.depthBuffer:!0;this.stencilBuffer=g.stencilBuffer!==void 0?g.stencilBuffer:!0};THREE.RenderableVertex=function(){this.positionWorld=new THREE.Vector3;this.positionScreen=new THREE.Vector4;this.visible=!0};THREE.RenderableVertex.prototype.copy=function(c){this.positionWorld.copy(c.positionWorld);this.positionScreen.copy(c.positionScreen)};THREE.RenderableFace3=function(){this.v1=new THREE.RenderableVertex;this.v2=new THREE.RenderableVertex;this.v3=new THREE.RenderableVertex;this.centroidWorld=new THREE.Vector3;this.centroidScreen=new THREE.Vector3;this.normalWorld=new THREE.Vector3;this.vertexNormalsWorld=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3];this.faceMaterials=this.meshMaterials=null;this.overdraw=!1;this.uvs=[[]];this.z=null};THREE.RenderableFace4=function(){this.v1=new THREE.RenderableVertex;this.v2=new THREE.RenderableVertex;this.v3=new THREE.RenderableVertex;this.v4=new THREE.RenderableVertex;this.centroidWorld=new THREE.Vector3;this.centroidScreen=new THREE.Vector3;this.normalWorld=new THREE.Vector3;this.vertexNormalsWorld=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3];this.faceMaterials=this.meshMaterials=null;this.overdraw=!1;this.uvs=[[]];this.z=null};THREE.RenderableObject=function(){this.z=this.object=null};THREE.RenderableParticle=function(){this.rotation=this.z=this.y=this.x=null;this.scale=new THREE.Vector2;this.materials=null};THREE.RenderableLine=function(){this.z=null;this.v1=new THREE.RenderableVertex;this.v2=new THREE.RenderableVertex;this.materials=null};THREE.ColorUtils={adjustHSV:function(h,n,m,k){var j=THREE.ColorUtils.__hsv;THREE.ColorUtils.rgbToHsv(h,j);j.h=THREE.ColorUtils.clamp(j.h+n,0,1);j.s=THREE.ColorUtils.clamp(j.s+m,0,1);j.v=THREE.ColorUtils.clamp(j.v+k,0,1);h.setHSV(j.h,j.s,j.v)},rgbToHsv:function(m,w){var v=m.r,u=m.g,t=m.b,o=Math.max(Math.max(v,u),t),p=Math.min(Math.min(v,u),t);if(p==o){p=v=0}else{var n=o-p,p=n/o,v=v==o?(u-t)/n:u==o?2+(t-v)/n:4+(v-u)/n;v/=6;v<0&&(v+=1);v>1&&(v-=1)}w===void 0&&(w={h:0,s:0,v:0});w.h=v;w.s=p;w.v=o;return w},clamp:function(f,h,g){return f<h?h:f>g?g:f}};THREE.ColorUtils.__hsv={h:0,s:0,v:0};THREE.GeometryUtils={merge:function(H,G){var F=G instanceof THREE.Mesh,E=H.vertices.length,D=F?G.geometry:G,B=H.vertices,C=D.vertices,A=H.faces,y=D.faces,z=H.faceVertexUvs[0],D=D.faceVertexUvs[0];F&&G.matrixAutoUpdate&&G.updateMatrix();for(var n=0,L=C.length;n<L;n++){var K=new THREE.Vertex(C[n].position.clone());F&&G.matrix.multiplyVector3(K.position);B.push(K)}n=0;for(L=y.length;n<L;n++){var C=y[n],M,J,I=C.vertexNormals,K=C.vertexColors;C instanceof THREE.Face3?M=new THREE.Face3(C.a+E,C.b+E,C.c+E):C instanceof THREE.Face4&&(M=new THREE.Face4(C.a+E,C.b+E,C.c+E,C.d+E));M.normal.copy(C.normal);F=0;for(B=I.length;F<B;F++){J=I[F],M.vertexNormals.push(J.clone())}M.color.copy(C.color);F=0;for(B=K.length;F<B;F++){J=K[F],M.vertexColors.push(J.clone())}M.materials=C.materials.slice();M.centroid.copy(C.centroid);A.push(M)}n=0;for(L=D.length;n<L;n++){E=D[n];A=[];F=0;for(B=E.length;F<B;F++){A.push(new THREE.UV(E[F].u,E[F].v))}z.push(A)}},clone:function(D){var C=new THREE.Geometry,B,A=D.vertices,z=D.faces,x=D.faceVertexUvs[0],D=0;for(B=A.length;D<B;D++){var y=new THREE.Vertex(A[D].position.clone());C.vertices.push(y)}D=0;for(B=z.length;D<B;D++){var w=z[D],t,v,n=w.vertexNormals,E=w.vertexColors;w instanceof THREE.Face3?t=new THREE.Face3(w.a,w.b,w.c):w instanceof THREE.Face4&&(t=new THREE.Face4(w.a,w.b,w.c,w.d));t.normal.copy(w.normal);A=0;for(y=n.length;A<y;A++){v=n[A],t.vertexNormals.push(v.clone())}t.color.copy(w.color);A=0;for(y=E.length;A<y;A++){v=E[A],t.vertexColors.push(v.clone())}t.materials=w.materials.slice();t.centroid.copy(w.centroid);C.faces.push(t)}D=0;for(B=x.length;D<B;D++){z=x[D];t=[];A=0;for(y=z.length;A<y;A++){t.push(new THREE.UV(z[A].u,z[A].v))}C.faceVertexUvs[0].push(t)}return C},randomPointInTriangle:function(m,w,v){var u,t,o,p=new THREE.Vector3,n=THREE.GeometryUtils.__v1;u=THREE.GeometryUtils.random();t=THREE.GeometryUtils.random();u+t>1&&(u=1-u,t=1-t);o=1-u-t;p.copy(m);p.multiplyScalar(u);n.copy(w);n.multiplyScalar(t);p.addSelf(n);n.copy(v);n.multiplyScalar(o);p.addSelf(n);return p},randomPointInFace:function(k,u,t){var p,o,m;if(k instanceof THREE.Face3){return p=u.vertices[k.a].position,o=u.vertices[k.b].position,m=u.vertices[k.c].position,THREE.GeometryUtils.randomPointInTriangle(p,o,m)}else{if(k instanceof THREE.Face4){p=u.vertices[k.a].position;o=u.vertices[k.b].position;m=u.vertices[k.c].position;var u=u.vertices[k.d].position,n;t?k._area1&&k._area2?(t=k._area1,n=k._area2):(t=THREE.GeometryUtils.triangleArea(p,o,u),n=THREE.GeometryUtils.triangleArea(o,m,u),k._area1=t,k._area2=n):(t=THREE.GeometryUtils.triangleArea(p,o,u),n=THREE.GeometryUtils.triangleArea(o,m,u));return THREE.GeometryUtils.random()*(t+n)<t?THREE.GeometryUtils.randomPointInTriangle(p,o,u):THREE.GeometryUtils.randomPointInTriangle(o,m,u)}}},randomPointsInGeometry:function(F,E){function D(e){function f(h,c){if(c<h){return h}var b=h+Math.floor((c-h)/2);return x[b]>e?f(h,b-1):x[b]<e?f(b+1,c):b}return f(0,x.length-1)}var C,B,z=F.faces,A=F.vertices,y=z.length,w=0,x=[],n,H,G,I;for(B=0;B<y;B++){C=z[B];if(C instanceof THREE.Face3){n=A[C.a].position,H=A[C.b].position,G=A[C.c].position,C._area=THREE.GeometryUtils.triangleArea(n,H,G)}else{if(C instanceof THREE.Face4){n=A[C.a].position,H=A[C.b].position,G=A[C.c].position,I=A[C.d].position,C._area1=THREE.GeometryUtils.triangleArea(n,H,I),C._area2=THREE.GeometryUtils.triangleArea(H,G,I),C._area=C._area1+C._area2}}w+=C._area;x[B]=w}C=[];A={};for(B=0;B<E;B++){y=THREE.GeometryUtils.random()*w,y=D(y),C[B]=THREE.GeometryUtils.randomPointInFace(z[y],F,!0),A[y]?A[y]+=1:A[y]=1}return C},triangleArea:function(h,n,m){var k,j=THREE.GeometryUtils.__v1;j.sub(h,n);k=j.length();j.sub(h,m);h=j.length();j.sub(n,m);m=j.length();n=0.5*(k+h+m);return Math.sqrt(n*(n-k)*(n-h)*(n-m))},random16:function(){return(65280*Math.random()+255*Math.random())/65535}};THREE.GeometryUtils.random=THREE.GeometryUtils.random16;THREE.GeometryUtils.__v1=new THREE.Vector3;THREE.ImageUtils={loadTexture:function(h,n,m){var k=new Image,j=new THREE.Texture(k,n);k.onload=function(){j.needsUpdate=!0;m&&m(this)};k.crossOrigin="";k.src=h;return j},loadTextureCube:function(h,p,o){var n,m=[],k=new THREE.Texture(m,p),p=m.loadCount=0;for(n=h.length;p<n;++p){m[p]=new Image,m[p].onload=function(){m.loadCount+=1;if(m.loadCount==6){k.needsUpdate=!0}o&&o(this)},m[p].crossOrigin="",m[p].src=h[p]}return k}};THREE.SceneUtils={showHierarchy:function(e,f){THREE.SceneUtils.traverseHierarchy(e,function(c){c.visible=f})},traverseHierarchy:function(h,n){var m,k,j=h.children.length;for(k=0;k<j;k++){m=h.children[k],n(m),THREE.SceneUtils.traverseHierarchy(m,n)}}};if(THREE.WebGLRenderer){THREE.ShaderUtils={lib:{fresnel:{uniforms:{mRefractionRatio:{type:"f",value:1.02},mFresnelBias:{type:"f",value:0.1},mFresnelPower:{type:"f",value:2},mFresnelScale:{type:"f",value:1},tCube:{type:"t",value:1,texture:null}},fragmentShader:"uniform samplerCube tCube;\nvarying vec3 vReflect;\nvarying vec3 vRefract[3];\nvarying float vReflectionFactor;\nvoid main() {\nvec4 reflectedColor = textureCube( tCube, vec3( -vReflect.x, vReflect.yz ) );\nvec4 refractedColor = vec4( 1.0, 1.0, 1.0, 1.0 );\nrefractedColor.r = textureCube( tCube, vec3( -vRefract[0].x, vRefract[0].yz ) ).r;\nrefractedColor.g = textureCube( tCube, vec3( -vRefract[1].x, vRefract[1].yz ) ).g;\nrefractedColor.b = textureCube( tCube, vec3( -vRefract[2].x, vRefract[2].yz ) ).b;\nrefractedColor.a = 1.0;\ngl_FragColor = mix( refractedColor, reflectedColor, clamp( vReflectionFactor, 0.0, 1.0 ) );\n}",vertexShader:"uniform float mRefractionRatio;\nuniform float mFresnelBias;\nuniform float mFresnelScale;\nuniform float mFresnelPower;\nvarying vec3 vReflect;\nvarying vec3 vRefract[3];\nvarying float vReflectionFactor;\nvoid main() {\nvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\nvec4 mPosition = objectMatrix * vec4( position, 1.0 );\nvec3 nWorld = normalize ( mat3( objectMatrix[0].xyz, objectMatrix[1].xyz, objectMatrix[2].xyz ) * normal );\nvec3 I = mPosition.xyz - cameraPosition;\nvReflect = reflect( I, nWorld );\nvRefract[0] = refract( normalize( I ), nWorld, mRefractionRatio );\nvRefract[1] = refract( normalize( I ), nWorld, mRefractionRatio * 0.99 );\nvRefract[2] = refract( normalize( I ), nWorld, mRefractionRatio * 0.98 );\nvReflectionFactor = mFresnelBias + mFresnelScale * pow( 1.0 + dot( normalize( I ), nWorld ), mFresnelPower );\ngl_Position = projectionMatrix * mvPosition;\n}"},normal:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.fog,THREE.UniformsLib.lights,{enableAO:{type:"i",value:0},enableDiffuse:{type:"i",value:0},enableSpecular:{type:"i",value:0},tDiffuse:{type:"t",value:0,texture:null},tNormal:{type:"t",value:2,texture:null},tSpecular:{type:"t",value:3,texture:null},tAO:{type:"t",value:4,texture:null},uNormalScale:{type:"f",value:1},tDisplacement:{type:"t",value:5,texture:null},uDisplacementBias:{type:"f",value:0},uDisplacementScale:{type:"f",value:1},uDiffuseColor:{type:"c",value:new THREE.Color(15658734)},uSpecularColor:{type:"c",value:new THREE.Color(1118481)},uAmbientColor:{type:"c",value:new THREE.Color(328965)},uShininess:{type:"f",value:30},uOpacity:{type:"f",value:1}}]),fragmentShader:["uniform vec3 uAmbientColor;\nuniform vec3 uDiffuseColor;\nuniform vec3 uSpecularColor;\nuniform float uShininess;\nuniform float uOpacity;\nuniform bool enableDiffuse;\nuniform bool enableSpecular;\nuniform bool enableAO;\nuniform sampler2D tDiffuse;\nuniform sampler2D tNormal;\nuniform sampler2D tSpecular;\nuniform sampler2D tAO;\nuniform float uNormalScale;\nvarying vec3 vTangent;\nvarying vec3 vBinormal;\nvarying vec3 vNormal;\nvarying vec2 vUv;\nuniform vec3 ambientLightColor;\n#if MAX_DIR_LIGHTS > 0\nuniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];\nuniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];\n#endif\n#if MAX_POINT_LIGHTS > 0\nuniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];\nvarying vec4 vPointLight[ MAX_POINT_LIGHTS ];\n#endif\nvarying vec3 vViewPosition;",THREE.ShaderChunk.fog_pars_fragment,"void main() {\ngl_FragColor = vec4( 1.0 );\nvec4 mColor = vec4( uDiffuseColor, uOpacity );\nvec4 mSpecular = vec4( uSpecularColor, uOpacity );\nvec3 specularTex = vec3( 1.0 );\nvec3 normalTex = texture2D( tNormal, vUv ).xyz * 2.0 - 1.0;\nnormalTex.xy *= uNormalScale;\nnormalTex = normalize( normalTex );\nif( enableDiffuse )\ngl_FragColor = gl_FragColor * texture2D( tDiffuse, vUv );\nif( enableAO )\ngl_FragColor = gl_FragColor * texture2D( tAO, vUv );\nif( enableSpecular )\nspecularTex = texture2D( tSpecular, vUv ).xyz;\nmat3 tsb = mat3( vTangent, vBinormal, vNormal );\nvec3 finalNormal = tsb * normalTex;\nvec3 normal = normalize( finalNormal );\nvec3 viewPosition = normalize( vViewPosition );\n#if MAX_POINT_LIGHTS > 0\nvec4 pointTotal = vec4( vec3( 0.0 ), 1.0 );\nfor ( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\nvec3 pointVector = normalize( vPointLight[ i ].xyz );\nvec3 pointHalfVector = normalize( vPointLight[ i ].xyz + viewPosition );\nfloat pointDistance = vPointLight[ i ].w;\nfloat pointDotNormalHalf = dot( normal, pointHalfVector );\nfloat pointDiffuseWeight = max( dot( normal, pointVector ), 0.0 );\nfloat pointSpecularWeight = 0.0;\nif ( pointDotNormalHalf >= 0.0 )\npointSpecularWeight = specularTex.r * pow( pointDotNormalHalf, uShininess );\npointTotal  += pointDistance * vec4( pointLightColor[ i ], 1.0 ) * ( mColor * pointDiffuseWeight + mSpecular * pointSpecularWeight * pointDiffuseWeight );\n}\n#endif\n#if MAX_DIR_LIGHTS > 0\nvec4 dirTotal = vec4( vec3( 0.0 ), 1.0 );\nfor( int i = 0; i < MAX_DIR_LIGHTS; i++ ) {\nvec4 lDirection = viewMatrix * vec4( directionalLightDirection[ i ], 0.0 );\nvec3 dirVector = normalize( lDirection.xyz );\nvec3 dirHalfVector = normalize( lDirection.xyz + viewPosition );\nfloat dirDotNormalHalf = dot( normal, dirHalfVector );\nfloat dirDiffuseWeight = max( dot( normal, dirVector ), 0.0 );\nfloat dirSpecularWeight = 0.0;\nif ( dirDotNormalHalf >= 0.0 )\ndirSpecularWeight = specularTex.r * pow( dirDotNormalHalf, uShininess );\ndirTotal  += vec4( directionalLightColor[ i ], 1.0 ) * ( mColor * dirDiffuseWeight + mSpecular * dirSpecularWeight * dirDiffuseWeight );\n}\n#endif\nvec4 totalLight = vec4( ambientLightColor * uAmbientColor, uOpacity );\n#if MAX_DIR_LIGHTS > 0\ntotalLight += dirTotal;\n#endif\n#if MAX_POINT_LIGHTS > 0\ntotalLight += pointTotal;\n#endif\ngl_FragColor = gl_FragColor * totalLight;",THREE.ShaderChunk.fog_fragment,"}"].join("\n"),vertexShader:"attribute vec4 tangent;\n#ifdef VERTEX_TEXTURES\nuniform sampler2D tDisplacement;\nuniform float uDisplacementScale;\nuniform float uDisplacementBias;\n#endif\nvarying vec3 vTangent;\nvarying vec3 vBinormal;\nvarying vec3 vNormal;\nvarying vec2 vUv;\n#if MAX_POINT_LIGHTS > 0\nuniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\nuniform float pointLightDistance[ MAX_POINT_LIGHTS ];\nvarying vec4 vPointLight[ MAX_POINT_LIGHTS ];\n#endif\nvarying vec3 vViewPosition;\nvoid main() {\nvec4 mPosition = objectMatrix * vec4( position, 1.0 );\nvViewPosition = cameraPosition - mPosition.xyz;\nvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\nvNormal = normalize( normalMatrix * normal );\nvTangent = normalize( normalMatrix * tangent.xyz );\nvBinormal = cross( vNormal, vTangent ) * tangent.w;\nvBinormal = normalize( vBinormal );\nvUv = uv;\n#if MAX_POINT_LIGHTS > 0\nfor( int i = 0; i < MAX_POINT_LIGHTS; i++ ) {\nvec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );\nvec3 lVector = lPosition.xyz - mvPosition.xyz;\nfloat lDistance = 1.0;\nif ( pointLightDistance[ i ] > 0.0 )\nlDistance = 1.0 - min( ( length( lVector ) / pointLightDistance[ i ] ), 1.0 );\nlVector = normalize( lVector );\nvPointLight[ i ] = vec4( lVector, lDistance );\n}\n#endif\n#ifdef VERTEX_TEXTURES\nvec3 dv = texture2D( tDisplacement, uv ).xyz;\nfloat df = uDisplacementScale * dv.x + uDisplacementBias;\nvec4 displacedPosition = vec4( vNormal.xyz * df, 0.0 ) + mvPosition;\ngl_Position = projectionMatrix * displacedPosition;\n#else\ngl_Position = projectionMatrix * mvPosition;\n#endif\n}"},cube:{uniforms:{tCube:{type:"t",value:1,texture:null}},vertexShader:"varying vec3 vViewPosition;\nvoid main() {\nvec4 mPosition = objectMatrix * vec4( position, 1.0 );\nvViewPosition = cameraPosition - mPosition.xyz;\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"uniform samplerCube tCube;\nvarying vec3 vViewPosition;\nvoid main() {\nvec3 wPos = cameraPosition - vViewPosition;\ngl_FragColor = textureCube( tCube, vec3( - wPos.x, wPos.yz ) );\n}"},convolution:{uniforms:{tDiffuse:{type:"t",value:0,texture:null},uImageIncrement:{type:"v2",value:new THREE.Vector2(0.001953125,0)},cKernel:{type:"fv1",value:[]}},vertexShader:"varying vec2 vUv;\nuniform vec2 uImageIncrement;\nvoid main(void) {\nvUv = uv - ((KERNEL_SIZE - 1.0) / 2.0) * uImageIncrement;\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"varying vec2 vUv;\nuniform sampler2D tDiffuse;\nuniform vec2 uImageIncrement;\nuniform float cKernel[KERNEL_SIZE];\nvoid main(void) {\nvec2 imageCoord = vUv;\nvec4 sum = vec4( 0.0, 0.0, 0.0, 0.0 );\nfor( int i=0; i<KERNEL_SIZE; ++i ) {\nsum += texture2D( tDiffuse, imageCoord ) * cKernel[i];\nimageCoord += uImageIncrement;\n}\ngl_FragColor = sum;\n}"},film:{uniforms:{tDiffuse:{type:"t",value:0,texture:null},time:{type:"f",value:0},nIntensity:{type:"f",value:0.5},sIntensity:{type:"f",value:0.05},sCount:{type:"f",value:4096},grayscale:{type:"i",value:1}},vertexShader:"varying vec2 vUv;\nvoid main() {\nvUv = vec2( uv.x, 1.0 - uv.y );\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"varying vec2 vUv;\nuniform sampler2D tDiffuse;\nuniform float time;\nuniform bool grayscale;\nuniform float nIntensity;\nuniform float sIntensity;\nuniform float sCount;\nvoid main() {\nvec4 cTextureScreen = texture2D( tDiffuse, vUv );\nfloat x = vUv.x * vUv.y * time *  1000.0;\nx = mod( x, 13.0 ) * mod( x, 123.0 );\nfloat dx = mod( x, 0.01 );\nvec3 cResult = cTextureScreen.rgb + cTextureScreen.rgb * clamp( 0.1 + dx * 100.0, 0.0, 1.0 );\nvec2 sc = vec2( sin( vUv.y * sCount ), cos( vUv.y * sCount ) );\ncResult += cTextureScreen.rgb * vec3( sc.x, sc.y, sc.x ) * sIntensity;\ncResult = cTextureScreen.rgb + clamp( nIntensity, 0.0,1.0 ) * ( cResult - cTextureScreen.rgb );\nif( grayscale ) {\ncResult = vec3( cResult.r * 0.3 + cResult.g * 0.59 + cResult.b * 0.11 );\n}\ngl_FragColor =  vec4( cResult, cTextureScreen.a );\n}"},screen:{uniforms:{tDiffuse:{type:"t",value:0,texture:null},opacity:{type:"f",value:1}},vertexShader:"varying vec2 vUv;\nvoid main() {\nvUv = vec2( uv.x, 1.0 - uv.y );\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"varying vec2 vUv;\nuniform sampler2D tDiffuse;\nuniform float opacity;\nvoid main() {\nvec4 texel = texture2D( tDiffuse, vUv );\ngl_FragColor = opacity * texel;\n}"},basic:{uniforms:{},vertexShader:"void main() {\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"void main() {\ngl_FragColor = vec4( 1.0, 0.0, 0.0, 0.5 );\n}"}},buildKernel:function(h){var p,o,n,m,k=2*Math.ceil(h*3)+1;k>25&&(k=25);m=(k-1)*0.5;o=Array(k);for(p=n=0;p<k;++p){o[p]=Math.exp(-((p-m)*(p-m))/(2*h*h)),n+=o[p]}for(p=0;p<k;++p){o[p]/=n}return o}}}THREE.AnimationHandler=function(){var g=[],k={},j={update:function(f){for(var b=0;b<g.length;b++){g[b].update(f)}},addToUpdate:function(b){g.indexOf(b)===-1&&g.push(b)},removeFromUpdate:function(b){b=g.indexOf(b);b!==-1&&g.splice(b,1)},add:function(n){k[n.name]!==void 0&&console.log("THREE.AnimationHandler.add: Warning! "+n.name+" already exists in library. Overwriting.");k[n.name]=n;if(n.initialized!==!0){for(var w=0;w<n.hierarchy.length;w++){for(var u=0;u<n.hierarchy[w].keys.length;u++){if(n.hierarchy[w].keys[u].time<0){n.hierarchy[w].keys[u].time=0}if(n.hierarchy[w].keys[u].rot!==void 0&&!(n.hierarchy[w].keys[u].rot instanceof THREE.Quaternion)){var t=n.hierarchy[w].keys[u].rot;n.hierarchy[w].keys[u].rot=new THREE.Quaternion(t[0],t[1],t[2],t[3])}}if(n.hierarchy[w].keys[0].morphTargets!==void 0){t={};for(u=0;u<n.hierarchy[w].keys.length;u++){for(var x=0;x<n.hierarchy[w].keys[u].morphTargets.length;x++){var c=n.hierarchy[w].keys[u].morphTargets[x];t[c]=-1}}n.hierarchy[w].usedMorphTargets=t;for(u=0;u<n.hierarchy[w].keys.length;u++){var v={};for(c in t){for(x=0;x<n.hierarchy[w].keys[u].morphTargets.length;x++){if(n.hierarchy[w].keys[u].morphTargets[x]===c){v[c]=n.hierarchy[w].keys[u].morphTargetsInfluences[x];break}}x===n.hierarchy[w].keys[u].morphTargets.length&&(v[c]=0)}n.hierarchy[w].keys[u].morphTargetsInfluences=v}}for(u=1;u<n.hierarchy[w].keys.length;u++){n.hierarchy[w].keys[u].time===n.hierarchy[w].keys[u-1].time&&(n.hierarchy[w].keys.splice(u,1),u--)}for(u=1;u<n.hierarchy[w].keys.length;u++){n.hierarchy[w].keys[u].index=u}}u=parseInt(n.length*n.fps,10);n.JIT={};n.JIT.hierarchy=[];for(w=0;w<n.hierarchy.length;w++){n.JIT.hierarchy.push(Array(u))}n.initialized=!0}},get:function(c){if(typeof c==="string"){return k[c]?k[c]:(console.log("THREE.AnimationHandler.get: Couldn't find animation "+c),null)}},parse:function(f){var m=[];if(f instanceof THREE.SkinnedMesh){for(var n=0;n<f.bones.length;n++){m.push(f.bones[n])}}else{h(f,m)}return m}},h=function(f,m){m.push(f);for(var n=0;n<f.children.length;n++){h(f.children[n],m)}};j.LINEAR=0;j.CATMULLROM=1;j.CATMULLROM_FORWARD=2;return j}();THREE.Animation=function(g,k,j,h){this.root=g;this.data=THREE.AnimationHandler.get(k);this.hierarchy=THREE.AnimationHandler.parse(g);this.currentTime=0;this.timeScale=1;this.isPlaying=!1;this.loop=this.isPaused=!0;this.interpolationType=j!==void 0?j:THREE.AnimationHandler.LINEAR;this.JITCompile=h!==void 0?h:!0;this.points=[];this.target=new THREE.Vector3};THREE.Animation.prototype.play=function(h,p){if(!this.isPlaying){this.isPlaying=!0;this.loop=h!==void 0?h:!0;this.currentTime=p!==void 0?p:0;var o,n=this.hierarchy.length,m;for(o=0;o<n;o++){m=this.hierarchy[o];if(this.interpolationType!==THREE.AnimationHandler.CATMULLROM_FORWARD){m.useQuaternion=!0}m.matrixAutoUpdate=!0;if(m.animationCache===void 0){m.animationCache={},m.animationCache.prevKey={pos:0,rot:0,scl:0},m.animationCache.nextKey={pos:0,rot:0,scl:0},m.animationCache.originalMatrix=m instanceof THREE.Bone?m.skinMatrix:m.matrix}var k=m.animationCache.prevKey;m=m.animationCache.nextKey;k.pos=this.data.hierarchy[o].keys[0];k.rot=this.data.hierarchy[o].keys[0];k.scl=this.data.hierarchy[o].keys[0];m.pos=this.getNextKeyWith("pos",o,1);m.rot=this.getNextKeyWith("rot",o,1);m.scl=this.getNextKeyWith("scl",o,1)}this.update(0)}this.isPaused=!1;THREE.AnimationHandler.addToUpdate(this)};THREE.Animation.prototype.pause=function(){this.isPaused?THREE.AnimationHandler.addToUpdate(this):THREE.AnimationHandler.removeFromUpdate(this);this.isPaused=!this.isPaused};THREE.Animation.prototype.stop=function(){this.isPaused=this.isPlaying=!1;THREE.AnimationHandler.removeFromUpdate(this);for(var c=0;c<this.hierarchy.length;c++){if(this.hierarchy[c].animationCache!==void 0){this.hierarchy[c] instanceof THREE.Bone?this.hierarchy[c].skinMatrix=this.hierarchy[c].animationCache.originalMatrix:this.hierarchy[c].matrix=this.hierarchy[c].animationCache.originalMatrix,delete this.hierarchy[c].animationCache}}};THREE.Animation.prototype.update=function(H){if(this.isPlaying){var G=["pos","rot","scl"],F,E,D,B,C,A,y,z,n=this.data.JIT.hierarchy,L,K;this.currentTime+=H*this.timeScale;K=this.currentTime;L=this.currentTime%=this.data.length;z=parseInt(Math.min(L*this.data.fps,this.data.length*this.data.fps),10);for(var M=0,J=this.hierarchy.length;M<J;M++){if(H=this.hierarchy[M],y=H.animationCache,this.JITCompile&&n[M][z]!==void 0){H instanceof THREE.Bone?(H.skinMatrix=n[M][z],H.matrixAutoUpdate=!1,H.matrixWorldNeedsUpdate=!1):(H.matrix=n[M][z],H.matrixAutoUpdate=!1,H.matrixWorldNeedsUpdate=!0)}else{if(this.JITCompile){H instanceof THREE.Bone?H.skinMatrix=H.animationCache.originalMatrix:H.matrix=H.animationCache.originalMatrix}for(var I=0;I<3;I++){F=G[I];C=y.prevKey[F];A=y.nextKey[F];if(A.time<=K){if(L<K){if(this.loop){C=this.data.hierarchy[M].keys[0];for(A=this.getNextKeyWith(F,M,1);A.time<L;){C=A,A=this.getNextKeyWith(F,M,A.index+1)}}else{this.stop();return}}else{do{C=A,A=this.getNextKeyWith(F,M,A.index+1)}while(A.time<L)}y.prevKey[F]=C;y.nextKey[F]=A}H.matrixAutoUpdate=!0;H.matrixWorldNeedsUpdate=!0;E=(L-C.time)/(A.time-C.time);D=C[F];B=A[F];if(E<0||E>1){console.log("THREE.Animation.update: Warning! Scale out of bounds:"+E+" on bone "+M),E=E<0?0:1}if(F==="pos"){if(F=H.position,this.interpolationType===THREE.AnimationHandler.LINEAR){F.x=D[0]+(B[0]-D[0])*E,F.y=D[1]+(B[1]-D[1])*E,F.z=D[2]+(B[2]-D[2])*E}else{if(this.interpolationType===THREE.AnimationHandler.CATMULLROM||this.interpolationType===THREE.AnimationHandler.CATMULLROM_FORWARD){if(this.points[0]=this.getPrevKeyWith("pos",M,C.index-1).pos,this.points[1]=D,this.points[2]=B,this.points[3]=this.getNextKeyWith("pos",M,A.index+1).pos,E=E*0.33+0.33,D=this.interpolateCatmullRom(this.points,E),F.x=D[0],F.y=D[1],F.z=D[2],this.interpolationType===THREE.AnimationHandler.CATMULLROM_FORWARD){E=this.interpolateCatmullRom(this.points,E*1.01),this.target.set(E[0],E[1],E[2]),this.target.subSelf(F),this.target.y=0,this.target.normalize(),E=Math.atan2(this.target.x,this.target.z),H.rotation.set(0,E,0)}}}}else{if(F==="rot"){THREE.Quaternion.slerp(D,B,H.quaternion,E)}else{if(F==="scl"){F=H.scale,F.x=D[0]+(B[0]-D[0])*E,F.y=D[1]+(B[1]-D[1])*E,F.z=D[2]+(B[2]-D[2])*E}}}}}}if(this.JITCompile&&n[0][z]===void 0){this.hierarchy[0].update(void 0,!0);for(M=0;M<this.hierarchy.length;M++){n[M][z]=this.hierarchy[M] instanceof THREE.Bone?this.hierarchy[M].skinMatrix.clone():this.hierarchy[M].matrix.clone()}}}};THREE.Animation.prototype.interpolateCatmullRom=function(A,z){var y=[],x=[],w,u,v,t,n,p;w=(A.length-1)*z;u=Math.floor(w);w-=u;y[0]=u==0?u:u-1;y[1]=u;y[2]=u>A.length-2?u:u+1;y[3]=u>A.length-3?u:u+2;u=A[y[0]];t=A[y[1]];n=A[y[2]];p=A[y[3]];y=w*w;v=w*y;x[0]=this.interpolate(u[0],t[0],n[0],p[0],w,y,v);x[1]=this.interpolate(u[1],t[1],n[1],p[1],w,y,v);x[2]=this.interpolate(u[2],t[2],n[2],p[2],w,y,v);return x};THREE.Animation.prototype.interpolate=function(k,u,t,p,o,m,n){k=(t-k)*0.5;p=(p-u)*0.5;return(2*(u-t)+k+p)*n+(-3*(u-t)-2*k-p)*m+k*o+u};THREE.Animation.prototype.getNextKeyWith=function(g,k,j){var h=this.data.hierarchy[k].keys;for(this.interpolationType===THREE.AnimationHandler.CATMULLROM||this.interpolationType===THREE.AnimationHandler.CATMULLROM_FORWARD?j=j<h.length-1?j:h.length-1:j%=h.length;j<h.length;j++){if(h[j][g]!==void 0){return h[j]}}return this.data.hierarchy[k].keys[0]};THREE.Animation.prototype.getPrevKeyWith=function(g,k,j){for(var h=this.data.hierarchy[k].keys,j=this.interpolationType===THREE.AnimationHandler.CATMULLROM||this.interpolationType===THREE.AnimationHandler.CATMULLROM_FORWARD?j>0?j:0:j>=0?j:j+h.length;j>=0;j--){if(h[j][g]!==void 0){return h[j]}}return this.data.hierarchy[k].keys[h.length-1]};THREE.FirstPersonCamera=function(e){function f(g,h){return function(){h.apply(g,arguments)}}THREE.Camera.call(this,e.fov,e.aspect,e.near,e.far,e.target);this.movementSpeed=1;this.lookSpeed=0.005;this.noFly=!1;this.lookVertical=!0;this.autoForward=!1;this.activeLook=!0;this.heightSpeed=!1;this.heightCoef=1;this.heightMin=0;this.constrainVertical=!1;this.verticalMin=0;this.verticalMax=3.14;this.domElement=document;this.lastUpdate=(new Date).getTime();this.tdiff=0;if(e){if(e.movementSpeed!==void 0){this.movementSpeed=e.movementSpeed}if(e.lookSpeed!==void 0){this.lookSpeed=e.lookSpeed}if(e.noFly!==void 0){this.noFly=e.noFly}if(e.lookVertical!==void 0){this.lookVertical=e.lookVertical}if(e.autoForward!==void 0){this.autoForward=e.autoForward}if(e.activeLook!==void 0){this.activeLook=e.activeLook}if(e.heightSpeed!==void 0){this.heightSpeed=e.heightSpeed}if(e.heightCoef!==void 0){this.heightCoef=e.heightCoef}if(e.heightMin!==void 0){this.heightMin=e.heightMin}if(e.heightMax!==void 0){this.heightMax=e.heightMax}if(e.constrainVertical!==void 0){this.constrainVertical=e.constrainVertical}if(e.verticalMin!==void 0){this.verticalMin=e.verticalMin}if(e.verticalMax!==void 0){this.verticalMax=e.verticalMax}if(e.domElement!==void 0){this.domElement=e.domElement}}this.theta=this.phi=this.lon=this.lat=this.mouseY=this.mouseX=this.autoSpeedFactor=0;this.mouseDragOn=this.freeze=this.moveRight=this.moveLeft=this.moveBackward=this.moveForward=!1;this.windowHalfX=window.innerWidth/2;this.windowHalfY=window.innerHeight/2;this.onMouseDown=function(c){c.preventDefault();c.stopPropagation();if(this.activeLook){switch(c.button){case 0:this.moveForward=!0;break;case 2:this.moveBackward=!0}}this.mouseDragOn=!0};this.onMouseUp=function(c){c.preventDefault();c.stopPropagation();if(this.activeLook){switch(c.button){case 0:this.moveForward=!1;break;case 2:this.moveBackward=!1}}this.mouseDragOn=!1};this.onMouseMove=function(c){this.mouseX=c.clientX-this.windowHalfX;this.mouseY=c.clientY-this.windowHalfY};this.onKeyDown=function(c){switch(c.keyCode){case 38:case 87:this.moveForward=!0;break;case 37:case 65:this.moveLeft=!0;break;case 40:case 83:this.moveBackward=!0;break;case 39:case 68:this.moveRight=!0;break;case 82:this.moveUp=!0;break;case 70:this.moveDown=!0;break;case 81:this.freeze=!this.freeze}};this.onKeyUp=function(c){switch(c.keyCode){case 38:case 87:this.moveForward=!1;break;case 37:case 65:this.moveLeft=!1;break;case 40:case 83:this.moveBackward=!1;break;case 39:case 68:this.moveRight=!1;break;case 82:this.moveUp=!1;break;case 70:this.moveDown=!1}};this.update=function(){var h=(new Date).getTime();this.tdiff=(h-this.lastUpdate)/1000;this.lastUpdate=h;if(!this.freeze){this.autoSpeedFactor=this.heightSpeed?this.tdiff*((this.position.y<this.heightMin?this.heightMin:this.position.y>this.heightMax?this.heightMax:this.position.y)-this.heightMin)*this.heightCoef:0;var k=this.tdiff*this.movementSpeed;(this.moveForward||this.autoForward&&!this.moveBackward)&&this.translateZ(-(k+this.autoSpeedFactor));this.moveBackward&&this.translateZ(k);this.moveLeft&&this.translateX(-k);this.moveRight&&this.translateX(k);this.moveUp&&this.translateY(k);this.moveDown&&this.translateY(-k);k=this.tdiff*this.lookSpeed;this.activeLook||(k=0);this.lon+=this.mouseX*k;this.lookVertical&&(this.lat-=this.mouseY*k);this.lat=Math.max(-85,Math.min(85,this.lat));this.phi=(90-this.lat)*Math.PI/180;this.theta=this.lon*Math.PI/180;var h=this.target.position,j=this.position;h.x=j.x+100*Math.sin(this.phi)*Math.cos(this.theta);h.y=j.y+100*Math.cos(this.phi);h.z=j.z+100*Math.sin(this.phi)*Math.sin(this.theta)}h=1;this.constrainVertical&&(h=3.14/(this.verticalMax-this.verticalMin));this.lon+=this.mouseX*k;this.lookVertical&&(this.lat-=this.mouseY*k*h);this.lat=Math.max(-85,Math.min(85,this.lat));this.phi=(90-this.lat)*Math.PI/180;this.theta=this.lon*Math.PI/180;if(this.constrainVertical){this.phi=(this.phi-0)*(this.verticalMax-this.verticalMin)/3.14+this.verticalMin}h=this.target.position;j=this.position;h.x=j.x+100*Math.sin(this.phi)*Math.cos(this.theta);h.y=j.y+100*Math.cos(this.phi);h.z=j.z+100*Math.sin(this.phi)*Math.sin(this.theta);this.supr.update.call(this)};this.domElement.addEventListener("contextmenu",function(c){c.preventDefault()},!1);this.domElement.addEventListener("mousemove",f(this,this.onMouseMove),!1);this.domElement.addEventListener("mousedown",f(this,this.onMouseDown),!1);this.domElement.addEventListener("mouseup",f(this,this.onMouseUp),!1);this.domElement.addEventListener("keydown",f(this,this.onKeyDown),!1);this.domElement.addEventListener("keyup",f(this,this.onKeyUp),!1)};THREE.FirstPersonCamera.prototype=new THREE.Camera;THREE.FirstPersonCamera.prototype.constructor=THREE.FirstPersonCamera;THREE.FirstPersonCamera.prototype.supr=THREE.Camera.prototype;THREE.FirstPersonCamera.prototype.translate=function(e,f){this.matrix.rotateAxis(f);if(this.noFly){f.y=0}this.position.addSelf(f.multiplyScalar(e));this.target.position.addSelf(f.multiplyScalar(e))};THREE.PathCamera=function(y){function x(I,G,F,E){var D={name:F,fps:0.6,length:E,hierarchy:[]},C,B=G.getControlPointsArray(),A=G.getLength(),z=B.length,J=0;C=z-1;G={parent:-1,keys:[]};G.keys[0]={time:0,pos:B[0],rot:[0,0,0,1],scl:[1,1,1]};G.keys[C]={time:E,pos:B[C],rot:[0,0,0,1],scl:[1,1,1]};for(C=1;C<z-1;C++){J=E*A.chunks[C]/A.total,G.keys[C]={time:J,pos:B[C]}}D.hierarchy[0]=G;THREE.AnimationHandler.add(D);return new THREE.Animation(I,F,THREE.AnimationHandler.CATMULLROM_FORWARD,!1)}function w(h,z){var o,k,j=new THREE.Geometry;for(o=0;o<h.points.length*z;o++){k=o/(h.points.length*z),k=h.getPoint(k),j.vertices[o]=new THREE.Vertex(new THREE.Vector3(k.x,k.y,k.z))}return j}function v(e,z){var o=w(z,10),k=w(z,10),j=new THREE.LineBasicMaterial({color:16711680,linewidth:3});lineObj=new THREE.Line(o,j);particleObj=new THREE.ParticleSystem(k,new THREE.ParticleBasicMaterial({color:16755200,size:3}));lineObj.scale.set(1,1,1);e.addChild(lineObj);particleObj.scale.set(1,1,1);e.addChild(particleObj);k=new THREE.SphereGeometry(1,16,8);j=new THREE.MeshBasicMaterial({color:65280});for(i=0;i<z.points.length;i++){o=new THREE.Mesh(k,j),o.position.copy(z.points[i]),o.updateMatrix(),e.addChild(o)}}THREE.Camera.call(this,y.fov,y.aspect,y.near,y.far,y.target);this.id="PathCamera"+THREE.PathCameraIdCounter++;this.duration=10000;this.waypoints=[];this.useConstantSpeed=!0;this.resamplingCoef=50;this.debugPath=new THREE.Object3D;this.debugDummy=new THREE.Object3D;this.animationParent=new THREE.Object3D;this.lookSpeed=0.005;this.lookHorizontal=this.lookVertical=!0;this.verticalAngleMap={srcRange:[0,6.28],dstRange:[0,6.28]};this.horizontalAngleMap={srcRange:[0,6.28],dstRange:[0,6.28]};this.domElement=document;if(y){if(y.duration!==void 0){this.duration=y.duration*1000}if(y.waypoints!==void 0){this.waypoints=y.waypoints}if(y.useConstantSpeed!==void 0){this.useConstantSpeed=y.useConstantSpeed}if(y.resamplingCoef!==void 0){this.resamplingCoef=y.resamplingCoef}if(y.createDebugPath!==void 0){this.createDebugPath=y.createDebugPath}if(y.createDebugDummy!==void 0){this.createDebugDummy=y.createDebugDummy}if(y.lookSpeed!==void 0){this.lookSpeed=y.lookSpeed}if(y.lookVertical!==void 0){this.lookVertical=y.lookVertical}if(y.lookHorizontal!==void 0){this.lookHorizontal=y.lookHorizontal}if(y.verticalAngleMap!==void 0){this.verticalAngleMap=y.verticalAngleMap}if(y.horizontalAngleMap!==void 0){this.horizontalAngleMap=y.horizontalAngleMap}if(y.domElement!==void 0){this.domElement=y.domElement}}this.theta=this.phi=this.lon=this.lat=this.mouseY=this.mouseX=0;this.windowHalfX=window.innerWidth/2;this.windowHalfY=window.innerHeight/2;var u=Math.PI*2,p=Math.PI/180;this.update=function(g,B,A){var z,o;this.lookHorizontal&&(this.lon+=this.mouseX*this.lookSpeed);this.lookVertical&&(this.lat-=this.mouseY*this.lookSpeed);this.lon=Math.max(0,Math.min(360,this.lon));this.lat=Math.max(-85,Math.min(85,this.lat));this.phi=(90-this.lat)*p;this.theta=this.lon*p;z=this.phi%u;this.phi=z>=0?z:z+u;z=this.verticalAngleMap.srcRange;o=this.verticalAngleMap.dstRange;var j=o[1]-o[0];this.phi=TWEEN.Easing.Quadratic.EaseInOut(((this.phi-z[0])*(o[1]-o[0])/(z[1]-z[0])+o[0]-o[0])/j)*j+o[0];z=this.horizontalAngleMap.srcRange;o=this.horizontalAngleMap.dstRange;j=o[1]-o[0];this.theta=TWEEN.Easing.Quadratic.EaseInOut(((this.theta-z[0])*(o[1]-o[0])/(z[1]-z[0])+o[0]-o[0])/j)*j+o[0];z=this.target.position;z.x=100*Math.sin(this.phi)*Math.cos(this.theta);z.y=100*Math.cos(this.phi);z.z=100*Math.sin(this.phi)*Math.sin(this.theta);this.supr.update.call(this,g,B,A)};this.onMouseMove=function(c){this.mouseX=c.clientX-this.windowHalfX;this.mouseY=c.clientY-this.windowHalfY};this.spline=new THREE.Spline;this.spline.initFromArray(this.waypoints);this.useConstantSpeed&&this.spline.reparametrizeByArcLength(this.resamplingCoef);if(this.createDebugDummy){var y=new THREE.MeshLambertMaterial({color:30719}),t=new THREE.MeshLambertMaterial({color:65280}),n=new THREE.CubeGeometry(10,10,20),m=new THREE.CubeGeometry(2,2,10);this.animationParent=new THREE.Mesh(n,y);y=new THREE.Mesh(m,t);y.position.set(0,10,0);this.animation=x(this.animationParent,this.spline,this.id,this.duration);this.animationParent.addChild(this);this.animationParent.addChild(this.target);this.animationParent.addChild(y)}else{this.animation=x(this.animationParent,this.spline,this.id,this.duration),this.animationParent.addChild(this.target),this.animationParent.addChild(this)}this.createDebugPath&&v(this.debugPath,this.spline);this.domElement.addEventListener("mousemove",function(e,f){return function(){f.apply(e,arguments)}}(this,this.onMouseMove),!1)};THREE.PathCamera.prototype=new THREE.Camera;THREE.PathCamera.prototype.constructor=THREE.PathCamera;THREE.PathCamera.prototype.supr=THREE.Camera.prototype;THREE.PathCameraIdCounter=0;THREE.FlyCamera=function(e){function f(g,h){return function(){h.apply(g,arguments)}}THREE.Camera.call(this,e.fov,e.aspect,e.near,e.far,e.target);this.tmpQuaternion=new THREE.Quaternion;this.movementSpeed=1;this.rollSpeed=0.005;this.autoForward=this.dragToLook=!1;this.domElement=document;if(e){if(e.movementSpeed!==void 0){this.movementSpeed=e.movementSpeed}if(e.rollSpeed!==void 0){this.rollSpeed=e.rollSpeed}if(e.dragToLook!==void 0){this.dragToLook=e.dragToLook}if(e.autoForward!==void 0){this.autoForward=e.autoForward}if(e.domElement!==void 0){this.domElement=e.domElement}}this.useTarget=!1;this.useQuaternion=!0;this.mouseStatus=0;this.moveState={up:0,down:0,left:0,right:0,forward:0,back:0,pitchUp:0,pitchDown:0,yawLeft:0,yawRight:0,rollLeft:0,rollRight:0};this.moveVector=new THREE.Vector3(0,0,0);this.rotationVector=new THREE.Vector3(0,0,0);this.lastUpdate=-1;this.tdiff=0;this.handleEvent=function(c){if(typeof this[c.type]=="function"){this[c.type](c)}};this.keydown=function(c){if(!c.altKey){switch(c.keyCode){case 16:this.movementSpeedMultiplier=0.1;break;case 87:this.moveState.forward=1;break;case 83:this.moveState.back=1;break;case 65:this.moveState.left=1;break;case 68:this.moveState.right=1;break;case 82:this.moveState.up=1;break;case 70:this.moveState.down=1;break;case 38:this.moveState.pitchUp=1;break;case 40:this.moveState.pitchDown=1;break;case 37:this.moveState.yawLeft=1;break;case 39:this.moveState.yawRight=1;break;case 81:this.moveState.rollLeft=1;break;case 69:this.moveState.rollRight=1}this.updateMovementVector();this.updateRotationVector()}};this.keyup=function(c){switch(c.keyCode){case 16:this.movementSpeedMultiplier=1;break;case 87:this.moveState.forward=0;break;case 83:this.moveState.back=0;break;case 65:this.moveState.left=0;break;case 68:this.moveState.right=0;break;case 82:this.moveState.up=0;break;case 70:this.moveState.down=0;break;case 38:this.moveState.pitchUp=0;break;case 40:this.moveState.pitchDown=0;break;case 37:this.moveState.yawLeft=0;break;case 39:this.moveState.yawRight=0;break;case 81:this.moveState.rollLeft=0;break;case 69:this.moveState.rollRight=0}this.updateMovementVector();this.updateRotationVector()};this.mousedown=function(c){c.preventDefault();c.stopPropagation();if(this.dragToLook){this.mouseStatus++}else{switch(c.button){case 0:this.moveForward=!0;break;case 2:this.moveBackward=!0}}};this.mousemove=function(h){if(!this.dragToLook||this.mouseStatus>0){var n=this.getContainerDimensions(),m=n.size[0]/2,k=n.size[1]/2;this.moveState.yawLeft=-(h.clientX-n.offset[0]-m)/m;this.moveState.pitchDown=(h.clientY-n.offset[1]-k)/k;this.updateRotationVector()}};this.mouseup=function(c){c.preventDefault();c.stopPropagation();if(this.dragToLook){this.mouseStatus--,this.moveState.yawLeft=this.moveState.pitchDown=0}else{switch(c.button){case 0:this.moveForward=!1;break;case 2:this.moveBackward=!1}}this.updateRotationVector()};this.update=function(){var g=(new Date).getTime();if(this.lastUpdate==-1){this.lastUpdate=g}this.tdiff=(g-this.lastUpdate)/1000;this.lastUpdate=g;var g=this.tdiff*this.movementSpeed,h=this.tdiff*this.rollSpeed;this.translateX(this.moveVector.x*g);this.translateY(this.moveVector.y*g);this.translateZ(this.moveVector.z*g);this.tmpQuaternion.set(this.rotationVector.x*h,this.rotationVector.y*h,this.rotationVector.z*h,1).normalize();this.quaternion.multiplySelf(this.tmpQuaternion);this.matrix.setPosition(this.position);this.matrix.setRotationFromQuaternion(this.quaternion);this.matrixWorldNeedsUpdate=!0;this.supr.update.call(this)};this.updateMovementVector=function(){var c=this.moveState.forward||this.autoForward&&!this.moveState.back?1:0;this.moveVector.x=-this.moveState.left+this.moveState.right;this.moveVector.y=-this.moveState.down+this.moveState.up;this.moveVector.z=-c+this.moveState.back};this.updateRotationVector=function(){this.rotationVector.x=-this.moveState.pitchDown+this.moveState.pitchUp;this.rotationVector.y=-this.moveState.yawRight+this.moveState.yawLeft;this.rotationVector.z=-this.moveState.rollRight+this.moveState.rollLeft};this.getContainerDimensions=function(){return this.domElement!=document?{size:[this.domElement.offsetWidth,this.domElement.offsetHeight],offset:[this.domElement.offsetLeft,this.domElement.offsetTop]}:{size:[window.innerWidth,window.innerHeight],offset:[0,0]}};this.domElement.addEventListener("mousemove",f(this,this.mousemove),!1);this.domElement.addEventListener("mousedown",f(this,this.mousedown),!1);this.domElement.addEventListener("mouseup",f(this,this.mouseup),!1);window.addEventListener("keydown",f(this,this.keydown),!1);window.addEventListener("keyup",f(this,this.keyup),!1);this.updateMovementVector();this.updateRotationVector()};THREE.FlyCamera.prototype=new THREE.Camera;THREE.FlyCamera.prototype.constructor=THREE.FlyCamera;THREE.FlyCamera.prototype.supr=THREE.Camera.prototype;THREE.RollCamera=function(J,I,H,G){THREE.Camera.call(this,J,I,H,G);this.mouseLook=!0;this.autoForward=!1;this.rollSpeed=this.movementSpeed=this.lookSpeed=1;this.constrainVertical=[-0.9,0.9];this.domElement=document;this.matrixAutoUpdate=this.useTarget=!1;this.forward=new THREE.Vector3(0,0,1);this.roll=0;this.lastUpdate=-1;this.delta=0;var F=new THREE.Vector3,D=new THREE.Vector3,E=new THREE.Vector3,C=new THREE.Matrix4,z=!1,A=1,y=0,N=0,M=0,O=0,L=0,K=window.innerWidth/2,n=window.innerHeight/2;this.update=function(){var c=(new Date).getTime();if(this.lastUpdate==-1){this.lastUpdate=c}this.delta=(c-this.lastUpdate)/1000;this.lastUpdate=c;this.mouseLook&&(c=this.delta*this.lookSpeed,this.rotateHorizontally(c*O),this.rotateVertically(c*L));c=this.delta*this.movementSpeed;this.translateZ(c*(y>0||this.autoForward&&!(y<0)?1:y));this.translateX(c*N);this.translateY(c*M);z&&(this.roll+=this.rollSpeed*this.delta*A);if(this.forward.y>this.constrainVertical[1]){this.forward.y=this.constrainVertical[1],this.forward.normalize()}else{if(this.forward.y<this.constrainVertical[0]){this.forward.y=this.constrainVertical[0],this.forward.normalize()}}E.copy(this.forward);D.set(0,1,0);F.cross(D,E).normalize();D.cross(E,F).normalize();this.matrix.n11=F.x;this.matrix.n12=D.x;this.matrix.n13=E.x;this.matrix.n21=F.y;this.matrix.n22=D.y;this.matrix.n23=E.y;this.matrix.n31=F.z;this.matrix.n32=D.z;this.matrix.n33=E.z;C.identity();C.n11=Math.cos(this.roll);C.n12=-Math.sin(this.roll);C.n21=Math.sin(this.roll);C.n22=Math.cos(this.roll);this.matrix.multiplySelf(C);this.matrixWorldNeedsUpdate=!0;this.matrix.n14=this.position.x;this.matrix.n24=this.position.y;this.matrix.n34=this.position.z;this.supr.update.call(this)};this.translateX=function(c){this.position.x+=this.matrix.n11*c;this.position.y+=this.matrix.n21*c;this.position.z+=this.matrix.n31*c};this.translateY=function(c){this.position.x+=this.matrix.n12*c;this.position.y+=this.matrix.n22*c;this.position.z+=this.matrix.n32*c};this.translateZ=function(c){this.position.x-=this.matrix.n13*c;this.position.y-=this.matrix.n23*c;this.position.z-=this.matrix.n33*c};this.rotateHorizontally=function(c){F.set(this.matrix.n11,this.matrix.n21,this.matrix.n31);F.multiplyScalar(c);this.forward.subSelf(F);this.forward.normalize()};this.rotateVertically=function(c){D.set(this.matrix.n12,this.matrix.n22,this.matrix.n32);D.multiplyScalar(c);this.forward.addSelf(D);this.forward.normalize()};this.domElement.addEventListener("contextmenu",function(c){c.preventDefault()},!1);this.domElement.addEventListener("mousemove",function(c){O=(c.clientX-K)/window.innerWidth;L=(c.clientY-n)/window.innerHeight},!1);this.domElement.addEventListener("mousedown",function(c){c.preventDefault();c.stopPropagation();switch(c.button){case 0:y=1;break;case 2:y=-1}},!1);this.domElement.addEventListener("mouseup",function(c){c.preventDefault();c.stopPropagation();switch(c.button){case 0:y=0;break;case 2:y=0}},!1);this.domElement.addEventListener("keydown",function(c){switch(c.keyCode){case 38:case 87:y=1;break;case 37:case 65:N=-1;break;case 40:case 83:y=-1;break;case 39:case 68:N=1;break;case 81:z=!0;A=1;break;case 69:z=!0;A=-1;break;case 82:M=1;break;case 70:M=-1}},!1);this.domElement.addEventListener("keyup",function(c){switch(c.keyCode){case 38:case 87:y=0;break;case 37:case 65:N=0;break;case 40:case 83:y=0;break;case 39:case 68:N=0;break;case 81:z=!1;break;case 69:z=!1;break;case 82:M=0;break;case 70:M=0}},!1)};THREE.RollCamera.prototype=new THREE.Camera;THREE.RollCamera.prototype.constructor=THREE.RollCamera;THREE.RollCamera.prototype.supr=THREE.Camera.prototype;THREE.TrackballCamera=function(C){function B(e,f){return function(){f.apply(e,arguments)}}C=C||{};THREE.Camera.call(this,C.fov,C.aspect,C.near,C.far,C.target);this.domElement=C.domElement||document;this.screen=C.screen||{width:window.innerWidth,height:window.innerHeight,offsetLeft:0,offsetTop:0};this.radius=C.radius||(this.screen.width+this.screen.height)/4;this.rotateSpeed=C.rotateSpeed||1;this.zoomSpeed=C.zoomSpeed||1.2;this.panSpeed=C.panSpeed||0.3;this.noZoom=C.noZoom||!1;this.noPan=C.noPan||!1;this.staticMoving=C.staticMoving||!1;this.dynamicDampingFactor=C.dynamicDampingFactor||0.2;this.minDistance=C.minDistance||0;this.maxDistance=C.maxDistance||Infinity;this.keys=C.keys||[65,83,68];this.useTarget=!0;var A=!1,z=this.STATE.NONE,y=new THREE.Vector3,w=new THREE.Vector3,x=new THREE.Vector3,v=new THREE.Vector2,t=new THREE.Vector2,u=new THREE.Vector2,n=new THREE.Vector2;this.handleEvent=function(c){if(typeof this[c.type]=="function"){this[c.type](c)}};this.getMouseOnScreen=function(e,f){return new THREE.Vector2((e-this.screen.offsetLeft)/this.radius*0.5,(f-this.screen.offsetTop)/this.radius*0.5)};this.getMouseProjectionOnBall=function(g,k){var j=new THREE.Vector3((g-this.screen.width*0.5-this.screen.offsetLeft)/this.radius,(this.screen.height*0.5+this.screen.offsetTop-k)/this.radius,0),h=j.length();h>1?j.normalize():j.z=Math.sqrt(1-h*h);y=this.position.clone().subSelf(this.target.position);h=this.up.clone().setLength(j.y);h.addSelf(this.up.clone().crossSelf(y).setLength(j.x));h.addSelf(y.setLength(j.z));return h};this.rotateCamera=function(){var f=Math.acos(w.dot(x)/w.length()/x.length());if(f){var h=(new THREE.Vector3).cross(w,x).normalize(),g=new THREE.Quaternion;f*=this.rotateSpeed;g.setFromAxisAngle(h,-f);g.multiplyVector3(y);g.multiplyVector3(this.up);g.multiplyVector3(x);this.staticMoving?w=x:(g.setFromAxisAngle(h,f*(this.dynamicDampingFactor-1)),g.multiplyVector3(w))}};this.zoomCamera=function(){var c=1+(t.y-v.y)*this.zoomSpeed;c!==1&&c>0&&(y.multiplyScalar(c),this.staticMoving?v=t:v.y+=(t.y-v.y)*this.dynamicDampingFactor)};this.panCamera=function(){var e=n.clone().subSelf(u);if(e.lengthSq()){e.multiplyScalar(y.length()*this.panSpeed);var f=y.clone().crossSelf(this.up).setLength(e.x);f.addSelf(this.up.clone().setLength(e.y));this.position.addSelf(f);this.target.position.addSelf(f);this.staticMoving?u=n:u.addSelf(e.sub(n,u).multiplyScalar(this.dynamicDampingFactor))}};this.checkDistances=function(){if(!this.noZoom||!this.noPan){this.position.lengthSq()>this.maxDistance*this.maxDistance&&this.position.setLength(this.maxDistance),y.lengthSq()<this.minDistance*this.minDistance&&this.position.add(this.target.position,y.setLength(this.minDistance))}};this.update=function(f,h,g){y=this.position.clone().subSelf(this.target.position);this.rotateCamera();this.noZoom||this.zoomCamera();this.noPan||this.panCamera();this.position.add(this.target.position,y);this.checkDistances();this.supr.update.call(this,f,h,g)};this.domElement.addEventListener("contextmenu",function(c){c.preventDefault()},!1);this.domElement.addEventListener("mousemove",B(this,function(c){A&&(w=x=this.getMouseProjectionOnBall(c.clientX,c.clientY),v=t=this.getMouseOnScreen(c.clientX,c.clientY),u=n=this.getMouseOnScreen(c.clientX,c.clientY),A=!1);z!==this.STATE.NONE&&(z===this.STATE.ROTATE?x=this.getMouseProjectionOnBall(c.clientX,c.clientY):z===this.STATE.ZOOM&&!this.noZoom?t=this.getMouseOnScreen(c.clientX,c.clientY):z===this.STATE.PAN&&!this.noPan&&(n=this.getMouseOnScreen(c.clientX,c.clientY)))}),!1);this.domElement.addEventListener("mousedown",B(this,function(c){c.preventDefault();c.stopPropagation();if(z===this.STATE.NONE){z=c.button,z===this.STATE.ROTATE?w=x=this.getMouseProjectionOnBall(c.clientX,c.clientY):z===this.STATE.ZOOM&&!this.noZoom?v=t=this.getMouseOnScreen(c.clientX,c.clientY):this.noPan||(u=n=this.getMouseOnScreen(c.clientX,c.clientY))}}),!1);this.domElement.addEventListener("mouseup",B(this,function(c){c.preventDefault();c.stopPropagation();z=this.STATE.NONE}),!1);window.addEventListener("keydown",B(this,function(c){if(z===this.STATE.NONE){if(c.keyCode===this.keys[this.STATE.ROTATE]){z=this.STATE.ROTATE}else{if(c.keyCode===this.keys[this.STATE.ZOOM]&&!this.noZoom){z=this.STATE.ZOOM}else{if(c.keyCode===this.keys[this.STATE.PAN]&&!this.noPan){z=this.STATE.PAN}}}z!==this.STATE.NONE&&(A=!0)}}),!1);window.addEventListener("keyup",B(this,function(){if(z!==this.STATE.NONE){z=this.STATE.NONE}}),!1)};THREE.TrackballCamera.prototype=new THREE.Camera;THREE.TrackballCamera.prototype.constructor=THREE.TrackballCamera;THREE.TrackballCamera.prototype.supr=THREE.Camera.prototype;THREE.TrackballCamera.prototype.STATE={NONE:-1,ROTATE:0,ZOOM:1,PAN:2};THREE.QuakeCamera=THREE.FirstPersonCamera;THREE.Curve=function(){};THREE.Curve.prototype.getPoint=function(){console.log("Warning, getPoint() not implemented!");return null};THREE.Curve.prototype.getPointAt=function(c){return this.getPoint(this.getUtoTmapping(c))};THREE.Curve.prototype.getPoints=function(f){f||(f=5);var h,g=[];for(h=0;h<=f;h++){g.push(this.getPoint(h/f))}return g};THREE.Curve.prototype.getSpacedPoints=function(f){f||(f=5);var h,g=[];for(h=0;h<=f;h++){g.push(this.getPointAt(h/f))}return g};THREE.Curve.prototype.getLength=function(){var c=this.getLengths();return c[c.length-1]};THREE.Curve.prototype.getLengths=function(h){h||(h=200);if(this.cacheArcLengths&&this.cacheArcLengths.length==h+1){return this.cacheArcLengths}var p=[],o,n=this.getPoint(0),m,k=0;p.push(0);for(m=1;m<=h;m++){o=this.getPoint(m/h),k+=o.distanceTo(n),p.push(k),n=o}return this.cacheArcLengths=p};THREE.Curve.prototype.getUtoTmapping=function(y,x){var w=this.getLengths(),v=0,u=w.length,p;p=x?x:y*w[u-1];time=Date.now();for(var t=0,n=u-1,m;t<=n;){if(v=Math.floor(t+(n-t)/2),m=w[v]-p,m<0){t=v+1}else{if(m>0){n=v-1}else{n=v;break}}}v=n;if(w[v]==p){return v/(u-1)}t=w[v];return w=(v+(p-t)/(w[v+1]-t))/(u-1)};THREE.Curve.prototype.getNormalVector=function(c){c=this.getTangent(c);return new THREE.Vector2(-c.y,c.x)};THREE.Curve.prototype.getTangent=function(f){var h=f-0.0001;f+=0.0001;h<0&&(h=0);f>1&&(f=1);var h=this.getPoint(h),f=this.getPoint(f),g=new THREE.Vector2;g.sub(f,h);return g.unit()};THREE.LineCurve=function(e,f){e instanceof THREE.Vector2?(this.v1=e,this.v2=f):THREE.LineCurve.oldConstructor.apply(this,arguments)};THREE.LineCurve.oldConstructor=function(g,k,j,h){this.constructor(new THREE.Vector2(g,k),new THREE.Vector2(j,h))};THREE.LineCurve.prototype=new THREE.Curve;THREE.LineCurve.prototype.constructor=THREE.LineCurve;THREE.LineCurve.prototype.getPoint=function(e){var f=new THREE.Vector2;f.sub(this.v2,this.v1);f.multiplyScalar(e).addSelf(this.v1);return f};THREE.LineCurve.prototype.getPointAt=function(c){return this.getPoint(c)};THREE.LineCurve.prototype.getTangent=function(){var c=new THREE.Vector2;c.sub(this.v2,this.v1);c.normalize();return c};THREE.QuadraticBezierCurve=function(g,k,j){if(!(k instanceof THREE.Vector2)){var h=Array.prototype.slice.call(arguments),g=new THREE.Vector2(h[0],h[1]),k=new THREE.Vector2(h[2],h[3]),j=new THREE.Vector2(h[4],h[5])}this.v0=g;this.v1=k;this.v2=j};THREE.QuadraticBezierCurve.prototype=new THREE.Curve;THREE.QuadraticBezierCurve.prototype.constructor=THREE.QuadraticBezierCurve;THREE.QuadraticBezierCurve.prototype.getPoint=function(e){var f;f=THREE.Shape.Utils.b2(e,this.v0.x,this.v1.x,this.v2.x);e=THREE.Shape.Utils.b2(e,this.v0.y,this.v1.y,this.v2.y);return new THREE.Vector2(f,e)};THREE.QuadraticBezierCurve.prototype.getTangent=function(e){var f;f=THREE.Curve.Utils.tangentQuadraticBezier(e,this.v0.x,this.v1.x,this.v2.x);e=THREE.Curve.Utils.tangentQuadraticBezier(e,this.v0.y,this.v1.y,this.v2.y);f=new THREE.Vector2(f,e);f.normalize();return f};THREE.CubicBezierCurve=function(h,n,m,k){if(!(n instanceof THREE.Vector2)){var j=Array.prototype.slice.call(arguments),h=new THREE.Vector2(j[0],j[1]),n=new THREE.Vector2(j[2],j[3]),m=new THREE.Vector2(j[4],j[5]),k=new THREE.Vector2(j[6],j[7])}this.v0=h;this.v1=n;this.v2=m;this.v3=k};THREE.CubicBezierCurve.prototype=new THREE.Curve;THREE.CubicBezierCurve.prototype.constructor=THREE.CubicBezierCurve;THREE.CubicBezierCurve.prototype.getPoint=function(e){var f;f=THREE.Shape.Utils.b3(e,this.v0.x,this.v1.x,this.v2.x,this.v3.x);e=THREE.Shape.Utils.b3(e,this.v0.y,this.v1.y,this.v2.y,this.v3.y);return new THREE.Vector2(f,e)};THREE.CubicBezierCurve.prototype.getTangent=function(e){var f;f=THREE.Curve.Utils.tangentCubicBezier(e,this.v0.x,this.v1.x,this.v2.x,this.v3.x);e=THREE.Curve.Utils.tangentCubicBezier(e,this.v0.y,this.v1.y,this.v2.y,this.v3.y);f=new THREE.Vector2(f,e);f.normalize();return f};THREE.SplineCurve=function(c){this.points=c};THREE.SplineCurve.prototype=new THREE.Curve;THREE.SplineCurve.prototype.constructor=THREE.SplineCurve;THREE.SplineCurve.prototype.getPoint=function(h){var n=new THREE.Vector2,m=[],k=this.points,j;j=(k.length-1)*h;h=Math.floor(j);j-=h;m[0]=h==0?h:h-1;m[1]=h;m[2]=h>k.length-2?h:h+1;m[3]=h>k.length-3?h:h+2;n.x=THREE.Curve.Utils.interpolate(k[m[0]].x,k[m[1]].x,k[m[2]].x,k[m[3]].x,j);n.y=THREE.Curve.Utils.interpolate(k[m[0]].y,k[m[1]].y,k[m[2]].y,k[m[3]].y,j);return n};THREE.ArcCurve=function(h,p,o,n,m,k){this.aX=h;this.aY=p;this.aRadius=o;this.aStartAngle=n;this.aEndAngle=m;this.aClockwise=k};THREE.ArcCurve.prototype=new THREE.Curve;THREE.ArcCurve.prototype.constructor=THREE.ArcCurve;THREE.ArcCurve.prototype.getPoint=function(e){var f=this.aEndAngle-this.aStartAngle;this.aClockwise||(e=1-e);e=this.aStartAngle+e*f;return new THREE.Vector2(this.aX+this.aRadius*Math.cos(e),this.aY+this.aRadius*Math.sin(e))};THREE.Curve.Utils={tangentQuadraticBezier:function(g,k,j,h){return 2*(1-g)*(j-k)+2*g*(h-j)},tangentCubicBezier:function(h,n,m,k,j){return -3*n*(1-h)*(1-h)+3*m*(1-h)*(1-h)-6*h*m*(1-h)+6*h*k*(1-h)-3*h*h*k+3*h*h*j},tangentSpline:function(c){return 6*c*c-6*c+(3*c*c-4*c+1)+(-6*c*c+6*c)+(3*c*c-2*c)},interpolate:function(h,p,o,n,m){var h=(o-h)*0.5,n=(n-p)*0.5,k=m*m;return(2*p-2*o+h+n)*m*k+(-3*p+3*o-2*h-n)*k+h*m+p}};THREE.Curve.create=function(e,f){e.prototype=new THREE.Curve;e.prototype.constructor=e;e.prototype.getPoint=f;return e};THREE.LineCurve3=THREE.Curve.create(function(e,f){this.v1=e;this.v2=f},function(e){var f=new THREE.Vector3;f.sub(v2,v1);f.multiplyScalar(e);f.addSelf(this.v1);return f});THREE.QuadraticBezierCurve3=THREE.Curve.create(function(f,h,g){this.v0=f;this.v1=h;this.v2=g},function(f){var h,g;h=THREE.Shape.Utils.b2(f,this.v0.x,this.v1.x,this.v2.x);g=THREE.Shape.Utils.b2(f,this.v0.y,this.v1.y,this.v2.y);f=THREE.Shape.Utils.b2(f,this.v0.z,this.v1.z,this.v2.z);return new THREE.Vector3(h,g,f)});THREE.CurvePath=function(){this.curves=[];this.bends=[]};THREE.CurvePath.prototype=new THREE.Curve;THREE.CurvePath.prototype.constructor=THREE.CurvePath;THREE.CurvePath.prototype.add=function(c){this.curves.push(c)};THREE.CurvePath.prototype.checkConnection=function(){};THREE.CurvePath.prototype.closePath=function(){};THREE.CurvePath.prototype.getPoint=function(f){for(var h=f*this.getLength(),g=this.getCurveLengths(),f=0;f<g.length;){if(g[f]>=h){return h=g[f]-h,f=this.curves[f],h=1-h/f.getLength(),f.getPointAt(h)}f++}return null};THREE.CurvePath.prototype.getLength=function(){var c=this.getCurveLengths();return c[c.length-1]};THREE.CurvePath.prototype.getCurveLengths=function(){if(this.cacheLengths&&this.cacheLengths.length==this.curves.length){return this.cacheLengths}var g=[],k=0,j,h=this.curves.length;for(j=0;j<h;j++){k+=this.curves[j].getLength(),g.push(k)}return this.cacheLengths=g};THREE.CurvePath.prototype.getBoundingBox=function(){var y=this.getPoints(),x,w,v,u;x=w=Number.NEGATIVE_INFINITY;v=u=Number.POSITIVE_INFINITY;var p,t,n,m;m=new THREE.Vector2;t=0;for(n=y.length;t<n;t++){p=y[t];if(p.x>x){x=p.x}else{if(p.x<v){v=p.x}}if(p.y>w){w=p.y}else{if(p.y<w){u=p.y}}m.addSelf(p.x,p.y)}return{minX:v,minY:u,maxX:x,maxY:w,centroid:m.divideScalar(n)}};THREE.CurvePath.prototype.createPointsGeometry=function(c){return this.createGeometry(this.getPoints(c,!0))};THREE.CurvePath.prototype.createSpacedPointsGeometry=function(c){return this.createGeometry(this.getSpacedPoints(c,!0))};THREE.CurvePath.prototype.createGeometry=function(f){for(var h=new THREE.Geometry,g=0;g<f.length;g++){h.vertices.push(new THREE.Vertex(new THREE.Vector3(f[g].x,f[g].y,0)))}return h};THREE.CurvePath.prototype.addWrapPath=function(c){this.bends.push(c)};THREE.CurvePath.prototype.getTransformedPoints=function(h,n){var m=this.getPoints(h),k,j;if(!n){n=this.bends}k=0;for(j=n.length;k<j;k++){m=this.getWrapPoints(m,n[k])}return m};THREE.CurvePath.prototype.getTransformedSpacedPoints=function(h,n){var m=this.getSpacedPoints(h),k,j;if(!n){n=this.bends}k=0;for(j=n.length;k<j;k++){m=this.getWrapPoints(m,n[k])}return m};THREE.CurvePath.prototype.getWrapPoints=function(y,x){var w=this.getBoundingBox(),v,u,p,t,n,m;v=0;for(u=y.length;v<u;v++){p=y[v],t=p.x,n=p.y,m=t/w.maxX,m=x.getUtoTmapping(m,t),t=x.getPoint(m),n=x.getNormalVector(m).multiplyScalar(n),p.x=t.x+n.x,p.y=t.y+n.y}return y};THREE.Path=function(c){THREE.CurvePath.call(this);this.actions=[];c&&this.fromPoints(c)};THREE.Path.prototype=new THREE.CurvePath;THREE.Path.prototype.constructor=THREE.Path;THREE.PathActions={MOVE_TO:"moveTo",LINE_TO:"lineTo",QUADRATIC_CURVE_TO:"quadraticCurveTo",BEZIER_CURVE_TO:"bezierCurveTo",CSPLINE_THRU:"splineThru",ARC:"arc"};THREE.Path.prototype.fromPoints=function(f){this.moveTo(f[0].x,f[0].y);var h,g=f.length;for(h=1;h<g;h++){this.lineTo(f[h].x,f[h].y)}};THREE.Path.prototype.moveTo=function(){var c=Array.prototype.slice.call(arguments);this.actions.push({action:THREE.PathActions.MOVE_TO,args:c})};THREE.Path.prototype.lineTo=function(g,k){var j=Array.prototype.slice.call(arguments),h=this.actions[this.actions.length-1].args;this.curves.push(new THREE.LineCurve(new THREE.Vector2(h[h.length-2],h[h.length-1]),new THREE.Vector2(g,k)));this.actions.push({action:THREE.PathActions.LINE_TO,args:j})};THREE.Path.prototype.quadraticCurveTo=function(h,p,o,n){var m=Array.prototype.slice.call(arguments),k=this.actions[this.actions.length-1].args;this.curves.push(new THREE.QuadraticBezierCurve(new THREE.Vector2(k[k.length-2],k[k.length-1]),new THREE.Vector2(h,p),new THREE.Vector2(o,n)));this.actions.push({action:THREE.PathActions.QUADRATIC_CURVE_TO,args:m})};THREE.Path.prototype.bezierCurveTo=function(m,w,v,u,t,o){var p=Array.prototype.slice.call(arguments),n=this.actions[this.actions.length-1].args;this.curves.push(new THREE.CubicBezierCurve(new THREE.Vector2(n[n.length-2],n[n.length-1]),new THREE.Vector2(m,w),new THREE.Vector2(v,u),new THREE.Vector2(t,o)));this.actions.push({action:THREE.PathActions.BEZIER_CURVE_TO,args:p})};THREE.Path.prototype.splineThru=function(f){var h=Array.prototype.slice.call(arguments),g=this.actions[this.actions.length-1].args,g=[new THREE.Vector2(g[g.length-2],g[g.length-1])],g=g.concat(f);this.curves.push(new THREE.SplineCurve(g));this.actions.push({action:THREE.PathActions.CSPLINE_THRU,args:h})};THREE.Path.prototype.arc=function(k,u,t,p,o,m){var n=Array.prototype.slice.call(arguments);this.curves.push(new THREE.ArcCurve(k,u,t,p,o,m));this.actions.push({action:THREE.PathActions.ARC,args:n})};THREE.Path.prototype.getSpacedPoints=function(f){f||(f=40);for(var h=[],g=0;g<f;g++){h.push(this.getPoint(g/f))}return h};THREE.Path.prototype.getPoints=function(J,I){var J=J||12,H=[],G,F,D,E,C,z,A,y,N,M,O,L,K;G=0;for(F=this.actions.length;G<F;G++){switch(D=this.actions[G],E=D.action,D=D.args,E){case THREE.PathActions.LINE_TO:H.push(new THREE.Vector2(D[0],D[1]));break;case THREE.PathActions.QUADRATIC_CURVE_TO:C=D[2];z=D[3];N=D[0];M=D[1];H.length>0?(E=H[H.length-1],O=E.x,L=E.y):(E=this.actions[G-1].args,O=E[E.length-2],L=E[E.length-1]);for(E=1;E<=J;E++){K=E/J,D=THREE.Shape.Utils.b2(K,O,N,C),K=THREE.Shape.Utils.b2(K,L,M,z),H.push(new THREE.Vector2(D,K))}break;case THREE.PathActions.BEZIER_CURVE_TO:C=D[4];z=D[5];N=D[0];M=D[1];A=D[2];y=D[3];H.length>0?(E=H[H.length-1],O=E.x,L=E.y):(E=this.actions[G-1].args,O=E[E.length-2],L=E[E.length-1]);for(E=1;E<=J;E++){K=E/J,D=THREE.Shape.Utils.b3(K,O,N,A,C),K=THREE.Shape.Utils.b3(K,L,M,y,z),H.push(new THREE.Vector2(D,K))}break;case THREE.PathActions.CSPLINE_THRU:E=this.actions[G-1].args;E=[new THREE.Vector2(E[E.length-2],E[E.length-1])];K=J*D[0].length;E=E.concat(D[0]);D=new THREE.SplineCurve(E);for(E=1;E<=K;E++){H.push(D.getPointAt(E/K))}break;case THREE.PathActions.ARC:E=this.actions[G-1].args;C=D[0];z=D[1];A=D[2];N=D[3];K=D[4];M=!!D[5];y=E[E.length-2];O=E[E.length-1];E.length==0&&(y=O=0);L=K-N;var n=J*2;for(E=1;E<=n;E++){K=E/n,M||(K=1-K),K=N+K*L,D=y+C+A*Math.cos(K),K=O+z+A*Math.sin(K),H.push(new THREE.Vector2(D,K))}}}I&&H.push(H[0]);return H};THREE.Path.prototype.transform=function(e,f){this.getBoundingBox();return this.getWrapPoints(this.getPoints(f),e)};THREE.Path.prototype.nltransform=function(D,C,B,A,z,x){var y=this.getPoints(),w,t,v,n,E;w=0;for(t=y.length;w<t;w++){v=y[w],n=v.x,E=v.y,v.x=D*n+C*E+B,v.y=A*E+z*n+x}return y};THREE.Path.prototype.debug=function(h){var n=this.getBoundingBox();h||(h=document.createElement("canvas"),h.setAttribute("width",n.maxX+100),h.setAttribute("height",n.maxY+100),document.body.appendChild(h));n=h.getContext("2d");n.fillStyle="white";n.fillRect(0,0,h.width,h.height);n.strokeStyle="black";n.beginPath();var m,k,j,h=0;for(m=this.actions.length;h<m;h++){k=this.actions[h],j=k.args,k=k.action,k!=THREE.PathActions.CSPLINE_THRU&&n[k].apply(n,j)}n.stroke();n.closePath();n.strokeStyle="red";k=this.getPoints();h=0;for(m=k.length;h<m;h++){j=k[h],n.beginPath(),n.arc(j.x,j.y,1.5,0,Math.PI*2,!1),n.stroke(),n.closePath()}};THREE.Path.prototype.toShapes=function(){var k,u,t,p,o=[],m=new THREE.Path;k=0;for(u=this.actions.length;k<u;k++){t=this.actions[k],p=t.args,t=t.action,t==THREE.PathActions.MOVE_TO&&m.actions.length!=0&&(o.push(m),m=new THREE.Path),m[t].apply(m,p)}m.actions.length!=0&&o.push(m);if(o.length==0){return[]}var n,m=[];if(THREE.Shape.Utils.isClockWise(o[0].getPoints())){k=0;for(u=o.length;k<u;k++){p=o[k],THREE.Shape.Utils.isClockWise(p.getPoints())?(n&&m.push(n),n=new THREE.Shape,n.actions=p.actions,n.curves=p.curves):n.holes.push(p)}m.push(n)}else{n=new THREE.Shape;k=0;for(u=o.length;k<u;k++){p=o[k],THREE.Shape.Utils.isClockWise(p.getPoints())?(n.actions=p.actions,n.curves=p.curves,m.push(n),n=new THREE.Shape):n.holes.push(p)}}return m};THREE.Shape=function(){THREE.Path.apply(this,arguments);this.holes=[]};THREE.Shape.prototype=new THREE.Path;THREE.Shape.prototype.constructor=THREE.Path;THREE.Shape.prototype.extrude=function(c){return new THREE.ExtrudeGeometry(this,c)};THREE.Shape.prototype.getPointsHoles=function(g){var k,j=this.holes.length,h=[];for(k=0;k<j;k++){h[k]=this.holes[k].getTransformedPoints(g,this.bends)}return h};THREE.Shape.prototype.getSpacedPointsHoles=function(g){var k,j=this.holes.length,h=[];for(k=0;k<j;k++){h[k]=this.holes[k].getTransformedSpacedPoints(g,this.bends)}return h};THREE.Shape.prototype.extractAllPoints=function(c){return{shape:this.getTransformedPoints(c),holes:this.getPointsHoles(c)}};THREE.Shape.prototype.extractAllSpacedPoints=function(c){return{shape:this.getTransformedSpacedPoints(c),holes:this.getSpacedPointsHoles(c)}};THREE.Shape.Utils={removeHoles:function(J,I){var H=J.concat(),G=H.concat(),F,D,E,C,z,A,y,N,M,O,L=[];for(z=0;z<I.length;z++){A=I[z];G=G.concat(A);D=Number.POSITIVE_INFINITY;for(F=0;F<A.length;F++){M=A[F];O=[];for(N=0;N<H.length;N++){y=H[N],y=M.distanceToSquared(y),O.push(y),y<D&&(D=y,E=F,C=N)}}F=C-1>=0?C-1:H.length-1;D=E-1>=0?E-1:A.length-1;var K=[A[E],H[C],H[F]];N=THREE.FontUtils.Triangulate.area(K);var n=[A[E],A[D],H[C]];M=THREE.FontUtils.Triangulate.area(n);O=C;y=E;C+=1;E+=-1;C<0&&(C+=H.length);C%=H.length;E<0&&(E+=A.length);E%=A.length;F=C-1>=0?C-1:H.length-1;D=E-1>=0?E-1:A.length-1;K=[A[E],H[C],H[F]];K=THREE.FontUtils.Triangulate.area(K);n=[A[E],A[D],H[C]];n=THREE.FontUtils.Triangulate.area(n);N+M>K+n&&(C=O,E=y,C<0&&(C+=H.length),C%=H.length,E<0&&(E+=A.length),E%=A.length,F=C-1>=0?C-1:H.length-1,D=E-1>=0?E-1:A.length-1);N=H.slice(0,C);M=H.slice(C);O=A.slice(E);y=A.slice(0,E);D=[A[E],A[D],H[C]];L.push([A[E],H[C],H[F]]);L.push(D);H=N.concat(O).concat(y).concat(M)}return{shape:H,isolatedPts:L,allpoints:G}},triangulateShape:function(A,z){var y=THREE.Shape.Utils.removeHoles(A,z),x=y.allpoints,w=y.isolatedPts,y=THREE.FontUtils.Triangulate(y.shape,!1),u,v,t,n,p={};u=0;for(v=x.length;u<v;u++){n=x[u].x+":"+x[u].y,p[n]!==void 0&&console.log("Duplicate point",n),p[n]=u}u=0;for(v=y.length;u<v;u++){t=y[u];for(x=0;x<3;x++){n=t[x].x+":"+t[x].y,n=p[n],n!==void 0&&(t[x]=n)}}u=0;for(v=w.length;u<v;u++){t=w[u];for(x=0;x<3;x++){n=t[x].x+":"+t[x].y,n=p[n],n!==void 0&&(t[x]=n)}}return y.concat(w)},isClockWise:function(c){return THREE.FontUtils.Triangulate.area(c)<0},b2p0:function(f,h){var g=1-f;return g*g*h},b2p1:function(e,f){return 2*(1-e)*e*f},b2p2:function(e,f){return e*e*f},b2:function(g,k,j,h){return this.b2p0(g,k)+this.b2p1(g,j)+this.b2p2(g,h)},b3p0:function(f,h){var g=1-f;return g*g*g*h},b3p1:function(f,h){var g=1-f;return 3*g*g*f*h},b3p2:function(e,f){return 3*(1-e)*e*e*f},b3p3:function(e,f){return e*e*e*f},b3:function(h,n,m,k,j){return this.b3p0(h,n)+this.b3p1(h,m)+this.b3p2(h,k)+this.b3p3(h,j)}};THREE.TextPath=function(e,f){THREE.Path.call(this);this.parameters=f||{};this.set(e)};THREE.TextPath.prototype.set=function(h,p){this.text=h;var p=p||this.parameters,o=p.curveSegments!==void 0?p.curveSegments:4,n=p.font!==void 0?p.font:"helvetiker",m=p.weight!==void 0?p.weight:"normal",k=p.style!==void 0?p.style:"normal";THREE.FontUtils.size=p.size!==void 0?p.size:100;THREE.FontUtils.divisions=o;THREE.FontUtils.face=n;THREE.FontUtils.weight=m;THREE.FontUtils.style=k};THREE.TextPath.prototype.toShapes=function(){for(var g=THREE.FontUtils.drawText(this.text).paths,k=[],j=0,h=g.length;j<h;j++){k=k.concat(g[j].toShapes())}return k};THREE.CubeGeometry=function(H,G,F,E,D,B,C,A,y){function z(ae,ad,ac,ab,aa,Z,U,S){var Q,P,O=E||1,N=D||1,j=aa/2,T=Z/2,Y=n.vertices.length;if(ae=="x"&&ad=="y"||ae=="y"&&ad=="x"){Q="z"}else{if(ae=="x"&&ad=="z"||ae=="z"&&ad=="x"){Q="y",N=B||1}else{if(ae=="z"&&ad=="y"||ae=="y"&&ad=="z"){Q="x",O=B||1}}}var f=O+1,g=N+1;aa/=O;var X=Z/N;for(P=0;P<g;P++){for(Z=0;Z<f;Z++){var p=new THREE.Vector3;p[ae]=(Z*aa-j)*ac;p[ad]=(P*X-T)*ab;p[Q]=U;n.vertices.push(new THREE.Vertex(p))}}for(P=0;P<N;P++){for(Z=0;Z<O;Z++){n.faces.push(new THREE.Face4(Z+f*P+Y,Z+f*(P+1)+Y,Z+1+f*(P+1)+Y,Z+1+f*P+Y,null,null,S)),n.faceVertexUvs[0].push([new THREE.UV(Z/O,P/N),new THREE.UV(Z/O,(P+1)/N),new THREE.UV((Z+1)/O,(P+1)/N),new THREE.UV((Z+1)/O,P/N)])}}}THREE.Geometry.call(this);var n=this,L=H/2,K=G/2,M=F/2,A=A?-1:1;if(C!==void 0){if(C instanceof Array){this.materials=C}else{this.materials=[];for(var J=0;J<6;J++){this.materials.push([C])}}}else{this.materials=[]}this.sides={px:!0,nx:!0,py:!0,ny:!0,pz:!0,nz:!0};if(y!=void 0){for(var I in y){this.sides[I]!=void 0&&(this.sides[I]=y[I])}}this.sides.px&&z("z","y",1*A,-1,F,G,-L,this.materials[0]);this.sides.nx&&z("z","y",-1*A,-1,F,G,L,this.materials[1]);this.sides.py&&z("x","z",1*A,1,H,F,K,this.materials[2]);this.sides.ny&&z("x","z",1*A,-1,H,F,-K,this.materials[3]);this.sides.pz&&z("x","y",1*A,-1,H,G,M,this.materials[4]);this.sides.nz&&z("x","y",-1*A,-1,H,G,-M,this.materials[5]);(function(){for(var O=[],N=[],x=0,w=n.vertices.length;x<w;x++){for(var v=n.vertices[x],u=!1,t=0,p=O.length;t<p;t++){var o=O[t];if(v.position.x==o.position.x&&v.position.y==o.position.y&&v.position.z==o.position.z){N[x]=t;u=!0;break}}if(!u){N[x]=O.length,O.push(new THREE.Vertex(v.position.clone()))}}x=0;for(w=n.faces.length;x<w;x++){v=n.faces[x],v.a=N[v.a],v.b=N[v.b],v.c=N[v.c],v.d=N[v.d]}n.vertices=O})();this.computeCentroids();this.computeFaceNormals()};THREE.CubeGeometry.prototype=new THREE.Geometry;THREE.CubeGeometry.prototype.constructor=THREE.CubeGeometry;THREE.CylinderGeometry=function(D,C,B,A,z,x){function y(f,h,g){w.vertices.push(new THREE.Vertex(new THREE.Vector3(f,h,g)))}THREE.Geometry.call(this);var w=this,t,v=Math.PI*2,n=A/2;for(t=0;t<D;t++){y(Math.sin(v*t/D)*C,Math.cos(v*t/D)*C,-n)}for(t=0;t<D;t++){y(Math.sin(v*t/D)*B,Math.cos(v*t/D)*B,n)}for(t=0;t<D;t++){w.faces.push(new THREE.Face4(t,t+D,D+(t+1)%D,(t+1)%D))}if(B>0){y(0,0,-n-(x||0));for(t=D;t<D+D/2;t++){w.faces.push(new THREE.Face4(2*D,(2*t-2*D)%D,(2*t-2*D+1)%D,(2*t-2*D+2)%D))}}if(C>0){y(0,0,n+(z||0));for(t=D+D/2;t<2*D;t++){w.faces.push(new THREE.Face4(2*D+1,(2*t-2*D+2)%D+D,(2*t-2*D+1)%D+D,(2*t-2*D)%D+D))}}t=0;for(D=this.faces.length;t<D;t++){var C=[],B=this.faces[t],z=this.vertices[B.a],x=this.vertices[B.b],n=this.vertices[B.c],E=this.vertices[B.d];C.push(new THREE.UV(0.5+Math.atan2(z.position.x,z.position.y)/v,0.5+z.position.z/A));C.push(new THREE.UV(0.5+Math.atan2(x.position.x,x.position.y)/v,0.5+x.position.z/A));C.push(new THREE.UV(0.5+Math.atan2(n.position.x,n.position.y)/v,0.5+n.position.z/A));B instanceof THREE.Face4&&C.push(new THREE.UV(0.5+Math.atan2(E.position.x,E.position.y)/v,0.5+E.position.z/A));this.faceVertexUvs[0].push(C)}this.computeCentroids();this.computeFaceNormals()};THREE.CylinderGeometry.prototype=new THREE.Geometry;THREE.CylinderGeometry.prototype.constructor=THREE.CylinderGeometry;THREE.ExtrudeGeometry=function(h,n){if(typeof h!="undefined"){THREE.Geometry.call(this);var h=h instanceof Array?h:[h],m,k=h.length,j;for(m=0;m<k;m++){j=h[m],this.addShape(j,n)}}};THREE.ExtrudeGeometry.prototype=new THREE.Geometry;THREE.ExtrudeGeometry.prototype.constructor=THREE.ExtrudeGeometry;THREE.ExtrudeGeometry.prototype.addShape=function(aE,aD){function aC(f,h,g){h||console.log("die");return h.clone().multiplyScalar(g).addSelf(f)}function aB(y,x,w){var v=THREE.ExtrudeGeometry.__v1,u=THREE.ExtrudeGeometry.__v2,t=THREE.ExtrudeGeometry.__v3,p=THREE.ExtrudeGeometry.__v4,o=THREE.ExtrudeGeometry.__v5,n=THREE.ExtrudeGeometry.__v6;v.set(y.x-x.x,y.y-x.y);u.set(y.x-w.x,y.y-w.y);v=v.normalize();u=u.normalize();t.set(-v.y,v.x);p.set(u.y,-u.x);o.copy(y).addSelf(t);n.copy(y).addSelf(p);if(o.equals(n)){return p.clone()}o.copy(x).addSelf(t);n.copy(w).addSelf(p);t=v.dot(p);p=n.subSelf(o).dot(p);t==0&&(console.log("Either infinite or no solutions!"),p==0?console.log("Its finite solutions."):console.log("Too bad, no solutions."));p/=t;if(p<0){return x=Math.atan2(x.y-y.y,x.x-y.x),y=Math.atan2(w.y-y.y,w.x-y.x),x>y&&(y+=Math.PI*2),anglec=(x+y)/2,new THREE.Vector2(-Math.cos(anglec),-Math.sin(anglec))}return v.multiplyScalar(p).addSelf(o).subSelf(y).clone()}function aA(j){for(ag=j.length;--ag>=0;){P=ag;O=ag-1;O<0&&(O=j.length-1);for(var p=0,p=0;p<ar+at*2;p++){var o=av*p,n=av*(p+1),m=ak+P+o,o=ak+O+o,k=ak+O+n,n=ak+P+n;m+=aa;o+=aa;k+=aa;n+=aa;af.faces.push(new THREE.Face4(m,o,k,n))}}}function ay(f,h,g){af.vertices.push(new THREE.Vertex(new THREE.Vector3(f,h,g)))}function az(f,h,g){f+=aa;h+=aa;g+=aa;af.faces.push(new THREE.Face3(f,h,g))}var ax=aD.amount!==void 0?aD.amount:100,au=aD.bevelThickness!==void 0?aD.bevelThickness:6,aw=aD.bevelSize!==void 0?aD.bevelSize:au-2,at=aD.bevelSegments!==void 0?aD.bevelSegments:3,aq=aD.bevelEnabled!==void 0?aD.bevelEnabled:!0,ap=aD.curveSegments!==void 0?aD.curveSegments:12,ar=aD.steps!==void 0?aD.steps:1,ao=aD.bendPath,an=aD.extrudePath,ai,aj=!1,ad=aD.useSpacedPoints!==void 0?aD.useSpacedPoints:!1;if(an){ai=an.getPoints(ap),ar=ai.length,aj=!0,aq=!1}aq||(aw=au=at=0);var am,ae,ac,af=this,aa=this.vertices.length;ao&&aE.addWrapPath(ao);ap=ad?aE.extractAllSpacedPoints(ap):aE.extractAllPoints(ap);ao=ap.shape;ap=ap.holes;if(an=!THREE.Shape.Utils.isClockWise(ao)){ao=ao.reverse();ae=0;for(ac=ap.length;ae<ac;ae++){am=ap[ae],THREE.Shape.Utils.isClockWise(am)&&(ap[ae]=am.reverse())}an=!1}an=THREE.Shape.Utils.triangulateShape(ao,ap);ad=ao;ae=0;for(ac=ap.length;ae<ac;ae++){am=ap[ae],ao=ao.concat(am)}var ag,ab,Q,F,Y,ah,av=ao.length,M=an.length,N=[];ag=0;ab=ad.length;P=ab-1;for(O=ag+1;ag<ab;ag++,P++,O++){P==ab&&(P=0),O==ab&&(O=0),N[ag]=aB(ad[ag],ad[P],ad[O])}var al=[],Z,z=N.concat();ae=0;for(ac=ap.length;ae<ac;ae++){am=ap[ae];Z=[];ag=0;ab=am.length;P=ab-1;for(O=ag+1;ag<ab;ag++,P++,O++){P==ab&&(P=0),O==ab&&(O=0),Z[ag]=aB(am[ag],am[P],am[O])}al.push(Z);z=z.concat(Z)}for(Q=0;Q<at;Q++){F=Q/at;Y=au*(1-F);F=aw*Math.sin(F*Math.PI/2);ag=0;for(ab=ad.length;ag<ab;ag++){ah=aC(ad[ag],N[ag],F),ay(ah.x,ah.y,-Y)}ae=0;for(ac=ap.length;ae<ac;ae++){am=ap[ae];Z=al[ae];ag=0;for(ab=am.length;ag<ab;ag++){ah=aC(am[ag],Z[ag],F),ay(ah.x,ah.y,-Y)}}}F=aw;for(ag=0;ag<av;ag++){ah=aq?aC(ao[ag],z[ag],F):ao[ag],aj?ay(ah.x,ah.y+ai[0].y,ai[0].x):ay(ah.x,ah.y,0)}for(Q=1;Q<=ar;Q++){for(ag=0;ag<av;ag++){ah=aq?aC(ao[ag],z[ag],F):ao[ag],aj?ay(ah.x,ah.y+ai[Q-1].y,ai[Q-1].x):ay(ah.x,ah.y,ax/ar*Q)}}for(Q=at-1;Q>=0;Q--){F=Q/at;Y=au*(1-F);F=aw*Math.sin(F*Math.PI/2);ag=0;for(ab=ad.length;ag<ab;ag++){ah=aC(ad[ag],N[ag],F),ay(ah.x,ah.y,ax+Y)}ae=0;for(ac=ap.length;ae<ac;ae++){am=ap[ae];Z=al[ae];ag=0;for(ab=am.length;ag<ab;ag++){ah=aC(am[ag],Z[ag],F),aj?ay(ah.x,ah.y+ai[ar-1].y,ai[ar-1].x+Y):ay(ah.x,ah.y,ax+Y)}}}if(aq){au=av*0;for(ag=0;ag<M;ag++){ax=an[ag],az(ax[2]+au,ax[1]+au,ax[0]+au)}au=av*(ar+at*2);for(ag=0;ag<M;ag++){ax=an[ag],az(ax[0]+au,ax[1]+au,ax[2]+au)}}else{for(ag=0;ag<M;ag++){ax=an[ag],az(ax[2],ax[1],ax[0])}for(ag=0;ag<M;ag++){ax=an[ag],az(ax[0]+av*ar,ax[1]+av*ar,ax[2]+av*ar)}}var P,O,ak=0;aA(ad);ak+=ad.length;ae=0;for(ac=ap.length;ae<ac;ae++){am=ap[ae],aA(am),ak+=am.length}this.computeCentroids();this.computeFaceNormals()};THREE.ExtrudeGeometry.__v1=new THREE.Vector2;THREE.ExtrudeGeometry.__v2=new THREE.Vector2;THREE.ExtrudeGeometry.__v3=new THREE.Vector2;THREE.ExtrudeGeometry.__v4=new THREE.Vector2;THREE.ExtrudeGeometry.__v5=new THREE.Vector2;THREE.ExtrudeGeometry.__v6=new THREE.Vector2;THREE.IcosahedronGeometry=function(C){function B(g,k,j){var h=Math.sqrt(g*g+k*k+j*j);return y.vertices.push(new THREE.Vertex(new THREE.Vector3(g/h,k/h,j/h)))-1}function A(g,k,j,h){h.faces.push(new THREE.Face3(g,k,j))}function z(c,k){var j=y.vertices[c].position,g=y.vertices[k].position;return B((j.x+g.x)/2,(j.y+g.y)/2,(j.z+g.z)/2)}var y=this,w=new THREE.Geometry;this.subdivisions=C||0;THREE.Geometry.call(this);C=(1+Math.sqrt(5))/2;B(-1,C,0);B(1,C,0);B(-1,-C,0);B(1,-C,0);B(0,-1,C);B(0,1,C);B(0,-1,-C);B(0,1,-C);B(C,0,-1);B(C,0,1);B(-C,0,-1);B(-C,0,1);A(0,11,5,w);A(0,5,1,w);A(0,1,7,w);A(0,7,10,w);A(0,10,11,w);A(1,5,9,w);A(5,11,4,w);A(11,10,2,w);A(10,7,6,w);A(7,1,8,w);A(3,9,4,w);A(3,4,2,w);A(3,2,6,w);A(3,6,8,w);A(3,8,9,w);A(4,9,5,w);A(2,4,11,w);A(6,2,10,w);A(8,6,7,w);A(9,8,1,w);for(var x=0;x<this.subdivisions;x++){var C=new THREE.Geometry,v;for(v in w.faces){var t=z(w.faces[v].a,w.faces[v].b),u=z(w.faces[v].b,w.faces[v].c),n=z(w.faces[v].c,w.faces[v].a);A(w.faces[v].a,t,n,C);A(w.faces[v].b,u,t,C);A(w.faces[v].c,n,u,C);A(t,u,n,C)}w.faces=C.faces}y.faces=w.faces;this.computeCentroids();this.computeFaceNormals();this.computeVertexNormals()};THREE.IcosahedronGeometry.prototype=new THREE.Geometry;THREE.IcosahedronGeometry.prototype.constructor=THREE.IcosahedronGeometry;THREE.LatheGeometry=function(y,x,w){THREE.Geometry.call(this);this.steps=x||12;this.angle=w||2*Math.PI;for(var x=this.angle/this.steps,w=[],v=[],u=[],p=[],t=(new THREE.Matrix4).setRotationZ(x),n=0;n<y.length;n++){this.vertices.push(new THREE.Vertex(y[n])),w[n]=y[n].clone(),v[n]=this.vertices.length-1}for(var m=0;m<=this.angle+0.001;m+=x){for(n=0;n<w.length;n++){m<this.angle?(w[n]=t.multiplyVector3(w[n].clone()),this.vertices.push(new THREE.Vertex(w[n])),u[n]=this.vertices.length-1):u=p}m==0&&(p=v);for(n=0;n<v.length-1;n++){this.faces.push(new THREE.Face4(u[n],u[n+1],v[n+1],v[n])),this.faceVertexUvs[0].push([new THREE.UV(1-m/this.angle,n/y.length),new THREE.UV(1-m/this.angle,(n+1)/y.length),new THREE.UV(1-(m-x)/this.angle,(n+1)/y.length),new THREE.UV(1-(m-x)/this.angle,n/y.length)])}v=u;u=[]}this.computeCentroids();this.computeFaceNormals();this.computeVertexNormals()};THREE.LatheGeometry.prototype=new THREE.Geometry;THREE.LatheGeometry.prototype.constructor=THREE.LatheGeometry;THREE.PlaneGeometry=function(A,z,y,x){THREE.Geometry.call(this);var w,u=A/2,v=z/2,y=y||1,x=x||1,t=y+1,n=x+1;A/=y;var p=z/x;for(w=0;w<n;w++){for(z=0;z<t;z++){this.vertices.push(new THREE.Vertex(new THREE.Vector3(z*A-u,-(w*p-v),0)))}}for(w=0;w<x;w++){for(z=0;z<y;z++){this.faces.push(new THREE.Face4(z+t*w,z+t*(w+1),z+1+t*(w+1),z+1+t*w)),this.faceVertexUvs[0].push([new THREE.UV(z/y,w/x),new THREE.UV(z/y,(w+1)/x),new THREE.UV((z+1)/y,(w+1)/x),new THREE.UV((z+1)/y,w/x)])}}this.computeCentroids();this.computeFaceNormals()};THREE.PlaneGeometry.prototype=new THREE.Geometry;THREE.PlaneGeometry.prototype.constructor=THREE.PlaneGeometry;THREE.SphereGeometry=function(J,I,H){THREE.Geometry.call(this);for(var J=J||50,G,F=Math.PI,D=Math.max(3,I||8),E=Math.max(2,H||6),I=[],H=0;H<E+1;H++){G=H/E;var C=J*Math.cos(G*F),z=J*Math.sin(G*F),A=[],y=0;for(G=0;G<D;G++){var N=2*G/D,M=z*Math.sin(N*F),N=z*Math.cos(N*F);(H==0||H==E)&&G>0||(y=this.vertices.push(new THREE.Vertex(new THREE.Vector3(N,C,M)))-1);A.push(y)}I.push(A)}for(var O,L,K,F=I.length,H=0;H<F;H++){if(D=I[H].length,H>0){for(G=0;G<D;G++){A=G==D-1;E=I[H][A?0:G+1];C=I[H][A?D-1:G];z=I[H-1][A?D-1:G];A=I[H-1][A?0:G+1];M=H/(F-1);O=(H-1)/(F-1);L=(G+1)/D;var N=G/D,y=new THREE.UV(1-L,M),M=new THREE.UV(1-N,M),N=new THREE.UV(1-N,O),n=new THREE.UV(1-L,O);H<I.length-1&&(O=this.vertices[E].position.clone(),L=this.vertices[C].position.clone(),K=this.vertices[z].position.clone(),O.normalize(),L.normalize(),K.normalize(),this.faces.push(new THREE.Face3(E,C,z,[new THREE.Vector3(O.x,O.y,O.z),new THREE.Vector3(L.x,L.y,L.z),new THREE.Vector3(K.x,K.y,K.z)])),this.faceVertexUvs[0].push([y,M,N]));H>1&&(O=this.vertices[E].position.clone(),L=this.vertices[z].position.clone(),K=this.vertices[A].position.clone(),O.normalize(),L.normalize(),K.normalize(),this.faces.push(new THREE.Face3(E,z,A,[new THREE.Vector3(O.x,O.y,O.z),new THREE.Vector3(L.x,L.y,L.z),new THREE.Vector3(K.x,K.y,K.z)])),this.faceVertexUvs[0].push([y,N,n]))}}}this.computeCentroids();this.computeFaceNormals();this.computeVertexNormals();this.boundingSphere={radius:J}};THREE.SphereGeometry.prototype=new THREE.Geometry;THREE.SphereGeometry.prototype.constructor=THREE.SphereGeometry;THREE.TextGeometry=function(g,k){var j=(new THREE.TextPath(g,k)).toShapes();k.amount=k.height!==void 0?k.height:50;if(k.bevelThickness===void 0){k.bevelThickness=10}if(k.bevelSize===void 0){k.bevelSize=8}if(k.bevelEnabled===void 0){k.bevelEnabled=!1}if(k.bend){var h=j[j.length-1].getBoundingBox().maxX;k.bendPath=new THREE.QuadraticBezierCurve(new THREE.Vector2(0,0),new THREE.Vector2(h/2,120),new THREE.Vector2(h,0))}THREE.ExtrudeGeometry.call(this,j,k)};THREE.TextGeometry.prototype=new THREE.ExtrudeGeometry;THREE.TextGeometry.prototype.constructor=THREE.TextGeometry;THREE.FontUtils={faces:{},face:"helvetiker",weight:"normal",style:"normal",size:150,divisions:10,getFace:function(){return this.faces[this.face][this.weight][this.style]},getTextShapes:function(e,f){return(new TextPath(e,f)).toShapes()},loadFace:function(e){var f=e.familyName.toLowerCase();this.faces[f]=this.faces[f]||{};this.faces[f][e.cssFontWeight]=this.faces[f][e.cssFontWeight]||{};this.faces[f][e.cssFontWeight][e.cssFontStyle]=e;return this.faces[f][e.cssFontWeight][e.cssFontStyle]=e},drawText:function(m){for(var w=this.getFace(),v=this.size/w.resolution,u=0,t=String(m).split(""),o=t.length,p=[],m=0;m<o;m++){var n=new THREE.Path,n=this.extractGlyphPoints(t[m],w,v,u,n);u+=n.offset;p.push(n.path)}return{paths:p,offset:u/2}},extractGlyphPoints:function(S,R,Q,P,O){var M=[],N,L,J,K,I,D,C,E,z,n,F=R.glyphs[S]||R.glyphs[ctxt.options.fallbackCharacter];if(F){if(F.o){R=F._cachedOutline||(F._cachedOutline=F.o.split(" "));J=R.length;for(S=0;S<J;){switch(L=R[S++],L){case"m":L=R[S++]*Q+P;K=R[S++]*Q;M.push(new THREE.Vector2(L,K));O.moveTo(L,K);break;case"l":L=R[S++]*Q+P;K=R[S++]*Q;M.push(new THREE.Vector2(L,K));O.lineTo(L,K);break;case"q":L=R[S++]*Q+P;K=R[S++]*Q;C=R[S++]*Q+P;E=R[S++]*Q;O.quadraticCurveTo(C,E,L,K);if(N=M[M.length-1]){I=N.x;D=N.y;N=1;for(divisions=this.divisions;N<=divisions;N++){var G=N/divisions,y=THREE.Shape.Utils.b2(G,I,C,L),G=THREE.Shape.Utils.b2(G,D,E,K);M.push(new THREE.Vector2(y,G))}}break;case"b":if(L=R[S++]*Q+P,K=R[S++]*Q,C=R[S++]*Q+P,E=R[S++]*-Q,z=R[S++]*Q+P,n=R[S++]*-Q,O.bezierCurveTo(L,K,C,E,z,n),N=M[M.length-1]){I=N.x;D=N.y;N=1;for(divisions=this.divisions;N<=divisions;N++){G=N/divisions,y=THREE.Shape.Utils.b3(G,I,C,z,L),G=THREE.Shape.Utils.b3(G,D,E,n,K),M.push(new THREE.Vector2(y,G))}}}}}return{offset:F.ha*Q,points:M,path:O}}}};(function(e){var f=function(k){for(var p=k.length,o=0,m=p-1,n=0;n<p;m=n++){o+=k[m].x*k[n].y-k[n].x*k[m].y}return o*0.5};e.Triangulate=function(aB,aA){var az=aB.length;if(az<3){return null}var ax=[],ay=[],aw=[],at,av,ar;if(f(aB)>0){for(av=0;av<az;av++){ay[av]=av}}else{for(av=0;av<az;av++){ay[av]=az-1-av}}var ap=2*az;for(av=az-1;az>2;){if(ap--<=0){console.log("Warning, unable to triangulate polygon!");if(aA){return aw}return ax}at=av;az<=at&&(at=0);av=at+1;az<=av&&(av=0);ar=av+1;az<=ar&&(ar=0);var ao;a:{ao=aB;var aq=at,an=av,am=ar,ah=az,ai=ay,ac=void 0,al=void 0,ad=void 0,ab=void 0,ae=void 0,Z=void 0,af=void 0,aa=void 0,P=void 0,al=ao[ai[aq]].x,ad=ao[ai[aq]].y,ab=ao[ai[an]].x,ae=ao[ai[an]].y,Z=ao[ai[am]].x,af=ao[ai[am]].y;if(1e-10>(ab-al)*(af-ad)-(ae-ad)*(Z-al)){ao=!1}else{for(ac=0;ac<ah;ac++){if(!(ac==aq||ac==an||ac==am)){var aa=ao[ai[ac]].x,P=ao[ai[ac]].y,z=void 0,Q=void 0,ag=void 0,au=void 0,F=void 0,M=void 0,ak=void 0,Y=void 0,c=void 0,O=void 0,N=void 0,aj=void 0,z=ag=F=void 0,z=Z-ab,Q=af-ae,ag=al-Z,au=ad-af,F=ab-al,M=ae-ad,ak=aa-al,Y=P-ad,c=aa-ab,O=P-ae,N=aa-Z,aj=P-af,z=z*O-Q*c,F=F*Y-M*ak,ag=ag*aj-au*N;if(z>=0&&ag>=0&&F>=0){ao=!1;break a}}}ao=!0}}if(ao){ax.push([aB[ay[at]],aB[ay[av]],aB[ay[ar]]]);aw.push([ay[at],ay[av],ay[ar]]);at=av;for(ar=av+1;ar<az;at++,ar++){ay[at]=ay[ar]}az--;ap=2*az}}if(aA){return aw}return ax};e.Triangulate.area=f;return e})(THREE.FontUtils);window._typeface_js={faces:THREE.FontUtils.faces,loadFace:THREE.FontUtils.loadFace};THREE.TorusGeometry=function(k,u,t,p){THREE.Geometry.call(this);this.radius=k||100;this.tube=u||40;this.segmentsR=t||8;this.segmentsT=p||6;k=[];for(u=0;u<=this.segmentsR;++u){for(t=0;t<=this.segmentsT;++t){var p=t/this.segmentsT*2*Math.PI,o=u/this.segmentsR*2*Math.PI;this.vertices.push(new THREE.Vertex(new THREE.Vector3((this.radius+this.tube*Math.cos(o))*Math.cos(p),(this.radius+this.tube*Math.cos(o))*Math.sin(p),this.tube*Math.sin(o))));k.push([t/this.segmentsT,1-u/this.segmentsR])}}for(u=1;u<=this.segmentsR;++u){for(t=1;t<=this.segmentsT;++t){var p=(this.segmentsT+1)*u+t,o=(this.segmentsT+1)*u+t-1,m=(this.segmentsT+1)*(u-1)+t-1,n=(this.segmentsT+1)*(u-1)+t;this.faces.push(new THREE.Face4(p,o,m,n));this.faceVertexUvs[0].push([new THREE.UV(k[p][0],k[p][1]),new THREE.UV(k[o][0],k[o][1]),new THREE.UV(k[m][0],k[m][1]),new THREE.UV(k[n][0],k[n][1])])}}this.computeCentroids();this.computeFaceNormals();this.computeVertexNormals()};THREE.TorusGeometry.prototype=new THREE.Geometry;THREE.TorusGeometry.prototype.constructor=THREE.TorusGeometry;THREE.TorusKnotGeometry=function(C,B,A,z,y,w,x){function v(j,D,p,o,m,k){D=p/o*j;p=Math.cos(D);return new THREE.Vector3(m*(2+p)*0.5*Math.cos(j),m*(2+p)*Math.sin(j)*0.5,k*m*Math.sin(D)*0.5)}THREE.Geometry.call(this);this.radius=C||200;this.tube=B||40;this.segmentsR=A||64;this.segmentsT=z||8;this.p=y||2;this.q=w||3;this.heightScale=x||1;this.grid=Array(this.segmentsR);A=new THREE.Vector3;z=new THREE.Vector3;w=new THREE.Vector3;for(C=0;C<this.segmentsR;++C){this.grid[C]=Array(this.segmentsT);for(B=0;B<this.segmentsT;++B){var t=C/this.segmentsR*2*this.p*Math.PI,x=B/this.segmentsT*2*Math.PI,y=v(t,x,this.q,this.p,this.radius,this.heightScale),t=v(t+0.01,x,this.q,this.p,this.radius,this.heightScale);A.x=t.x-y.x;A.y=t.y-y.y;A.z=t.z-y.z;z.x=t.x+y.x;z.y=t.y+y.y;z.z=t.z+y.z;w.cross(A,z);z.cross(w,A);w.normalize();z.normalize();t=-this.tube*Math.cos(x);x=this.tube*Math.sin(x);y.x+=t*z.x+x*w.x;y.y+=t*z.y+x*w.y;y.z+=t*z.z+x*w.z;this.grid[C][B]=this.vertices.push(new THREE.Vertex(new THREE.Vector3(y.x,y.y,y.z)))-1}}for(C=0;C<this.segmentsR;++C){for(B=0;B<this.segmentsT;++B){var z=(C+1)%this.segmentsR,w=(B+1)%this.segmentsT,y=this.grid[C][B],A=this.grid[z][B],z=this.grid[z][w],w=this.grid[C][w],x=new THREE.UV(C/this.segmentsR,B/this.segmentsT),t=new THREE.UV((C+1)/this.segmentsR,B/this.segmentsT),u=new THREE.UV((C+1)/this.segmentsR,(B+1)/this.segmentsT),n=new THREE.UV(C/this.segmentsR,(B+1)/this.segmentsT);this.faces.push(new THREE.Face4(y,A,z,w));this.faceVertexUvs[0].push([x,t,u,n])}}this.computeCentroids();this.computeFaceNormals();this.computeVertexNormals()};THREE.TorusKnotGeometry.prototype=new THREE.Geometry;THREE.TorusKnotGeometry.prototype.constructor=THREE.TorusKnotGeometry;THREE.Loader=function(c){this.statusDomElement=(this.showStatus=c)?THREE.Loader.prototype.addStatusElement():null;this.onLoadStart=function(){};this.onLoadProgress=function(){};this.onLoadComplete=function(){}};THREE.Loader.prototype={addStatusElement:function(){var c=document.createElement("div");c.style.position="absolute";c.style.right="0px";c.style.top="0px";c.style.fontSize="0.8em";c.style.textAlign="left";c.style.background="rgba(0,0,0,0.25)";c.style.color="#fff";c.style.width="120px";c.style.padding="0.5em 0.5em 0.5em 0.5em";c.style.zIndex=1000;c.innerHTML="Loading ...";return c},updateProgress:function(e){var f="Loaded ";f+=e.total?(100*e.loaded/e.total).toFixed(0)+"%":(e.loaded/1000).toFixed(2)+" KB";this.statusDomElement.innerHTML=f},extractUrlbase:function(c){c=c.split("/");c.pop();return c.join("/")},init_materials:function(g,k,j){g.materials=[];for(var h=0;h<k.length;++h){g.materials[h]=[THREE.Loader.prototype.createMaterial(k[h],j)]}},hasNormals:function(g){var k,j,h=g.materials.length;for(j=0;j<h;j++){if(k=g.materials[j][0],k instanceof THREE.MeshShaderMaterial){return !0}}return !1},createMaterial:function(E,D){function C(c){c=Math.log(c)/Math.LN2;return Math.floor(c)==c}function B(e,h){var g=new Image;g.onload=function(){if(!C(this.width)||!C(this.height)){var j=Math.pow(2,Math.round(Math.log(this.width)/Math.LN2)),b=Math.pow(2,Math.round(Math.log(this.height)/Math.LN2));e.image.width=j;e.image.height=b;e.image.getContext("2d").drawImage(this,0,0,j,b)}else{e.image=this}e.needsUpdate=!0};g.src=h}function A(f,H,v,u,p,o){var c=document.createElement("canvas");f[H]=new THREE.Texture(c);f[H].sourceFile=v;if(u){f[H].repeat.set(u[0],u[1]);if(u[0]!=1){f[H].wrapS=THREE.RepeatWrapping}if(u[1]!=1){f[H].wrapT=THREE.RepeatWrapping}}p&&f[H].offset.set(p[0],p[1]);if(o){u={repeat:THREE.RepeatWrapping,mirror:THREE.MirroredRepeatWrapping};if(u[o[0]]!==void 0){f[H].wrapS=u[o[0]]}if(u[o[1]]!==void 0){f[H].wrapT=u[o[1]]}}B(f[H],D+"/"+v)}function y(c){return(c[0]*255<<16)+(c[1]*255<<8)+c[2]*255}var z,x,t;x="MeshLambertMaterial";z={color:15658734,opacity:1,map:null,lightMap:null,normalMap:null,wireframe:E.wireframe};E.shading&&(E.shading=="Phong"?x="MeshPhongMaterial":E.shading=="Basic"&&(x="MeshBasicMaterial"));if(E.blending){if(E.blending=="Additive"){z.blending=THREE.AdditiveBlending}else{if(E.blending=="Subtractive"){z.blending=THREE.SubtractiveBlending}else{if(E.blending=="Multiply"){z.blending=THREE.MultiplyBlending}}}}if(E.transparent!==void 0||E.opacity<1){z.transparent=E.transparent}if(E.depthTest!==void 0){z.depthTest=E.depthTest}if(E.vertexColors!==void 0){if(E.vertexColors=="face"){z.vertexColors=THREE.FaceColors}else{if(E.vertexColors){z.vertexColors=THREE.VertexColors}}}if(E.colorDiffuse){z.color=y(E.colorDiffuse)}else{if(E.DbgColor){z.color=E.DbgColor}}if(E.colorSpecular){z.specular=y(E.colorSpecular)}if(E.colorAmbient){z.ambient=y(E.colorAmbient)}if(E.transparency){z.opacity=E.transparency}if(E.specularCoef){z.shininess=E.specularCoef}E.mapDiffuse&&D&&A(z,"map",E.mapDiffuse,E.mapDiffuseRepeat,E.mapDiffuseOffset,E.mapDiffuseWrap);E.mapLight&&D&&A(z,"lightMap",E.mapLight,E.mapLightRepeat,E.mapLightOffset,E.mapLightWrap);E.mapNormal&&D&&A(z,"normalMap",E.mapNormal,E.mapNormalRepeat,E.mapNormalOffset,E.mapNormalWrap);E.mapSpecular&&D&&A(z,"specularMap",E.mapSpecular,E.mapSpecularRepeat,E.mapSpecularOffset,E.mapSpecularWrap);if(E.mapNormal){var w=THREE.ShaderUtils.lib.normal,n=THREE.UniformsUtils.clone(w.uniforms),G=z.color;x=z.specular;t=z.ambient;var F=z.shininess;n.tNormal.texture=z.normalMap;if(E.mapNormalFactor){n.uNormalScale.value=E.mapNormalFactor}if(z.map){n.tDiffuse.texture=z.map,n.enableDiffuse.value=!0}if(z.specularMap){n.tSpecular.texture=z.specularMap,n.enableSpecular.value=!0}if(z.lightMap){n.tAO.texture=z.lightMap,n.enableAO.value=!0}n.uDiffuseColor.value.setHex(G);n.uSpecularColor.value.setHex(x);n.uAmbientColor.value.setHex(t);n.uShininess.value=F;if(z.opacity){n.uOpacity.value=z.opacity}z=new THREE.MeshShaderMaterial({fragmentShader:w.fragmentShader,vertexShader:w.vertexShader,uniforms:n,lights:!0,fog:!0})}else{z=new THREE[x](z)}return z},constructor:THREE.Loader};THREE.JSONLoader=function(c){THREE.Loader.call(this,c)};THREE.JSONLoader.prototype=new THREE.Loader;THREE.JSONLoader.prototype.constructor=THREE.JSONLoader;THREE.JSONLoader.prototype.supr=THREE.Loader.prototype;THREE.JSONLoader.prototype.load=function(h){var n=this,m=h.model,k=h.callback,j=h.texture_path?h.texture_path:this.extractUrlbase(m),h=new Worker(m);h.onmessage=function(c){n.createModel(c.data,k,j);n.onLoadComplete()};this.onLoadStart();h.postMessage((new Date).getTime())};THREE.JSONLoader.prototype.createModel=function(h,n,m){var k=new THREE.Geometry,j=h.scale!==void 0?1/h.scale:1;this.init_materials(k,h.materials,m);(function(W){if(h.version===void 0||h.version!=2){console.error("Deprecated file format.")}else{var V,U,S,T,R,M,L,O,F,C,P,Q,D,f,J=h.faces;M=h.vertices;var z=h.normals,N=h.colors,b=0;for(V=0;V<h.uvs.length;V++){h.uvs[V].length&&b++}for(V=0;V<b;V++){k.faceUvs[V]=[],k.faceVertexUvs[V]=[]}T=0;for(R=M.length;T<R;){L=new THREE.Vertex,L.position.x=M[T++]*W,L.position.y=M[T++]*W,L.position.z=M[T++]*W,k.vertices.push(L)}T=0;for(R=J.length;T<R;){W=J[T++];M=W&1;S=W&2;V=W&4;U=W&8;O=W&16;L=W&32;C=W&64;W&=128;M?(P=new THREE.Face4,P.a=J[T++],P.b=J[T++],P.c=J[T++],P.d=J[T++],M=4):(P=new THREE.Face3,P.a=J[T++],P.b=J[T++],P.c=J[T++],M=3);if(S){S=J[T++],P.materials=k.materials[S]}S=k.faces.length;if(V){for(V=0;V<b;V++){Q=h.uvs[V],F=J[T++],f=Q[F*2],F=Q[F*2+1],k.faceUvs[V][S]=new THREE.UV(f,F)}}if(U){for(V=0;V<b;V++){Q=h.uvs[V];D=[];for(U=0;U<M;U++){F=J[T++],f=Q[F*2],F=Q[F*2+1],D[U]=new THREE.UV(f,F)}k.faceVertexUvs[V][S]=D}}if(O){O=J[T++]*3,U=new THREE.Vector3,U.x=z[O++],U.y=z[O++],U.z=z[O],P.normal=U}if(L){for(V=0;V<M;V++){O=J[T++]*3,U=new THREE.Vector3,U.x=z[O++],U.y=z[O++],U.z=z[O],P.vertexNormals.push(U)}}if(C){L=J[T++],L=new THREE.Color(N[L]),P.color=L}if(W){for(V=0;V<M;V++){L=J[T++],L=new THREE.Color(N[L]),P.vertexColors.push(L)}}k.faces.push(P)}}})(j);(function(){var t,f,b,p;if(h.skinWeights){t=0;for(f=h.skinWeights.length;t<f;t+=2){b=h.skinWeights[t],p=h.skinWeights[t+1],k.skinWeights.push(new THREE.Vector4(b,p,0,0))}}if(h.skinIndices){t=0;for(f=h.skinIndices.length;t<f;t+=2){b=h.skinIndices[t],p=h.skinIndices[t+1],k.skinIndices.push(new THREE.Vector4(b,p,0,0))}}k.bones=h.bones;k.animation=h.animation})();(function(A){if(h.morphTargets!==void 0){var z,y,f,x,b,D,C,E,B;z=0;for(y=h.morphTargets.length;z<y;z++){k.morphTargets[z]={};k.morphTargets[z].name=h.morphTargets[z].name;k.morphTargets[z].vertices=[];E=k.morphTargets[z].vertices;B=h.morphTargets[z].vertices;f=0;for(x=B.length;f<x;f+=3){b=B[f]*A,D=B[f+1]*A,C=B[f+2]*A,E.push(new THREE.Vertex(new THREE.Vector3(b,D,C)))}}}if(h.morphColors!==void 0){z=0;for(y=h.morphColors.length;z<y;z++){k.morphColors[z]={};k.morphColors[z].name=h.morphColors[z].name;k.morphColors[z].colors=[];x=k.morphColors[z].colors;b=h.morphColors[z].colors;A=0;for(f=b.length;A<f;A+=3){D=new THREE.Color(16755200),D.setRGB(b[A],b[A+1],b[A+2]),x.push(D)}}}})(j);(function(){if(h.edges!==void 0){var o,f,b;for(o=0;o<h.edges.length;o+=2){f=h.edges[o],b=h.edges[o+1],k.edges.push(new THREE.Edge(k.vertices[f],k.vertices[b],f,b))}}})();k.computeCentroids();k.computeFaceNormals();this.hasNormals(k)&&k.computeTangents();n(k)};THREE.BinaryLoader=function(c){THREE.Loader.call(this,c)};THREE.BinaryLoader.prototype=new THREE.Loader;THREE.BinaryLoader.prototype.constructor=THREE.BinaryLoader;THREE.BinaryLoader.prototype.supr=THREE.Loader.prototype;THREE.BinaryLoader.prototype={load:function(h){var p=h.model,o=h.callback,n=h.texture_path?h.texture_path:THREE.Loader.prototype.extractUrlbase(p),m=h.bin_path?h.bin_path:THREE.Loader.prototype.extractUrlbase(p),h=(new Date).getTime(),p=new Worker(p),k=this.showProgress?THREE.Loader.prototype.updateProgress:null;p.onmessage=function(c){THREE.BinaryLoader.prototype.loadAjaxBuffers(c.data.buffers,c.data.materials,o,m,n,k)};p.onerror=function(c){alert("worker.onerror: "+c.message+"\n"+c.data);c.preventDefault()};p.postMessage(h)},loadAjaxBuffers:function(y,x,w,v,u,p){var t=new XMLHttpRequest,n=v+"/"+y,m=0;t.onreadystatechange=function(){t.readyState==4?t.status==200||t.status==0?THREE.BinaryLoader.prototype.createBinModel(t.responseText,w,u,x):alert("Couldn't load ["+n+"] ["+t.status+"]"):t.readyState==3?p&&(m==0&&(m=t.getResponseHeader("Content-Length")),p({total:m,loaded:t.responseText.length})):t.readyState==2&&(m=t.getResponseHeader("Content-Length"))};t.open("GET",n,!0);t.overrideMimeType("text/plain; charset=x-user-defined");t.setRequestHeader("Content-Type","text/plain");t.send(null)},createBinModel:function(h,n,m,k){var j=function(aK){function aJ(e,w){var v=aE(e,w),u=aE(e,w+1),t=aE(e,w+2),p=aE(e,w+3),o=(p<<1&255|t>>7)-127;v|=(t&127)<<16|u<<8;if(v==0&&o==-127){return 0}return(1-2*(p>>7))*(1+v*Math.pow(2,-23))*Math.pow(2,o)}function aI(g,u){var t=aE(g,u),p=aE(g,u+1),o=aE(g,u+2);return(aE(g,u+3)<<24)+(o<<16)+(p<<8)+t}function aF(g,p){var o=aE(g,p);return(aE(g,p+1)<<8)+o}function aH(g,p){var o=aE(g,p);return o>127?o-256:o}function aE(e,g){return e.charCodeAt(g)&255}function aC(t){var p,o,g;p=aI(h,t);o=aI(h,t+an);g=aI(h,t+ai);t=aF(h,t+ao);THREE.BinaryLoader.prototype.f3(ar,p,o,g,t)}function aB(w){var u,t,p,o,g,v;u=aI(h,w);t=aI(h,w+an);p=aI(h,w+ai);o=aF(h,w+ao);g=aI(h,w+aj);v=aI(h,w+ad);w=aI(h,w+N);THREE.BinaryLoader.prototype.f3n(ar,am,u,t,p,o,g,v,w)}function aD(u){var t,p,o,g;t=aI(h,u);p=aI(h,u+ae);o=aI(h,u+ap);g=aI(h,u+aG);u=aF(h,u+O);THREE.BinaryLoader.prototype.f4(ar,t,p,o,g,u)}function aA(A){var y,x,w,v,o,g,C,B;y=aI(h,A);x=aI(h,A+ae);w=aI(h,A+ap);v=aI(h,A+aG);o=aF(h,A+O);g=aI(h,A+Q);C=aI(h,A+aw);B=aI(h,A+ah);A=aI(h,A+b);THREE.BinaryLoader.prototype.f4n(ar,am,y,x,w,v,o,g,C,B,A)}function az(p){var o,g;o=aI(h,p);g=aI(h,p+ac);p=aI(h,p+ab);THREE.BinaryLoader.prototype.uv3(ar.faceVertexUvs[0],ak[o*2],ak[o*2+1],ak[g*2],ak[g*2+1],ak[p*2],ak[p*2+1])}function aq(t){var p,o,g;p=aI(h,t);o=aI(h,t+au);g=aI(h,t+f);t=aI(h,t+ax);THREE.BinaryLoader.prototype.uv4(ar.faceVertexUvs[0],ak[p*2],ak[p*2+1],ak[o*2],ak[o*2+1],ak[g*2],ak[g*2+1],ak[t*2],ak[t*2+1])}var ar=this,al=0,ay,am=[],ak=[],an,ai,ao,aj,ad,N,ae,ap,aG,O,Q,aw,ah,b,ac,ab,au,f,ax,ag,af,at,F,z,av;THREE.Geometry.call(this);THREE.Loader.prototype.init_materials(ar,k,aK);ay={signature:h.substr(al,8),header_bytes:aE(h,al+8),vertex_coordinate_bytes:aE(h,al+9),normal_coordinate_bytes:aE(h,al+10),uv_coordinate_bytes:aE(h,al+11),vertex_index_bytes:aE(h,al+12),normal_index_bytes:aE(h,al+13),uv_index_bytes:aE(h,al+14),material_index_bytes:aE(h,al+15),nvertices:aI(h,al+16),nnormals:aI(h,al+16+4),nuvs:aI(h,al+16+8),ntri_flat:aI(h,al+16+12),ntri_smooth:aI(h,al+16+16),ntri_flat_uv:aI(h,al+16+20),ntri_smooth_uv:aI(h,al+16+24),nquad_flat:aI(h,al+16+28),nquad_smooth:aI(h,al+16+32),nquad_flat_uv:aI(h,al+16+36),nquad_smooth_uv:aI(h,al+16+40)};al+=ay.header_bytes;an=ay.vertex_index_bytes;ai=ay.vertex_index_bytes*2;ao=ay.vertex_index_bytes*3;aj=ay.vertex_index_bytes*3+ay.material_index_bytes;ad=ay.vertex_index_bytes*3+ay.material_index_bytes+ay.normal_index_bytes;N=ay.vertex_index_bytes*3+ay.material_index_bytes+ay.normal_index_bytes*2;ae=ay.vertex_index_bytes;ap=ay.vertex_index_bytes*2;aG=ay.vertex_index_bytes*3;O=ay.vertex_index_bytes*4;Q=ay.vertex_index_bytes*4+ay.material_index_bytes;aw=ay.vertex_index_bytes*4+ay.material_index_bytes+ay.normal_index_bytes;ah=ay.vertex_index_bytes*4+ay.material_index_bytes+ay.normal_index_bytes*2;b=ay.vertex_index_bytes*4+ay.material_index_bytes+ay.normal_index_bytes*3;ac=ay.uv_index_bytes;ab=ay.uv_index_bytes*2;au=ay.uv_index_bytes;f=ay.uv_index_bytes*2;ax=ay.uv_index_bytes*3;aK=ay.vertex_index_bytes*3+ay.material_index_bytes;av=ay.vertex_index_bytes*4+ay.material_index_bytes;ag=ay.ntri_flat*aK;af=ay.ntri_smooth*(aK+ay.normal_index_bytes*3);at=ay.ntri_flat_uv*(aK+ay.uv_index_bytes*3);F=ay.ntri_smooth_uv*(aK+ay.normal_index_bytes*3+ay.uv_index_bytes*3);z=ay.nquad_flat*av;aK=ay.nquad_smooth*(av+ay.normal_index_bytes*4);av=ay.nquad_flat_uv*(av+ay.uv_index_bytes*4);al+=function(v){for(var u,t,p,o=ay.vertex_coordinate_bytes*3,e=v+ay.nvertices*o;v<e;v+=o){u=aJ(h,v),t=aJ(h,v+ay.vertex_coordinate_bytes),p=aJ(h,v+ay.vertex_coordinate_bytes*2),THREE.BinaryLoader.prototype.v(ar,u,t,p)}return ay.nvertices*o}(al);al+=function(w){for(var v,u,t,p=ay.normal_coordinate_bytes*3,o=w+ay.nnormals*p;w<o;w+=p){v=aH(h,w),u=aH(h,w+ay.normal_coordinate_bytes),t=aH(h,w+ay.normal_coordinate_bytes*2),am.push(v/127,u/127,t/127)}return ay.nnormals*p}(al);al+=function(u){for(var t,p,o=ay.uv_coordinate_bytes*2,e=u+ay.nuvs*o;u<e;u+=o){t=aJ(h,u),p=aJ(h,u+ay.uv_coordinate_bytes),ak.push(t,p)}return ay.nuvs*o}(al);ag=al+ag;af=ag+af;at=af+at;F=at+F;z=F+z;aK=z+aK;av=aK+av;(function(o){var v,u=ay.vertex_index_bytes*3+ay.material_index_bytes,t=u+ay.uv_index_bytes*3,p=o+ay.ntri_flat_uv*t;for(v=o;v<p;v+=t){aC(v),az(v+u)}return p-o})(af);(function(o){var v,u=ay.vertex_index_bytes*3+ay.material_index_bytes+ay.normal_index_bytes*3,t=u+ay.uv_index_bytes*3,p=o+ay.ntri_smooth_uv*t;for(v=o;v<p;v+=t){aB(v),az(v+u)}return p-o})(at);(function(o){var v,u=ay.vertex_index_bytes*4+ay.material_index_bytes,t=u+ay.uv_index_bytes*4,p=o+ay.nquad_flat_uv*t;for(v=o;v<p;v+=t){aD(v),aq(v+u)}return p-o})(aK);(function(o){var v,u=ay.vertex_index_bytes*4+ay.material_index_bytes+ay.normal_index_bytes*4,t=u+ay.uv_index_bytes*4,p=o+ay.nquad_smooth_uv*t;for(v=o;v<p;v+=t){aA(v),aq(v+u)}return p-o})(av);(function(g){var t,p=ay.vertex_index_bytes*3+ay.material_index_bytes,o=g+ay.ntri_flat*p;for(t=g;t<o;t+=p){aC(t)}return o-g})(al);(function(g){var t,p=ay.vertex_index_bytes*3+ay.material_index_bytes+ay.normal_index_bytes*3,o=g+ay.ntri_smooth*p;for(t=g;t<o;t+=p){aB(t)}return o-g})(ag);(function(g){var t,p=ay.vertex_index_bytes*4+ay.material_index_bytes,o=g+ay.nquad_flat*p;for(t=g;t<o;t+=p){aD(t)}return o-g})(F);(function(g){var t,p=ay.vertex_index_bytes*4+ay.material_index_bytes+ay.normal_index_bytes*4,o=g+ay.nquad_smooth*p;for(t=g;t<o;t+=p){aA(t)}return o-g})(z);this.computeCentroids();this.computeFaceNormals();THREE.Loader.prototype.hasNormals(this)&&this.computeTangents()};j.prototype=new THREE.Geometry;j.prototype.constructor=j;n(new j(m))},v:function(g,k,j,h){g.vertices.push(new THREE.Vertex(new THREE.Vector3(k,j,h)))},f3:function(h,n,m,k,j){h.faces.push(new THREE.Face3(n,m,k,null,null,h.materials[j]))},f4:function(h,p,o,n,m,k){h.faces.push(new THREE.Face4(p,o,n,m,null,null,h.materials[k]))},f3n:function(E,D,C,B,A,y,z,x,t){var y=E.materials[y],w=D[x*3],n=D[x*3+1],x=D[x*3+2],G=D[t*3],F=D[t*3+1],t=D[t*3+2];E.faces.push(new THREE.Face3(C,B,A,[new THREE.Vector3(D[z*3],D[z*3+1],D[z*3+2]),new THREE.Vector3(w,n,x),new THREE.Vector3(G,F,t)],null,y))},f4n:function(J,I,H,G,F,D,E,C,z,A,y){var E=J.materials[E],N=I[z*3],M=I[z*3+1],z=I[z*3+2],O=I[A*3],L=I[A*3+1],A=I[A*3+2],K=I[y*3],n=I[y*3+1],y=I[y*3+2];J.faces.push(new THREE.Face4(H,G,F,D,[new THREE.Vector3(I[C*3],I[C*3+1],I[C*3+2]),new THREE.Vector3(N,M,z),new THREE.Vector3(O,L,A),new THREE.Vector3(K,n,y)],null,E))},uv3:function(m,w,v,u,t,o,p){var n=[];n.push(new THREE.UV(w,v));n.push(new THREE.UV(u,t));n.push(new THREE.UV(o,p));m.push(n)},uv4:function(A,z,y,x,w,u,v,t,n){var p=[];p.push(new THREE.UV(z,y));p.push(new THREE.UV(x,w));p.push(new THREE.UV(u,v));p.push(new THREE.UV(t,n));A.push(p)},constructor:THREE.BinaryLoader};THREE.SceneLoader=function(){this.onLoadStart=function(){};this.onLoadProgress=function(){};this.onLoadComplete=function(){};this.callbackSync=function(){};this.callbackProgress=function(){}};THREE.SceneLoader.prototype={load:function(h,n){var m=this,k=new Worker(h);k.postMessage(0);var j=THREE.Loader.prototype.extractUrlbase(h);k.onmessage=function(at){function ar(f,o){return o=="relativeToHTML"?f:j+"/"+f}function aq(){for(ag in M.objects){if(!O.objects[ag]){if(aa=M.objects[ag],aa.geometry!==void 0){if(af=O.geometries[aa.geometry]){var f=!1;F=[];for(z=0;z<aa.materials.length;z++){F[z]=O.materials[aa.materials[z]],f=F[z] instanceof THREE.MeshShaderMaterial}f&&af.computeTangents();U=aa.position;r=aa.rotation;q=aa.quaternion;s=aa.scale;q=0;F.length==0&&(F[0]=new THREE.MeshFaceMaterial);F.length>1&&(F=[new THREE.MeshFaceMaterial]);object=new THREE.Mesh(af,F);object.name=ag;object.position.set(U[0],U[1],U[2]);q?(object.quaternion.set(q[0],q[1],q[2],q[3]),object.useQuaternion=!0):object.rotation.set(r[0],r[1],r[2]);object.scale.set(s[0],s[1],s[2]);object.visible=aa.visible;O.scene.addObject(object);O.objects[ag]=object;aa.meshCollider&&(f=THREE.CollisionUtils.MeshColliderWBox(object),O.scene.collisions.colliders.push(f));if(aa.castsShadow){f=new THREE.ShadowVolume(af),O.scene.addChild(f),f.position=object.position,f.rotation=object.rotation,f.scale=object.scale}aa.trigger&&aa.trigger.toLowerCase()!="none"&&(f={type:aa.trigger,object:aa},O.triggers[object.name]=f)}}else{U=aa.position,r=aa.rotation,q=aa.quaternion,s=aa.scale,q=0,object=new THREE.Object3D,object.name=ag,object.position.set(U[0],U[1],U[2]),q?(object.quaternion.set(q[0],q[1],q[2],q[3]),object.useQuaternion=!0):object.rotation.set(r[0],r[1],r[2]),object.scale.set(s[0],s[1],s[2]),object.visible=aa.visible!==void 0?aa.visible:!1,O.scene.addObject(object),O.objects[ag]=object,O.empties[ag]=object,aa.trigger&&aa.trigger.toLowerCase()!="none"&&(f={type:aa.trigger,object:aa},O.triggers[object.name]=f)}}}}function am(f){return function(b){O.geometries[f]=b;aq();ao-=1;m.onLoadComplete();al()}}function ap(f){return function(b){O.geometries[f]=b}}function al(){m.callbackProgress({totalModels:g,totalTextures:an,loadedModels:g-ao,loadedTextures:an-e},O);m.onLoadProgress();ao==0&&e==0&&n(O)}var ae,ad,ag,ab,Z,aj,ak,aa,U,ac,Y,af,P,ah,Q,F,c,M,ai,ao,e,g,an,O;M=at.data;Q=new THREE.BinaryLoader;ai=new THREE.JSONLoader;e=ao=0;O={scene:new THREE.Scene,geometries:{},materials:{},textures:{},objects:{},cameras:{},lights:{},fogs:{},triggers:{},empties:{}};at=!1;for(ag in M.objects){if(aa=M.objects[ag],aa.meshCollider){at=!0;break}}if(at){O.scene.collisions=new THREE.CollisionSystem}if(M.transform){at=M.transform.position;ac=M.transform.rotation;var N=M.transform.scale;at&&O.scene.position.set(at[0],at[1],at[2]);ac&&O.scene.rotation.set(ac[0],ac[1],ac[2]);N&&O.scene.scale.set(N[0],N[1],N[2]);(at||ac||N)&&O.scene.updateMatrix()}at=function(){e-=1;al();m.onLoadComplete()};for(Z in M.cameras){ac=M.cameras[Z];if(ac.type=="perspective"){P=new THREE.Camera(ac.fov,ac.aspect,ac.near,ac.far)}else{if(ac.type=="ortho"){P=new THREE.Camera,P.projectionMatrix=THREE.Matrix4.makeOrtho(ac.left,ac.right,ac.top,ac.bottom,ac.near,ac.far)}}U=ac.position;ac=ac.target;P.position.set(U[0],U[1],U[2]);P.target.position.set(ac[0],ac[1],ac[2]);O.cameras[Z]=P}for(ab in M.lights){Z=M.lights[ab],P=Z.color!==void 0?Z.color:16777215,ac=Z.intensity!==void 0?Z.intensity:1,Z.type=="directional"?(U=Z.direction,c=new THREE.DirectionalLight(P,ac),c.position.set(U[0],U[1],U[2]),c.position.normalize()):Z.type=="point"?(U=Z.position,d=Z.distance,c=new THREE.PointLight(P,ac,d),c.position.set(U[0],U[1],U[2])):Z.type=="ambient"&&(c=new THREE.AmbientLight(P)),O.scene.addLight(c),O.lights[ab]=c}for(aj in M.fogs){ab=M.fogs[aj],ab.type=="linear"?ah=new THREE.Fog(0,ab.near,ab.far):ab.type=="exp2"&&(ah=new THREE.FogExp2(0,ab.density)),ac=ab.color,ah.color.setRGB(ac[0],ac[1],ac[2]),O.fogs[aj]=ah}if(O.cameras&&M.defaults.camera){O.currentCamera=O.cameras[M.defaults.camera]}if(O.fogs&&M.defaults.fog){O.scene.fog=O.fogs[M.defaults.fog]}ac=M.defaults.bgcolor;O.bgColor=new THREE.Color;O.bgColor.setRGB(ac[0],ac[1],ac[2]);O.bgColorAlpha=M.defaults.bgalpha;for(ae in M.geometries){if(aj=M.geometries[ae],aj.type=="bin_mesh"||aj.type=="ascii_mesh"){ao+=1,m.onLoadStart()}}g=ao;for(ae in M.geometries){aj=M.geometries[ae],aj.type=="cube"?(af=new THREE.CubeGeometry(aj.width,aj.height,aj.depth,aj.segmentsWidth,aj.segmentsHeight,aj.segmentsDepth,null,aj.flipped,aj.sides),O.geometries[ae]=af):aj.type=="plane"?(af=new THREE.PlaneGeometry(aj.width,aj.height,aj.segmentsWidth,aj.segmentsHeight),O.geometries[ae]=af):aj.type=="sphere"?(af=new THREE.SphereGeometry(aj.radius,aj.segmentsWidth,aj.segmentsHeight),O.geometries[ae]=af):aj.type=="cylinder"?(af=new THREE.CylinderGeometry(aj.numSegs,aj.topRad,aj.botRad,aj.height,aj.topOffset,aj.botOffset),O.geometries[ae]=af):aj.type=="torus"?(af=new THREE.TorusGeometry(aj.radius,aj.tube,aj.segmentsR,aj.segmentsT),O.geometries[ae]=af):aj.type=="icosahedron"?(af=new THREE.IcosahedronGeometry(aj.subdivisions),O.geometries[ae]=af):aj.type=="bin_mesh"?Q.load({model:ar(aj.url,M.urlBaseType),callback:am(ae)}):aj.type=="ascii_mesh"?ai.load({model:ar(aj.url,M.urlBaseType),callback:am(ae)}):aj.type=="embedded_mesh"&&(aj=M.embeds[aj.id])&&ai.createModel(aj,ap(ae),"")}for(ak in M.textures){if(ae=M.textures[ak],ae.url instanceof Array){e+=ae.url.length;for(Q=0;Q<ae.url.length;Q++){m.onLoadStart()}}else{e+=1,m.onLoadStart()}}an=e;for(ak in M.textures){ae=M.textures[ak];if(ae.mapping!=void 0&&THREE[ae.mapping]!=void 0){ae.mapping=new THREE[ae.mapping]}if(ae.url instanceof Array){Q=[];for(var z=0;z<ae.url.length;z++){Q[z]=ar(ae.url[z],M.urlBaseType)}Q=THREE.ImageUtils.loadTextureCube(Q,ae.mapping,at)}else{Q=THREE.ImageUtils.loadTexture(ar(ae.url,M.urlBaseType),ae.mapping,at);if(THREE[ae.minFilter]!=void 0){Q.minFilter=THREE[ae.minFilter]}if(THREE[ae.magFilter]!=void 0){Q.magFilter=THREE[ae.magFilter]}if(ae.repeat){Q.repeat.set(ae.repeat[0],ae.repeat[1]);if(ae.repeat[0]!=1){Q.wrapS=THREE.RepeatWrapping}if(ae.repeat[1]!=1){Q.wrapT=THREE.RepeatWrapping}}ae.offset&&Q.offset.set(ae.offset[0],ae.offset[1]);if(ae.wrap){ai={repeat:THREE.RepeatWrapping,mirror:THREE.MirroredRepeatWrapping};if(ai[ae.wrap[0]]!==void 0){Q.wrapS=ai[ae.wrap[0]]}if(ai[ae.wrap[1]]!==void 0){Q.wrapT=ai[ae.wrap[1]]}}}O.textures[ak]=Q}for(ad in M.materials){ak=M.materials[ad];for(Y in ak.parameters){if(Y=="envMap"||Y=="map"||Y=="lightMap"){ak.parameters[Y]=O.textures[ak.parameters[Y]]}else{if(Y=="shading"){ak.parameters[Y]=ak.parameters[Y]=="flat"?THREE.FlatShading:THREE.SmoothShading}else{if(Y=="blending"){ak.parameters[Y]=THREE[ak.parameters[Y]]?THREE[ak.parameters[Y]]:THREE.NormalBlending}else{if(Y=="combine"){ak.parameters[Y]=ak.parameters[Y]=="MixOperation"?THREE.MixOperation:THREE.MultiplyOperation}else{if(Y=="vertexColors"){if(ak.parameters[Y]=="face"){ak.parameters[Y]=THREE.FaceColors}else{if(ak.parameters[Y]){ak.parameters[Y]=THREE.VertexColors}}}}}}}}if(ak.parameters.opacity!==void 0&&ak.parameters.opacity<1){ak.parameters.transparent=!0}if(ak.parameters.normalMap){ae=THREE.ShaderUtils.lib.normal;at=THREE.UniformsUtils.clone(ae.uniforms);Q=ak.parameters.color;ai=ak.parameters.specular;aj=ak.parameters.ambient;ah=ak.parameters.shininess;at.tNormal.texture=O.textures[ak.parameters.normalMap];if(ak.parameters.normalMapFactor){at.uNormalScale.value=ak.parameters.normalMapFactor}if(ak.parameters.map){at.tDiffuse.texture=ak.parameters.map,at.enableDiffuse.value=!0}if(ak.parameters.lightMap){at.tAO.texture=ak.parameters.lightMap,at.enableAO.value=!0}if(ak.parameters.specularMap){at.tSpecular.texture=O.textures[ak.parameters.specularMap],at.enableSpecular.value=!0}at.uDiffuseColor.value.setHex(Q);at.uSpecularColor.value.setHex(ai);at.uAmbientColor.value.setHex(aj);at.uShininess.value=ah;if(ak.parameters.opacity){at.uOpacity.value=ak.parameters.opacity}ak=new THREE.MeshShaderMaterial({fragmentShader:ae.fragmentShader,vertexShader:ae.vertexShader,uniforms:at,lights:!0,fog:!0})}else{ak=new THREE[ak.type](ak.parameters)}O.materials[ad]=ak}aq();m.callbackSync(O)}},constructor:THREE.SceneLoader};THREE.UTF8Loader=function(){};THREE.UTF8Loader.prototype=new THREE.UTF8Loader;THREE.UTF8Loader.prototype.constructor=THREE.UTF8Loader;THREE.UTF8Loader.prototype={load:function(m){var w=new XMLHttpRequest,v=m.model,u=m.callback,t=m.scale!==void 0?m.scale:1,o=m.offsetX!==void 0?m.offsetX:0,p=m.offsetY!==void 0?m.offsetY:0,n=m.offsetZ!==void 0?m.offsetZ:0;w.onreadystatechange=function(){w.readyState==4?w.status==200||w.status==0?THREE.UTF8Loader.prototype.createModel(w.responseText,u,t,o,p,n):alert("Couldn't load ["+v+"] ["+w.status+"]"):w.readyState!=3&&w.readyState==2&&w.getResponseHeader("Content-Length")};w.open("GET",v,!0);w.send(null)},decompressMesh:function(m){var w=m.charCodeAt(0);w>=57344&&(w-=2048);w++;for(var v=new Float32Array(8*w),u=1,t=0;t<8;t++){for(var o=0,p=0;p<w;++p){var n=m.charCodeAt(p+u);o+=n>>1^-(n&1);v[8*p+t]=o}u+=w}w=m.length-u;o=new Uint16Array(w);for(t=p=0;t<w;t++){n=m.charCodeAt(t+u),o[t]=p-n,n==0&&p++}return[v,o]},createModel:function(k,u,t,p,o,m){var n=function(){var g=this;g.materials=[];THREE.Geometry.call(this);var e=THREE.UTF8Loader.prototype.decompressMesh(k),b=[],f=[];(function(v,w,j){for(var y,x,z,c=v.length;j<c;j+=w){y=v[j],x=v[j+1],z=v[j+2],y=y/16383*t,x=x/16383*t,z=z/16383*t,y+=p,x+=o,z+=m,THREE.UTF8Loader.prototype.v(g,y,x,z)}})(e[0],8,0);(function(j,z,y){for(var x,w,v=j.length;y<v;y+=z){x=j[y],w=j[y+1],x/=1023,w/=1023,f.push(x,w)}})(e[0],8,3);(function(v,B,A){for(var z,y,x,w=v.length;A<w;A+=B){z=v[A],y=v[A+1],x=v[A+2],z=(z-512)/511,y=(y-512)/511,x=(x-512)/511,b.push(z,y,x)}})(e[0],8,5);(function(C){var A,z,x,w,v,c,D,B=C.length;for(A=0;A<B;A+=3){z=C[A],x=C[A+1],w=C[A+2],THREE.UTF8Loader.prototype.f3n(g,b,z,x,w,0,z,x,w),v=f[z*2],z=f[z*2+1],c=f[x*2],x=f[x*2+1],D=f[w*2],w=f[w*2+1],THREE.UTF8Loader.prototype.uv3(g.faceVertexUvs[0],v,z,c,x,D,w)}})(e[1]);this.computeCentroids();this.computeFaceNormals()};n.prototype=new THREE.Geometry;n.prototype.constructor=n;u(new n)},v:function(g,k,j,h){g.vertices.push(new THREE.Vertex(new THREE.Vector3(k,j,h)))},f3n:function(E,D,C,B,A,y,z,x,t){var y=E.materials[y],w=D[x*3],n=D[x*3+1],x=D[x*3+2],G=D[t*3],F=D[t*3+1],t=D[t*3+2],z=new THREE.Vector3(D[z*3],D[z*3+1],D[z*3+2]),x=new THREE.Vector3(w,n,x),t=new THREE.Vector3(G,F,t);E.faces.push(new THREE.Face3(C,B,A,[z,x,t],null,y))},uv3:function(m,w,v,u,t,o,p){var n=[];n.push(new THREE.UV(w,v));n.push(new THREE.UV(u,t));n.push(new THREE.UV(o,p));m.push(n)},constructor:THREE.UTF8Loader};THREE.MarchingCubes=function(e,f){THREE.Object3D.call(this);this.materials=f instanceof Array?f:[f];this.init=function(c){this.isolation=80;this.size=c;this.size2=this.size*this.size;this.size3=this.size2*this.size;this.halfsize=this.size/2;this.delta=2/this.size;this.yd=this.size;this.zd=this.size2;this.field=new Float32Array(this.size3);this.normal_cache=new Float32Array(this.size3*3);this.vlist=new Float32Array(36);this.nlist=new Float32Array(36);this.firstDraw=!0;this.maxCount=4096;this.count=0;this.hasNormal=this.hasPos=!1;this.positionArray=new Float32Array(this.maxCount*3);this.normalArray=new Float32Array(this.maxCount*3)};this.lerp=function(h,k,j){return h+(k-h)*j};this.VIntX=function(B,A,z,x,y,w,t,v,n,C){y=(y-n)/(C-n);n=this.normal_cache;A[x]=w+y*this.delta;A[x+1]=t;A[x+2]=v;z[x]=this.lerp(n[B],n[B+3],y);z[x+1]=this.lerp(n[B+1],n[B+4],y);z[x+2]=this.lerp(n[B+2],n[B+5],y)};this.VIntY=function(B,A,z,x,y,w,t,v,n,C){y=(y-n)/(C-n);n=this.normal_cache;A[x]=w;A[x+1]=t+y*this.delta;A[x+2]=v;A=B+this.yd*3;z[x]=this.lerp(n[B],n[A],y);z[x+1]=this.lerp(n[B+1],n[A+1],y);z[x+2]=this.lerp(n[B+2],n[A+2],y)};this.VIntZ=function(B,A,z,x,y,w,t,v,n,C){y=(y-n)/(C-n);n=this.normal_cache;A[x]=w;A[x+1]=t;A[x+2]=v+y*this.delta;A=B+this.zd*3;z[x]=this.lerp(n[B],n[A],y);z[x+1]=this.lerp(n[B+1],n[A+1],y);z[x+2]=this.lerp(n[B+2],n[A+2],y)};this.compNorm=function(g){var h=g*3;this.normal_cache[h]==0&&(this.normal_cache[h]=this.field[g-1]-this.field[g+1],this.normal_cache[h+1]=this.field[g-this.yd]-this.field[g+this.yd],this.normal_cache[h+2]=this.field[g-this.zd]-this.field[g+this.zd])};this.polygonize=function(ai,ah,ag,ae,af,ad){var ab=ae+1,ac=ae+this.yd,aa=ae+this.zd,T=ab+this.yd,R=ab+this.zd,V=ae+this.yd+this.zd,P=ab+this.yd+this.zd,N=0,Y=this.field[ae],Z=this.field[ab],O=this.field[ac],L=this.field[T],Q=this.field[aa],M=this.field[R],U=this.field[V],C=this.field[P];Y<af&&(N|=1);Z<af&&(N|=2);O<af&&(N|=8);L<af&&(N|=4);Q<af&&(N|=16);M<af&&(N|=32);U<af&&(N|=128);C<af&&(N|=64);var W=THREE.edgeTable[N];if(W==0){return 0}var F=this.delta,z=ai+F,n=ah+F,F=ag+F;W&1&&(this.compNorm(ae),this.compNorm(ab),this.VIntX(ae*3,this.vlist,this.nlist,0,af,ai,ah,ag,Y,Z));W&2&&(this.compNorm(ab),this.compNorm(T),this.VIntY(ab*3,this.vlist,this.nlist,3,af,z,ah,ag,Z,L));W&4&&(this.compNorm(ac),this.compNorm(T),this.VIntX(ac*3,this.vlist,this.nlist,6,af,ai,n,ag,O,L));W&8&&(this.compNorm(ae),this.compNorm(ac),this.VIntY(ae*3,this.vlist,this.nlist,9,af,ai,ah,ag,Y,O));W&16&&(this.compNorm(aa),this.compNorm(R),this.VIntX(aa*3,this.vlist,this.nlist,12,af,ai,ah,F,Q,M));W&32&&(this.compNorm(R),this.compNorm(P),this.VIntY(R*3,this.vlist,this.nlist,15,af,z,ah,F,M,C));W&64&&(this.compNorm(V),this.compNorm(P),this.VIntX(V*3,this.vlist,this.nlist,18,af,ai,n,F,U,C));W&128&&(this.compNorm(aa),this.compNorm(V),this.VIntY(aa*3,this.vlist,this.nlist,21,af,ai,ah,F,Q,U));W&256&&(this.compNorm(ae),this.compNorm(aa),this.VIntZ(ae*3,this.vlist,this.nlist,24,af,ai,ah,ag,Y,Q));W&512&&(this.compNorm(ab),this.compNorm(R),this.VIntZ(ab*3,this.vlist,this.nlist,27,af,z,ah,ag,Z,M));W&1024&&(this.compNorm(T),this.compNorm(P),this.VIntZ(T*3,this.vlist,this.nlist,30,af,z,n,ag,L,C));W&2048&&(this.compNorm(ac),this.compNorm(V),this.VIntZ(ac*3,this.vlist,this.nlist,33,af,ai,n,ag,O,U));N<<=4;for(af=ae=0;THREE.triTable[N+af]!=-1;){ai=N+af,ah=ai+1,ag=ai+2,this.posnormtriv(this.vlist,this.nlist,3*THREE.triTable[ai],3*THREE.triTable[ah],3*THREE.triTable[ag],ad),af+=3,ae++}return ae};this.posnormtriv=function(m,w,u,p,t,n){var v=this.count*3;this.positionArray[v]=m[u];this.positionArray[v+1]=m[u+1];this.positionArray[v+2]=m[u+2];this.positionArray[v+3]=m[p];this.positionArray[v+4]=m[p+1];this.positionArray[v+5]=m[p+2];this.positionArray[v+6]=m[t];this.positionArray[v+7]=m[t+1];this.positionArray[v+8]=m[t+2];this.normalArray[v]=w[u];this.normalArray[v+1]=w[u+1];this.normalArray[v+2]=w[u+2];this.normalArray[v+3]=w[p];this.normalArray[v+4]=w[p+1];this.normalArray[v+5]=w[p+2];this.normalArray[v+6]=w[t];this.normalArray[v+7]=w[t+1];this.normalArray[v+8]=w[t+2];this.hasNormal=this.hasPos=!0;this.count+=3;this.count>=this.maxCount-3&&n(this)};this.begin=function(){this.count=0;this.hasNormal=this.hasPos=!1};this.end=function(g){if(this.count!=0){for(var h=this.count*3;h<this.positionArray.length;h++){this.positionArray[h]=0}g(this)}};this.addBall=function(S,R,Q,O,P){var N=this.size*Math.sqrt(O/P),L=Q*this.size,M=R*this.size,K=S*this.size,F=Math.floor(L-N);F<1&&(F=1);L=Math.floor(L+N);L>this.size-1&&(L=this.size-1);var E=Math.floor(M-N);E<1&&(E=1);M=Math.floor(M+N);M>this.size-1&&(M=this.size-1);var G=Math.floor(K-N);G<1&&(G=1);N=Math.floor(K+N);N>this.size-1&&(N=this.size-1);for(var D,z,I,J,C,n;F<L;F++){K=this.size2*F;z=F/this.size-Q;C=z*z;for(z=E;z<M;z++){I=K+this.size*z;D=z/this.size-R;n=D*D;for(D=G;D<N;D++){J=D/this.size-S,J=O/(0.000001+J*J+n+C)-P,J>0&&(this.field[I+D]+=J)}}}};this.addPlaneX=function(D,C){var B,z,A,y,w,x=this.size,n=this.yd,F=this.zd,E=this.field,G=x*Math.sqrt(D/C);G>x&&(G=x);for(B=0;B<G;B++){if(z=B/x,z*=z,y=D/(0.0001+z)-C,y>0){for(z=0;z<x;z++){w=B+z*n;for(A=0;A<x;A++){E[F*A+w]+=y}}}}};this.addPlaneY=function(E,D){var C,A,B,z,x,y,n=this.size,H=this.yd,G=this.zd,I=this.field,F=n*Math.sqrt(E/D);F>n&&(F=n);for(A=0;A<F;A++){if(C=A/n,C*=C,z=E/(0.0001+C)-D,z>0){x=A*H;for(C=0;C<n;C++){y=x+C;for(B=0;B<n;B++){I[G*B+y]+=z}}}}};this.addPlaneZ=function(p,y){var w,u,v,t,x,n;size=this.size;yd=this.yd;zd=this.zd;field=this.field;dist=size*Math.sqrt(p/y);dist>size&&(dist=size);for(v=0;v<dist;v++){if(w=v/size,w*=w,t=p/(0.0001+w)-y,t>0){x=zd*v;for(u=0;u<size;u++){n=x+u*yd;for(w=0;w<size;w++){field[n+w]+=t}}}}};this.reset=function(){var c;for(c=0;c<this.size3;c++){this.normal_cache[c*3]=0,this.field[c]=0}};this.render=function(C){this.begin();var B,A,y,z,x,t,w,n,E,D=this.size-2;for(z=1;z<D;z++){E=this.size2*z;w=(z-this.halfsize)/this.halfsize;for(y=1;y<D;y++){n=E+this.size*y;t=(y-this.halfsize)/this.halfsize;for(A=1;A<D;A++){x=(A-this.halfsize)/this.halfsize,B=n+A,this.polygonize(x,t,w,B,this.isolation,C)}}}this.end(C)};this.generateGeometry=function(){var h=0,k=new THREE.Geometry,j=[];this.render(function(w){var x,n,c,g,b,z,y,A;for(x=0;x<w.count;x++){y=x*3,b=y+1,A=y+2,n=w.positionArray[y],c=w.positionArray[b],g=w.positionArray[A],z=new THREE.Vector3(n,c,g),n=w.normalArray[y],c=w.normalArray[b],g=w.normalArray[A],y=new THREE.Vector3(n,c,g),y.normalize(),b=new THREE.Vertex(z),k.vertices.push(b),j.push(y)}nfaces=w.count/3;for(x=0;x<nfaces;x++){y=(h+x)*3,b=y+1,A=y+2,z=j[y],n=j[b],c=j[A],y=new THREE.Face3(y,b,A,[z,n,c]),k.faces.push(y)}h+=nfaces;w.count=0});return k};this.init(e)};THREE.MarchingCubes.prototype=new THREE.Object3D;THREE.MarchingCubes.prototype.constructor=THREE.MarchingCubes;THREE.edgeTable=new Int32Array([0,265,515,778,1030,1295,1541,1804,2060,2309,2575,2822,3082,3331,3593,3840,400,153,915,666,1430,1183,1941,1692,2460,2197,2975,2710,3482,3219,3993,3728,560,825,51,314,1590,1855,1077,1340,2620,2869,2111,2358,3642,3891,3129,3376,928,681,419,170,1958,1711,1445,1196,2988,2725,2479,2214,4010,3747,3497,3232,1120,1385,1635,1898,102,367,613,876,3180,3429,3695,3942,2154,2403,2665,2912,1520,1273,2035,1786,502,255,1013,764,3580,3317,4095,3830,2554,2291,3065,2800,1616,1881,1107,1370,598,863,85,348,3676,3925,3167,3414,2650,2899,2137,2384,1984,1737,1475,1226,966,719,453,204,4044,3781,3535,3270,3018,2755,2505,2240,2240,2505,2755,3018,3270,3535,3781,4044,204,453,719,966,1226,1475,1737,1984,2384,2137,2899,2650,3414,3167,3925,3676,348,85,863,598,1370,1107,1881,1616,2800,3065,2291,2554,3830,4095,3317,3580,764,1013,255,502,1786,2035,1273,1520,2912,2665,2403,2154,3942,3695,3429,3180,876,613,367,102,1898,1635,1385,1120,3232,3497,3747,4010,2214,2479,2725,2988,1196,1445,1711,1958,170,419,681,928,3376,3129,3891,3642,2358,2111,2869,2620,1340,1077,1855,1590,314,51,825,560,3728,3993,3219,3482,2710,2975,2197,2460,1692,1941,1183,1430,666,915,153,400,3840,3593,3331,3082,2822,2575,2309,2060,1804,1541,1295,1030,778,515,265,0]);THREE.triTable=new Int32Array([-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,8,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,1,9,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,8,3,9,8,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,2,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,8,3,1,2,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,2,10,0,2,9,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2,8,3,2,10,8,10,9,8,-1,-1,-1,-1,-1,-1,-1,3,11,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,11,2,8,11,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,9,0,2,3,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,11,2,1,9,11,9,8,11,-1,-1,-1,-1,-1,-1,-1,3,10,1,11,10,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,10,1,0,8,10,8,11,10,-1,-1,-1,-1,-1,-1,-1,3,9,0,3,11,9,11,10,9,-1,-1,-1,-1,-1,-1,-1,9,8,10,10,8,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,7,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,3,0,7,3,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,1,9,8,4,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,1,9,4,7,1,7,3,1,-1,-1,-1,-1,-1,-1,-1,1,2,10,8,4,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,4,7,3,0,4,1,2,10,-1,-1,-1,-1,-1,-1,-1,9,2,10,9,0,2,8,4,7,-1,-1,-1,-1,-1,-1,-1,2,10,9,2,9,7,2,7,3,7,9,4,-1,-1,-1,-1,8,4,7,3,11,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,11,4,7,11,2,4,2,0,4,-1,-1,-1,-1,-1,-1,-1,9,0,1,8,4,7,2,3,11,-1,-1,-1,-1,-1,-1,-1,4,7,11,9,4,11,9,11,2,9,2,1,-1,-1,-1,-1,3,10,1,3,11,10,7,8,4,-1,-1,-1,-1,-1,-1,-1,1,11,10,1,4,11,1,0,4,7,11,4,-1,-1,-1,-1,4,7,8,9,0,11,9,11,10,11,0,3,-1,-1,-1,-1,4,7,11,4,11,9,9,11,10,-1,-1,-1,-1,-1,-1,-1,9,5,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,5,4,0,8,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,5,4,1,5,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,5,4,8,3,5,3,1,5,-1,-1,-1,-1,-1,-1,-1,1,2,10,9,5,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,0,8,1,2,10,4,9,5,-1,-1,-1,-1,-1,-1,-1,5,2,10,5,4,2,4,0,2,-1,-1,-1,-1,-1,-1,-1,2,10,5,3,2,5,3,5,4,3,4,8,-1,-1,-1,-1,9,5,4,2,3,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,11,2,0,8,11,4,9,5,-1,-1,-1,-1,-1,-1,-1,0,5,4,0,1,5,2,3,11,-1,-1,-1,-1,-1,-1,-1,2,1,5,2,5,8,2,8,11,4,8,5,-1,-1,-1,-1,10,3,11,10,1,3,9,5,4,-1,-1,-1,-1,-1,-1,-1,4,9,5,0,8,1,8,10,1,8,11,10,-1,-1,-1,-1,5,4,0,5,0,11,5,11,10,11,0,3,-1,-1,-1,-1,5,4,8,5,8,10,10,8,11,-1,-1,-1,-1,-1,-1,-1,9,7,8,5,7,9,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,3,0,9,5,3,5,7,3,-1,-1,-1,-1,-1,-1,-1,0,7,8,0,1,7,1,5,7,-1,-1,-1,-1,-1,-1,-1,1,5,3,3,5,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,7,8,9,5,7,10,1,2,-1,-1,-1,-1,-1,-1,-1,10,1,2,9,5,0,5,3,0,5,7,3,-1,-1,-1,-1,8,0,2,8,2,5,8,5,7,10,5,2,-1,-1,-1,-1,2,10,5,2,5,3,3,5,7,-1,-1,-1,-1,-1,-1,-1,7,9,5,7,8,9,3,11,2,-1,-1,-1,-1,-1,-1,-1,9,5,7,9,7,2,9,2,0,2,7,11,-1,-1,-1,-1,2,3,11,0,1,8,1,7,8,1,5,7,-1,-1,-1,-1,11,2,1,11,1,7,7,1,5,-1,-1,-1,-1,-1,-1,-1,9,5,8,8,5,7,10,1,3,10,3,11,-1,-1,-1,-1,5,7,0,5,0,9,7,11,0,1,0,10,11,10,0,-1,11,10,0,11,0,3,10,5,0,8,0,7,5,7,0,-1,11,10,5,7,11,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,10,6,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,8,3,5,10,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,0,1,5,10,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,8,3,1,9,8,5,10,6,-1,-1,-1,-1,-1,-1,-1,1,6,5,2,6,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,6,5,1,2,6,3,0,8,-1,-1,-1,-1,-1,-1,-1,9,6,5,9,0,6,0,2,6,-1,-1,-1,-1,-1,-1,-1,5,9,8,5,8,2,5,2,6,3,2,8,-1,-1,-1,-1,2,3,11,10,6,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,11,0,8,11,2,0,10,6,5,-1,-1,-1,-1,-1,-1,-1,0,1,9,2,3,11,5,10,6,-1,-1,-1,-1,-1,-1,-1,5,10,6,1,9,2,9,11,2,9,8,11,-1,-1,-1,-1,6,3,11,6,5,3,5,1,3,-1,-1,-1,-1,-1,-1,-1,0,8,11,0,11,5,0,5,1,5,11,6,-1,-1,-1,-1,3,11,6,0,3,6,0,6,5,0,5,9,-1,-1,-1,-1,6,5,9,6,9,11,11,9,8,-1,-1,-1,-1,-1,-1,-1,5,10,6,4,7,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,3,0,4,7,3,6,5,10,-1,-1,-1,-1,-1,-1,-1,1,9,0,5,10,6,8,4,7,-1,-1,-1,-1,-1,-1,-1,10,6,5,1,9,7,1,7,3,7,9,4,-1,-1,-1,-1,6,1,2,6,5,1,4,7,8,-1,-1,-1,-1,-1,-1,-1,1,2,5,5,2,6,3,0,4,3,4,7,-1,-1,-1,-1,8,4,7,9,0,5,0,6,5,0,2,6,-1,-1,-1,-1,7,3,9,7,9,4,3,2,9,5,9,6,2,6,9,-1,3,11,2,7,8,4,10,6,5,-1,-1,-1,-1,-1,-1,-1,5,10,6,4,7,2,4,2,0,2,7,11,-1,-1,-1,-1,0,1,9,4,7,8,2,3,11,5,10,6,-1,-1,-1,-1,9,2,1,9,11,2,9,4,11,7,11,4,5,10,6,-1,8,4,7,3,11,5,3,5,1,5,11,6,-1,-1,-1,-1,5,1,11,5,11,6,1,0,11,7,11,4,0,4,11,-1,0,5,9,0,6,5,0,3,6,11,6,3,8,4,7,-1,6,5,9,6,9,11,4,7,9,7,11,9,-1,-1,-1,-1,10,4,9,6,4,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,10,6,4,9,10,0,8,3,-1,-1,-1,-1,-1,-1,-1,10,0,1,10,6,0,6,4,0,-1,-1,-1,-1,-1,-1,-1,8,3,1,8,1,6,8,6,4,6,1,10,-1,-1,-1,-1,1,4,9,1,2,4,2,6,4,-1,-1,-1,-1,-1,-1,-1,3,0,8,1,2,9,2,4,9,2,6,4,-1,-1,-1,-1,0,2,4,4,2,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,3,2,8,2,4,4,2,6,-1,-1,-1,-1,-1,-1,-1,10,4,9,10,6,4,11,2,3,-1,-1,-1,-1,-1,-1,-1,0,8,2,2,8,11,4,9,10,4,10,6,-1,-1,-1,-1,3,11,2,0,1,6,0,6,4,6,1,10,-1,-1,-1,-1,6,4,1,6,1,10,4,8,1,2,1,11,8,11,1,-1,9,6,4,9,3,6,9,1,3,11,6,3,-1,-1,-1,-1,8,11,1,8,1,0,11,6,1,9,1,4,6,4,1,-1,3,11,6,3,6,0,0,6,4,-1,-1,-1,-1,-1,-1,-1,6,4,8,11,6,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7,10,6,7,8,10,8,9,10,-1,-1,-1,-1,-1,-1,-1,0,7,3,0,10,7,0,9,10,6,7,10,-1,-1,-1,-1,10,6,7,1,10,7,1,7,8,1,8,0,-1,-1,-1,-1,10,6,7,10,7,1,1,7,3,-1,-1,-1,-1,-1,-1,-1,1,2,6,1,6,8,1,8,9,8,6,7,-1,-1,-1,-1,2,6,9,2,9,1,6,7,9,0,9,3,7,3,9,-1,7,8,0,7,0,6,6,0,2,-1,-1,-1,-1,-1,-1,-1,7,3,2,6,7,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2,3,11,10,6,8,10,8,9,8,6,7,-1,-1,-1,-1,2,0,7,2,7,11,0,9,7,6,7,10,9,10,7,-1,1,8,0,1,7,8,1,10,7,6,7,10,2,3,11,-1,11,2,1,11,1,7,10,6,1,6,7,1,-1,-1,-1,-1,8,9,6,8,6,7,9,1,6,11,6,3,1,3,6,-1,0,9,1,11,6,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7,8,0,7,0,6,3,11,0,11,6,0,-1,-1,-1,-1,7,11,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7,6,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,0,8,11,7,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,1,9,11,7,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,1,9,8,3,1,11,7,6,-1,-1,-1,-1,-1,-1,-1,10,1,2,6,11,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,2,10,3,0,8,6,11,7,-1,-1,-1,-1,-1,-1,-1,2,9,0,2,10,9,6,11,7,-1,-1,-1,-1,-1,-1,-1,6,11,7,2,10,3,10,8,3,10,9,8,-1,-1,-1,-1,7,2,3,6,2,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7,0,8,7,6,0,6,2,0,-1,-1,-1,-1,-1,-1,-1,2,7,6,2,3,7,0,1,9,-1,-1,-1,-1,-1,-1,-1,1,6,2,1,8,6,1,9,8,8,7,6,-1,-1,-1,-1,10,7,6,10,1,7,1,3,7,-1,-1,-1,-1,-1,-1,-1,10,7,6,1,7,10,1,8,7,1,0,8,-1,-1,-1,-1,0,3,7,0,7,10,0,10,9,6,10,7,-1,-1,-1,-1,7,6,10,7,10,8,8,10,9,-1,-1,-1,-1,-1,-1,-1,6,8,4,11,8,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,6,11,3,0,6,0,4,6,-1,-1,-1,-1,-1,-1,-1,8,6,11,8,4,6,9,0,1,-1,-1,-1,-1,-1,-1,-1,9,4,6,9,6,3,9,3,1,11,3,6,-1,-1,-1,-1,6,8,4,6,11,8,2,10,1,-1,-1,-1,-1,-1,-1,-1,1,2,10,3,0,11,0,6,11,0,4,6,-1,-1,-1,-1,4,11,8,4,6,11,0,2,9,2,10,9,-1,-1,-1,-1,10,9,3,10,3,2,9,4,3,11,3,6,4,6,3,-1,8,2,3,8,4,2,4,6,2,-1,-1,-1,-1,-1,-1,-1,0,4,2,4,6,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,9,0,2,3,4,2,4,6,4,3,8,-1,-1,-1,-1,1,9,4,1,4,2,2,4,6,-1,-1,-1,-1,-1,-1,-1,8,1,3,8,6,1,8,4,6,6,10,1,-1,-1,-1,-1,10,1,0,10,0,6,6,0,4,-1,-1,-1,-1,-1,-1,-1,4,6,3,4,3,8,6,10,3,0,3,9,10,9,3,-1,10,9,4,6,10,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,9,5,7,6,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,8,3,4,9,5,11,7,6,-1,-1,-1,-1,-1,-1,-1,5,0,1,5,4,0,7,6,11,-1,-1,-1,-1,-1,-1,-1,11,7,6,8,3,4,3,5,4,3,1,5,-1,-1,-1,-1,9,5,4,10,1,2,7,6,11,-1,-1,-1,-1,-1,-1,-1,6,11,7,1,2,10,0,8,3,4,9,5,-1,-1,-1,-1,7,6,11,5,4,10,4,2,10,4,0,2,-1,-1,-1,-1,3,4,8,3,5,4,3,2,5,10,5,2,11,7,6,-1,7,2,3,7,6,2,5,4,9,-1,-1,-1,-1,-1,-1,-1,9,5,4,0,8,6,0,6,2,6,8,7,-1,-1,-1,-1,3,6,2,3,7,6,1,5,0,5,4,0,-1,-1,-1,-1,6,2,8,6,8,7,2,1,8,4,8,5,1,5,8,-1,9,5,4,10,1,6,1,7,6,1,3,7,-1,-1,-1,-1,1,6,10,1,7,6,1,0,7,8,7,0,9,5,4,-1,4,0,10,4,10,5,0,3,10,6,10,7,3,7,10,-1,7,6,10,7,10,8,5,4,10,4,8,10,-1,-1,-1,-1,6,9,5,6,11,9,11,8,9,-1,-1,-1,-1,-1,-1,-1,3,6,11,0,6,3,0,5,6,0,9,5,-1,-1,-1,-1,0,11,8,0,5,11,0,1,5,5,6,11,-1,-1,-1,-1,6,11,3,6,3,5,5,3,1,-1,-1,-1,-1,-1,-1,-1,1,2,10,9,5,11,9,11,8,11,5,6,-1,-1,-1,-1,0,11,3,0,6,11,0,9,6,5,6,9,1,2,10,-1,11,8,5,11,5,6,8,0,5,10,5,2,0,2,5,-1,6,11,3,6,3,5,2,10,3,10,5,3,-1,-1,-1,-1,5,8,9,5,2,8,5,6,2,3,8,2,-1,-1,-1,-1,9,5,6,9,6,0,0,6,2,-1,-1,-1,-1,-1,-1,-1,1,5,8,1,8,0,5,6,8,3,8,2,6,2,8,-1,1,5,6,2,1,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,3,6,1,6,10,3,8,6,5,6,9,8,9,6,-1,10,1,0,10,0,6,9,5,0,5,6,0,-1,-1,-1,-1,0,3,8,5,6,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,10,5,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,11,5,10,7,5,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,11,5,10,11,7,5,8,3,0,-1,-1,-1,-1,-1,-1,-1,5,11,7,5,10,11,1,9,0,-1,-1,-1,-1,-1,-1,-1,10,7,5,10,11,7,9,8,1,8,3,1,-1,-1,-1,-1,11,1,2,11,7,1,7,5,1,-1,-1,-1,-1,-1,-1,-1,0,8,3,1,2,7,1,7,5,7,2,11,-1,-1,-1,-1,9,7,5,9,2,7,9,0,2,2,11,7,-1,-1,-1,-1,7,5,2,7,2,11,5,9,2,3,2,8,9,8,2,-1,2,5,10,2,3,5,3,7,5,-1,-1,-1,-1,-1,-1,-1,8,2,0,8,5,2,8,7,5,10,2,5,-1,-1,-1,-1,9,0,1,5,10,3,5,3,7,3,10,2,-1,-1,-1,-1,9,8,2,9,2,1,8,7,2,10,2,5,7,5,2,-1,1,3,5,3,7,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,8,7,0,7,1,1,7,5,-1,-1,-1,-1,-1,-1,-1,9,0,3,9,3,5,5,3,7,-1,-1,-1,-1,-1,-1,-1,9,8,7,5,9,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,5,8,4,5,10,8,10,11,8,-1,-1,-1,-1,-1,-1,-1,5,0,4,5,11,0,5,10,11,11,3,0,-1,-1,-1,-1,0,1,9,8,4,10,8,10,11,10,4,5,-1,-1,-1,-1,10,11,4,10,4,5,11,3,4,9,4,1,3,1,4,-1,2,5,1,2,8,5,2,11,8,4,5,8,-1,-1,-1,-1,0,4,11,0,11,3,4,5,11,2,11,1,5,1,11,-1,0,2,5,0,5,9,2,11,5,4,5,8,11,8,5,-1,9,4,5,2,11,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2,5,10,3,5,2,3,4,5,3,8,4,-1,-1,-1,-1,5,10,2,5,2,4,4,2,0,-1,-1,-1,-1,-1,-1,-1,3,10,2,3,5,10,3,8,5,4,5,8,0,1,9,-1,5,10,2,5,2,4,1,9,2,9,4,2,-1,-1,-1,-1,8,4,5,8,5,3,3,5,1,-1,-1,-1,-1,-1,-1,-1,0,4,5,1,0,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,4,5,8,5,3,9,0,5,0,3,5,-1,-1,-1,-1,9,4,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,11,7,4,9,11,9,10,11,-1,-1,-1,-1,-1,-1,-1,0,8,3,4,9,7,9,11,7,9,10,11,-1,-1,-1,-1,1,10,11,1,11,4,1,4,0,7,4,11,-1,-1,-1,-1,3,1,4,3,4,8,1,10,4,7,4,11,10,11,4,-1,4,11,7,9,11,4,9,2,11,9,1,2,-1,-1,-1,-1,9,7,4,9,11,7,9,1,11,2,11,1,0,8,3,-1,11,7,4,11,4,2,2,4,0,-1,-1,-1,-1,-1,-1,-1,11,7,4,11,4,2,8,3,4,3,2,4,-1,-1,-1,-1,2,9,10,2,7,9,2,3,7,7,4,9,-1,-1,-1,-1,9,10,7,9,7,4,10,2,7,8,7,0,2,0,7,-1,3,7,10,3,10,2,7,4,10,1,10,0,4,0,10,-1,1,10,2,8,7,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,9,1,4,1,7,7,1,3,-1,-1,-1,-1,-1,-1,-1,4,9,1,4,1,7,0,8,1,8,7,1,-1,-1,-1,-1,4,0,3,7,4,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,8,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,10,8,10,11,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,0,9,3,9,11,11,9,10,-1,-1,-1,-1,-1,-1,-1,0,1,10,0,10,8,8,10,11,-1,-1,-1,-1,-1,-1,-1,3,1,10,11,3,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,2,11,1,11,9,9,11,8,-1,-1,-1,-1,-1,-1,-1,3,0,9,3,9,11,1,2,9,2,11,9,-1,-1,-1,-1,0,2,11,8,0,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,2,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2,3,8,2,8,10,10,8,9,-1,-1,-1,-1,-1,-1,-1,9,10,2,0,9,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2,3,8,2,8,10,0,1,8,1,10,8,-1,-1,-1,-1,1,10,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,3,8,9,1,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,9,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,3,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1]);THREE.Trident=function(h){function n(b){return new THREE.Mesh(new THREE.CylinderGeometry(30,0.1,h.length/20,h.length/5),new THREE.MeshBasicMaterial({color:b}))}function m(f,o){var g=new THREE.Geometry;g.vertices=[new THREE.Vertex,new THREE.Vertex(f)];return new THREE.Line(g,new THREE.LineBasicMaterial({color:o}))}THREE.Object3D.call(this);var k=Math.PI/2,j,h=h||THREE.Trident.defaultParams;if(h!==THREE.Trident.defaultParams){for(j in THREE.Trident.defaultParams){h.hasOwnProperty(j)||(h[j]=THREE.Trident.defaultParams[j])}}this.scale=new THREE.Vector3(h.scale,h.scale,h.scale);this.addChild(m(new THREE.Vector3(h.length,0,0),h.xAxisColor));this.addChild(m(new THREE.Vector3(0,h.length,0),h.yAxisColor));this.addChild(m(new THREE.Vector3(0,0,h.length),h.zAxisColor));if(h.showArrows){j=n(h.xAxisColor),j.rotation.y=-k,j.position.x=h.length,this.addChild(j),j=n(h.yAxisColor),j.rotation.x=k,j.position.y=h.length,this.addChild(j),j=n(h.zAxisColor),j.rotation.y=Math.PI,j.position.z=h.length,this.addChild(j)}};THREE.Trident.prototype=new THREE.Object3D;THREE.Trident.prototype.constructor=THREE.Trident;THREE.Trident.defaultParams={xAxisColor:16711680,yAxisColor:65280,zAxisColor:255,showArrows:!0,length:100,scale:1};THREE.PlaneCollider=function(e,f){this.point=e;this.normal=f};THREE.SphereCollider=function(e,f){this.center=e;this.radius=f;this.radiusSq=f*f};THREE.BoxCollider=function(e,f){this.min=e;this.max=f;this.dynamic=!0;this.normal=new THREE.Vector3};THREE.MeshCollider=function(e,f){this.mesh=e;this.box=f;this.numFaces=this.mesh.geometry.faces.length;this.normal=new THREE.Vector3};THREE.CollisionSystem=function(){this.collisionNormal=new THREE.Vector3;this.colliders=[];this.hits=[]};THREE.Collisions=new THREE.CollisionSystem;THREE.CollisionSystem.prototype.merge=function(c){this.colliders=this.colliders.concat(c.colliders);this.hits=this.hits.concat(c.hits)};THREE.CollisionSystem.prototype.rayCastAll=function(h){h.direction.normalize();this.hits.length=0;var p,o,n,m,k=0;p=0;for(o=this.colliders.length;p<o;p++){if(m=this.colliders[p],n=this.rayCast(h,m),n<Number.MAX_VALUE){m.distance=n,n>k?this.hits.push(m):this.hits.unshift(m),k=n}}return this.hits};THREE.CollisionSystem.prototype.rayCastNearest=function(g){var k=this.rayCastAll(g);if(k.length==0){return null}for(var j=0;k[j] instanceof THREE.MeshCollider;){var h=this.rayMesh(g,k[j]);if(h.dist<Number.MAX_VALUE){k[j].distance=h.dist;k[j].faceIndex=h.faceIndex;break}j++}if(j>k.length){return null}return k[j]};THREE.CollisionSystem.prototype.rayCast=function(e,f){if(f instanceof THREE.PlaneCollider){return this.rayPlane(e,f)}else{if(f instanceof THREE.SphereCollider){return this.raySphere(e,f)}else{if(f instanceof THREE.BoxCollider){return this.rayBox(e,f)}else{if(f instanceof THREE.MeshCollider&&f.box){return this.rayBox(e,f.box)}}}}};THREE.CollisionSystem.prototype.rayMesh=function(C,B){for(var A=this.makeRayLocal(C,B.mesh),z=Number.MAX_VALUE,y,w=0;w<B.numFaces;w++){var x=B.mesh.geometry.faces[w],v=B.mesh.geometry.vertices[x.a].position,t=B.mesh.geometry.vertices[x.b].position,u=B.mesh.geometry.vertices[x.c].position,n=x instanceof THREE.Face4?B.mesh.geometry.vertices[x.d].position:null;x instanceof THREE.Face3?(x=this.rayTriangle(A,v,t,u,z,this.collisionNormal,B.mesh),x<z&&(z=x,y=w,B.normal.copy(this.collisionNormal),B.normal.normalize())):x instanceof THREE.Face4&&(x=this.rayTriangle(A,v,t,n,z,this.collisionNormal,B.mesh),x<z&&(z=x,y=w,B.normal.copy(this.collisionNormal),B.normal.normalize()),x=this.rayTriangle(A,t,u,n,z,this.collisionNormal,B.mesh),x<z&&(z=x,y=w,B.normal.copy(this.collisionNormal),B.normal.normalize()))}return{dist:z,faceIndex:y}};THREE.CollisionSystem.prototype.rayTriangle=function(y,x,w,v,u,p,t){var n=THREE.CollisionSystem.__v1,m=THREE.CollisionSystem.__v2;p.set(0,0,0);n.sub(w,x);m.sub(v,w);p.cross(n,m);n=p.dot(y.direction);if(!(n<0)){if(t.doubleSided||t.flipSided){p.multiplyScalar(-1),n*=-1}else{return Number.MAX_VALUE}}t=p.dot(x)-p.dot(y.origin);if(!(t<=0)){return Number.MAX_VALUE}if(!(t>=n*u)){return Number.MAX_VALUE}t/=n;n=THREE.CollisionSystem.__v3;n.copy(y.direction);n.multiplyScalar(t);n.addSelf(y.origin);Math.abs(p.x)>Math.abs(p.y)?Math.abs(p.x)>Math.abs(p.z)?(y=n.y-x.y,p=w.y-x.y,u=v.y-x.y,n=n.z-x.z,w=w.z-x.z,v=v.z-x.z):(y=n.x-x.x,p=w.x-x.x,u=v.x-x.x,n=n.y-x.y,w=w.y-x.y,v=v.y-x.y):Math.abs(p.y)>Math.abs(p.z)?(y=n.x-x.x,p=w.x-x.x,u=v.x-x.x,n=n.z-x.z,w=w.z-x.z,v=v.z-x.z):(y=n.x-x.x,p=w.x-x.x,u=v.x-x.x,n=n.y-x.y,w=w.y-x.y,v=v.y-x.y);x=p*v-w*u;if(x==0){return Number.MAX_VALUE}x=1/x;v=(y*v-n*u)*x;if(!(v>=0)){return Number.MAX_VALUE}x*=p*n-w*y;if(!(x>=0)){return Number.MAX_VALUE}if(!(1-v-x>=0)){return Number.MAX_VALUE}return t};THREE.CollisionSystem.prototype.makeRayLocal=function(g,k){var j=THREE.CollisionSystem.__m;THREE.Matrix4.makeInvert(k.matrixWorld,j);var h=THREE.CollisionSystem.__r;h.origin.copy(g.origin);h.direction.copy(g.direction);j.multiplyVector3(h.origin);j.rotateAxis(h.direction);h.direction.normalize();return h};THREE.CollisionSystem.prototype.rayBox=function(A,z){var y;z.dynamic&&z.mesh&&z.mesh.matrixWorld?y=this.makeRayLocal(A,z.mesh):(y=THREE.CollisionSystem.__r,y.origin.copy(A.origin),y.direction.copy(A.direction));var x=0,w=0,u=0,v=0,t=0,n=0,p=!0;y.origin.x<z.min.x?(x=z.min.x-y.origin.x,x/=y.direction.x,p=!1,v=-1):y.origin.x>z.max.x&&(x=z.max.x-y.origin.x,x/=y.direction.x,p=!1,v=1);y.origin.y<z.min.y?(w=z.min.y-y.origin.y,w/=y.direction.y,p=!1,t=-1):y.origin.y>z.max.y&&(w=z.max.y-y.origin.y,w/=y.direction.y,p=!1,t=1);y.origin.z<z.min.z?(u=z.min.z-y.origin.z,u/=y.direction.z,p=!1,n=-1):y.origin.z>z.max.z&&(u=z.max.z-y.origin.z,u/=y.direction.z,p=!1,n=1);if(p){return -1}p=0;w>x&&(p=1,x=w);u>x&&(p=2,x=u);switch(p){case 0:t=y.origin.y+y.direction.y*x;if(t<z.min.y||t>z.max.y){return Number.MAX_VALUE}y=y.origin.z+y.direction.z*x;if(y<z.min.z||y>z.max.z){return Number.MAX_VALUE}z.normal.set(v,0,0);break;case 1:v=y.origin.x+y.direction.x*x;if(v<z.min.x||v>z.max.x){return Number.MAX_VALUE}y=y.origin.z+y.direction.z*x;if(y<z.min.z||y>z.max.z){return Number.MAX_VALUE}z.normal.set(0,t,0);break;case 2:v=y.origin.x+y.direction.x*x;if(v<z.min.x||v>z.max.x){return Number.MAX_VALUE}t=y.origin.y+y.direction.y*x;if(t<z.min.y||t>z.max.y){return Number.MAX_VALUE}z.normal.set(0,0,n)}return x};THREE.CollisionSystem.prototype.rayPlane=function(g,k){var j=g.direction.dot(k.normal),h=k.point.dot(k.normal);if(j<0){j=(h-g.origin.dot(k.normal))/j}else{return Number.MAX_VALUE}return j>0?j:Number.MAX_VALUE};THREE.CollisionSystem.prototype.raySphere=function(g,k){var j=k.center.clone().subSelf(g.origin);if(j.lengthSq<k.radiusSq){return -1}var h=j.dot(g.direction.clone());if(h<=0){return Number.MAX_VALUE}j=k.radiusSq-(j.lengthSq()-h*h);if(j>=0){return Math.abs(h)-Math.sqrt(j)}return Number.MAX_VALUE};THREE.CollisionSystem.__v1=new THREE.Vector3;THREE.CollisionSystem.__v2=new THREE.Vector3;THREE.CollisionSystem.__v3=new THREE.Vector3;THREE.CollisionSystem.__nr=new THREE.Vector3;THREE.CollisionSystem.__m=new THREE.Matrix4;THREE.CollisionSystem.__r=new THREE.Ray;THREE.CollisionUtils={};THREE.CollisionUtils.MeshOBB=function(f){f.geometry.computeBoundingBox();var h=f.geometry.boundingBox,g=new THREE.Vector3(h.x[0],h.y[0],h.z[0]),h=new THREE.Vector3(h.x[1],h.y[1],h.z[1]),g=new THREE.BoxCollider(g,h);g.mesh=f;return g};THREE.CollisionUtils.MeshAABB=function(e){var f=THREE.CollisionUtils.MeshOBB(e);f.min.addSelf(e.position);f.max.addSelf(e.position);f.dynamic=!1;return f};THREE.CollisionUtils.MeshColliderWBox=function(c){return new THREE.MeshCollider(c,THREE.CollisionUtils.MeshOBB(c))};if(THREE.WebGLRenderer){THREE.AnaglyphWebGLRenderer=function(G){THREE.WebGLRenderer.call(this,G);var F=this,E=this.setSize,D=this.render,C=new THREE.Camera,A=new THREE.Camera,B=new THREE.Matrix4,z=new THREE.Matrix4,x,y,n;C.useTarget=A.useTarget=!1;C.matrixAutoUpdate=A.matrixAutoUpdate=!1;var G={minFilter:THREE.LinearFilter,magFilter:THREE.NearestFilter,format:THREE.RGBAFormat},J=new THREE.WebGLRenderTarget(512,512,G),I=new THREE.WebGLRenderTarget(512,512,G),K=new THREE.Camera(53,1,1,10000);K.position.z=2;_material=new THREE.MeshShaderMaterial({uniforms:{mapLeft:{type:"t",value:0,texture:J},mapRight:{type:"t",value:1,texture:I}},vertexShader:"varying vec2 vUv;\nvoid main() {\nvUv = vec2( uv.x, 1.0 - uv.y );\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D mapLeft;\nuniform sampler2D mapRight;\nvarying vec2 vUv;\nvoid main() {\nvec4 colorL, colorR;\nvec2 uv = vUv;\ncolorL = texture2D( mapLeft, uv );\ncolorR = texture2D( mapRight, uv );\ngl_FragColor = vec4( colorL.g * 0.7 + colorL.b * 0.3, colorR.g, colorR.b, colorL.a + colorR.a ) * 1.1;\n}"});var H=new THREE.Scene;H.addObject(new THREE.Mesh(new THREE.PlaneGeometry(2,2),_material));this.setSize=function(c,e){E.call(F,c,e);J.width=c;J.height=e;I.width=c;I.height=e};this.render=function(f,k){k.update(null,!0);if(x!==k.aspect||y!==k.near||n!==k.fov){x=k.aspect;y=k.near;n=k.fov;var c=k.projectionMatrix.clone(),h=125/30*0.5,m=h*y/125,j=y*Math.tan(n*Math.PI/360),g;B.n14=h;z.n14=-h;h=-j*x+m;g=j*x+m;c.n11=2*y/(g-h);c.n13=(g+h)/(g-h);C.projectionMatrix=c.clone();h=-j*x-m;g=j*x-m;c.n11=2*y/(g-h);c.n13=(g+h)/(g-h);A.projectionMatrix=c.clone()}C.matrix=k.matrixWorld.clone().multiplySelf(z);C.update(null,!0);C.position.copy(k.position);C.near=y;C.far=k.far;D.call(F,f,C,J,!0);A.matrix=k.matrixWorld.clone().multiplySelf(B);A.update(null,!0);A.position.copy(k.position);A.near=y;A.far=k.far;D.call(F,f,A,I,!0);D.call(F,H,K)}}}if(THREE.WebGLRenderer){THREE.CrosseyedWebGLRenderer=function(m){THREE.WebGLRenderer.call(this,m);this.autoClear=!1;var w=this,v=this.setSize,u=this.render,t,o,p=new THREE.Camera,n=new THREE.Camera;w.separation=10;if(m&&m.separation!==void 0){w.separation=m.separation}(new THREE.Camera(53,window.innerWidth/2/window.innerHeight,1,10000)).position.z=-10;this.setSize=function(c,e){v.call(w,c,e);t=c/2;o=e};this.render=function(c,f){this.clear();p.fov=f.fov;p.aspect=0.5*f.aspect;p.near=f.near;p.far=f.far;p.updateProjectionMatrix();p.position.copy(f.position);p.target.position.copy(f.target.position);p.translateX(w.separation);n.projectionMatrix=p.projectionMatrix;n.position.copy(f.position);n.target.position.copy(f.target.position);n.translateX(-w.separation);this.setViewport(0,0,t,o);u.call(w,c,p);this.setViewport(t,0,t,o);u.call(w,c,n,!1)}}}THREE.CustomCubeGeometry=function(t,p,x,v,b,f,g,m,w){THREE.Geometry.call(this);var c=this,j=t/2,h=p/2,y=x/2,k=m?-1:1;if(g!==undefined){if(g instanceof Array){this.materials=g}else{this.materials=[];for(var u=0;u<6;u++){this.materials.push([g])}}}else{this.materials=[]}this.sides={px:true,nx:true,py:true,ny:true,pz:true,nz:true};if(w!=undefined){for(var o in w){if(this.sides[o]!=undefined){this.sides[o]=w[o]}}}this.sides.px&&n("y","z",1*k,-1,x,p,j,this.materials[0]);this.sides.nx&&n("y","z",-1*k,-1,x,p,-j,this.materials[1]);this.sides.py&&n("x","z",-1*k,-1,t,x,h,this.materials[2]);this.sides.ny&&n("x","z",1*k,-1,t,x,-h,this.materials[3]);this.sides.pz&&n("x","y",1*k,-1,t,p,y,this.materials[4]);this.sides.nz&&n("x","y",-1*k,-1,t,p,-y,this.materials[5]);e();function n(K,J,z,G,N,M,X,L){var I,E,D,P=v||1,O=b||1,F=N/2,C=M/2,H=c.vertices.length;if((K=="x"&&J=="y")||(K=="y"&&J=="x")){I="z"}else{if((K=="x"&&J=="z")||(K=="z"&&J=="x")){I="y";O=f||1}else{if((K=="z"&&J=="y")||(K=="y"&&J=="z")){I="x";P=f||1}}}var Q=P+1,B=O+1,W=N/P,S=M/O;for(D=0;D<B;D++){for(E=0;E<Q;E++){var A=new THREE.Vector3();A[K]=(E*W-F)*z;A[J]=(D*S-C)*G;A[I]=X;c.vertices.push(new THREE.Vertex(A))}}for(D=0;D<O;D++){for(E=0;E<P;E++){var V=E+Q*D;var U=E+Q*(D+1);var T=(E+1)+Q*(D+1);var R=(E+1)+Q*D;c.faces.push(new THREE.Face4(V+H,U+H,T+H,R+H,null,null,L));c.faceVertexUvs[0].push([new THREE.UV(E/P,D/O),new THREE.UV(E/P,(D+1)/O),new THREE.UV((E+1)/P,(D+1)/O),new THREE.UV((E+1)/P,D/O)])}}}function e(){var z=[],F=[];for(var B=0,G=c.vertices.length;B<G;B++){var I=c.vertices[B],D=false;for(var A=0,C=z.length;A<C;A++){var H=z[A];if(I.position.x==H.position.x&&I.position.y==H.position.y&&I.position.z==H.position.z){F[B]=A;D=true;break}}if(!D){F[B]=z.length;z.push(new THREE.Vertex(I.position.clone()))}}for(B=0,G=c.faces.length;B<G;B++){var E=c.faces[B];E.a=F[E.a];E.b=F[E.b];E.c=F[E.c];E.d=F[E.d]}c.vertices=z}this.computeCentroids();this.computeFaceNormals()};THREE.CustomCubeGeometry.prototype=new THREE.Geometry();THREE.CustomCubeGeometry.prototype.constructor=THREE.CustomCubeGeometry;if(!window.requestAnimationFrame){window.requestAnimationFrame=(function(){return window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(c,b){window.setTimeout(c,1000/60)}})()}var Stats=function(){function R(b,h,m){var j,n,k;for(n=0;n<30;n++){for(j=0;j<73;j++){k=(j+n*74)*4,b[k]=b[k+4],b[k+1]=b[k+5],b[k+2]=b[k+6]}}for(n=0;n<30;n++){k=(73+n*74)*4,n<h?(b[k]=ak[m].bg.r,b[k+1]=ak[m].bg.g,b[k+2]=ak[m].bg.b):(b[k]=ak[m].fg.r,b[k+1]=ak[m].fg.g,b[k+2]=ak[m].fg.b)}}var T=0,P=2,ag,N=0,ad=(new Date).getTime(),M=ad,L=ad,ab=0,J=1000,I=0,ac,ai,al,aa,H,Z=0,e=1000,X=0,ah,aj,Y,V,W=0,S=1000,Q=0,af,ae,U,O,ak={fps:{bg:{r:16,g:16,b:48},fg:{r:0,g:255,b:255}},ms:{bg:{r:16,g:48,b:16},fg:{r:0,g:255,b:0}},mb:{bg:{r:48,g:16,b:26},fg:{r:255,g:0,b:128}}};ag=document.createElement("div");ag.style.cursor="pointer";ag.style.width="80px";ag.style.opacity="0.9";ag.style.zIndex="10001";ag.addEventListener("click",function(){T++;T==P&&(T=0);ac.style.display="none";ah.style.display="none";af.style.display="none";switch(T){case 0:ac.style.display="block";break;case 1:ah.style.display="block";break;case 2:af.style.display="block"}},!1);ac=document.createElement("div");ac.style.backgroundColor="rgb("+Math.floor(ak.fps.bg.r/2)+","+Math.floor(ak.fps.bg.g/2)+","+Math.floor(ak.fps.bg.b/2)+")";ac.style.padding="2px 0px 3px 0px";ag.appendChild(ac);ai=document.createElement("div");ai.style.fontFamily="Helvetica, Arial, sans-serif";ai.style.textAlign="left";ai.style.fontSize="9px";ai.style.color="rgb("+ak.fps.fg.r+","+ak.fps.fg.g+","+ak.fps.fg.b+")";ai.style.margin="0px 0px 1px 3px";ai.innerHTML='<span style="font-weight:bold">FPS</span>';ac.appendChild(ai);al=document.createElement("canvas");al.width=74;al.height=30;al.style.display="block";al.style.marginLeft="3px";ac.appendChild(al);aa=al.getContext("2d");aa.fillStyle="rgb("+ak.fps.bg.r+","+ak.fps.bg.g+","+ak.fps.bg.b+")";aa.fillRect(0,0,al.width,al.height);H=aa.getImageData(0,0,al.width,al.height);ah=document.createElement("div");ah.style.backgroundColor="rgb("+Math.floor(ak.ms.bg.r/2)+","+Math.floor(ak.ms.bg.g/2)+","+Math.floor(ak.ms.bg.b/2)+")";ah.style.padding="2px 0px 3px 0px";ah.style.display="none";ag.appendChild(ah);aj=document.createElement("div");aj.style.fontFamily="Helvetica, Arial, sans-serif";aj.style.textAlign="left";aj.style.fontSize="9px";aj.style.color="rgb("+ak.ms.fg.r+","+ak.ms.fg.g+","+ak.ms.fg.b+")";aj.style.margin="0px 0px 1px 3px";aj.innerHTML='<span style="font-weight:bold">MS</span>';ah.appendChild(aj);al=document.createElement("canvas");al.width=74;al.height=30;al.style.display="block";al.style.marginLeft="3px";ah.appendChild(al);Y=al.getContext("2d");Y.fillStyle="rgb("+ak.ms.bg.r+","+ak.ms.bg.g+","+ak.ms.bg.b+")";Y.fillRect(0,0,al.width,al.height);V=Y.getImageData(0,0,al.width,al.height);try{performance&&performance.memory&&performance.memory.totalJSHeapSize&&(P=3)}catch(K){}af=document.createElement("div");af.style.backgroundColor="rgb("+Math.floor(ak.mb.bg.r/2)+","+Math.floor(ak.mb.bg.g/2)+","+Math.floor(ak.mb.bg.b/2)+")";af.style.padding="2px 0px 3px 0px";af.style.display="none";ag.appendChild(af);ae=document.createElement("div");ae.style.fontFamily="Helvetica, Arial, sans-serif";ae.style.textAlign="left";ae.style.fontSize="9px";ae.style.color="rgb("+ak.mb.fg.r+","+ak.mb.fg.g+","+ak.mb.fg.b+")";ae.style.margin="0px 0px 1px 3px";ae.innerHTML='<span style="font-weight:bold">MB</span>';af.appendChild(ae);al=document.createElement("canvas");al.width=74;al.height=30;al.style.display="block";al.style.marginLeft="3px";af.appendChild(al);U=al.getContext("2d");U.fillStyle="#301010";U.fillRect(0,0,al.width,al.height);O=U.getImageData(0,0,al.width,al.height);return{domElement:ag,update:function(){N++;ad=(new Date).getTime();Z=ad-M;e=Math.min(e,Z);X=Math.max(X,Z);R(V.data,Math.min(30,30-Z/200*30),"ms");aj.innerHTML='<span style="font-weight:bold">'+Z+" MS</span> ("+e+"-"+X+")";Y.putImageData(V,0,0);M=ad;if(ad>L+1000){ab=Math.round(N*1000/(ad-L));J=Math.min(J,ab);I=Math.max(I,ab);R(H.data,Math.min(30,30-ab/100*30),"fps");ai.innerHTML='<span style="font-weight:bold">'+ab+" FPS</span> ("+J+"-"+I+")";aa.putImageData(H,0,0);if(P==3){W=performance.memory.usedJSHeapSize*9.54e-7,S=Math.min(S,W),Q=Math.max(Q,W),R(O.data,Math.min(30,30-W/2),"mb"),ae.innerHTML='<span style="font-weight:bold">'+Math.round(W)+" MB</span> ("+Math.round(S)+"-"+Math.round(Q)+")",U.putImageData(O,0,0)}L=ad;N=0}}}};
/*! jQuery v1.7.1 jquery.com | jquery.org/license */
(function(a,b){function cy(a){return f.isWindow(a)?a:a.nodeType===9?a.defaultView||a.parentWindow:!1}function cv(a){if(!ck[a]){var b=c.body,d=f("<"+a+">").appendTo(b),e=d.css("display");d.remove();if(e==="none"||e===""){cl||(cl=c.createElement("iframe"),cl.frameBorder=cl.width=cl.height=0),b.appendChild(cl);if(!cm||!cl.createElement){cm=(cl.contentWindow||cl.contentDocument).document,cm.write((c.compatMode==="CSS1Compat"?"<!doctype html>":"")+"<html><body>"),cm.close()}d=cm.createElement(a),cm.body.appendChild(d),e=f.css(d,"display"),b.removeChild(cl)}ck[a]=e}return ck[a]}function cu(a,b){var c={};f.each(cq.concat.apply([],cq.slice(0,b)),function(){c[this]=a});return c}function ct(){cr=b}function cs(){setTimeout(ct,0);return cr=f.now()}function cj(){try{return new a.ActiveXObject("Microsoft.XMLHTTP")}catch(b){}}function ci(){try{return new a.XMLHttpRequest}catch(b){}}function cc(a,c){a.dataFilter&&(c=a.dataFilter(c,a.dataType));var d=a.dataTypes,e={},g,h,i=d.length,j,k=d[0],l,m,n,o,p;for(g=1;g<i;g++){if(g===1){for(h in a.converters){typeof h=="string"&&(e[h.toLowerCase()]=a.converters[h])}}l=k,k=d[g];if(k==="*"){k=l}else{if(l!=="*"&&l!==k){m=l+" "+k,n=e[m]||e["* "+k];if(!n){p=b;for(o in e){j=o.split(" ");if(j[0]===l||j[0]==="*"){p=e[j[1]+" "+k];if(p){o=e[o],o===!0?n=p:p===!0&&(n=o);break}}}}!n&&!p&&f.error("No conversion from "+m.replace(" "," to ")),n!==!0&&(c=n?n(c):p(o(c)))}}}return c}function cb(a,c,d){var e=a.contents,f=a.dataTypes,g=a.responseFields,h,i,j,k;for(i in g){i in d&&(c[g[i]]=d[i])}while(f[0]==="*"){f.shift(),h===b&&(h=a.mimeType||c.getResponseHeader("content-type"))}if(h){for(i in e){if(e[i]&&e[i].test(h)){f.unshift(i);break}}}if(f[0] in d){j=f[0]}else{for(i in d){if(!f[0]||a.converters[i+" "+f[0]]){j=i;break}k||(k=i)}j=j||k}if(j){j!==f[0]&&f.unshift(j);return d[j]}}function ca(a,b,c,d){if(f.isArray(b)){f.each(b,function(b,e){c||bE.test(a)?d(a,e):ca(a+"["+(typeof e=="object"||f.isArray(e)?b:"")+"]",e,c,d)})}else{if(!c&&b!=null&&typeof b=="object"){for(var e in b){ca(a+"["+e+"]",b[e],c,d)}}else{d(a,b)}}}function b_(a,c){var d,e,g=f.ajaxSettings.flatOptions||{};for(d in c){c[d]!==b&&((g[d]?a:e||(e={}))[d]=c[d])}e&&f.extend(!0,a,e)}function b$(a,c,d,e,f,g){f=f||c.dataTypes[0],g=g||{},g[f]=!0;var h=a[f],i=0,j=h?h.length:0,k=a===bT,l;for(;i<j&&(k||!l);i++){l=h[i](c,d,e),typeof l=="string"&&(!k||g[l]?l=b:(c.dataTypes.unshift(l),l=b$(a,c,d,e,l,g)))}(k||!l)&&!g["*"]&&(l=b$(a,c,d,e,"*",g));return l}function bZ(a){return function(b,c){typeof b!="string"&&(c=b,b="*");if(f.isFunction(c)){var d=b.toLowerCase().split(bP),e=0,g=d.length,h,i,j;for(;e<g;e++){h=d[e],j=/^\+/.test(h),j&&(h=h.substr(1)||"*"),i=a[h]=a[h]||[],i[j?"unshift":"push"](c)}}}}function bC(a,b,c){var d=b==="width"?a.offsetWidth:a.offsetHeight,e=b==="width"?bx:by,g=0,h=e.length;if(d>0){if(c!=="border"){for(;g<h;g++){c||(d-=parseFloat(f.css(a,"padding"+e[g]))||0),c==="margin"?d+=parseFloat(f.css(a,c+e[g]))||0:d-=parseFloat(f.css(a,"border"+e[g]+"Width"))||0}}return d+"px"}d=bz(a,b,b);if(d<0||d==null){d=a.style[b]||0}d=parseFloat(d)||0;if(c){for(;g<h;g++){d+=parseFloat(f.css(a,"padding"+e[g]))||0,c!=="padding"&&(d+=parseFloat(f.css(a,"border"+e[g]+"Width"))||0),c==="margin"&&(d+=parseFloat(f.css(a,c+e[g]))||0)}}return d+"px"}function bp(a,b){b.src?f.ajax({url:b.src,async:!1,dataType:"script"}):f.globalEval((b.text||b.textContent||b.innerHTML||"").replace(bf,"/*$0*/")),b.parentNode&&b.parentNode.removeChild(b)}function bo(a){var b=c.createElement("div");bh.appendChild(b),b.innerHTML=a.outerHTML;return b.firstChild}function bn(a){var b=(a.nodeName||"").toLowerCase();b==="input"?bm(a):b!=="script"&&typeof a.getElementsByTagName!="undefined"&&f.grep(a.getElementsByTagName("input"),bm)}function bm(a){if(a.type==="checkbox"||a.type==="radio"){a.defaultChecked=a.checked}}function bl(a){return typeof a.getElementsByTagName!="undefined"?a.getElementsByTagName("*"):typeof a.querySelectorAll!="undefined"?a.querySelectorAll("*"):[]}function bk(a,b){var c;if(b.nodeType===1){b.clearAttributes&&b.clearAttributes(),b.mergeAttributes&&b.mergeAttributes(a),c=b.nodeName.toLowerCase();if(c==="object"){b.outerHTML=a.outerHTML}else{if(c!=="input"||a.type!=="checkbox"&&a.type!=="radio"){if(c==="option"){b.selected=a.defaultSelected}else{if(c==="input"||c==="textarea"){b.defaultValue=a.defaultValue}}}else{a.checked&&(b.defaultChecked=b.checked=a.checked),b.value!==a.value&&(b.value=a.value)}}b.removeAttribute(f.expando)}}function bj(a,b){if(b.nodeType===1&&!!f.hasData(a)){var c,d,e,g=f._data(a),h=f._data(b,g),i=g.events;if(i){delete h.handle,h.events={};for(c in i){for(d=0,e=i[c].length;d<e;d++){f.event.add(b,c+(i[c][d].namespace?".":"")+i[c][d].namespace,i[c][d],i[c][d].data)}}}h.data&&(h.data=f.extend({},h.data))}}function bi(a,b){return f.nodeName(a,"table")?a.getElementsByTagName("tbody")[0]||a.appendChild(a.ownerDocument.createElement("tbody")):a}function U(a){var b=V.split("|"),c=a.createDocumentFragment();if(c.createElement){while(b.length){c.createElement(b.pop())}}return c}function T(a,b,c){b=b||0;if(f.isFunction(b)){return f.grep(a,function(a,d){var e=!!b.call(a,d,a);return e===c})}if(b.nodeType){return f.grep(a,function(a,d){return a===b===c})}if(typeof b=="string"){var d=f.grep(a,function(a){return a.nodeType===1});if(O.test(b)){return f.filter(b,d,!c)}b=f.filter(b,d)}return f.grep(a,function(a,d){return f.inArray(a,b)>=0===c})}function S(a){return !a||!a.parentNode||a.parentNode.nodeType===11}function K(){return !0}function J(){return !1}function n(a,b,c){var d=b+"defer",e=b+"queue",g=b+"mark",h=f._data(a,d);h&&(c==="queue"||!f._data(a,e))&&(c==="mark"||!f._data(a,g))&&setTimeout(function(){!f._data(a,e)&&!f._data(a,g)&&(f.removeData(a,d,!0),h.fire())},0)}function m(a){for(var b in a){if(b==="data"&&f.isEmptyObject(a[b])){continue}if(b!=="toJSON"){return !1}}return !0}function l(a,c,d){if(d===b&&a.nodeType===1){var e="data-"+c.replace(k,"-$1").toLowerCase();d=a.getAttribute(e);if(typeof d=="string"){try{d=d==="true"?!0:d==="false"?!1:d==="null"?null:f.isNumeric(d)?parseFloat(d):j.test(d)?f.parseJSON(d):d}catch(g){}f.data(a,c,d)}else{d=b}}return d}function h(a){var b=g[a]={},c,d;a=a.split(/\s+/);for(c=0,d=a.length;c<d;c++){b[a[c]]=!0}return b}var c=a.document,d=a.navigator,e=a.location,f=function(){function J(){if(!e.isReady){try{c.documentElement.doScroll("left")}catch(a){setTimeout(J,1);return}e.ready()}}var e=function(a,b){return new e.fn.init(a,b,h)},f=a.jQuery,g=a.$,h,i=/^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,j=/\S/,k=/^\s+/,l=/\s+$/,m=/^<(\w+)\s*\/?>(?:<\/\1>)?$/,n=/^[\],:{}\s]*$/,o=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,p=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,q=/(?:^|:|,)(?:\s*\[)+/g,r=/(webkit)[ \/]([\w.]+)/,s=/(opera)(?:.*version)?[ \/]([\w.]+)/,t=/(msie) ([\w.]+)/,u=/(mozilla)(?:.*? rv:([\w.]+))?/,v=/-([a-z]|[0-9])/ig,w=/^-ms-/,x=function(a,b){return(b+"").toUpperCase()},y=d.userAgent,z,A,B,C=Object.prototype.toString,D=Object.prototype.hasOwnProperty,E=Array.prototype.push,F=Array.prototype.slice,G=String.prototype.trim,H=Array.prototype.indexOf,I={};e.fn=e.prototype={constructor:e,init:function(a,d,f){var g,h,j,k;if(!a){return this}if(a.nodeType){this.context=this[0]=a,this.length=1;return this}if(a==="body"&&!d&&c.body){this.context=c,this[0]=c.body,this.selector=a,this.length=1;return this}if(typeof a=="string"){a.charAt(0)!=="<"||a.charAt(a.length-1)!==">"||a.length<3?g=i.exec(a):g=[null,a,null];if(g&&(g[1]||!d)){if(g[1]){d=d instanceof e?d[0]:d,k=d?d.ownerDocument||d:c,j=m.exec(a),j?e.isPlainObject(d)?(a=[c.createElement(j[1])],e.fn.attr.call(a,d,!0)):a=[k.createElement(j[1])]:(j=e.buildFragment([g[1]],[k]),a=(j.cacheable?e.clone(j.fragment):j.fragment).childNodes);return e.merge(this,a)}h=c.getElementById(g[2]);if(h&&h.parentNode){if(h.id!==g[2]){return f.find(a)}this.length=1,this[0]=h}this.context=c,this.selector=a;return this}return !d||d.jquery?(d||f).find(a):this.constructor(d).find(a)}if(e.isFunction(a)){return f.ready(a)}a.selector!==b&&(this.selector=a.selector,this.context=a.context);return e.makeArray(a,this)},selector:"",jquery:"1.7.1",length:0,size:function(){return this.length},toArray:function(){return F.call(this,0)},get:function(a){return a==null?this.toArray():a<0?this[this.length+a]:this[a]},pushStack:function(a,b,c){var d=this.constructor();e.isArray(a)?E.apply(d,a):e.merge(d,a),d.prevObject=this,d.context=this.context,b==="find"?d.selector=this.selector+(this.selector?" ":"")+c:b&&(d.selector=this.selector+"."+b+"("+c+")");return d},each:function(a,b){return e.each(this,a,b)},ready:function(a){e.bindReady(),A.add(a);return this},eq:function(a){a=+a;return a===-1?this.slice(a):this.slice(a,a+1)},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},slice:function(){return this.pushStack(F.apply(this,arguments),"slice",F.call(arguments).join(","))},map:function(a){return this.pushStack(e.map(this,function(b,c){return a.call(b,c,b)}))},end:function(){return this.prevObject||this.constructor(null)},push:E,sort:[].sort,splice:[].splice},e.fn.init.prototype=e.fn,e.extend=e.fn.extend=function(){var a,c,d,f,g,h,i=arguments[0]||{},j=1,k=arguments.length,l=!1;typeof i=="boolean"&&(l=i,i=arguments[1]||{},j=2),typeof i!="object"&&!e.isFunction(i)&&(i={}),k===j&&(i=this,--j);for(;j<k;j++){if((a=arguments[j])!=null){for(c in a){d=i[c],f=a[c];if(i===f){continue}l&&f&&(e.isPlainObject(f)||(g=e.isArray(f)))?(g?(g=!1,h=d&&e.isArray(d)?d:[]):h=d&&e.isPlainObject(d)?d:{},i[c]=e.extend(l,h,f)):f!==b&&(i[c]=f)}}}return i},e.extend({noConflict:function(b){a.$===e&&(a.$=g),b&&a.jQuery===e&&(a.jQuery=f);return e},isReady:!1,readyWait:1,holdReady:function(a){a?e.readyWait++:e.ready(!0)},ready:function(a){if(a===!0&&!--e.readyWait||a!==!0&&!e.isReady){if(!c.body){return setTimeout(e.ready,1)}e.isReady=!0;if(a!==!0&&--e.readyWait>0){return}A.fireWith(c,[e]),e.fn.trigger&&e(c).trigger("ready").off("ready")}},bindReady:function(){if(!A){A=e.Callbacks("once memory");if(c.readyState==="complete"){return setTimeout(e.ready,1)}if(c.addEventListener){c.addEventListener("DOMContentLoaded",B,!1),a.addEventListener("load",e.ready,!1)}else{if(c.attachEvent){c.attachEvent("onreadystatechange",B),a.attachEvent("onload",e.ready);var b=!1;try{b=a.frameElement==null}catch(d){}c.documentElement.doScroll&&b&&J()}}}},isFunction:function(a){return e.type(a)==="function"},isArray:Array.isArray||function(a){return e.type(a)==="array"},isWindow:function(a){return a&&typeof a=="object"&&"setInterval" in a},isNumeric:function(a){return !isNaN(parseFloat(a))&&isFinite(a)},type:function(a){return a==null?String(a):I[C.call(a)]||"object"},isPlainObject:function(a){if(!a||e.type(a)!=="object"||a.nodeType||e.isWindow(a)){return !1}try{if(a.constructor&&!D.call(a,"constructor")&&!D.call(a.constructor.prototype,"isPrototypeOf")){return !1}}catch(c){return !1}var d;for(d in a){}return d===b||D.call(a,d)},isEmptyObject:function(a){for(var b in a){return !1}return !0},error:function(a){throw new Error(a)},parseJSON:function(b){if(typeof b!="string"||!b){return null}b=e.trim(b);if(a.JSON&&a.JSON.parse){return a.JSON.parse(b)}if(n.test(b.replace(o,"@").replace(p,"]").replace(q,""))){return(new Function("return "+b))()}e.error("Invalid JSON: "+b)},parseXML:function(c){var d,f;try{a.DOMParser?(f=new DOMParser,d=f.parseFromString(c,"text/xml")):(d=new ActiveXObject("Microsoft.XMLDOM"),d.async="false",d.loadXML(c))}catch(g){d=b}(!d||!d.documentElement||d.getElementsByTagName("parsererror").length)&&e.error("Invalid XML: "+c);return d},noop:function(){},globalEval:function(b){b&&j.test(b)&&(a.execScript||function(b){a.eval.call(a,b)})(b)},camelCase:function(a){return a.replace(w,"ms-").replace(v,x)},nodeName:function(a,b){return a.nodeName&&a.nodeName.toUpperCase()===b.toUpperCase()},each:function(a,c,d){var f,g=0,h=a.length,i=h===b||e.isFunction(a);if(d){if(i){for(f in a){if(c.apply(a[f],d)===!1){break}}}else{for(;g<h;){if(c.apply(a[g++],d)===!1){break}}}}else{if(i){for(f in a){if(c.call(a[f],f,a[f])===!1){break}}}else{for(;g<h;){if(c.call(a[g],g,a[g++])===!1){break}}}}return a},trim:G?function(a){return a==null?"":G.call(a)}:function(a){return a==null?"":(a+"").replace(k,"").replace(l,"")},makeArray:function(a,b){var c=b||[];if(a!=null){var d=e.type(a);a.length==null||d==="string"||d==="function"||d==="regexp"||e.isWindow(a)?E.call(c,a):e.merge(c,a)}return c},inArray:function(a,b,c){var d;if(b){if(H){return H.call(b,a,c)}d=b.length,c=c?c<0?Math.max(0,d+c):c:0;for(;c<d;c++){if(c in b&&b[c]===a){return c}}}return -1},merge:function(a,c){var d=a.length,e=0;if(typeof c.length=="number"){for(var f=c.length;e<f;e++){a[d++]=c[e]}}else{while(c[e]!==b){a[d++]=c[e++]}}a.length=d;return a},grep:function(a,b,c){var d=[],e;c=!!c;for(var f=0,g=a.length;f<g;f++){e=!!b(a[f],f),c!==e&&d.push(a[f])}return d},map:function(a,c,d){var f,g,h=[],i=0,j=a.length,k=a instanceof e||j!==b&&typeof j=="number"&&(j>0&&a[0]&&a[j-1]||j===0||e.isArray(a));if(k){for(;i<j;i++){f=c(a[i],i,d),f!=null&&(h[h.length]=f)}}else{for(g in a){f=c(a[g],g,d),f!=null&&(h[h.length]=f)}}return h.concat.apply([],h)},guid:1,proxy:function(a,c){if(typeof c=="string"){var d=a[c];c=a,a=d}if(!e.isFunction(a)){return b}var f=F.call(arguments,2),g=function(){return a.apply(c,f.concat(F.call(arguments)))};g.guid=a.guid=a.guid||g.guid||e.guid++;return g},access:function(a,c,d,f,g,h){var i=a.length;if(typeof c=="object"){for(var j in c){e.access(a,j,c[j],f,g,d)}return a}if(d!==b){f=!h&&f&&e.isFunction(d);for(var k=0;k<i;k++){g(a[k],c,f?d.call(a[k],k,g(a[k],c)):d,h)}return a}return i?g(a[0],c):b},now:function(){return(new Date).getTime()},uaMatch:function(a){a=a.toLowerCase();var b=r.exec(a)||s.exec(a)||t.exec(a)||a.indexOf("compatible")<0&&u.exec(a)||[];return{browser:b[1]||"",version:b[2]||"0"}},sub:function(){function a(b,c){return new a.fn.init(b,c)}e.extend(!0,a,this),a.superclass=this,a.fn=a.prototype=this(),a.fn.constructor=a,a.sub=this.sub,a.fn.init=function(d,f){f&&f instanceof e&&!(f instanceof a)&&(f=a(f));return e.fn.init.call(this,d,f,b)},a.fn.init.prototype=a.fn;var b=a(c);return a},browser:{}}),e.each("Boolean Number String Function Array Date RegExp Object".split(" "),function(a,b){I["[object "+b+"]"]=b.toLowerCase()}),z=e.uaMatch(y),z.browser&&(e.browser[z.browser]=!0,e.browser.version=z.version),e.browser.webkit&&(e.browser.safari=!0),j.test(" ")&&(k=/^[\s\xA0]+/,l=/[\s\xA0]+$/),h=e(c),c.addEventListener?B=function(){c.removeEventListener("DOMContentLoaded",B,!1),e.ready()}:c.attachEvent&&(B=function(){c.readyState==="complete"&&(c.detachEvent("onreadystatechange",B),e.ready())});return e}(),g={};f.Callbacks=function(a){a=a?g[a]||h(a):{};var c=[],d=[],e,i,j,k,l,m=function(b){var d,e,g,h,i;for(d=0,e=b.length;d<e;d++){g=b[d],h=f.type(g),h==="array"?m(g):h==="function"&&(!a.unique||!o.has(g))&&c.push(g)}},n=function(b,f){f=f||[],e=!a.memory||[b,f],i=!0,l=j||0,j=0,k=c.length;for(;c&&l<k;l++){if(c[l].apply(b,f)===!1&&a.stopOnFalse){e=!0;break}}i=!1,c&&(a.once?e===!0?o.disable():c=[]:d&&d.length&&(e=d.shift(),o.fireWith(e[0],e[1])))},o={add:function(){if(c){var a=c.length;m(arguments),i?k=c.length:e&&e!==!0&&(j=a,n(e[0],e[1]))}return this},remove:function(){if(c){var b=arguments,d=0,e=b.length;for(;d<e;d++){for(var f=0;f<c.length;f++){if(b[d]===c[f]){i&&f<=k&&(k--,f<=l&&l--),c.splice(f--,1);if(a.unique){break}}}}}return this},has:function(a){if(c){var b=0,d=c.length;for(;b<d;b++){if(a===c[b]){return !0}}}return !1},empty:function(){c=[];return this},disable:function(){c=d=e=b;return this},disabled:function(){return !c},lock:function(){d=b,(!e||e===!0)&&o.disable();return this},locked:function(){return !d},fireWith:function(b,c){d&&(i?a.once||d.push([b,c]):(!a.once||!e)&&n(b,c));return this},fire:function(){o.fireWith(this,arguments);return this},fired:function(){return !!e}};return o};var i=[].slice;f.extend({Deferred:function(a){var b=f.Callbacks("once memory"),c=f.Callbacks("once memory"),d=f.Callbacks("memory"),e="pending",g={resolve:b,reject:c,notify:d},h={done:b.add,fail:c.add,progress:d.add,state:function(){return e},isResolved:b.fired,isRejected:c.fired,then:function(a,b,c){i.done(a).fail(b).progress(c);return this},always:function(){i.done.apply(i,arguments).fail.apply(i,arguments);return this},pipe:function(a,b,c){return f.Deferred(function(d){f.each({done:[a,"resolve"],fail:[b,"reject"],progress:[c,"notify"]},function(a,b){var c=b[0],e=b[1],g;f.isFunction(c)?i[a](function(){g=c.apply(this,arguments),g&&f.isFunction(g.promise)?g.promise().then(d.resolve,d.reject,d.notify):d[e+"With"](this===i?d:this,[g])}):i[a](d[e])})}).promise()},promise:function(a){if(a==null){a=h}else{for(var b in h){a[b]=h[b]}}return a}},i=h.promise({}),j;for(j in g){i[j]=g[j].fire,i[j+"With"]=g[j].fireWith}i.done(function(){e="resolved"},c.disable,d.lock).fail(function(){e="rejected"},b.disable,d.lock),a&&a.call(i,i);return i},when:function(a){function m(a){return function(b){e[a]=arguments.length>1?i.call(arguments,0):b,j.notifyWith(k,e)}}function l(a){return function(c){b[a]=arguments.length>1?i.call(arguments,0):c,--g||j.resolveWith(j,b)}}var b=i.call(arguments,0),c=0,d=b.length,e=Array(d),g=d,h=d,j=d<=1&&a&&f.isFunction(a.promise)?a:f.Deferred(),k=j.promise();if(d>1){for(;c<d;c++){b[c]&&b[c].promise&&f.isFunction(b[c].promise)?b[c].promise().then(l(c),j.reject,m(c)):--g}g||j.resolveWith(j,b)}else{j!==a&&j.resolveWith(j,d?[a]:[])}return k}}),f.support=function(){var b,d,e,g,h,i,j,k,l,m,n,o,p,q=c.createElement("div"),r=c.documentElement;q.setAttribute("className","t"),q.innerHTML="   <link/><table></table><a href='/a' style='top:1px;float:left;opacity:.55;'>a</a><input type='checkbox'/>",d=q.getElementsByTagName("*"),e=q.getElementsByTagName("a")[0];if(!d||!d.length||!e){return{}}g=c.createElement("select"),h=g.appendChild(c.createElement("option")),i=q.getElementsByTagName("input")[0],b={leadingWhitespace:q.firstChild.nodeType===3,tbody:!q.getElementsByTagName("tbody").length,htmlSerialize:!!q.getElementsByTagName("link").length,style:/top/.test(e.getAttribute("style")),hrefNormalized:e.getAttribute("href")==="/a",opacity:/^0.55/.test(e.style.opacity),cssFloat:!!e.style.cssFloat,checkOn:i.value==="on",optSelected:h.selected,getSetAttribute:q.className!=="t",enctype:!!c.createElement("form").enctype,html5Clone:c.createElement("nav").cloneNode(!0).outerHTML!=="<:nav></:nav>",submitBubbles:!0,changeBubbles:!0,focusinBubbles:!1,deleteExpando:!0,noCloneEvent:!0,inlineBlockNeedsLayout:!1,shrinkWrapBlocks:!1,reliableMarginRight:!0},i.checked=!0,b.noCloneChecked=i.cloneNode(!0).checked,g.disabled=!0,b.optDisabled=!h.disabled;try{delete q.test}catch(s){b.deleteExpando=!1}!q.addEventListener&&q.attachEvent&&q.fireEvent&&(q.attachEvent("onclick",function(){b.noCloneEvent=!1}),q.cloneNode(!0).fireEvent("onclick")),i=c.createElement("input"),i.value="t",i.setAttribute("type","radio"),b.radioValue=i.value==="t",i.setAttribute("checked","checked"),q.appendChild(i),k=c.createDocumentFragment(),k.appendChild(q.lastChild),b.checkClone=k.cloneNode(!0).cloneNode(!0).lastChild.checked,b.appendChecked=i.checked,k.removeChild(i),k.appendChild(q),q.innerHTML="",a.getComputedStyle&&(j=c.createElement("div"),j.style.width="0",j.style.marginRight="0",q.style.width="2px",q.appendChild(j),b.reliableMarginRight=(parseInt((a.getComputedStyle(j,null)||{marginRight:0}).marginRight,10)||0)===0);if(q.attachEvent){for(o in {submit:1,change:1,focusin:1}){n="on"+o,p=n in q,p||(q.setAttribute(n,"return;"),p=typeof q[n]=="function"),b[o+"Bubbles"]=p}}k.removeChild(q),k=g=h=j=q=i=null,f(function(){var a,d,e,g,h,i,j,k,m,n,o,r=c.getElementsByTagName("body")[0];!r||(j=1,k="position:absolute;top:0;left:0;width:1px;height:1px;margin:0;",m="visibility:hidden;border:0;",n="style='"+k+"border:5px solid #000;padding:0;'",o="<div "+n+"><div></div></div><table "+n+" cellpadding='0' cellspacing='0'><tr><td></td></tr></table>",a=c.createElement("div"),a.style.cssText=m+"width:0;height:0;position:static;top:0;margin-top:"+j+"px",r.insertBefore(a,r.firstChild),q=c.createElement("div"),a.appendChild(q),q.innerHTML="<table><tr><td style='padding:0;border:0;display:none'></td><td>t</td></tr></table>",l=q.getElementsByTagName("td"),p=l[0].offsetHeight===0,l[0].style.display="",l[1].style.display="none",b.reliableHiddenOffsets=p&&l[0].offsetHeight===0,q.innerHTML="",q.style.width=q.style.paddingLeft="1px",f.boxModel=b.boxModel=q.offsetWidth===2,typeof q.style.zoom!="undefined"&&(q.style.display="inline",q.style.zoom=1,b.inlineBlockNeedsLayout=q.offsetWidth===2,q.style.display="",q.innerHTML="<div style='width:4px;'></div>",b.shrinkWrapBlocks=q.offsetWidth!==2),q.style.cssText=k+m,q.innerHTML=o,d=q.firstChild,e=d.firstChild,h=d.nextSibling.firstChild.firstChild,i={doesNotAddBorder:e.offsetTop!==5,doesAddBorderForTableAndCells:h.offsetTop===5},e.style.position="fixed",e.style.top="20px",i.fixedPosition=e.offsetTop===20||e.offsetTop===15,e.style.position=e.style.top="",d.style.overflow="hidden",d.style.position="relative",i.subtractsBorderForOverflowNotVisible=e.offsetTop===-5,i.doesNotIncludeMarginInBodyOffset=r.offsetTop!==j,r.removeChild(a),q=a=null,f.extend(b,i))});return b}();var j=/^(?:\{.*\}|\[.*\])$/,k=/([A-Z])/g;f.extend({cache:{},uuid:0,expando:"jQuery"+(f.fn.jquery+Math.random()).replace(/\D/g,""),noData:{embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:!0},hasData:function(a){a=a.nodeType?f.cache[a[f.expando]]:a[f.expando];return !!a&&!m(a)},data:function(a,c,d,e){if(!!f.acceptData(a)){var g,h,i,j=f.expando,k=typeof c=="string",l=a.nodeType,m=l?f.cache:a,n=l?a[j]:a[j]&&j,o=c==="events";if((!n||!m[n]||!o&&!e&&!m[n].data)&&k&&d===b){return}n||(l?a[j]=n=++f.uuid:n=j),m[n]||(m[n]={},l||(m[n].toJSON=f.noop));if(typeof c=="object"||typeof c=="function"){e?m[n]=f.extend(m[n],c):m[n].data=f.extend(m[n].data,c)}g=h=m[n],e||(h.data||(h.data={}),h=h.data),d!==b&&(h[f.camelCase(c)]=d);if(o&&!h[c]){return g.events}k?(i=h[c],i==null&&(i=h[f.camelCase(c)])):i=h;return i}},removeData:function(a,b,c){if(!!f.acceptData(a)){var d,e,g,h=f.expando,i=a.nodeType,j=i?f.cache:a,k=i?a[h]:h;if(!j[k]){return}if(b){d=c?j[k]:j[k].data;if(d){f.isArray(b)||(b in d?b=[b]:(b=f.camelCase(b),b in d?b=[b]:b=b.split(" ")));for(e=0,g=b.length;e<g;e++){delete d[b[e]]}if(!(c?m:f.isEmptyObject)(d)){return}}}if(!c){delete j[k].data;if(!m(j[k])){return}}f.support.deleteExpando||!j.setInterval?delete j[k]:j[k]=null,i&&(f.support.deleteExpando?delete a[h]:a.removeAttribute?a.removeAttribute(h):a[h]=null)}},_data:function(a,b,c){return f.data(a,b,c,!0)},acceptData:function(a){if(a.nodeName){var b=f.noData[a.nodeName.toLowerCase()];if(b){return b!==!0&&a.getAttribute("classid")===b}}return !0}}),f.fn.extend({data:function(a,c){var d,e,g,h=null;if(typeof a=="undefined"){if(this.length){h=f.data(this[0]);if(this[0].nodeType===1&&!f._data(this[0],"parsedAttrs")){e=this[0].attributes;for(var i=0,j=e.length;i<j;i++){g=e[i].name,g.indexOf("data-")===0&&(g=f.camelCase(g.substring(5)),l(this[0],g,h[g]))}f._data(this[0],"parsedAttrs",!0)}}return h}if(typeof a=="object"){return this.each(function(){f.data(this,a)})}d=a.split("."),d[1]=d[1]?"."+d[1]:"";if(c===b){h=this.triggerHandler("getData"+d[1]+"!",[d[0]]),h===b&&this.length&&(h=f.data(this[0],a),h=l(this[0],a,h));return h===b&&d[1]?this.data(d[0]):h}return this.each(function(){var b=f(this),e=[d[0],c];b.triggerHandler("setData"+d[1]+"!",e),f.data(this,a,c),b.triggerHandler("changeData"+d[1]+"!",e)})},removeData:function(a){return this.each(function(){f.removeData(this,a)})}}),f.extend({_mark:function(a,b){a&&(b=(b||"fx")+"mark",f._data(a,b,(f._data(a,b)||0)+1))},_unmark:function(a,b,c){a!==!0&&(c=b,b=a,a=!1);if(b){c=c||"fx";var d=c+"mark",e=a?0:(f._data(b,d)||1)-1;e?f._data(b,d,e):(f.removeData(b,d,!0),n(b,c,"mark"))}},queue:function(a,b,c){var d;if(a){b=(b||"fx")+"queue",d=f._data(a,b),c&&(!d||f.isArray(c)?d=f._data(a,b,f.makeArray(c)):d.push(c));return d||[]}},dequeue:function(a,b){b=b||"fx";var c=f.queue(a,b),d=c.shift(),e={};d==="inprogress"&&(d=c.shift()),d&&(b==="fx"&&c.unshift("inprogress"),f._data(a,b+".run",e),d.call(a,function(){f.dequeue(a,b)},e)),c.length||(f.removeData(a,b+"queue "+b+".run",!0),n(a,b,"queue"))}}),f.fn.extend({queue:function(a,c){typeof a!="string"&&(c=a,a="fx");if(c===b){return f.queue(this[0],a)}return this.each(function(){var b=f.queue(this,a,c);a==="fx"&&b[0]!=="inprogress"&&f.dequeue(this,a)})},dequeue:function(a){return this.each(function(){f.dequeue(this,a)})},delay:function(a,b){a=f.fx?f.fx.speeds[a]||a:a,b=b||"fx";return this.queue(b,function(b,c){var d=setTimeout(b,a);c.stop=function(){clearTimeout(d)}})},clearQueue:function(a){return this.queue(a||"fx",[])},promise:function(a,c){function m(){--h||d.resolveWith(e,[e])}typeof a!="string"&&(c=a,a=b),a=a||"fx";var d=f.Deferred(),e=this,g=e.length,h=1,i=a+"defer",j=a+"queue",k=a+"mark",l;while(g--){if(l=f.data(e[g],i,b,!0)||(f.data(e[g],j,b,!0)||f.data(e[g],k,b,!0))&&f.data(e[g],i,f.Callbacks("once memory"),!0)){h++,l.add(m)}}m();return d.promise()}});var o=/[\n\t\r]/g,p=/\s+/,q=/\r/g,r=/^(?:button|input)$/i,s=/^(?:button|input|object|select|textarea)$/i,t=/^a(?:rea)?$/i,u=/^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,v=f.support.getSetAttribute,w,x,y;f.fn.extend({attr:function(a,b){return f.access(this,a,b,!0,f.attr)},removeAttr:function(a){return this.each(function(){f.removeAttr(this,a)})},prop:function(a,b){return f.access(this,a,b,!0,f.prop)},removeProp:function(a){a=f.propFix[a]||a;return this.each(function(){try{this[a]=b,delete this[a]}catch(c){}})},addClass:function(a){var b,c,d,e,g,h,i;if(f.isFunction(a)){return this.each(function(b){f(this).addClass(a.call(this,b,this.className))})}if(a&&typeof a=="string"){b=a.split(p);for(c=0,d=this.length;c<d;c++){e=this[c];if(e.nodeType===1){if(!e.className&&b.length===1){e.className=a}else{g=" "+e.className+" ";for(h=0,i=b.length;h<i;h++){~g.indexOf(" "+b[h]+" ")||(g+=b[h]+" ")}e.className=f.trim(g)}}}}return this},removeClass:function(a){var c,d,e,g,h,i,j;if(f.isFunction(a)){return this.each(function(b){f(this).removeClass(a.call(this,b,this.className))})}if(a&&typeof a=="string"||a===b){c=(a||"").split(p);for(d=0,e=this.length;d<e;d++){g=this[d];if(g.nodeType===1&&g.className){if(a){h=(" "+g.className+" ").replace(o," ");for(i=0,j=c.length;i<j;i++){h=h.replace(" "+c[i]+" "," ")}g.className=f.trim(h)}else{g.className=""}}}}return this},toggleClass:function(a,b){var c=typeof a,d=typeof b=="boolean";if(f.isFunction(a)){return this.each(function(c){f(this).toggleClass(a.call(this,c,this.className,b),b)})}return this.each(function(){if(c==="string"){var e,g=0,h=f(this),i=b,j=a.split(p);while(e=j[g++]){i=d?i:!h.hasClass(e),h[i?"addClass":"removeClass"](e)}}else{if(c==="undefined"||c==="boolean"){this.className&&f._data(this,"__className__",this.className),this.className=this.className||a===!1?"":f._data(this,"__className__")||""}}})},hasClass:function(a){var b=" "+a+" ",c=0,d=this.length;for(;c<d;c++){if(this[c].nodeType===1&&(" "+this[c].className+" ").replace(o," ").indexOf(b)>-1){return !0}}return !1},val:function(a){var c,d,e,g=this[0];if(!!arguments.length){e=f.isFunction(a);return this.each(function(d){var g=f(this),h;if(this.nodeType===1){e?h=a.call(this,d,g.val()):h=a,h==null?h="":typeof h=="number"?h+="":f.isArray(h)&&(h=f.map(h,function(a){return a==null?"":a+""})),c=f.valHooks[this.nodeName.toLowerCase()]||f.valHooks[this.type];if(!c||!("set" in c)||c.set(this,h,"value")===b){this.value=h}}})}if(g){c=f.valHooks[g.nodeName.toLowerCase()]||f.valHooks[g.type];if(c&&"get" in c&&(d=c.get(g,"value"))!==b){return d}d=g.value;return typeof d=="string"?d.replace(q,""):d==null?"":d}}}),f.extend({valHooks:{option:{get:function(a){var b=a.attributes.value;return !b||b.specified?a.value:a.text}},select:{get:function(a){var b,c,d,e,g=a.selectedIndex,h=[],i=a.options,j=a.type==="select-one";if(g<0){return null}c=j?g:0,d=j?g+1:i.length;for(;c<d;c++){e=i[c];if(e.selected&&(f.support.optDisabled?!e.disabled:e.getAttribute("disabled")===null)&&(!e.parentNode.disabled||!f.nodeName(e.parentNode,"optgroup"))){b=f(e).val();if(j){return b}h.push(b)}}if(j&&!h.length&&i.length){return f(i[g]).val()}return h},set:function(a,b){var c=f.makeArray(b);f(a).find("option").each(function(){this.selected=f.inArray(f(this).val(),c)>=0}),c.length||(a.selectedIndex=-1);return c}}},attrFn:{val:!0,css:!0,html:!0,text:!0,data:!0,width:!0,height:!0,offset:!0},attr:function(a,c,d,e){var g,h,i,j=a.nodeType;if(!!a&&j!==3&&j!==8&&j!==2){if(e&&c in f.attrFn){return f(a)[c](d)}if(typeof a.getAttribute=="undefined"){return f.prop(a,c,d)}i=j!==1||!f.isXMLDoc(a),i&&(c=c.toLowerCase(),h=f.attrHooks[c]||(u.test(c)?x:w));if(d!==b){if(d===null){f.removeAttr(a,c);return}if(h&&"set" in h&&i&&(g=h.set(a,d,c))!==b){return g}a.setAttribute(c,""+d);return d}if(h&&"get" in h&&i&&(g=h.get(a,c))!==null){return g}g=a.getAttribute(c);return g===null?b:g}},removeAttr:function(a,b){var c,d,e,g,h=0;if(b&&a.nodeType===1){d=b.toLowerCase().split(p),g=d.length;for(;h<g;h++){e=d[h],e&&(c=f.propFix[e]||e,f.attr(a,e,""),a.removeAttribute(v?e:c),u.test(e)&&c in a&&(a[c]=!1))}}},attrHooks:{type:{set:function(a,b){if(r.test(a.nodeName)&&a.parentNode){f.error("type property can't be changed")}else{if(!f.support.radioValue&&b==="radio"&&f.nodeName(a,"input")){var c=a.value;a.setAttribute("type",b),c&&(a.value=c);return b}}}},value:{get:function(a,b){if(w&&f.nodeName(a,"button")){return w.get(a,b)}return b in a?a.value:null},set:function(a,b,c){if(w&&f.nodeName(a,"button")){return w.set(a,b,c)}a.value=b}}},propFix:{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},prop:function(a,c,d){var e,g,h,i=a.nodeType;if(!!a&&i!==3&&i!==8&&i!==2){h=i!==1||!f.isXMLDoc(a),h&&(c=f.propFix[c]||c,g=f.propHooks[c]);return d!==b?g&&"set" in g&&(e=g.set(a,d,c))!==b?e:a[c]=d:g&&"get" in g&&(e=g.get(a,c))!==null?e:a[c]}},propHooks:{tabIndex:{get:function(a){var c=a.getAttributeNode("tabindex");return c&&c.specified?parseInt(c.value,10):s.test(a.nodeName)||t.test(a.nodeName)&&a.href?0:b}}}}),f.attrHooks.tabindex=f.propHooks.tabIndex,x={get:function(a,c){var d,e=f.prop(a,c);return e===!0||typeof e!="boolean"&&(d=a.getAttributeNode(c))&&d.nodeValue!==!1?c.toLowerCase():b},set:function(a,b,c){var d;b===!1?f.removeAttr(a,c):(d=f.propFix[c]||c,d in a&&(a[d]=!0),a.setAttribute(c,c.toLowerCase()));return c}},v||(y={name:!0,id:!0},w=f.valHooks.button={get:function(a,c){var d;d=a.getAttributeNode(c);return d&&(y[c]?d.nodeValue!=="":d.specified)?d.nodeValue:b},set:function(a,b,d){var e=a.getAttributeNode(d);e||(e=c.createAttribute(d),a.setAttributeNode(e));return e.nodeValue=b+""}},f.attrHooks.tabindex.set=w.set,f.each(["width","height"],function(a,b){f.attrHooks[b]=f.extend(f.attrHooks[b],{set:function(a,c){if(c===""){a.setAttribute(b,"auto");return c}}})}),f.attrHooks.contenteditable={get:w.get,set:function(a,b,c){b===""&&(b="false"),w.set(a,b,c)}}),f.support.hrefNormalized||f.each(["href","src","width","height"],function(a,c){f.attrHooks[c]=f.extend(f.attrHooks[c],{get:function(a){var d=a.getAttribute(c,2);return d===null?b:d}})}),f.support.style||(f.attrHooks.style={get:function(a){return a.style.cssText.toLowerCase()||b},set:function(a,b){return a.style.cssText=""+b}}),f.support.optSelected||(f.propHooks.selected=f.extend(f.propHooks.selected,{get:function(a){var b=a.parentNode;b&&(b.selectedIndex,b.parentNode&&b.parentNode.selectedIndex);return null}})),f.support.enctype||(f.propFix.enctype="encoding"),f.support.checkOn||f.each(["radio","checkbox"],function(){f.valHooks[this]={get:function(a){return a.getAttribute("value")===null?"on":a.value}}}),f.each(["radio","checkbox"],function(){f.valHooks[this]=f.extend(f.valHooks[this],{set:function(a,b){if(f.isArray(b)){return a.checked=f.inArray(f(a).val(),b)>=0}}})});var z=/^(?:textarea|input|select)$/i,A=/^([^\.]*)?(?:\.(.+))?$/,B=/\bhover(\.\S+)?\b/,C=/^key/,D=/^(?:mouse|contextmenu)|click/,E=/^(?:focusinfocus|focusoutblur)$/,F=/^(\w*)(?:#([\w\-]+))?(?:\.([\w\-]+))?$/,G=function(a){var b=F.exec(a);b&&(b[1]=(b[1]||"").toLowerCase(),b[3]=b[3]&&new RegExp("(?:^|\\s)"+b[3]+"(?:\\s|$)"));return b},H=function(a,b){var c=a.attributes||{};return(!b[1]||a.nodeName.toLowerCase()===b[1])&&(!b[2]||(c.id||{}).value===b[2])&&(!b[3]||b[3].test((c["class"]||{}).value))},I=function(a){return f.event.special.hover?a:a.replace(B,"mouseenter$1 mouseleave$1")};f.event={add:function(a,c,d,e,g){var h,i,j,k,l,m,n,o,p,q,r,s;if(!(a.nodeType===3||a.nodeType===8||!c||!d||!(h=f._data(a)))){d.handler&&(p=d,d=p.handler),d.guid||(d.guid=f.guid++),j=h.events,j||(h.events=j={}),i=h.handle,i||(h.handle=i=function(a){return typeof f!="undefined"&&(!a||f.event.triggered!==a.type)?f.event.dispatch.apply(i.elem,arguments):b},i.elem=a),c=f.trim(I(c)).split(" ");for(k=0;k<c.length;k++){l=A.exec(c[k])||[],m=l[1],n=(l[2]||"").split(".").sort(),s=f.event.special[m]||{},m=(g?s.delegateType:s.bindType)||m,s=f.event.special[m]||{},o=f.extend({type:m,origType:l[1],data:e,handler:d,guid:d.guid,selector:g,quick:G(g),namespace:n.join(".")},p),r=j[m];if(!r){r=j[m]=[],r.delegateCount=0;if(!s.setup||s.setup.call(a,e,n,i)===!1){a.addEventListener?a.addEventListener(m,i,!1):a.attachEvent&&a.attachEvent("on"+m,i)}}s.add&&(s.add.call(a,o),o.handler.guid||(o.handler.guid=d.guid)),g?r.splice(r.delegateCount++,0,o):r.push(o),f.event.global[m]=!0}a=null}},global:{},remove:function(a,b,c,d,e){var g=f.hasData(a)&&f._data(a),h,i,j,k,l,m,n,o,p,q,r,s;if(!!g&&!!(o=g.events)){b=f.trim(I(b||"")).split(" ");for(h=0;h<b.length;h++){i=A.exec(b[h])||[],j=k=i[1],l=i[2];if(!j){for(j in o){f.event.remove(a,j+b[h],c,d,!0)}continue}p=f.event.special[j]||{},j=(d?p.delegateType:p.bindType)||j,r=o[j]||[],m=r.length,l=l?new RegExp("(^|\\.)"+l.split(".").sort().join("\\.(?:.*\\.)?")+"(\\.|$)"):null;for(n=0;n<r.length;n++){s=r[n],(e||k===s.origType)&&(!c||c.guid===s.guid)&&(!l||l.test(s.namespace))&&(!d||d===s.selector||d==="**"&&s.selector)&&(r.splice(n--,1),s.selector&&r.delegateCount--,p.remove&&p.remove.call(a,s))}r.length===0&&m!==r.length&&((!p.teardown||p.teardown.call(a,l)===!1)&&f.removeEvent(a,j,g.handle),delete o[j])}f.isEmptyObject(o)&&(q=g.handle,q&&(q.elem=null),f.removeData(a,["events","handle"],!0))}},customEvent:{getData:!0,setData:!0,changeData:!0},trigger:function(c,d,e,g){if(!e||e.nodeType!==3&&e.nodeType!==8){var h=c.type||c,i=[],j,k,l,m,n,o,p,q,r,s;if(E.test(h+f.event.triggered)){return}h.indexOf("!")>=0&&(h=h.slice(0,-1),k=!0),h.indexOf(".")>=0&&(i=h.split("."),h=i.shift(),i.sort());if((!e||f.event.customEvent[h])&&!f.event.global[h]){return}c=typeof c=="object"?c[f.expando]?c:new f.Event(h,c):new f.Event(h),c.type=h,c.isTrigger=!0,c.exclusive=k,c.namespace=i.join("."),c.namespace_re=c.namespace?new RegExp("(^|\\.)"+i.join("\\.(?:.*\\.)?")+"(\\.|$)"):null,o=h.indexOf(":")<0?"on"+h:"";if(!e){j=f.cache;for(l in j){j[l].events&&j[l].events[h]&&f.event.trigger(c,d,j[l].handle.elem,!0)}return}c.result=b,c.target||(c.target=e),d=d!=null?f.makeArray(d):[],d.unshift(c),p=f.event.special[h]||{};if(p.trigger&&p.trigger.apply(e,d)===!1){return}r=[[e,p.bindType||h]];if(!g&&!p.noBubble&&!f.isWindow(e)){s=p.delegateType||h,m=E.test(s+h)?e:e.parentNode,n=null;for(;m;m=m.parentNode){r.push([m,s]),n=m}n&&n===e.ownerDocument&&r.push([n.defaultView||n.parentWindow||a,s])}for(l=0;l<r.length&&!c.isPropagationStopped();l++){m=r[l][0],c.type=r[l][1],q=(f._data(m,"events")||{})[c.type]&&f._data(m,"handle"),q&&q.apply(m,d),q=o&&m[o],q&&f.acceptData(m)&&q.apply(m,d)===!1&&c.preventDefault()}c.type=h,!g&&!c.isDefaultPrevented()&&(!p._default||p._default.apply(e.ownerDocument,d)===!1)&&(h!=="click"||!f.nodeName(e,"a"))&&f.acceptData(e)&&o&&e[h]&&(h!=="focus"&&h!=="blur"||c.target.offsetWidth!==0)&&!f.isWindow(e)&&(n=e[o],n&&(e[o]=null),f.event.triggered=h,e[h](),f.event.triggered=b,n&&(e[o]=n));return c.result}},dispatch:function(c){c=f.event.fix(c||a.event);var d=(f._data(this,"events")||{})[c.type]||[],e=d.delegateCount,g=[].slice.call(arguments,0),h=!c.exclusive&&!c.namespace,i=[],j,k,l,m,n,o,p,q,r,s,t;g[0]=c,c.delegateTarget=this;if(e&&!c.target.disabled&&(!c.button||c.type!=="click")){m=f(this),m.context=this.ownerDocument||this;for(l=c.target;l!=this;l=l.parentNode||this){o={},q=[],m[0]=l;for(j=0;j<e;j++){r=d[j],s=r.selector,o[s]===b&&(o[s]=r.quick?H(l,r.quick):m.is(s)),o[s]&&q.push(r)}q.length&&i.push({elem:l,matches:q})}}d.length>e&&i.push({elem:this,matches:d.slice(e)});for(j=0;j<i.length&&!c.isPropagationStopped();j++){p=i[j],c.currentTarget=p.elem;for(k=0;k<p.matches.length&&!c.isImmediatePropagationStopped();k++){r=p.matches[k];if(h||!c.namespace&&!r.namespace||c.namespace_re&&c.namespace_re.test(r.namespace)){c.data=r.data,c.handleObj=r,n=((f.event.special[r.origType]||{}).handle||r.handler).apply(p.elem,g),n!==b&&(c.result=n,n===!1&&(c.preventDefault(),c.stopPropagation()))}}}return c.result},props:"attrChange attrName relatedNode srcElement altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(a,b){a.which==null&&(a.which=b.charCode!=null?b.charCode:b.keyCode);return a}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(a,d){var e,f,g,h=d.button,i=d.fromElement;a.pageX==null&&d.clientX!=null&&(e=a.target.ownerDocument||c,f=e.documentElement,g=e.body,a.pageX=d.clientX+(f&&f.scrollLeft||g&&g.scrollLeft||0)-(f&&f.clientLeft||g&&g.clientLeft||0),a.pageY=d.clientY+(f&&f.scrollTop||g&&g.scrollTop||0)-(f&&f.clientTop||g&&g.clientTop||0)),!a.relatedTarget&&i&&(a.relatedTarget=i===a.target?d.toElement:i),!a.which&&h!==b&&(a.which=h&1?1:h&2?3:h&4?2:0);return a}},fix:function(a){if(a[f.expando]){return a}var d,e,g=a,h=f.event.fixHooks[a.type]||{},i=h.props?this.props.concat(h.props):this.props;a=f.Event(g);for(d=i.length;d;){e=i[--d],a[e]=g[e]}a.target||(a.target=g.srcElement||c),a.target.nodeType===3&&(a.target=a.target.parentNode),a.metaKey===b&&(a.metaKey=a.ctrlKey);return h.filter?h.filter(a,g):a},special:{ready:{setup:f.bindReady},load:{noBubble:!0},focus:{delegateType:"focusin"},blur:{delegateType:"focusout"},beforeunload:{setup:function(a,b,c){f.isWindow(this)&&(this.onbeforeunload=c)},teardown:function(a,b){this.onbeforeunload===b&&(this.onbeforeunload=null)}}},simulate:function(a,b,c,d){var e=f.extend(new f.Event,c,{type:a,isSimulated:!0,originalEvent:{}});d?f.event.trigger(e,null,b):f.event.dispatch.call(b,e),e.isDefaultPrevented()&&c.preventDefault()}},f.event.handle=f.event.dispatch,f.removeEvent=c.removeEventListener?function(a,b,c){a.removeEventListener&&a.removeEventListener(b,c,!1)}:function(a,b,c){a.detachEvent&&a.detachEvent("on"+b,c)},f.Event=function(a,b){if(!(this instanceof f.Event)){return new f.Event(a,b)}a&&a.type?(this.originalEvent=a,this.type=a.type,this.isDefaultPrevented=a.defaultPrevented||a.returnValue===!1||a.getPreventDefault&&a.getPreventDefault()?K:J):this.type=a,b&&f.extend(this,b),this.timeStamp=a&&a.timeStamp||f.now(),this[f.expando]=!0},f.Event.prototype={preventDefault:function(){this.isDefaultPrevented=K;var a=this.originalEvent;!a||(a.preventDefault?a.preventDefault():a.returnValue=!1)},stopPropagation:function(){this.isPropagationStopped=K;var a=this.originalEvent;!a||(a.stopPropagation&&a.stopPropagation(),a.cancelBubble=!0)},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=K,this.stopPropagation()},isDefaultPrevented:J,isPropagationStopped:J,isImmediatePropagationStopped:J},f.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(a,b){f.event.special[a]={delegateType:b,bindType:b,handle:function(a){var c=this,d=a.relatedTarget,e=a.handleObj,g=e.selector,h;if(!d||d!==c&&!f.contains(c,d)){a.type=e.origType,h=e.handler.apply(this,arguments),a.type=b}return h}}}),f.support.submitBubbles||(f.event.special.submit={setup:function(){if(f.nodeName(this,"form")){return !1}f.event.add(this,"click._submit keypress._submit",function(a){var c=a.target,d=f.nodeName(c,"input")||f.nodeName(c,"button")?c.form:b;d&&!d._submit_attached&&(f.event.add(d,"submit._submit",function(a){this.parentNode&&!a.isTrigger&&f.event.simulate("submit",this.parentNode,a,!0)}),d._submit_attached=!0)})},teardown:function(){if(f.nodeName(this,"form")){return !1}f.event.remove(this,"._submit")}}),f.support.changeBubbles||(f.event.special.change={setup:function(){if(z.test(this.nodeName)){if(this.type==="checkbox"||this.type==="radio"){f.event.add(this,"propertychange._change",function(a){a.originalEvent.propertyName==="checked"&&(this._just_changed=!0)}),f.event.add(this,"click._change",function(a){this._just_changed&&!a.isTrigger&&(this._just_changed=!1,f.event.simulate("change",this,a,!0))})}return !1}f.event.add(this,"beforeactivate._change",function(a){var b=a.target;z.test(b.nodeName)&&!b._change_attached&&(f.event.add(b,"change._change",function(a){this.parentNode&&!a.isSimulated&&!a.isTrigger&&f.event.simulate("change",this.parentNode,a,!0)}),b._change_attached=!0)})},handle:function(a){var b=a.target;if(this!==b||a.isSimulated||a.isTrigger||b.type!=="radio"&&b.type!=="checkbox"){return a.handleObj.handler.apply(this,arguments)}},teardown:function(){f.event.remove(this,"._change");return z.test(this.nodeName)}}),f.support.focusinBubbles||f.each({focus:"focusin",blur:"focusout"},function(a,b){var d=0,e=function(a){f.event.simulate(b,a.target,f.event.fix(a),!0)};f.event.special[b]={setup:function(){d++===0&&c.addEventListener(a,e,!0)},teardown:function(){--d===0&&c.removeEventListener(a,e,!0)}}}),f.fn.extend({on:function(a,c,d,e,g){var h,i;if(typeof a=="object"){typeof c!="string"&&(d=c,c=b);for(i in a){this.on(i,c,d,a[i],g)}return this}d==null&&e==null?(e=c,d=c=b):e==null&&(typeof c=="string"?(e=d,d=b):(e=d,d=c,c=b));if(e===!1){e=J}else{if(!e){return this}}g===1&&(h=e,e=function(a){f().off(a);return h.apply(this,arguments)},e.guid=h.guid||(h.guid=f.guid++));return this.each(function(){f.event.add(this,a,e,d,c)})},one:function(a,b,c,d){return this.on.call(this,a,b,c,d,1)},off:function(a,c,d){if(a&&a.preventDefault&&a.handleObj){var e=a.handleObj;f(a.delegateTarget).off(e.namespace?e.type+"."+e.namespace:e.type,e.selector,e.handler);return this}if(typeof a=="object"){for(var g in a){this.off(g,c,a[g])}return this}if(c===!1||typeof c=="function"){d=c,c=b}d===!1&&(d=J);return this.each(function(){f.event.remove(this,a,d,c)})},bind:function(a,b,c){return this.on(a,null,b,c)},unbind:function(a,b){return this.off(a,null,b)},live:function(a,b,c){f(this.context).on(a,this.selector,b,c);return this},die:function(a,b){f(this.context).off(a,this.selector||"**",b);return this},delegate:function(a,b,c,d){return this.on(b,a,c,d)},undelegate:function(a,b,c){return arguments.length==1?this.off(a,"**"):this.off(b,a,c)},trigger:function(a,b){return this.each(function(){f.event.trigger(a,b,this)})},triggerHandler:function(a,b){if(this[0]){return f.event.trigger(a,b,this[0],!0)}},toggle:function(a){var b=arguments,c=a.guid||f.guid++,d=0,e=function(c){var e=(f._data(this,"lastToggle"+a.guid)||0)%d;f._data(this,"lastToggle"+a.guid,e+1),c.preventDefault();return b[e].apply(this,arguments)||!1};e.guid=c;while(d<b.length){b[d++].guid=c}return this.click(e)},hover:function(a,b){return this.mouseenter(a).mouseleave(b||a)}}),f.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(a,b){f.fn[b]=function(a,c){c==null&&(c=a,a=null);return arguments.length>0?this.on(b,null,a,c):this.trigger(b)},f.attrFn&&(f.attrFn[b]=!0),C.test(b)&&(f.event.fixHooks[b]=f.event.keyHooks),D.test(b)&&(f.event.fixHooks[b]=f.event.mouseHooks)}),function(){function x(a,b,c,e,f,g){for(var h=0,i=e.length;h<i;h++){var j=e[h];if(j){var k=!1;j=j[a];while(j){if(j[d]===c){k=e[j.sizset];break}if(j.nodeType===1){g||(j[d]=c,j.sizset=h);if(typeof b!="string"){if(j===b){k=!0;break}}else{if(m.filter(b,[j]).length>0){k=j;break}}}j=j[a]}e[h]=k}}}function w(a,b,c,e,f,g){for(var h=0,i=e.length;h<i;h++){var j=e[h];if(j){var k=!1;j=j[a];while(j){if(j[d]===c){k=e[j.sizset];break}j.nodeType===1&&!g&&(j[d]=c,j.sizset=h);if(j.nodeName.toLowerCase()===b){k=j;break}j=j[a]}e[h]=k}}}var a=/((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^\[\]]*\]|['"][^'"]*['"]|[^\[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*)/g,d="sizcache"+(Math.random()+"").replace(".",""),e=0,g=Object.prototype.toString,h=!1,i=!0,j=/\\/g,k=/\r\n/g,l=/\W/;[0,0].sort(function(){i=!1;return 0});var m=function(b,d,e,f){e=e||[],d=d||c;var h=d;if(d.nodeType!==1&&d.nodeType!==9){return[]}if(!b||typeof b!="string"){return e}var i,j,k,l,n,q,r,t,u=!0,v=m.isXML(d),w=[],x=b;do{a.exec(""),i=a.exec(x);if(i){x=i[3],w.push(i[1]);if(i[2]){l=i[3];break}}}while(i);if(w.length>1&&p.exec(b)){if(w.length===2&&o.relative[w[0]]){j=y(w[0]+w[1],d,f)}else{j=o.relative[w[0]]?[d]:m(w.shift(),d);while(w.length){b=w.shift(),o.relative[b]&&(b+=w.shift()),j=y(b,j,f)}}}else{!f&&w.length>1&&d.nodeType===9&&!v&&o.match.ID.test(w[0])&&!o.match.ID.test(w[w.length-1])&&(n=m.find(w.shift(),d,v),d=n.expr?m.filter(n.expr,n.set)[0]:n.set[0]);if(d){n=f?{expr:w.pop(),set:s(f)}:m.find(w.pop(),w.length===1&&(w[0]==="~"||w[0]==="+")&&d.parentNode?d.parentNode:d,v),j=n.expr?m.filter(n.expr,n.set):n.set,w.length>0?k=s(j):u=!1;while(w.length){q=w.pop(),r=q,o.relative[q]?r=w.pop():q="",r==null&&(r=d),o.relative[q](k,r,v)}}else{k=w=[]}}k||(k=j),k||m.error(q||b);if(g.call(k)==="[object Array]"){if(!u){e.push.apply(e,k)}else{if(d&&d.nodeType===1){for(t=0;k[t]!=null;t++){k[t]&&(k[t]===!0||k[t].nodeType===1&&m.contains(d,k[t]))&&e.push(j[t])}}else{for(t=0;k[t]!=null;t++){k[t]&&k[t].nodeType===1&&e.push(j[t])}}}}else{s(k,e)}l&&(m(l,h,e,f),m.uniqueSort(e));return e};m.uniqueSort=function(a){if(u){h=i,a.sort(u);if(h){for(var b=1;b<a.length;b++){a[b]===a[b-1]&&a.splice(b--,1)}}}return a},m.matches=function(a,b){return m(a,null,null,b)},m.matchesSelector=function(a,b){return m(b,null,null,[a]).length>0},m.find=function(a,b,c){var d,e,f,g,h,i;if(!a){return[]}for(e=0,f=o.order.length;e<f;e++){h=o.order[e];if(g=o.leftMatch[h].exec(a)){i=g[1],g.splice(1,1);if(i.substr(i.length-1)!=="\\"){g[1]=(g[1]||"").replace(j,""),d=o.find[h](g,b,c);if(d!=null){a=a.replace(o.match[h],"");break}}}}d||(d=typeof b.getElementsByTagName!="undefined"?b.getElementsByTagName("*"):[]);return{set:d,expr:a}},m.filter=function(a,c,d,e){var f,g,h,i,j,k,l,n,p,q=a,r=[],s=c,t=c&&c[0]&&m.isXML(c[0]);while(a&&c.length){for(h in o.filter){if((f=o.leftMatch[h].exec(a))!=null&&f[2]){k=o.filter[h],l=f[1],g=!1,f.splice(1,1);if(l.substr(l.length-1)==="\\"){continue}s===r&&(r=[]);if(o.preFilter[h]){f=o.preFilter[h](f,s,d,r,e,t);if(!f){g=i=!0}else{if(f===!0){continue}}}if(f){for(n=0;(j=s[n])!=null;n++){j&&(i=k(j,f,n,s),p=e^i,d&&i!=null?p?g=!0:s[n]=!1:p&&(r.push(j),g=!0))}}if(i!==b){d||(s=r),a=a.replace(o.match[h],"");if(!g){return[]}break}}}if(a===q){if(g==null){m.error(a)}else{break}}q=a}return s},m.error=function(a){throw new Error("Syntax error, unrecognized expression: "+a)};var n=m.getText=function(a){var b,c,d=a.nodeType,e="";if(d){if(d===1||d===9){if(typeof a.textContent=="string"){return a.textContent}if(typeof a.innerText=="string"){return a.innerText.replace(k,"")}for(a=a.firstChild;a;a=a.nextSibling){e+=n(a)}}else{if(d===3||d===4){return a.nodeValue}}}else{for(b=0;c=a[b];b++){c.nodeType!==8&&(e+=n(c))}}return e},o=m.selectors={order:["ID","NAME","TAG"],match:{ID:/#((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,CLASS:/\.((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,NAME:/\[name=['"]*((?:[\w\u00c0-\uFFFF\-]|\\.)+)['"]*\]/,ATTR:/\[\s*((?:[\w\u00c0-\uFFFF\-]|\\.)+)\s*(?:(\S?=)\s*(?:(['"])(.*?)\3|(#?(?:[\w\u00c0-\uFFFF\-]|\\.)*)|)|)\s*\]/,TAG:/^((?:[\w\u00c0-\uFFFF\*\-]|\\.)+)/,CHILD:/:(only|nth|last|first)-child(?:\(\s*(even|odd|(?:[+\-]?\d+|(?:[+\-]?\d*)?n\s*(?:[+\-]\s*\d+)?))\s*\))?/,POS:/:(nth|eq|gt|lt|first|last|even|odd)(?:\((\d*)\))?(?=[^\-]|$)/,PSEUDO:/:((?:[\w\u00c0-\uFFFF\-]|\\.)+)(?:\((['"]?)((?:\([^\)]+\)|[^\(\)]*)+)\2\))?/},leftMatch:{},attrMap:{"class":"className","for":"htmlFor"},attrHandle:{href:function(a){return a.getAttribute("href")},type:function(a){return a.getAttribute("type")}},relative:{"+":function(a,b){var c=typeof b=="string",d=c&&!l.test(b),e=c&&!d;d&&(b=b.toLowerCase());for(var f=0,g=a.length,h;f<g;f++){if(h=a[f]){while((h=h.previousSibling)&&h.nodeType!==1){}a[f]=e||h&&h.nodeName.toLowerCase()===b?h||!1:h===b}}e&&m.filter(b,a,!0)},">":function(a,b){var c,d=typeof b=="string",e=0,f=a.length;if(d&&!l.test(b)){b=b.toLowerCase();for(;e<f;e++){c=a[e];if(c){var g=c.parentNode;a[e]=g.nodeName.toLowerCase()===b?g:!1}}}else{for(;e<f;e++){c=a[e],c&&(a[e]=d?c.parentNode:c.parentNode===b)}d&&m.filter(b,a,!0)}},"":function(a,b,c){var d,f=e++,g=x;typeof b=="string"&&!l.test(b)&&(b=b.toLowerCase(),d=b,g=w),g("parentNode",b,f,a,d,c)},"~":function(a,b,c){var d,f=e++,g=x;typeof b=="string"&&!l.test(b)&&(b=b.toLowerCase(),d=b,g=w),g("previousSibling",b,f,a,d,c)}},find:{ID:function(a,b,c){if(typeof b.getElementById!="undefined"&&!c){var d=b.getElementById(a[1]);return d&&d.parentNode?[d]:[]}},NAME:function(a,b){if(typeof b.getElementsByName!="undefined"){var c=[],d=b.getElementsByName(a[1]);for(var e=0,f=d.length;e<f;e++){d[e].getAttribute("name")===a[1]&&c.push(d[e])}return c.length===0?null:c}},TAG:function(a,b){if(typeof b.getElementsByTagName!="undefined"){return b.getElementsByTagName(a[1])}}},preFilter:{CLASS:function(a,b,c,d,e,f){a=" "+a[1].replace(j,"")+" ";if(f){return a}for(var g=0,h;(h=b[g])!=null;g++){h&&(e^(h.className&&(" "+h.className+" ").replace(/[\t\n\r]/g," ").indexOf(a)>=0)?c||d.push(h):c&&(b[g]=!1))}return !1},ID:function(a){return a[1].replace(j,"")},TAG:function(a,b){return a[1].replace(j,"").toLowerCase()},CHILD:function(a){if(a[1]==="nth"){a[2]||m.error(a[0]),a[2]=a[2].replace(/^\+|\s*/g,"");var b=/(-?)(\d*)(?:n([+\-]?\d*))?/.exec(a[2]==="even"&&"2n"||a[2]==="odd"&&"2n+1"||!/\D/.test(a[2])&&"0n+"+a[2]||a[2]);a[2]=b[1]+(b[2]||1)-0,a[3]=b[3]-0}else{a[2]&&m.error(a[0])}a[0]=e++;return a},ATTR:function(a,b,c,d,e,f){var g=a[1]=a[1].replace(j,"");!f&&o.attrMap[g]&&(a[1]=o.attrMap[g]),a[4]=(a[4]||a[5]||"").replace(j,""),a[2]==="~="&&(a[4]=" "+a[4]+" ");return a},PSEUDO:function(b,c,d,e,f){if(b[1]==="not"){if((a.exec(b[3])||"").length>1||/^\w/.test(b[3])){b[3]=m(b[3],null,null,c)}else{var g=m.filter(b[3],c,d,!0^f);d||e.push.apply(e,g);return !1}}else{if(o.match.POS.test(b[0])||o.match.CHILD.test(b[0])){return !0}}return b},POS:function(a){a.unshift(!0);return a}},filters:{enabled:function(a){return a.disabled===!1&&a.type!=="hidden"},disabled:function(a){return a.disabled===!0},checked:function(a){return a.checked===!0},selected:function(a){a.parentNode&&a.parentNode.selectedIndex;return a.selected===!0},parent:function(a){return !!a.firstChild},empty:function(a){return !a.firstChild},has:function(a,b,c){return !!m(c[3],a).length},header:function(a){return/h\d/i.test(a.nodeName)},text:function(a){var b=a.getAttribute("type"),c=a.type;return a.nodeName.toLowerCase()==="input"&&"text"===c&&(b===c||b===null)},radio:function(a){return a.nodeName.toLowerCase()==="input"&&"radio"===a.type},checkbox:function(a){return a.nodeName.toLowerCase()==="input"&&"checkbox"===a.type},file:function(a){return a.nodeName.toLowerCase()==="input"&&"file"===a.type},password:function(a){return a.nodeName.toLowerCase()==="input"&&"password"===a.type},submit:function(a){var b=a.nodeName.toLowerCase();return(b==="input"||b==="button")&&"submit"===a.type},image:function(a){return a.nodeName.toLowerCase()==="input"&&"image"===a.type},reset:function(a){var b=a.nodeName.toLowerCase();return(b==="input"||b==="button")&&"reset"===a.type},button:function(a){var b=a.nodeName.toLowerCase();return b==="input"&&"button"===a.type||b==="button"},input:function(a){return/input|select|textarea|button/i.test(a.nodeName)},focus:function(a){return a===a.ownerDocument.activeElement}},setFilters:{first:function(a,b){return b===0},last:function(a,b,c,d){return b===d.length-1},even:function(a,b){return b%2===0},odd:function(a,b){return b%2===1},lt:function(a,b,c){return b<c[3]-0},gt:function(a,b,c){return b>c[3]-0},nth:function(a,b,c){return c[3]-0===b},eq:function(a,b,c){return c[3]-0===b}},filter:{PSEUDO:function(a,b,c,d){var e=b[1],f=o.filters[e];if(f){return f(a,c,b,d)}if(e==="contains"){return(a.textContent||a.innerText||n([a])||"").indexOf(b[3])>=0}if(e==="not"){var g=b[3];for(var h=0,i=g.length;h<i;h++){if(g[h]===a){return !1}}return !0}m.error(e)},CHILD:function(a,b){var c,e,f,g,h,i,j,k=b[1],l=a;switch(k){case"only":case"first":while(l=l.previousSibling){if(l.nodeType===1){return !1}}if(k==="first"){return !0}l=a;case"last":while(l=l.nextSibling){if(l.nodeType===1){return !1}}return !0;case"nth":c=b[2],e=b[3];if(c===1&&e===0){return !0}f=b[0],g=a.parentNode;if(g&&(g[d]!==f||!a.nodeIndex)){i=0;for(l=g.firstChild;l;l=l.nextSibling){l.nodeType===1&&(l.nodeIndex=++i)}g[d]=f}j=a.nodeIndex-e;return c===0?j===0:j%c===0&&j/c>=0}},ID:function(a,b){return a.nodeType===1&&a.getAttribute("id")===b},TAG:function(a,b){return b==="*"&&a.nodeType===1||!!a.nodeName&&a.nodeName.toLowerCase()===b},CLASS:function(a,b){return(" "+(a.className||a.getAttribute("class"))+" ").indexOf(b)>-1},ATTR:function(a,b){var c=b[1],d=m.attr?m.attr(a,c):o.attrHandle[c]?o.attrHandle[c](a):a[c]!=null?a[c]:a.getAttribute(c),e=d+"",f=b[2],g=b[4];return d==null?f==="!=":!f&&m.attr?d!=null:f==="="?e===g:f==="*="?e.indexOf(g)>=0:f==="~="?(" "+e+" ").indexOf(g)>=0:g?f==="!="?e!==g:f==="^="?e.indexOf(g)===0:f==="$="?e.substr(e.length-g.length)===g:f==="|="?e===g||e.substr(0,g.length+1)===g+"-":!1:e&&d!==!1},POS:function(a,b,c,d){var e=b[2],f=o.setFilters[e];if(f){return f(a,c,b,d)}}}},p=o.match.POS,q=function(a,b){return"\\"+(b-0+1)};for(var r in o.match){o.match[r]=new RegExp(o.match[r].source+/(?![^\[]*\])(?![^\(]*\))/.source),o.leftMatch[r]=new RegExp(/(^(?:.|\r|\n)*?)/.source+o.match[r].source.replace(/\\(\d+)/g,q))}var s=function(a,b){a=Array.prototype.slice.call(a,0);if(b){b.push.apply(b,a);return b}return a};try{Array.prototype.slice.call(c.documentElement.childNodes,0)[0].nodeType}catch(t){s=function(a,b){var c=0,d=b||[];if(g.call(a)==="[object Array]"){Array.prototype.push.apply(d,a)}else{if(typeof a.length=="number"){for(var e=a.length;c<e;c++){d.push(a[c])}}else{for(;a[c];c++){d.push(a[c])}}}return d}}var u,v;c.documentElement.compareDocumentPosition?u=function(a,b){if(a===b){h=!0;return 0}if(!a.compareDocumentPosition||!b.compareDocumentPosition){return a.compareDocumentPosition?-1:1}return a.compareDocumentPosition(b)&4?-1:1}:(u=function(a,b){if(a===b){h=!0;return 0}if(a.sourceIndex&&b.sourceIndex){return a.sourceIndex-b.sourceIndex}var c,d,e=[],f=[],g=a.parentNode,i=b.parentNode,j=g;if(g===i){return v(a,b)}if(!g){return -1}if(!i){return 1}while(j){e.unshift(j),j=j.parentNode}j=i;while(j){f.unshift(j),j=j.parentNode}c=e.length,d=f.length;for(var k=0;k<c&&k<d;k++){if(e[k]!==f[k]){return v(e[k],f[k])}}return k===c?v(a,f[k],-1):v(e[k],b,1)},v=function(a,b,c){if(a===b){return c}var d=a.nextSibling;while(d){if(d===b){return -1}d=d.nextSibling}return 1}),function(){var a=c.createElement("div"),d="script"+(new Date).getTime(),e=c.documentElement;a.innerHTML="<a name='"+d+"'/>",e.insertBefore(a,e.firstChild),c.getElementById(d)&&(o.find.ID=function(a,c,d){if(typeof c.getElementById!="undefined"&&!d){var e=c.getElementById(a[1]);return e?e.id===a[1]||typeof e.getAttributeNode!="undefined"&&e.getAttributeNode("id").nodeValue===a[1]?[e]:b:[]}},o.filter.ID=function(a,b){var c=typeof a.getAttributeNode!="undefined"&&a.getAttributeNode("id");return a.nodeType===1&&c&&c.nodeValue===b}),e.removeChild(a),e=a=null}(),function(){var a=c.createElement("div");a.appendChild(c.createComment("")),a.getElementsByTagName("*").length>0&&(o.find.TAG=function(a,b){var c=b.getElementsByTagName(a[1]);if(a[1]==="*"){var d=[];for(var e=0;c[e];e++){c[e].nodeType===1&&d.push(c[e])}c=d}return c}),a.innerHTML="<a href='#'></a>",a.firstChild&&typeof a.firstChild.getAttribute!="undefined"&&a.firstChild.getAttribute("href")!=="#"&&(o.attrHandle.href=function(a){return a.getAttribute("href",2)}),a=null}(),c.querySelectorAll&&function(){var a=m,b=c.createElement("div"),d="__sizzle__";b.innerHTML="<p class='TEST'></p>";if(!b.querySelectorAll||b.querySelectorAll(".TEST").length!==0){m=function(b,e,f,g){e=e||c;if(!g&&!m.isXML(e)){var h=/^(\w+$)|^\.([\w\-]+$)|^#([\w\-]+$)/.exec(b);if(h&&(e.nodeType===1||e.nodeType===9)){if(h[1]){return s(e.getElementsByTagName(b),f)}if(h[2]&&o.find.CLASS&&e.getElementsByClassName){return s(e.getElementsByClassName(h[2]),f)}}if(e.nodeType===9){if(b==="body"&&e.body){return s([e.body],f)}if(h&&h[3]){var i=e.getElementById(h[3]);if(!i||!i.parentNode){return s([],f)}if(i.id===h[3]){return s([i],f)}}try{return s(e.querySelectorAll(b),f)}catch(j){}}else{if(e.nodeType===1&&e.nodeName.toLowerCase()!=="object"){var k=e,l=e.getAttribute("id"),n=l||d,p=e.parentNode,q=/^\s*[+~]/.test(b);l?n=n.replace(/'/g,"\\$&"):e.setAttribute("id",n),q&&p&&(e=e.parentNode);try{if(!q||p){return s(e.querySelectorAll("[id='"+n+"'] "+b),f)}}catch(r){}finally{l||k.removeAttribute("id")}}}}return a(b,e,f,g)};for(var e in a){m[e]=a[e]}b=null}}(),function(){var a=c.documentElement,b=a.matchesSelector||a.mozMatchesSelector||a.webkitMatchesSelector||a.msMatchesSelector;if(b){var d=!b.call(c.createElement("div"),"div"),e=!1;try{b.call(c.documentElement,"[test!='']:sizzle")}catch(f){e=!0}m.matchesSelector=function(a,c){c=c.replace(/\=\s*([^'"\]]*)\s*\]/g,"='$1']");if(!m.isXML(a)){try{if(e||!o.match.PSEUDO.test(c)&&!/!=/.test(c)){var f=b.call(a,c);if(f||!d||a.document&&a.document.nodeType!==11){return f}}}catch(g){}}return m(c,null,null,[a]).length>0}}}(),function(){var a=c.createElement("div");a.innerHTML="<div class='test e'></div><div class='test'></div>";if(!!a.getElementsByClassName&&a.getElementsByClassName("e").length!==0){a.lastChild.className="e";if(a.getElementsByClassName("e").length===1){return}o.order.splice(1,0,"CLASS"),o.find.CLASS=function(a,b,c){if(typeof b.getElementsByClassName!="undefined"&&!c){return b.getElementsByClassName(a[1])}},a=null}}(),c.documentElement.contains?m.contains=function(a,b){return a!==b&&(a.contains?a.contains(b):!0)}:c.documentElement.compareDocumentPosition?m.contains=function(a,b){return !!(a.compareDocumentPosition(b)&16)}:m.contains=function(){return !1},m.isXML=function(a){var b=(a?a.ownerDocument||a:0).documentElement;return b?b.nodeName!=="HTML":!1};var y=function(a,b,c){var d,e=[],f="",g=b.nodeType?[b]:b;while(d=o.match.PSEUDO.exec(a)){f+=d[0],a=a.replace(o.match.PSEUDO,"")}a=o.relative[a]?a+"*":a;for(var h=0,i=g.length;h<i;h++){m(a,g[h],e,c)}return m.filter(f,e)};m.attr=f.attr,m.selectors.attrMap={},f.find=m,f.expr=m.selectors,f.expr[":"]=f.expr.filters,f.unique=m.uniqueSort,f.text=m.getText,f.isXMLDoc=m.isXML,f.contains=m.contains}();var L=/Until$/,M=/^(?:parents|prevUntil|prevAll)/,N=/,/,O=/^.[^:#\[\.,]*$/,P=Array.prototype.slice,Q=f.expr.match.POS,R={children:!0,contents:!0,next:!0,prev:!0};f.fn.extend({find:function(a){var b=this,c,d;if(typeof a!="string"){return f(a).filter(function(){for(c=0,d=b.length;c<d;c++){if(f.contains(b[c],this)){return !0}}})}var e=this.pushStack("","find",a),g,h,i;for(c=0,d=this.length;c<d;c++){g=e.length,f.find(a,this[c],e);if(c>0){for(h=g;h<e.length;h++){for(i=0;i<g;i++){if(e[i]===e[h]){e.splice(h--,1);break}}}}}return e},has:function(a){var b=f(a);return this.filter(function(){for(var a=0,c=b.length;a<c;a++){if(f.contains(this,b[a])){return !0}}})},not:function(a){return this.pushStack(T(this,a,!1),"not",a)},filter:function(a){return this.pushStack(T(this,a,!0),"filter",a)},is:function(a){return !!a&&(typeof a=="string"?Q.test(a)?f(a,this.context).index(this[0])>=0:f.filter(a,this).length>0:this.filter(a).length>0)},closest:function(a,b){var c=[],d,e,g=this[0];if(f.isArray(a)){var h=1;while(g&&g.ownerDocument&&g!==b){for(d=0;d<a.length;d++){f(g).is(a[d])&&c.push({selector:a[d],elem:g,level:h})}g=g.parentNode,h++}return c}var i=Q.test(a)||typeof a!="string"?f(a,b||this.context):0;for(d=0,e=this.length;d<e;d++){g=this[d];while(g){if(i?i.index(g)>-1:f.find.matchesSelector(g,a)){c.push(g);break}g=g.parentNode;if(!g||!g.ownerDocument||g===b||g.nodeType===11){break}}}c=c.length>1?f.unique(c):c;return this.pushStack(c,"closest",a)},index:function(a){if(!a){return this[0]&&this[0].parentNode?this.prevAll().length:-1}if(typeof a=="string"){return f.inArray(this[0],f(a))}return f.inArray(a.jquery?a[0]:a,this)},add:function(a,b){var c=typeof a=="string"?f(a,b):f.makeArray(a&&a.nodeType?[a]:a),d=f.merge(this.get(),c);return this.pushStack(S(c[0])||S(d[0])?d:f.unique(d))},andSelf:function(){return this.add(this.prevObject)}}),f.each({parent:function(a){var b=a.parentNode;return b&&b.nodeType!==11?b:null},parents:function(a){return f.dir(a,"parentNode")},parentsUntil:function(a,b,c){return f.dir(a,"parentNode",c)},next:function(a){return f.nth(a,2,"nextSibling")},prev:function(a){return f.nth(a,2,"previousSibling")},nextAll:function(a){return f.dir(a,"nextSibling")},prevAll:function(a){return f.dir(a,"previousSibling")},nextUntil:function(a,b,c){return f.dir(a,"nextSibling",c)},prevUntil:function(a,b,c){return f.dir(a,"previousSibling",c)},siblings:function(a){return f.sibling(a.parentNode.firstChild,a)},children:function(a){return f.sibling(a.firstChild)},contents:function(a){return f.nodeName(a,"iframe")?a.contentDocument||a.contentWindow.document:f.makeArray(a.childNodes)}},function(a,b){f.fn[a]=function(c,d){var e=f.map(this,b,c);L.test(a)||(d=c),d&&typeof d=="string"&&(e=f.filter(d,e)),e=this.length>1&&!R[a]?f.unique(e):e,(this.length>1||N.test(d))&&M.test(a)&&(e=e.reverse());return this.pushStack(e,a,P.call(arguments).join(","))}}),f.extend({filter:function(a,b,c){c&&(a=":not("+a+")");return b.length===1?f.find.matchesSelector(b[0],a)?[b[0]]:[]:f.find.matches(a,b)},dir:function(a,c,d){var e=[],g=a[c];while(g&&g.nodeType!==9&&(d===b||g.nodeType!==1||!f(g).is(d))){g.nodeType===1&&e.push(g),g=g[c]}return e},nth:function(a,b,c,d){b=b||1;var e=0;for(;a;a=a[c]){if(a.nodeType===1&&++e===b){break}}return a},sibling:function(a,b){var c=[];for(;a;a=a.nextSibling){a.nodeType===1&&a!==b&&c.push(a)}return c}});var V="abbr|article|aside|audio|canvas|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",W=/ jQuery\d+="(?:\d+|null)"/g,X=/^\s+/,Y=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/ig,Z=/<([\w:]+)/,$=/<tbody/i,_=/<|&#?\w+;/,ba=/<(?:script|style)/i,bb=/<(?:script|object|embed|option|style)/i,bc=new RegExp("<(?:"+V+")","i"),bd=/checked\s*(?:[^=]|=\s*.checked.)/i,be=/\/(java|ecma)script/i,bf=/^\s*<!(?:\[CDATA\[|\-\-)/,bg={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],area:[1,"<map>","</map>"],_default:[0,"",""]},bh=U(c);bg.optgroup=bg.option,bg.tbody=bg.tfoot=bg.colgroup=bg.caption=bg.thead,bg.th=bg.td,f.support.htmlSerialize||(bg._default=[1,"div<div>","</div>"]),f.fn.extend({text:function(a){if(f.isFunction(a)){return this.each(function(b){var c=f(this);c.text(a.call(this,b,c.text()))})}if(typeof a!="object"&&a!==b){return this.empty().append((this[0]&&this[0].ownerDocument||c).createTextNode(a))}return f.text(this)},wrapAll:function(a){if(f.isFunction(a)){return this.each(function(b){f(this).wrapAll(a.call(this,b))})}if(this[0]){var b=f(a,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&b.insertBefore(this[0]),b.map(function(){var a=this;while(a.firstChild&&a.firstChild.nodeType===1){a=a.firstChild}return a}).append(this)}return this},wrapInner:function(a){if(f.isFunction(a)){return this.each(function(b){f(this).wrapInner(a.call(this,b))})}return this.each(function(){var b=f(this),c=b.contents();c.length?c.wrapAll(a):b.append(a)})},wrap:function(a){var b=f.isFunction(a);return this.each(function(c){f(this).wrapAll(b?a.call(this,c):a)})},unwrap:function(){return this.parent().each(function(){f.nodeName(this,"body")||f(this).replaceWith(this.childNodes)}).end()},append:function(){return this.domManip(arguments,!0,function(a){this.nodeType===1&&this.appendChild(a)})},prepend:function(){return this.domManip(arguments,!0,function(a){this.nodeType===1&&this.insertBefore(a,this.firstChild)})},before:function(){if(this[0]&&this[0].parentNode){return this.domManip(arguments,!1,function(a){this.parentNode.insertBefore(a,this)})}if(arguments.length){var a=f.clean(arguments);a.push.apply(a,this.toArray());return this.pushStack(a,"before",arguments)}},after:function(){if(this[0]&&this[0].parentNode){return this.domManip(arguments,!1,function(a){this.parentNode.insertBefore(a,this.nextSibling)})}if(arguments.length){var a=this.pushStack(this,"after",arguments);a.push.apply(a,f.clean(arguments));return a}},remove:function(a,b){for(var c=0,d;(d=this[c])!=null;c++){if(!a||f.filter(a,[d]).length){!b&&d.nodeType===1&&(f.cleanData(d.getElementsByTagName("*")),f.cleanData([d])),d.parentNode&&d.parentNode.removeChild(d)}}return this},empty:function(){for(var a=0,b;(b=this[a])!=null;a++){b.nodeType===1&&f.cleanData(b.getElementsByTagName("*"));while(b.firstChild){b.removeChild(b.firstChild)}}return this},clone:function(a,b){a=a==null?!1:a,b=b==null?a:b;return this.map(function(){return f.clone(this,a,b)})},html:function(a){if(a===b){return this[0]&&this[0].nodeType===1?this[0].innerHTML.replace(W,""):null}if(typeof a=="string"&&!ba.test(a)&&(f.support.leadingWhitespace||!X.test(a))&&!bg[(Z.exec(a)||["",""])[1].toLowerCase()]){a=a.replace(Y,"<$1></$2>");try{for(var c=0,d=this.length;c<d;c++){this[c].nodeType===1&&(f.cleanData(this[c].getElementsByTagName("*")),this[c].innerHTML=a)}}catch(e){this.empty().append(a)}}else{f.isFunction(a)?this.each(function(b){var c=f(this);c.html(a.call(this,b,c.html()))}):this.empty().append(a)}return this},replaceWith:function(a){if(this[0]&&this[0].parentNode){if(f.isFunction(a)){return this.each(function(b){var c=f(this),d=c.html();c.replaceWith(a.call(this,b,d))})}typeof a!="string"&&(a=f(a).detach());return this.each(function(){var b=this.nextSibling,c=this.parentNode;f(this).remove(),b?f(b).before(a):f(c).append(a)})}return this.length?this.pushStack(f(f.isFunction(a)?a():a),"replaceWith",a):this},detach:function(a){return this.remove(a,!0)},domManip:function(a,c,d){var e,g,h,i,j=a[0],k=[];if(!f.support.checkClone&&arguments.length===3&&typeof j=="string"&&bd.test(j)){return this.each(function(){f(this).domManip(a,c,d,!0)})}if(f.isFunction(j)){return this.each(function(e){var g=f(this);a[0]=j.call(this,e,c?g.html():b),g.domManip(a,c,d)})}if(this[0]){i=j&&j.parentNode,f.support.parentNode&&i&&i.nodeType===11&&i.childNodes.length===this.length?e={fragment:i}:e=f.buildFragment(a,this,k),h=e.fragment,h.childNodes.length===1?g=h=h.firstChild:g=h.firstChild;if(g){c=c&&f.nodeName(g,"tr");for(var l=0,m=this.length,n=m-1;l<m;l++){d.call(c?bi(this[l],g):this[l],e.cacheable||m>1&&l<n?f.clone(h,!0,!0):h)}}k.length&&f.each(k,bp)}return this}}),f.buildFragment=function(a,b,d){var e,g,h,i,j=a[0];b&&b[0]&&(i=b[0].ownerDocument||b[0]),i.createDocumentFragment||(i=c),a.length===1&&typeof j=="string"&&j.length<512&&i===c&&j.charAt(0)==="<"&&!bb.test(j)&&(f.support.checkClone||!bd.test(j))&&(f.support.html5Clone||!bc.test(j))&&(g=!0,h=f.fragments[j],h&&h!==1&&(e=h)),e||(e=i.createDocumentFragment(),f.clean(a,i,e,d)),g&&(f.fragments[j]=h?e:1);return{fragment:e,cacheable:g}},f.fragments={},f.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(a,b){f.fn[a]=function(c){var d=[],e=f(c),g=this.length===1&&this[0].parentNode;if(g&&g.nodeType===11&&g.childNodes.length===1&&e.length===1){e[b](this[0]);return this}for(var h=0,i=e.length;h<i;h++){var j=(h>0?this.clone(!0):this).get();f(e[h])[b](j),d=d.concat(j)}return this.pushStack(d,a,e.selector)}}),f.extend({clone:function(a,b,c){var d,e,g,h=f.support.html5Clone||!bc.test("<"+a.nodeName)?a.cloneNode(!0):bo(a);if((!f.support.noCloneEvent||!f.support.noCloneChecked)&&(a.nodeType===1||a.nodeType===11)&&!f.isXMLDoc(a)){bk(a,h),d=bl(a),e=bl(h);for(g=0;d[g];++g){e[g]&&bk(d[g],e[g])}}if(b){bj(a,h);if(c){d=bl(a),e=bl(h);for(g=0;d[g];++g){bj(d[g],e[g])}}}d=e=null;return h},clean:function(a,b,d,e){var g;b=b||c,typeof b.createElement=="undefined"&&(b=b.ownerDocument||b[0]&&b[0].ownerDocument||c);var h=[],i;for(var j=0,k;(k=a[j])!=null;j++){typeof k=="number"&&(k+="");if(!k){continue}if(typeof k=="string"){if(!_.test(k)){k=b.createTextNode(k)}else{k=k.replace(Y,"<$1></$2>");var l=(Z.exec(k)||["",""])[1].toLowerCase(),m=bg[l]||bg._default,n=m[0],o=b.createElement("div");b===c?bh.appendChild(o):U(b).appendChild(o),o.innerHTML=m[1]+k+m[2];while(n--){o=o.lastChild}if(!f.support.tbody){var p=$.test(k),q=l==="table"&&!p?o.firstChild&&o.firstChild.childNodes:m[1]==="<table>"&&!p?o.childNodes:[];for(i=q.length-1;i>=0;--i){f.nodeName(q[i],"tbody")&&!q[i].childNodes.length&&q[i].parentNode.removeChild(q[i])}}!f.support.leadingWhitespace&&X.test(k)&&o.insertBefore(b.createTextNode(X.exec(k)[0]),o.firstChild),k=o.childNodes}}var r;if(!f.support.appendChecked){if(k[0]&&typeof(r=k.length)=="number"){for(i=0;i<r;i++){bn(k[i])}}else{bn(k)}}k.nodeType?h.push(k):h=f.merge(h,k)}if(d){g=function(a){return !a.type||be.test(a.type)};for(j=0;h[j];j++){if(e&&f.nodeName(h[j],"script")&&(!h[j].type||h[j].type.toLowerCase()==="text/javascript")){e.push(h[j].parentNode?h[j].parentNode.removeChild(h[j]):h[j])}else{if(h[j].nodeType===1){var s=f.grep(h[j].getElementsByTagName("script"),g);h.splice.apply(h,[j+1,0].concat(s))}d.appendChild(h[j])}}}return h},cleanData:function(a){var b,c,d=f.cache,e=f.event.special,g=f.support.deleteExpando;for(var h=0,i;(i=a[h])!=null;h++){if(i.nodeName&&f.noData[i.nodeName.toLowerCase()]){continue}c=i[f.expando];if(c){b=d[c];if(b&&b.events){for(var j in b.events){e[j]?f.event.remove(i,j):f.removeEvent(i,j,b.handle)}b.handle&&(b.handle.elem=null)}g?delete i[f.expando]:i.removeAttribute&&i.removeAttribute(f.expando),delete d[c]}}}});var bq=/alpha\([^)]*\)/i,br=/opacity=([^)]*)/,bs=/([A-Z]|^ms)/g,bt=/^-?\d+(?:px)?$/i,bu=/^-?\d/,bv=/^([\-+])=([\-+.\de]+)/,bw={position:"absolute",visibility:"hidden",display:"block"},bx=["Left","Right"],by=["Top","Bottom"],bz,bA,bB;f.fn.css=function(a,c){if(arguments.length===2&&c===b){return this}return f.access(this,a,c,!0,function(a,c,d){return d!==b?f.style(a,c,d):f.css(a,c)})},f.extend({cssHooks:{opacity:{get:function(a,b){if(b){var c=bz(a,"opacity","opacity");return c===""?"1":c}return a.style.opacity}}},cssNumber:{fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":f.support.cssFloat?"cssFloat":"styleFloat"},style:function(a,c,d,e){if(!!a&&a.nodeType!==3&&a.nodeType!==8&&!!a.style){var g,h,i=f.camelCase(c),j=a.style,k=f.cssHooks[i];c=f.cssProps[i]||i;if(d===b){if(k&&"get" in k&&(g=k.get(a,!1,e))!==b){return g}return j[c]}h=typeof d,h==="string"&&(g=bv.exec(d))&&(d=+(g[1]+1)*+g[2]+parseFloat(f.css(a,c)),h="number");if(d==null||h==="number"&&isNaN(d)){return}h==="number"&&!f.cssNumber[i]&&(d+="px");if(!k||!("set" in k)||(d=k.set(a,d))!==b){try{j[c]=d}catch(l){}}}},css:function(a,c,d){var e,g;c=f.camelCase(c),g=f.cssHooks[c],c=f.cssProps[c]||c,c==="cssFloat"&&(c="float");if(g&&"get" in g&&(e=g.get(a,!0,d))!==b){return e}if(bz){return bz(a,c)}},swap:function(a,b,c){var d={};for(var e in b){d[e]=a.style[e],a.style[e]=b[e]}c.call(a);for(e in b){a.style[e]=d[e]}}}),f.curCSS=f.css,f.each(["height","width"],function(a,b){f.cssHooks[b]={get:function(a,c,d){var e;if(c){if(a.offsetWidth!==0){return bC(a,b,d)}f.swap(a,bw,function(){e=bC(a,b,d)});return e}},set:function(a,b){if(!bt.test(b)){return b}b=parseFloat(b);if(b>=0){return b+"px"}}}}),f.support.opacity||(f.cssHooks.opacity={get:function(a,b){return br.test((b&&a.currentStyle?a.currentStyle.filter:a.style.filter)||"")?parseFloat(RegExp.$1)/100+"":b?"1":""},set:function(a,b){var c=a.style,d=a.currentStyle,e=f.isNumeric(b)?"alpha(opacity="+b*100+")":"",g=d&&d.filter||c.filter||"";c.zoom=1;if(b>=1&&f.trim(g.replace(bq,""))===""){c.removeAttribute("filter");if(d&&!d.filter){return}}c.filter=bq.test(g)?g.replace(bq,e):g+" "+e}}),f(function(){f.support.reliableMarginRight||(f.cssHooks.marginRight={get:function(a,b){var c;f.swap(a,{display:"inline-block"},function(){b?c=bz(a,"margin-right","marginRight"):c=a.style.marginRight});return c}})}),c.defaultView&&c.defaultView.getComputedStyle&&(bA=function(a,b){var c,d,e;b=b.replace(bs,"-$1").toLowerCase(),(d=a.ownerDocument.defaultView)&&(e=d.getComputedStyle(a,null))&&(c=e.getPropertyValue(b),c===""&&!f.contains(a.ownerDocument.documentElement,a)&&(c=f.style(a,b)));return c}),c.documentElement.currentStyle&&(bB=function(a,b){var c,d,e,f=a.currentStyle&&a.currentStyle[b],g=a.style;f===null&&g&&(e=g[b])&&(f=e),!bt.test(f)&&bu.test(f)&&(c=g.left,d=a.runtimeStyle&&a.runtimeStyle.left,d&&(a.runtimeStyle.left=a.currentStyle.left),g.left=b==="fontSize"?"1em":f||0,f=g.pixelLeft+"px",g.left=c,d&&(a.runtimeStyle.left=d));return f===""?"auto":f}),bz=bA||bB,f.expr&&f.expr.filters&&(f.expr.filters.hidden=function(a){var b=a.offsetWidth,c=a.offsetHeight;return b===0&&c===0||!f.support.reliableHiddenOffsets&&(a.style&&a.style.display||f.css(a,"display"))==="none"},f.expr.filters.visible=function(a){return !f.expr.filters.hidden(a)});var bD=/%20/g,bE=/\[\]$/,bF=/\r?\n/g,bG=/#.*$/,bH=/^(.*?):[ \t]*([^\r\n]*)\r?$/mg,bI=/^(?:color|date|datetime|datetime-local|email|hidden|month|number|password|range|search|tel|text|time|url|week)$/i,bJ=/^(?:about|app|app\-storage|.+\-extension|file|res|widget):$/,bK=/^(?:GET|HEAD)$/,bL=/^\/\//,bM=/\?/,bN=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,bO=/^(?:select|textarea)/i,bP=/\s+/,bQ=/([?&])_=[^&]*/,bR=/^([\w\+\.\-]+:)(?:\/\/([^\/?#:]*)(?::(\d+))?)?/,bS=f.fn.load,bT={},bU={},bV,bW,bX=["*/"]+["*"];try{bV=e.href}catch(bY){bV=c.createElement("a"),bV.href="",bV=bV.href}bW=bR.exec(bV.toLowerCase())||[],f.fn.extend({load:function(a,c,d){if(typeof a!="string"&&bS){return bS.apply(this,arguments)}if(!this.length){return this}var e=a.indexOf(" ");if(e>=0){var g=a.slice(e,a.length);a=a.slice(0,e)}var h="GET";c&&(f.isFunction(c)?(d=c,c=b):typeof c=="object"&&(c=f.param(c,f.ajaxSettings.traditional),h="POST"));var i=this;f.ajax({url:a,type:h,dataType:"html",data:c,complete:function(a,b,c){c=a.responseText,a.isResolved()&&(a.done(function(a){c=a}),i.html(g?f("<div>").append(c.replace(bN,"")).find(g):c)),d&&i.each(d,[c,b,a])}});return this},serialize:function(){return f.param(this.serializeArray())},serializeArray:function(){return this.map(function(){return this.elements?f.makeArray(this.elements):this}).filter(function(){return this.name&&!this.disabled&&(this.checked||bO.test(this.nodeName)||bI.test(this.type))}).map(function(a,b){var c=f(this).val();return c==null?null:f.isArray(c)?f.map(c,function(a,c){return{name:b.name,value:a.replace(bF,"\r\n")}}):{name:b.name,value:c.replace(bF,"\r\n")}}).get()}}),f.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),function(a,b){f.fn[b]=function(a){return this.on(b,a)}}),f.each(["get","post"],function(a,c){f[c]=function(a,d,e,g){f.isFunction(d)&&(g=g||e,e=d,d=b);return f.ajax({type:c,url:a,data:d,success:e,dataType:g})}}),f.extend({getScript:function(a,c){return f.get(a,b,c,"script")},getJSON:function(a,b,c){return f.get(a,b,c,"json")},ajaxSetup:function(a,b){b?b_(a,f.ajaxSettings):(b=a,a=f.ajaxSettings),b_(a,b);return a},ajaxSettings:{url:bV,isLocal:bJ.test(bW[1]),global:!0,type:"GET",contentType:"application/x-www-form-urlencoded",processData:!0,async:!0,accepts:{xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript","*":bX},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText"},converters:{"* text":a.String,"text html":!0,"text json":f.parseJSON,"text xml":f.parseXML},flatOptions:{context:!0,url:!0}},ajaxPrefilter:bZ(bT),ajaxTransport:bZ(bU),ajax:function(a,c){function w(a,c,l,m){if(s!==2){s=2,q&&clearTimeout(q),p=b,n=m||"",v.readyState=a>0?4:0;var o,r,u,w=c,x=l?cb(d,v,l):b,y,z;if(a>=200&&a<300||a===304){if(d.ifModified){if(y=v.getResponseHeader("Last-Modified")){f.lastModified[k]=y}if(z=v.getResponseHeader("Etag")){f.etag[k]=z}}if(a===304){w="notmodified",o=!0}else{try{r=cc(d,x),w="success",o=!0}catch(A){w="parsererror",u=A}}}else{u=w;if(!w||a){w="error",a<0&&(a=0)}}v.status=a,v.statusText=""+(c||w),o?h.resolveWith(e,[r,w,v]):h.rejectWith(e,[v,w,u]),v.statusCode(j),j=b,t&&g.trigger("ajax"+(o?"Success":"Error"),[v,d,o?r:u]),i.fireWith(e,[v,w]),t&&(g.trigger("ajaxComplete",[v,d]),--f.active||f.event.trigger("ajaxStop"))}}typeof a=="object"&&(c=a,a=b),c=c||{};var d=f.ajaxSetup({},c),e=d.context||d,g=e!==d&&(e.nodeType||e instanceof f)?f(e):f.event,h=f.Deferred(),i=f.Callbacks("once memory"),j=d.statusCode||{},k,l={},m={},n,o,p,q,r,s=0,t,u,v={readyState:0,setRequestHeader:function(a,b){if(!s){var c=a.toLowerCase();a=m[c]=m[c]||a,l[a]=b}return this},getAllResponseHeaders:function(){return s===2?n:null},getResponseHeader:function(a){var c;if(s===2){if(!o){o={};while(c=bH.exec(n)){o[c[1].toLowerCase()]=c[2]}}c=o[a.toLowerCase()]}return c===b?null:c},overrideMimeType:function(a){s||(d.mimeType=a);return this},abort:function(a){a=a||"abort",p&&p.abort(a),w(0,a);return this}};h.promise(v),v.success=v.done,v.error=v.fail,v.complete=i.add,v.statusCode=function(a){if(a){var b;if(s<2){for(b in a){j[b]=[j[b],a[b]]}}else{b=a[v.status],v.then(b,b)}}return this},d.url=((a||d.url)+"").replace(bG,"").replace(bL,bW[1]+"//"),d.dataTypes=f.trim(d.dataType||"*").toLowerCase().split(bP),d.crossDomain==null&&(r=bR.exec(d.url.toLowerCase()),d.crossDomain=!(!r||r[1]==bW[1]&&r[2]==bW[2]&&(r[3]||(r[1]==="http:"?80:443))==(bW[3]||(bW[1]==="http:"?80:443)))),d.data&&d.processData&&typeof d.data!="string"&&(d.data=f.param(d.data,d.traditional)),b$(bT,d,c,v);if(s===2){return !1}t=d.global,d.type=d.type.toUpperCase(),d.hasContent=!bK.test(d.type),t&&f.active++===0&&f.event.trigger("ajaxStart");if(!d.hasContent){d.data&&(d.url+=(bM.test(d.url)?"&":"?")+d.data,delete d.data),k=d.url;if(d.cache===!1){var x=f.now(),y=d.url.replace(bQ,"$1_="+x);d.url=y+(y===d.url?(bM.test(d.url)?"&":"?")+"_="+x:"")}}(d.data&&d.hasContent&&d.contentType!==!1||c.contentType)&&v.setRequestHeader("Content-Type",d.contentType),d.ifModified&&(k=k||d.url,f.lastModified[k]&&v.setRequestHeader("If-Modified-Since",f.lastModified[k]),f.etag[k]&&v.setRequestHeader("If-None-Match",f.etag[k])),v.setRequestHeader("Accept",d.dataTypes[0]&&d.accepts[d.dataTypes[0]]?d.accepts[d.dataTypes[0]]+(d.dataTypes[0]!=="*"?", "+bX+"; q=0.01":""):d.accepts["*"]);for(u in d.headers){v.setRequestHeader(u,d.headers[u])}if(d.beforeSend&&(d.beforeSend.call(e,v,d)===!1||s===2)){v.abort();return !1}for(u in {success:1,error:1,complete:1}){v[u](d[u])}p=b$(bU,d,c,v);if(!p){w(-1,"No Transport")}else{v.readyState=1,t&&g.trigger("ajaxSend",[v,d]),d.async&&d.timeout>0&&(q=setTimeout(function(){v.abort("timeout")},d.timeout));try{s=1,p.send(l,w)}catch(z){if(s<2){w(-1,z)}else{throw z}}}return v},param:function(a,c){var d=[],e=function(a,b){b=f.isFunction(b)?b():b,d[d.length]=encodeURIComponent(a)+"="+encodeURIComponent(b)};c===b&&(c=f.ajaxSettings.traditional);if(f.isArray(a)||a.jquery&&!f.isPlainObject(a)){f.each(a,function(){e(this.name,this.value)})}else{for(var g in a){ca(g,a[g],c,e)}}return d.join("&").replace(bD,"+")}}),f.extend({active:0,lastModified:{},etag:{}});var cd=f.now(),ce=/(\=)\?(&|$)|\?\?/i;f.ajaxSetup({jsonp:"callback",jsonpCallback:function(){return f.expando+"_"+cd++}}),f.ajaxPrefilter("json jsonp",function(b,c,d){var e=b.contentType==="application/x-www-form-urlencoded"&&typeof b.data=="string";if(b.dataTypes[0]==="jsonp"||b.jsonp!==!1&&(ce.test(b.url)||e&&ce.test(b.data))){var g,h=b.jsonpCallback=f.isFunction(b.jsonpCallback)?b.jsonpCallback():b.jsonpCallback,i=a[h],j=b.url,k=b.data,l="$1"+h+"$2";b.jsonp!==!1&&(j=j.replace(ce,l),b.url===j&&(e&&(k=k.replace(ce,l)),b.data===k&&(j+=(/\?/.test(j)?"&":"?")+b.jsonp+"="+h))),b.url=j,b.data=k,a[h]=function(a){g=[a]},d.always(function(){a[h]=i,g&&f.isFunction(i)&&a[h](g[0])}),b.converters["script json"]=function(){g||f.error(h+" was not called");return g[0]},b.dataTypes[0]="json";return"script"}}),f.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/javascript|ecmascript/},converters:{"text script":function(a){f.globalEval(a);return a}}}),f.ajaxPrefilter("script",function(a){a.cache===b&&(a.cache=!1),a.crossDomain&&(a.type="GET",a.global=!1)}),f.ajaxTransport("script",function(a){if(a.crossDomain){var d,e=c.head||c.getElementsByTagName("head")[0]||c.documentElement;return{send:function(f,g){d=c.createElement("script"),d.async="async",a.scriptCharset&&(d.charset=a.scriptCharset),d.src=a.url,d.onload=d.onreadystatechange=function(a,c){if(c||!d.readyState||/loaded|complete/.test(d.readyState)){d.onload=d.onreadystatechange=null,e&&d.parentNode&&e.removeChild(d),d=b,c||g(200,"success")}},e.insertBefore(d,e.firstChild)},abort:function(){d&&d.onload(0,1)}}}});var cf=a.ActiveXObject?function(){for(var a in ch){ch[a](0,1)}}:!1,cg=0,ch;f.ajaxSettings.xhr=a.ActiveXObject?function(){return !this.isLocal&&ci()||cj()}:ci,function(a){f.extend(f.support,{ajax:!!a,cors:!!a&&"withCredentials" in a})}(f.ajaxSettings.xhr()),f.support.ajax&&f.ajaxTransport(function(c){if(!c.crossDomain||f.support.cors){var d;return{send:function(e,g){var h=c.xhr(),i,j;c.username?h.open(c.type,c.url,c.async,c.username,c.password):h.open(c.type,c.url,c.async);if(c.xhrFields){for(j in c.xhrFields){h[j]=c.xhrFields[j]}}c.mimeType&&h.overrideMimeType&&h.overrideMimeType(c.mimeType),!c.crossDomain&&!e["X-Requested-With"]&&(e["X-Requested-With"]="XMLHttpRequest");try{for(j in e){h.setRequestHeader(j,e[j])}}catch(k){}h.send(c.hasContent&&c.data||null),d=function(a,e){var j,k,l,m,n;try{if(d&&(e||h.readyState===4)){d=b,i&&(h.onreadystatechange=f.noop,cf&&delete ch[i]);if(e){h.readyState!==4&&h.abort()}else{j=h.status,l=h.getAllResponseHeaders(),m={},n=h.responseXML,n&&n.documentElement&&(m.xml=n),m.text=h.responseText;try{k=h.statusText}catch(o){k=""}!j&&c.isLocal&&!c.crossDomain?j=m.text?200:404:j===1223&&(j=204)}}}catch(p){e||g(-1,p)}m&&g(j,k,m,l)},!c.async||h.readyState===4?d():(i=++cg,cf&&(ch||(ch={},f(a).unload(cf)),ch[i]=d),h.onreadystatechange=d)},abort:function(){d&&d(0,1)}}}});var ck={},cl,cm,cn=/^(?:toggle|show|hide)$/,co=/^([+\-]=)?([\d+.\-]+)([a-z%]*)$/i,cp,cq=[["height","marginTop","marginBottom","paddingTop","paddingBottom"],["width","marginLeft","marginRight","paddingLeft","paddingRight"],["opacity"]],cr;f.fn.extend({show:function(a,b,c){var d,e;if(a||a===0){return this.animate(cu("show",3),a,b,c)}for(var g=0,h=this.length;g<h;g++){d=this[g],d.style&&(e=d.style.display,!f._data(d,"olddisplay")&&e==="none"&&(e=d.style.display=""),e===""&&f.css(d,"display")==="none"&&f._data(d,"olddisplay",cv(d.nodeName)))}for(g=0;g<h;g++){d=this[g];if(d.style){e=d.style.display;if(e===""||e==="none"){d.style.display=f._data(d,"olddisplay")||""}}}return this},hide:function(a,b,c){if(a||a===0){return this.animate(cu("hide",3),a,b,c)}var d,e,g=0,h=this.length;for(;g<h;g++){d=this[g],d.style&&(e=f.css(d,"display"),e!=="none"&&!f._data(d,"olddisplay")&&f._data(d,"olddisplay",e))}for(g=0;g<h;g++){this[g].style&&(this[g].style.display="none")}return this},_toggle:f.fn.toggle,toggle:function(a,b,c){var d=typeof a=="boolean";f.isFunction(a)&&f.isFunction(b)?this._toggle.apply(this,arguments):a==null||d?this.each(function(){var b=d?a:f(this).is(":hidden");f(this)[b?"show":"hide"]()}):this.animate(cu("toggle",3),a,b,c);return this},fadeTo:function(a,b,c,d){return this.filter(":hidden").css("opacity",0).show().end().animate({opacity:b},a,c,d)},animate:function(a,b,c,d){function g(){e.queue===!1&&f._mark(this);var b=f.extend({},e),c=this.nodeType===1,d=c&&f(this).is(":hidden"),g,h,i,j,k,l,m,n,o;b.animatedProperties={};for(i in a){g=f.camelCase(i),i!==g&&(a[g]=a[i],delete a[i]),h=a[g],f.isArray(h)?(b.animatedProperties[g]=h[1],h=a[g]=h[0]):b.animatedProperties[g]=b.specialEasing&&b.specialEasing[g]||b.easing||"swing";if(h==="hide"&&d||h==="show"&&!d){return b.complete.call(this)}c&&(g==="height"||g==="width")&&(b.overflow=[this.style.overflow,this.style.overflowX,this.style.overflowY],f.css(this,"display")==="inline"&&f.css(this,"float")==="none"&&(!f.support.inlineBlockNeedsLayout||cv(this.nodeName)==="inline"?this.style.display="inline-block":this.style.zoom=1))}b.overflow!=null&&(this.style.overflow="hidden");for(i in a){j=new f.fx(this,b,i),h=a[i],cn.test(h)?(o=f._data(this,"toggle"+i)||(h==="toggle"?d?"show":"hide":0),o?(f._data(this,"toggle"+i,o==="show"?"hide":"show"),j[o]()):j[h]()):(k=co.exec(h),l=j.cur(),k?(m=parseFloat(k[2]),n=k[3]||(f.cssNumber[i]?"":"px"),n!=="px"&&(f.style(this,i,(m||1)+n),l=(m||1)/j.cur()*l,f.style(this,i,l+n)),k[1]&&(m=(k[1]==="-="?-1:1)*m+l),j.custom(l,m,n)):j.custom(l,h,""))}return !0}var e=f.speed(b,c,d);if(f.isEmptyObject(a)){return this.each(e.complete,[!1])}a=f.extend({},a);return e.queue===!1?this.each(g):this.queue(e.queue,g)},stop:function(a,c,d){typeof a!="string"&&(d=c,c=a,a=b),c&&a!==!1&&this.queue(a||"fx",[]);return this.each(function(){function h(a,b,c){var e=b[c];f.removeData(a,c,!0),e.stop(d)}var b,c=!1,e=f.timers,g=f._data(this);d||f._unmark(!0,this);if(a==null){for(b in g){g[b]&&g[b].stop&&b.indexOf(".run")===b.length-4&&h(this,g,b)}}else{g[b=a+".run"]&&g[b].stop&&h(this,g,b)}for(b=e.length;b--;){e[b].elem===this&&(a==null||e[b].queue===a)&&(d?e[b](!0):e[b].saveState(),c=!0,e.splice(b,1))}(!d||!c)&&f.dequeue(this,a)})}}),f.each({slideDown:cu("show",1),slideUp:cu("hide",1),slideToggle:cu("toggle",1),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(a,b){f.fn[a]=function(a,c,d){return this.animate(b,a,c,d)}}),f.extend({speed:function(a,b,c){var d=a&&typeof a=="object"?f.extend({},a):{complete:c||!c&&b||f.isFunction(a)&&a,duration:a,easing:c&&b||b&&!f.isFunction(b)&&b};d.duration=f.fx.off?0:typeof d.duration=="number"?d.duration:d.duration in f.fx.speeds?f.fx.speeds[d.duration]:f.fx.speeds._default;if(d.queue==null||d.queue===!0){d.queue="fx"}d.old=d.complete,d.complete=function(a){f.isFunction(d.old)&&d.old.call(this),d.queue?f.dequeue(this,d.queue):a!==!1&&f._unmark(this)};return d},easing:{linear:function(a,b,c,d){return c+d*a},swing:function(a,b,c,d){return(-Math.cos(a*Math.PI)/2+0.5)*d+c}},timers:[],fx:function(a,b,c){this.options=b,this.elem=a,this.prop=c,b.orig=b.orig||{}}}),f.fx.prototype={update:function(){this.options.step&&this.options.step.call(this.elem,this.now,this),(f.fx.step[this.prop]||f.fx.step._default)(this)},cur:function(){if(this.elem[this.prop]!=null&&(!this.elem.style||this.elem.style[this.prop]==null)){return this.elem[this.prop]}var a,b=f.css(this.elem,this.prop);return isNaN(a=parseFloat(b))?!b||b==="auto"?0:b:a},custom:function(a,c,d){function h(a){return e.step(a)}var e=this,g=f.fx;this.startTime=cr||cs(),this.end=c,this.now=this.start=a,this.pos=this.state=0,this.unit=d||this.unit||(f.cssNumber[this.prop]?"":"px"),h.queue=this.options.queue,h.elem=this.elem,h.saveState=function(){e.options.hide&&f._data(e.elem,"fxshow"+e.prop)===b&&f._data(e.elem,"fxshow"+e.prop,e.start)},h()&&f.timers.push(h)&&!cp&&(cp=setInterval(g.tick,g.interval))},show:function(){var a=f._data(this.elem,"fxshow"+this.prop);this.options.orig[this.prop]=a||f.style(this.elem,this.prop),this.options.show=!0,a!==b?this.custom(this.cur(),a):this.custom(this.prop==="width"||this.prop==="height"?1:0,this.cur()),f(this.elem).show()},hide:function(){this.options.orig[this.prop]=f._data(this.elem,"fxshow"+this.prop)||f.style(this.elem,this.prop),this.options.hide=!0,this.custom(this.cur(),0)},step:function(a){var b,c,d,e=cr||cs(),g=!0,h=this.elem,i=this.options;if(a||e>=i.duration+this.startTime){this.now=this.end,this.pos=this.state=1,this.update(),i.animatedProperties[this.prop]=!0;for(b in i.animatedProperties){i.animatedProperties[b]!==!0&&(g=!1)}if(g){i.overflow!=null&&!f.support.shrinkWrapBlocks&&f.each(["","X","Y"],function(a,b){h.style["overflow"+b]=i.overflow[a]}),i.hide&&f(h).hide();if(i.hide||i.show){for(b in i.animatedProperties){f.style(h,b,i.orig[b]),f.removeData(h,"fxshow"+b,!0),f.removeData(h,"toggle"+b,!0)}}d=i.complete,d&&(i.complete=!1,d.call(h))}return !1}i.duration==Infinity?this.now=e:(c=e-this.startTime,this.state=c/i.duration,this.pos=f.easing[i.animatedProperties[this.prop]](this.state,c,0,1,i.duration),this.now=this.start+(this.end-this.start)*this.pos),this.update();return !0}},f.extend(f.fx,{tick:function(){var a,b=f.timers,c=0;for(;c<b.length;c++){a=b[c],!a()&&b[c]===a&&b.splice(c--,1)}b.length||f.fx.stop()},interval:13,stop:function(){clearInterval(cp),cp=null},speeds:{slow:600,fast:200,_default:400},step:{opacity:function(a){f.style(a.elem,"opacity",a.now)},_default:function(a){a.elem.style&&a.elem.style[a.prop]!=null?a.elem.style[a.prop]=a.now+a.unit:a.elem[a.prop]=a.now}}}),f.each(["width","height"],function(a,b){f.fx.step[b]=function(a){f.style(a.elem,b,Math.max(0,a.now)+a.unit)}}),f.expr&&f.expr.filters&&(f.expr.filters.animated=function(a){return f.grep(f.timers,function(b){return a===b.elem}).length});var cw=/^t(?:able|d|h)$/i,cx=/^(?:body|html)$/i;"getBoundingClientRect" in c.documentElement?f.fn.offset=function(a){var b=this[0],c;if(a){return this.each(function(b){f.offset.setOffset(this,a,b)})}if(!b||!b.ownerDocument){return null}if(b===b.ownerDocument.body){return f.offset.bodyOffset(b)}try{c=b.getBoundingClientRect()}catch(d){}var e=b.ownerDocument,g=e.documentElement;if(!c||!f.contains(g,b)){return c?{top:c.top,left:c.left}:{top:0,left:0}}var h=e.body,i=cy(e),j=g.clientTop||h.clientTop||0,k=g.clientLeft||h.clientLeft||0,l=i.pageYOffset||f.support.boxModel&&g.scrollTop||h.scrollTop,m=i.pageXOffset||f.support.boxModel&&g.scrollLeft||h.scrollLeft,n=c.top+l-j,o=c.left+m-k;return{top:n,left:o}}:f.fn.offset=function(a){var b=this[0];if(a){return this.each(function(b){f.offset.setOffset(this,a,b)})}if(!b||!b.ownerDocument){return null}if(b===b.ownerDocument.body){return f.offset.bodyOffset(b)}var c,d=b.offsetParent,e=b,g=b.ownerDocument,h=g.documentElement,i=g.body,j=g.defaultView,k=j?j.getComputedStyle(b,null):b.currentStyle,l=b.offsetTop,m=b.offsetLeft;while((b=b.parentNode)&&b!==i&&b!==h){if(f.support.fixedPosition&&k.position==="fixed"){break}c=j?j.getComputedStyle(b,null):b.currentStyle,l-=b.scrollTop,m-=b.scrollLeft,b===d&&(l+=b.offsetTop,m+=b.offsetLeft,f.support.doesNotAddBorder&&(!f.support.doesAddBorderForTableAndCells||!cw.test(b.nodeName))&&(l+=parseFloat(c.borderTopWidth)||0,m+=parseFloat(c.borderLeftWidth)||0),e=d,d=b.offsetParent),f.support.subtractsBorderForOverflowNotVisible&&c.overflow!=="visible"&&(l+=parseFloat(c.borderTopWidth)||0,m+=parseFloat(c.borderLeftWidth)||0),k=c}if(k.position==="relative"||k.position==="static"){l+=i.offsetTop,m+=i.offsetLeft}f.support.fixedPosition&&k.position==="fixed"&&(l+=Math.max(h.scrollTop,i.scrollTop),m+=Math.max(h.scrollLeft,i.scrollLeft));return{top:l,left:m}},f.offset={bodyOffset:function(a){var b=a.offsetTop,c=a.offsetLeft;f.support.doesNotIncludeMarginInBodyOffset&&(b+=parseFloat(f.css(a,"marginTop"))||0,c+=parseFloat(f.css(a,"marginLeft"))||0);return{top:b,left:c}},setOffset:function(a,b,c){var d=f.css(a,"position");d==="static"&&(a.style.position="relative");var e=f(a),g=e.offset(),h=f.css(a,"top"),i=f.css(a,"left"),j=(d==="absolute"||d==="fixed")&&f.inArray("auto",[h,i])>-1,k={},l={},m,n;j?(l=e.position(),m=l.top,n=l.left):(m=parseFloat(h)||0,n=parseFloat(i)||0),f.isFunction(b)&&(b=b.call(a,c,g)),b.top!=null&&(k.top=b.top-g.top+m),b.left!=null&&(k.left=b.left-g.left+n),"using" in b?b.using.call(a,k):e.css(k)}},f.fn.extend({position:function(){if(!this[0]){return null}var a=this[0],b=this.offsetParent(),c=this.offset(),d=cx.test(b[0].nodeName)?{top:0,left:0}:b.offset();c.top-=parseFloat(f.css(a,"marginTop"))||0,c.left-=parseFloat(f.css(a,"marginLeft"))||0,d.top+=parseFloat(f.css(b[0],"borderTopWidth"))||0,d.left+=parseFloat(f.css(b[0],"borderLeftWidth"))||0;return{top:c.top-d.top,left:c.left-d.left}},offsetParent:function(){return this.map(function(){var a=this.offsetParent||c.body;while(a&&!cx.test(a.nodeName)&&f.css(a,"position")==="static"){a=a.offsetParent}return a})}}),f.each(["Left","Top"],function(a,c){var d="scroll"+c;f.fn[d]=function(c){var e,g;if(c===b){e=this[0];if(!e){return null}g=cy(e);return g?"pageXOffset" in g?g[a?"pageYOffset":"pageXOffset"]:f.support.boxModel&&g.document.documentElement[d]||g.document.body[d]:e[d]}return this.each(function(){g=cy(this),g?g.scrollTo(a?f(g).scrollLeft():c,a?c:f(g).scrollTop()):this[d]=c})}}),f.each(["Height","Width"],function(a,c){var d=c.toLowerCase();f.fn["inner"+c]=function(){var a=this[0];return a?a.style?parseFloat(f.css(a,d,"padding")):this[d]():null},f.fn["outer"+c]=function(a){var b=this[0];return b?b.style?parseFloat(f.css(b,d,a?"margin":"border")):this[d]():null},f.fn[d]=function(a){var e=this[0];if(!e){return a==null?null:this}if(f.isFunction(a)){return this.each(function(b){var c=f(this);c[d](a.call(this,b,c[d]()))})}if(f.isWindow(e)){var g=e.document.documentElement["client"+c],h=e.document.body;return e.document.compatMode==="CSS1Compat"&&g||h&&h["client"+c]||g}if(e.nodeType===9){return Math.max(e.documentElement["client"+c],e.body["scroll"+c],e.documentElement["scroll"+c],e.body["offset"+c],e.documentElement["offset"+c])}if(a===b){var i=f.css(e,d),j=parseFloat(i);return f.isNumeric(j)?j:i}return this.css(d,typeof a=="string"?a:a+"px")}}),a.jQuery=a.$=f,typeof define=="function"&&define.amd&&define.amd.jQuery&&define("jquery",[],function(){return f})})(window);jQuery.easing.jswing=jQuery.easing.swing;jQuery.extend(jQuery.easing,{def:"easeOutQuad",swing:function(f,g,e,j,h){return jQuery.easing[jQuery.easing.def](f,g,e,j,h)},easeInQuad:function(f,g,e,j,h){return j*(g/=h)*g+e},easeOutQuad:function(f,g,e,j,h){return -j*(g/=h)*(g-2)+e},easeInOutQuad:function(f,g,e,j,h){if((g/=h/2)<1){return j/2*g*g+e}return -j/2*((--g)*(g-2)-1)+e},easeInCubic:function(f,g,e,j,h){return j*(g/=h)*g*g+e},easeOutCubic:function(f,g,e,j,h){return j*((g=g/h-1)*g*g+1)+e},easeInOutCubic:function(f,g,e,j,h){if((g/=h/2)<1){return j/2*g*g*g+e}return j/2*((g-=2)*g*g+2)+e},easeInQuart:function(f,g,e,j,h){return j*(g/=h)*g*g*g+e},easeOutQuart:function(f,g,e,j,h){return -j*((g=g/h-1)*g*g*g-1)+e},easeInOutQuart:function(f,g,e,j,h){if((g/=h/2)<1){return j/2*g*g*g*g+e}return -j/2*((g-=2)*g*g*g-2)+e},easeInQuint:function(f,g,e,j,h){return j*(g/=h)*g*g*g*g+e},easeOutQuint:function(f,g,e,j,h){return j*((g=g/h-1)*g*g*g*g+1)+e},easeInOutQuint:function(f,g,e,j,h){if((g/=h/2)<1){return j/2*g*g*g*g*g+e}return j/2*((g-=2)*g*g*g*g+2)+e},easeInSine:function(f,g,e,j,h){return -j*Math.cos(g/h*(Math.PI/2))+j+e},easeOutSine:function(f,g,e,j,h){return j*Math.sin(g/h*(Math.PI/2))+e},easeInOutSine:function(f,g,e,j,h){return -j/2*(Math.cos(Math.PI*g/h)-1)+e},easeInExpo:function(f,g,e,j,h){return(g==0)?e:j*Math.pow(2,10*(g/h-1))+e},easeOutExpo:function(f,g,e,j,h){return(g==h)?e+j:j*(-Math.pow(2,-10*g/h)+1)+e},easeInOutExpo:function(f,g,e,j,h){if(g==0){return e}if(g==h){return e+j}if((g/=h/2)<1){return j/2*Math.pow(2,10*(g-1))+e}return j/2*(-Math.pow(2,-10*--g)+2)+e},easeInCirc:function(f,g,e,j,h){return -j*(Math.sqrt(1-(g/=h)*g)-1)+e},easeOutCirc:function(f,g,e,j,h){return j*Math.sqrt(1-(g=g/h-1)*g)+e},easeInOutCirc:function(f,g,e,j,h){if((g/=h/2)<1){return -j/2*(Math.sqrt(1-g*g)-1)+e}return j/2*(Math.sqrt(1-(g-=2)*g)+1)+e},easeInElastic:function(f,h,e,n,m){var j=1.70158;var k=0;var g=n;if(h==0){return e}if((h/=m)==1){return e+n}if(!k){k=m*0.3}if(g<Math.abs(n)){g=n;var j=k/4}else{var j=k/(2*Math.PI)*Math.asin(n/g)}return -(g*Math.pow(2,10*(h-=1))*Math.sin((h*m-j)*(2*Math.PI)/k))+e},easeOutElastic:function(f,h,e,n,m){var j=1.70158;var k=0;var g=n;if(h==0){return e}if((h/=m)==1){return e+n}if(!k){k=m*0.3}if(g<Math.abs(n)){g=n;var j=k/4}else{var j=k/(2*Math.PI)*Math.asin(n/g)}return g*Math.pow(2,-10*h)*Math.sin((h*m-j)*(2*Math.PI)/k)+n+e},easeInOutElastic:function(f,h,e,n,m){var j=1.70158;var k=0;var g=n;if(h==0){return e}if((h/=m/2)==2){return e+n}if(!k){k=m*(0.3*1.5)}if(g<Math.abs(n)){g=n;var j=k/4}else{var j=k/(2*Math.PI)*Math.asin(n/g)}if(h<1){return -0.5*(g*Math.pow(2,10*(h-=1))*Math.sin((h*m-j)*(2*Math.PI)/k))+e}return g*Math.pow(2,-10*(h-=1))*Math.sin((h*m-j)*(2*Math.PI)/k)*0.5+n+e},easeInBack:function(f,g,e,k,j,h){if(h==undefined){h=1.70158}return k*(g/=j)*g*((h+1)*g-h)+e},easeOutBack:function(f,g,e,k,j,h){if(h==undefined){h=1.70158}return k*((g=g/j-1)*g*((h+1)*g+h)+1)+e},easeInOutBack:function(f,g,e,k,j,h){if(h==undefined){h=1.70158}if((g/=j/2)<1){return k/2*(g*g*(((h*=(1.525))+1)*g-h))+e}return k/2*((g-=2)*g*(((h*=(1.525))+1)*g+h)+2)+e},easeInBounce:function(f,g,e,j,h){return j-jQuery.easing.easeOutBounce(f,h-g,0,j,h)+e},easeOutBounce:function(f,g,e,j,h){if((g/=h)<(1/2.75)){return j*(7.5625*g*g)+e}else{if(g<(2/2.75)){return j*(7.5625*(g-=(1.5/2.75))*g+0.75)+e}else{if(g<(2.5/2.75)){return j*(7.5625*(g-=(2.25/2.75))*g+0.9375)+e}else{return j*(7.5625*(g-=(2.625/2.75))*g+0.984375)+e}}}},easeInOutBounce:function(f,g,e,j,h){if(g<h/2){return jQuery.easing.easeInBounce(f,g*2,0,j,h)*0.5+e}return jQuery.easing.easeOutBounce(f,g*2-h,0,j,h)*0.5+j*0.5+e}});(function(g){var f={},j="doTimeout",h=Array.prototype.slice;g[j]=function(){return e.apply(window,[0].concat(h.call(arguments)))};g.fn[j]=function(){var b=h.call(arguments),c=e.apply(this,[j+b[0]].concat(b));return typeof b[0]==="number"||typeof b[1]==="number"?this:c};function e(v){var u=this,z,w={},A=v?g.fn:g,t=arguments,y=4,B=t[1],x=t[2],b=t[3];if(typeof B!=="string"){y--;B=v=0;x=t[1];b=t[2]}if(v){z=u.eq(0);z.data(v,w=z.data(v)||{})}else{if(B){w=f[B]||(f[B]={})}}w.id&&clearTimeout(w.id);delete w.id;function C(){if(v){z.removeData(v)}else{if(B){delete f[B]}}}function c(){w.id=setTimeout(function(){w.fn()},x)}if(b){w.fn=function(k){if(typeof b==="string"){b=A[b]}b.apply(u,h.call(t,y))===true&&!k?c():C()};c()}else{if(w.fn){x===undefined?C():w.fn(x===false);return true}else{C()}}}})(jQuery);(function(b){b.address=function(){var aI=function(g){b(b.address).trigger(b.extend(b.Event(g),function(){for(var h={},m=b.address.parameterNames(),j=0,k=m.length;j<k;j++){h[m[j]]=b.address.parameter(m[j])}return{value:b.address.value(),path:b.address.path(),pathNames:b.address.pathNames(),parameterNames:m,parameters:h,queryString:b.address.queryString()}}.call(b.address)))},aH=function(){b().bind.apply(b(b.address),Array.prototype.slice.call(arguments));return b.address},aM=function(){return ai.pushState&&aW.state!==aS},aL=function(){return("/"+aV.pathname.replace(new RegExp(aW.state),"")+aV.search+(aq()?"#"+aq():"")).replace(ac,"/")},aq=function(){var g=aV.href.indexOf("#");return g!=-1?at(aV.href.substr(g+1),aR):""},aJ=function(){return aM()?aL():aq()},e=function(){return"javascript"},ah=function(g){g=g.toString();return(aW.strict&&g.substr(0,1)!="/"?"/":"")+g},at=function(h,g){if(aW.crawlable&&g){return(h!==""?"!":"")+h}return h.replace(/^\!/,"")},aG=function(h,g){return parseInt(h.css(g),10)},ab=function(h){for(var g,n,k=0,m=h.childNodes.length;k<m;k++){try{if("src" in h.childNodes[k]&&h.childNodes[k].src){g=String(h.childNodes[k].src)}}catch(j){}if(n=ab(h.childNodes[k])){g=n}}return g},ao=function(){if(!ak){var g=aJ();if(aU!=g){if(aE&&aN<7){aV.reload()}else{aE&&aN<8&&aW.history&&aK(ag,50);aU=g;ap(aR)}}}},ap=function(g){aI(T);aI(g?J:A);aK(f,10)},f=function(){if(aW.tracker!=="null"&&aW.tracker!==null){var h=b.isFunction(aW.tracker)?aW.tracker:aT[aW.tracker],g=(aV.pathname+aV.search+(b.address&&!aM()?b.address.value():"")).replace(/\/\//,"/").replace(/^\/$/,"");if(b.isFunction(h)){h(g)}else{if(b.isFunction(aT.urchinTracker)){aT.urchinTracker(g)}else{if(aT.pageTracker!==aS&&b.isFunction(aT.pageTracker._trackPageview)){aT.pageTracker._trackPageview(g)}else{aT._gaq!==aS&&b.isFunction(aT._gaq.push)&&aT._gaq.push(["_trackPageview",decodeURI(g)])}}}}},ag=function(){var g=e()+":"+aR+";document.open();document.writeln('<html><head><title>"+aP.title.replace("'","\\'")+"</title><script>var "+ar+' = "'+encodeURIComponent(aJ())+(aP.domain!=aV.hostname?'";document.domain="'+aP.domain:"")+"\";<\/script></head></html>');document.close();";if(aN<7){aQ.src=g}else{aQ.contentWindow.location.replace(g)}},au=function(){if(an&&az!=-1){var h,g=an.substr(az+1).split("&");for(i=0;i<g.length;i++){h=g[i].split("=");if(/^(autoUpdate|crawlable|history|strict|wrap)$/.test(h[0])){aW[h[0]]=isNaN(h[1])?/^(true|yes)$/i.test(h[1]):parseInt(h[1],10)!==0}if(/^(state|tracker)$/.test(h[0])){aW[h[0]]=h[1]}}an=null}aU=aJ()},aA=function(){if(!aX){aX=aO;au();var h=function(){aC.call(this);ax.call(this)},g=b("body").ajaxComplete(h);h();if(aW.wrap){b("body > *").wrapAll('<div style="padding:'+(aG(g,"marginTop")+aG(g,"paddingTop"))+"px "+(aG(g,"marginRight")+aG(g,"paddingRight"))+"px "+(aG(g,"marginBottom")+aG(g,"paddingBottom"))+"px "+(aG(g,"marginLeft")+aG(g,"paddingLeft"))+'px;" />').parent().wrap('<div id="'+ar+'" style="height:100%;overflow:auto;position:relative;'+(am&&!window.statusbar.visible?"resize:both;":"")+'" />');b("html, body").css({height:"100%",margin:0,padding:0,overflow:"hidden"});am&&b('<style type="text/css" />').appendTo("head").text("#"+ar+"::-webkit-resizer { background-color: #fff; }")}if(aE&&aN<8){h=aP.getElementsByTagName("frameset")[0];aQ=aP.createElement((h?"":"i")+"frame");if(h){h.insertAdjacentElement("beforeEnd",aQ);h[h.cols?"cols":"rows"]+=",0";aQ.noResize=aO;aQ.frameBorder=aQ.frameSpacing=0}else{aQ.style.display="none";aQ.style.width=aQ.style.height=0;aQ.tabIndex=-1;aP.body.insertAdjacentElement("afterBegin",aQ)}aK(function(){b(aQ).bind("load",function(){var j=aQ.contentWindow;aU=j[ar]!==aS?j[ar]:"";if(aU!=aJ()){ap(aR);aV.hash=at(aU,aO)}});aQ.contentWindow[ar]===aS&&ag()},50)}aK(function(){aI("init");ap(aR)},1);if(!aM()){if(aE&&aN>7||!aE&&"on"+al in aT){if(aT.addEventListener){aT.addEventListener(al,ao,aR)}else{aT.attachEvent&&aT.attachEvent("on"+al,ao)}}else{p(ao,50)}}}},aC=function(){var h,g=b("a"),m=g.size(),j=-1,k=function(){if(++j!=m){h=b(g.get(j));h.is('[rel*="address:"]')&&h.address();aK(k,1)}};aK(k,1)},aF=function(){if(aU!=aJ()){aU=aJ();ap(aR)}},ay=function(){if(aT.removeEventListener){aT.removeEventListener(al,ao,aR)}else{aT.detachEvent&&aT.detachEvent("on"+al,ao)}},ax=function(){if(aW.crawlable){var g=aV.pathname.replace(/\/$/,"");b("body").html().indexOf("_escaped_fragment_")!=-1&&b('a[href]:not([href^=http]), a[href*="'+document.domain+'"]').each(function(){var h=b(this).attr("href").replace(/^http:/,"").replace(new RegExp(g+"/?$"),"");if(h===""||h.indexOf("_escaped_fragment_")!=-1){b(this).attr("href","#"+h.replace(/\/(.*)\?_escaped_fragment_=(.*)$/,"!$2"))}})}},aS,ar="jQueryAddress",al="hashchange",T="change",J="internalChange",A="externalChange",aO=true,aR=false,aW={autoUpdate:aO,crawlable:aR,history:aO,strict:aO,wrap:aR},aD=b.browser,aN=parseFloat(b.browser.version),av=aD.mozilla,aE=aD.msie,c=aD.opera,am=aD.webkit||aD.safari,af=aR,aT=function(){try{return top.document!==aS?top:window}catch(g){return window}}(),aP=aT.document,ai=aT.history,aV=aT.location,p=setInterval,aK=setTimeout,ac=/\/{2,9}/g;aD=navigator.userAgent;var aQ,an=ab(document),az=an?an.indexOf("?"):-1,ae=aP.title,ak=aR,aX=aR,ad=aO,aB=aO,aj=aR,aU=aJ();if(aE){aN=parseFloat(aD.substr(aD.indexOf("MSIE")+4));if(aP.documentMode&&aP.documentMode!=aN){aN=aP.documentMode!=8?7:8}var aw=aP.onpropertychange;aP.onpropertychange=function(){aw&&aw.call(aP);if(aP.title!=ae&&aP.title.indexOf("#"+aJ())!=-1){aP.title=ae}}}if(af=av&&aN>=1||aE&&aN>=6||c&&aN>=9.5||am&&aN>=523){if(c){history.navigationMode="compatible"}if(document.readyState=="complete"){var S=setInterval(function(){if(b.address){aA();clearInterval(S)}},50)}else{au();b(aA)}b(window).bind("popstate",aF).bind("unload",ay)}else{!af&&aq()!==""?aV.replace(aV.href.substr(0,aV.href.indexOf("#"))):f()}return{bind:function(h,g,j){return aH(h,g,j)},init:function(g){return aH("init",g)},change:function(g){return aH(T,g)},internalChange:function(g){return aH(J,g)},externalChange:function(g){return aH(A,g)},baseURL:function(){var g=aV.href;if(g.indexOf("#")!=-1){g=g.substr(0,g.indexOf("#"))}if(/\/$/.test(g)){g=g.substr(0,g.length-1)}return g},autoUpdate:function(g){if(g!==aS){aW.autoUpdate=g;return this}return aW.autoUpdate},crawlable:function(g){if(g!==aS){aW.crawlable=g;return this}return aW.crawlable},history:function(g){if(g!==aS){aW.history=g;return this}return aW.history},state:function(h){if(h!==aS){aW.state=h;var g=aL();if(aW.state!==aS){if(ai.pushState){g.substr(0,3)=="/#/"&&aV.replace(aW.state.replace(/^\/$/,"")+g.substr(2))}else{g!="/"&&g.replace(/^\/#/,"")!=aq()&&aK(function(){aV.replace(aW.state.replace(/^\/$/,"")+"/#"+g)},1)}}return this}return aW.state},strict:function(g){if(g!==aS){aW.strict=g;return this}return aW.strict},tracker:function(g){if(g!==aS){aW.tracker=g;return this}return aW.tracker},wrap:function(g){if(g!==aS){aW.wrap=g;return this}return aW.wrap},update:function(){aj=aO;this.value(aU);aj=aR;return this},title:function(g){if(g!==aS){aK(function(){ae=aP.title=g;if(aB&&aQ&&aQ.contentWindow&&aQ.contentWindow.document){aQ.contentWindow.document.title=g;aB=aR}if(!ad&&av){aV.replace(aV.href.indexOf("#")!=-1?aV.href:aV.href+"#")}ad=aR},50);return this}return aP.title},value:function(g){if(g!==aS){g=ah(g);if(g=="/"){g=""}if(aU==g&&!aj){return}ad=aO;aU=g;if(aW.autoUpdate||aj){ap(aO);if(aM()){ai[aW.history?"pushState":"replaceState"]({},"",aW.state.replace(/\/$/,"")+(aU===""?"/":aU))}else{ak=aO;if(am){if(aW.history){aV.hash="#"+at(aU,aO)}else{aV.replace("#"+at(aU,aO))}}else{if(aU!=aJ()){if(aW.history){aV.hash="#"+at(aU,aO)}else{aV.replace("#"+at(aU,aO))}}}aE&&aN<8&&aW.history&&aK(ag,50);if(am){aK(function(){ak=aR},1)}else{ak=aR}}}return this}if(!af){return null}return ah(aU)},path:function(h){if(h!==aS){var g=this.queryString(),j=this.hash();this.value(h+(g?"?"+g:"")+(j?"#"+j:""));return this}return ah(aU).split("#")[0].split("?")[0]},pathNames:function(){var h=this.path(),g=h.replace(ac,"/").split("/");if(h.substr(0,1)=="/"||h.length===0){g.splice(0,1)}h.substr(h.length-1,1)=="/"&&g.splice(g.length-1,1);return g},queryString:function(h){if(h!==aS){var g=this.hash();this.value(this.path()+(h?"?"+h:"")+(g?"#"+g:""));return this}h=aU.split("?");return h.slice(1,h.length).join("?").split("#")[0]},parameter:function(u,o,n){var m,g;if(o!==aS){var t=this.parameterNames();g=[];o=o?o.toString():"";for(m=0;m<t.length;m++){var k=t[m],h=this.parameter(k);if(typeof h=="string"){h=[h]}if(k==u){h=o===null||o===""?[]:n?h.concat([o]):[o]}for(var j=0;j<h.length;j++){g.push(k+"="+h[j])}}b.inArray(u,t)==-1&&o!==null&&o!==""&&g.push(u+"="+o);this.queryString(g.join("&"));return this}if(o=this.queryString()){n=[];g=o.split("&");for(m=0;m<g.length;m++){o=g[m].split("=");o[0]==u&&n.push(o.slice(1).join("="))}if(n.length!==0){return n.length!=1?n:n[0]}}},parameterNames:function(){var h=this.queryString(),g=[];if(h&&h.indexOf("=")!=-1){h=h.split("&");for(var k=0;k<h.length;k++){var j=h[k].split("=")[0];b.inArray(j,g)==-1&&g.push(j)}}return g},hash:function(g){if(g!==aS){this.value(aU.split("#")[0]+(g?"#"+g:""));return this}g=aU.split("#");return g.slice(1,g.length).join("#")}}}();b.fn.address=function(e){if(!b(this).attr("address")){var c=function(g){if(g.shiftKey||g.ctrlKey||g.metaKey){return true}if(b(this).is("a")){var f=e?e.call(this):/address:/.test(b(this).attr("rel"))?b(this).attr("rel").split("address:")[1].split(" ")[0]:b.address.state()!==undefined&&b.address.state()!="/"?b(this).attr("href").replace(new RegExp("^(.*"+b.address.state()+"|\\.)"),""):b(this).attr("href").replace(/^(#\!?|\.)/,"");b.address.value(f);g.preventDefault()}};b(this).click(c).live("click",c).live("submit",function(g){if(b(this).is("form")){var f=b(this).attr("action");f=e?e.call(this):(f.indexOf("?")!=-1?f.replace(/&$/,""):f+"?")+b(this).serialize();b.address.value(f);g.preventDefault()}}).attr("address",true)}return this}})(jQuery);window.debug=(function(){var u=this,B=Array.prototype.slice,z=u.console,v={},x,w,n=9,A=["error","warn","info","debug","log"],o="assert clear count dir dirxml exception group groupCollapsed groupEnd profile profileEnd table time timeEnd trace".split(" "),t=o.length,C=[];while(--t>=0){(function(b){v[b]=function(){n!==0&&z&&z[b]&&z[b].apply(z,arguments)}})(o[t])}t=A.length;while(--t>=0){(function(c,b){v[b]=function(){var e=B.call(arguments),f=[b].concat(e);C.push(f);y(f);if(!z||!p(c)){return}z.firebug?z[b].apply(u,e):z[b]?z[b](e):z.log(e)}})(t,A[t])}function y(b){if(x&&(w||!z||!z.log)){x.apply(u,b)}}v.setLevel=function(b){n=typeof b==="number"?b:9};function p(b){return n>0?n>b:A.length+n<=b}v.setCallback=function(){var c=B.call(arguments),e=C.length,b=e;x=c.shift()||null;w=typeof c[0]==="boolean"?c.shift():false;b-=typeof c[0]==="number"?c.shift():e;while(b<e){y(C[b++])}};return v})();var MCBM=MCBM||{};MCBM.GA_ACCOUNT="UA-26457160-5";MCBM.PAGE_URI="/js/mc-bookmarklet.js";MCBM.PAGE_TITLE="Sony Xperia Minecraft Bookmarklet";MCBM.DEBUG=false;MCBM.fbShareURL={eng:"http://campaigns.sonymobile.com/minecraft/like_eng.html?2",esp:"http://campaigns.sonymobile.com/minecraft/like_esp.html"};MCBM.fbShareCopy={eng:"Play Minecraft™ Anywhere http://campaigns.sonymobile.com/minecraft Time to kill? Take it out on the web.",esp:"Juega Minecraft™ donde quiera sea http://campaigns.sonymobile.com/minecraft Si tienes tiempo de sobra, desquítate con el Internet."};MCBM.twShareURL={eng:"http://campaigns.sonymobile.com/minecraft/index.php?l=en",esp:"http://campaigns.sonymobile.com/minecraft/index.php?l=sp"};MCBM.twShareCopy={eng:"I just wreaked havoc with the the new Minecraft browser game from Sony Mobile.",esp:"Acabo de causar estragos con el nuevo juego de navegador Minecraft de Sony móvil."};if(typeof window.mcbmLang==="undefined"){MCBM.language="eng"}else{MCBM.language=window.mcbmLang}MCBM.shareFbURI="http://www.facebook.com/sharer.php?u="+encodeURIComponent(MCBM.fbShareURL[MCBM.language])+"&t="+encodeURIComponent(MCBM.fbShareCopy[MCBM.language]);MCBM.shareTwitterURI="http://twitter.com/home?status="+encodeURIComponent(MCBM.twShareCopy[MCBM.language])+" "+encodeURIComponent(MCBM.twShareURL[MCBM.language]);MCBM.initLocationURI=window.location;if(typeof window.mcbmRootURI==="undefined"){var href=window.location.href;MCBM.rootURI=href.substring(0,href.lastIndexOf("/"))}else{MCBM.rootURI=window.mcbmRootURI.substring(0,window.mcbmRootURI.lastIndexOf("/"))}MCBM.events={};MCBM.events.ITEM_LOADED="mcbmItemLoaded";MCBM.events.LOAD_ERROR="mcbmLoadError";MCBM.events.CREEPER_LOADED="creeperLoaded";MCBM.events.CREEPER_AUDIO_LOAD_COMPLETE="audioLoadComplete.creeper";MCBM.events.CREEPER_AUDIO_LOAD_ERROR="audioLoadError.creeper";MCBM.events.CREEPER_EXPLODED="creeperExploded";MCBM.events.EXPLOSION_COMPLETE="explosionComplete";MCBM.events.MINE_START="mine-start";MCBM.events.MINE_END="mine-end";MCBM.events.PICKAXE_AUDIO_LOAD_COMPLETE="audioLoadComplete.pickaxe";MCBM.events.PICKAXE_AUDIO_LOAD_ERROR="audioLoadError.pickaxe";MCBM.events.OPEN_UI="mcbmOpenUI";MCBM.events.OPEN_UI_COMPLETE="mcbmOpenUIComplete";MCBM.events.CLOSE_UI_COMPLETE="mcbmCloseUIComplete";MCBM.events.PLAY_CREEPER_CLICK="playCreeperClick";MCBM.events.PLAY_PICKAXE_CLICK="playPickaxeClick";MCBM.events.EXIT_CLICK="mcbmExitClick";MCBM.events.UI_MOUSE_MOVE="mcbmUIMouseMove";MCBM.LOAD_TIMEOUT=5000;MCBM.MAX_WIDTH=2000;MCBM.MAX_HEIGHT=1200;MCBM.webGLenabled=false;MCBM.errorDimensions={eng:{width:365,height:162},esp:{width:365,height:208}};MCBM.startTime=0;MCBM.trackDurations=[61,121,181,241];MCBM.curDurationIndex=0;MCBM.randomInRange=function(c,b){return c+(Math.random()*(b-c))};MCBM.randomFromArray=function(b){return b[Math.floor(Math.random()*b.length)]};MCBM.getDuration=function(){var b=new Date().getTime()-MCBM.startTime,f=Math.floor(b/1000),c=Math.floor(f/60),e=(c+1)+" min";return e};MCBM.getTrackDurationDelay=function(){var b=new Date().getTime()-MCBM.startTime,c=MCBM.trackDurations[MCBM.curDurationIndex]*1000-b;return c};MCBM.trackDurationCallback=function(){MCBM.gaTrackEvent("game","duration",MCBM.getDuration());MCBM.curDurationIndex++;if(MCBM.curDurationIndex<MCBM.trackDurations.length){setTimeout(MCBM.trackDurationCallback,MCBM.getTrackDurationDelay())}};MCBM.gaTrackPage=function(c){var b="&utmdt="+c+"&utmp="+MCBM.PAGE_URI;if(MCBM.DEBUG){debug.log("GA track page: "+c+" page uri: "+MCBM.PAGE_URI);return}MCBM.gaUrchinCall(b)};MCBM.gaTrackEvent=function(f,h,c,g){var j=(typeof c!=="undefined")?"*"+c:"",k=(typeof g!=="undefined")?"("+g+")":"",e="5("+f+"*"+h+j+")"+k,b="&utmdt="+MCBM.PAGE_TITLE+"&utmp="+MCBM.PAGE_URI+"&utmt=event&utme="+e;if(MCBM.DEBUG){debug.log("GA track event: category: "+f+" action: "+h+" label: "+c+" value: "+k);return}MCBM.gaUrchinCall(b)};MCBM.gaUrchinCall=function(c){var h=1000000000,n=MCBM.randomInRange(h,9999999999)|0,e=MCBM.randomInRange(10000000,99999999)|0,g=MCBM.randomInRange(h,2147483647)|0,m=(new Date()).getTime(),k=window.location,j=new Image(),f="http://www.google-analytics.com/__utm.gif?utmwv=5.2.0&utmn="+n+"&utmsr=-&utmsc=-&utmul=-&utmje=0&utmfl=-&utmhn="+MCBM.rootURI+"&utmr="+k+"{trackvars}&utmac="+MCBM.GA_ACCOUNT+"&utmcc=__utma%3D"+e+"."+g+"."+m+"."+m+"."+m+".2%3B%2B__utmb%3D"+e+"%3B%2B__utmc%3D"+e+"%3B%2B__utmz%3D"+e+"."+m+".2.2.utmccn%3D(referral)%7Cutmcsr%3D"+k.host+"%7Cutmcct%3D"+k.pathname+"%7Cutmcmd%3Dreferral%3B%2B__utmv%3D"+e+".-%3B",b=f.split("{trackvars}").join(c);j.src=b};(function(b){MCBM.init=function(){var j=b(window),h=b(document),f=b("body"),e="  body { position: relative; }  #mcbm-container {    position: absolute;    top: 0px;    left: 0px;    width: 100%;    height: 100%;    overflow: hidden;    z-index: 9999999!important;  }  #mcbm-bedrock {    position: absolute;    top: 0px;    left: 0px;    width: 100%;    height: 0px;    overflow: hidden;    background:url("+MCBM.rootURI+"/img/textures/minecraft/bedrock.png);    z-index: 9999998!important;  }  #mcbm-loading {    position: absolute;    top: 0px;    left: 0px;    width: 259px;    height: 36px;  }  #mcbm-error {    position: absolute;    top: 0px;    left: 0px;    width: "+MCBM.errorDimensions[MCBM.language].width+"px;    height: "+MCBM.errorDimensions[MCBM.language].height+"px;    opacity:0;  }  #mcbm-container img {    margin: 0;  }  .mcbm-hidden {    visibility:hidden;    display:none;  }";b("head").append("<style>"+e+"</style>");BrowserDetect.init();MCBM.$container=b('<div id="mcbm-container"></div>');MCBM.$loading=b('<div id="mcbm-loading"><img src="'+MCBM.rootURI+"/img/ui/loading-"+MCBM.language+'.gif" width="259" height="36"></div>');MCBM.$error=b('<div id="mcbm-error"><img src="'+MCBM.rootURI+"/img/ui/error-"+MCBM.language+'.gif"></div>');f.append(MCBM.$container);MCBM.$container.append(MCBM.$loading);MCBM.$loading.css({top:j.height()*0.5-18,left:j.width()*0.5-130});MCBM.$container.append(MCBM.$error);MCBM.$error.css({top:(j.height()-MCBM.errorDimensions[MCBM.language].height)*0.5,left:(j.width()-MCBM.errorDimensions[MCBM.language].width)*0.5});MCBM.$error.addClass("mcbm-hidden");MCBM.$container.addClass(MCBM.language);if(MCBM.$container.outerWidth()>MCBM.MAX_WIDTH){MCBM.$container.css({width:MCBM.MAX_WIDTH+"px",left:"50%","margin-left":Math.floor(-MCBM.MAX_WIDTH*0.5)+"px"})}var g=h.height();if((g<j.height())||(MCBM.$container.outerHeight()<j.height())){MCBM.$container.css("height",j.height()+"px")}else{if(g>MCBM.MAX_HEIGHT){var c=g-MCBM.MAX_HEIGHT;MCBM.$bedrock=b('<div id="mcbm-bedrock"></div>');MCBM.$bedrock.css({top:MCBM.MAX_HEIGHT,height:c});MCBM.$container.css("height",MCBM.MAX_HEIGHT+"px");f.append(MCBM.$bedrock)}}MCBM.gaTrackPage(MCBM.PAGE_TITLE);MCBM.startTime=new Date().getTime();setTimeout(MCBM.trackDurationCallback,MCBM.getTrackDurationDelay());MCBM.gaTrackEvent("game","duration",MCBM.getDuration())}})(jQuery);jQuery.noConflict();jQuery(function(b){if(typeof window.mcbmScriptURI==="undefined"){MCBM.init();if(typeof MCBM.main==="function"){MCBM.main()}else{}}});(function(b){MCBM.display=function(g,k){var j=b("body"),h=document.createElement("canvas"),f=h.getContext((k===true)?"experimental-webgl":"2d"),e=null;var c={};c.canvas=h;c.dirty=false;h.width=MCBM.$container.outerWidth();h.height=MCBM.$container.outerHeight();$displayCanvas=b(h);$displayCanvas.css({position:"absolute",top:"0px",left:"0px"});MCBM.$container.append($displayCanvas);if(g){c.stats=new Stats();e=b(c.stats.domElement);e.css({position:"absolute",top:"0px"});MCBM.$container.append(e)}c.getContext=function(){return f};c.getCanvas=function(){return h};c.getContainer=function(){return $container};c.clear=function(){f.clearRect(0,0,h.width,h.height);c.dirty=false};c.resize=function(m,n){h.width=m};return c}})(jQuery);MCBM.sprite=function(N,L,y,o,j,p){var m=N,f=L,t=y,H=o||1,F=H,D=null,I=(typeof p!=="undefined")?new THREE.Vector2(-p.x,-p.y):new THREE.Vector2(-f*0.5,-t*0.5),z=new THREE.Vector2(0,0),g=0,c=0,w=0,E=0,M=0,A=j,J,K=0,h=0,n=0,B=false,C=false,G=false,v=false,u=null;var e={};function x(){g=m.width/f;c=m.height/t;K=c*g;E=K;C=true}function k(O){if(M==O){return}M=O;if(M>E){if(B){M=w}else{M=E;G=false}}if(M<=w){if(B){M=E}else{M=1;G=false}}}function b(O){var R=(M-1)%g;var W=(M-1)/g|0;var V=f*F;var S=t*F;var Q=R*f;var P=W*t;var U=z.x+(I.x*F);var T=z.y+(I.y*F);if(D!=null){O.save();O.scale(D.x,D.y);if(D.x<0){U=D.x*(z.x-I.x)}if(D.y<0){T=D.y*(z.y-I.y)}}O.drawImage(e.getImage(),Q,P,f,t,U,T,V,S);if(D!=null){O.restore()}u=null}x();e.getImage=function(){return m};e.setScale=function(O){F=O};e.getBaseScale=function(){return H};e.setPosition=function(O){z=O};e.setDuration=function(O){n=O};e.setLooping=function(O){B=O};e.update=function(Q){if(!G){return}var O=Q-h;O=(B)?O%n:O;if(A==null){var P=((O/n)*K)|0;k(P+1)}else{var P=((O/n)*K)|0;k(w+P)}};e.draw=function(O){if(C){b(O)}else{u=O}};e.play=function(O){if(G){return}M=1;G=v=true;n=O;h=new Date().getTime()};e.stop=function(){G=false};e.getHasPlayed=function(){return v};e.getIsPlaying=function(){return G};e.setSequence=function(O){if(typeof A=="undefined"){return}var P=A[O];if(typeof P=="undefined"){return}J=P;D=null;w=J.frameBounds[0];E=J.frameBounds[1];K=E-w+1;if(J.flipHorizontal||J.flipVertical){D={x:(J.flipHorizontal)?-1:1,y:(J.flipVertical)?-1:1}}};return e};MCBM.particle=function(g,e){var c=g||new THREE.Vector3(0,0,0),f=e||new THREE.Vector3(0,0,0);var b={};b.update=function(){c.addSelf(f)};b.getPosition=function(){return c};b.setPosition=function(h){c.copy(h)};b.getVelocity=function(){return f};b.setVelocity=function(h){f.copy(h)};b.destroy=function(){c=null;f=null};return b};MCBM.voxelGrid=function(){var e=[],c={};var b={};function f(g){return g.x+","+g.y+","+g.z}b.addVoxel=function(j,h){var g=f(j);if(!b.hasPos(j)){e.push(g)}c[g]=h};b.getVoxelByPos=function(g){return c[f(g)]};b.hasPos=function(g){return(e.indexOf(f(g))==-1)?false:true};b.getSharedSidesForPos=function(h){var g={px:b.hasPos(new THREE.Vector3(h.x+1,h.y,h.z)),nx:b.hasPos(new THREE.Vector3(h.x-1,h.y,h.z)),py:b.hasPos(new THREE.Vector3(h.x,h.y+1,h.z)),ny:b.hasPos(new THREE.Vector3(h.x,h.y-1,h.z)),pz:b.hasPos(new THREE.Vector3(h.x,h.y,h.z+1)),nz:b.hasPos(new THREE.Vector3(h.x,h.y,h.z-1))};return g};return b};(function(b){MCBM.playfieldGrid=function(aa,g){var U=false;var X=b("body"),ay=aa,au=b(ay),H=ay.getContext("2d"),J,G,ad=ay.width,ap=ay.height;var T=ad/ap,ab=25,V,S,p,P,R,O,A;var ai=null,C=null,K=null,I=null,y=null,ao=null,at=null,E=null;var Q=null,m=null,f=null;var N,ak,L,o;var Z=g,B=Math.ceil(MCBM.MAX_WIDTH/Z),an=Math.ceil(MCBM.MAX_HEIGHT/Z),aw=0,aq=0,k=0,am=1000,av=7,t=null;var v={};v.isDirty=true;function al(){c();j();t=MCBM.voxelGrid();F();L=new THREE.Vector3(0,0,0)}function af(){S=new THREE.Scene();S.addObject(P);R=new THREE.Scene();O=new THREE.Mesh(new THREE.PlaneGeometry(aq,k,an,B),new THREE.MeshFaceMaterial());R.addObject(O);t=MCBM.voxelGrid(B,an,av);A.render(R,V);p.render(S,V)}function c(){J=document.createElement("canvas");V=new THREE.Camera(ab,T,1,10000);V.position.z=am;V.target.position.z=0;S=new THREE.Scene();p=(MCBM.webGLenabled)?new THREE.WebGLRenderer({canvas:J}):new THREE.CanvasRenderer({canvas:J});p.setSize(ad,ap);p.render(S,V);N=new THREE.Projector();ak=new THREE.Ray(V.position,null);var aC=new THREE.Vector3(1,0,0);aC=N.unprojectVector(aC.clone(),V);ak.direction=aC.subSelf(V.position).normalize();var az=ak.direction.x*(-ak.origin.z/ak.direction.z);var aD=new THREE.Vector3(-1,0,0);aD=N.unprojectVector(aD,V);ak.direction=aD.subSelf(V.position).normalize();var aB=ak.direction.x*(-ak.origin.z/ak.direction.z);var aE=az-aB;var aA=aE/ad;aw=Z*aA;aq=B*aw;k=an*aw;x()}function ax(){T=ad/ap;V.aspect=T;V.updateProjectionMatrix();p.setSize(ad,ap);p.render(S,V);ak=new THREE.Ray(V.position,null);var aC=new THREE.Vector3(1,0,0);aC=N.unprojectVector(aC.clone(),V);ak.direction=aC.subSelf(V.position).normalize();var az=ak.direction.x*(-ak.origin.z/ak.direction.z);var aD=new THREE.Vector3(-1,0,0);aD=N.unprojectVector(aD,V);ak.direction=aD.subSelf(V.position).normalize();var aB=ak.direction.x*(-ak.origin.z/ak.direction.z);var aE=az-aB;var aA=aE/ad;aw=Z*aA;aq=B*aw;k=an*aw;A.setSize(ad,ap);ag()}function x(){G=document.createElement("canvas");R=new THREE.Scene();O=new THREE.Mesh(new THREE.PlaneGeometry(aq,k,an,B),new THREE.MeshFaceMaterial());R.addObject(O);A=new THREE.CanvasRenderer({canvas:G});A.setSize(ad,ap)}function j(){ai=ah(MCBM.rootURI+"/img/textures/minecraft/grass_dirt.png"),C=ah(MCBM.rootURI+"/img/textures/minecraft/dirt.png");K=ah(MCBM.rootURI+"/img/textures/minecraft/stone.png");I=ah(MCBM.rootURI+"/img/textures/minecraft/gravel.png");y=ah(MCBM.rootURI+"/img/textures/minecraft/coal.png");ao=ah(MCBM.rootURI+"/img/textures/minecraft/iron.png");at=ah(MCBM.rootURI+"/img/textures/minecraft/gold.png");E=ah(MCBM.rootURI+"/img/textures/minecraft/lava.png");_bedrockTex=ah(MCBM.rootURI+"/img/textures/minecraft/bedrock.png");f=["gravel","stone","coal","iron","gold"];Q={grassDirt:ai,dirt:C,gravel:I,stone:K,coal:y,iron:ao,gold:at,lava:E,bedrock:_bedrockTex,};aj()}function ah(aB){var aA=new Image();var az=new THREE.Texture(aA,new THREE.UVMapping(),THREE.ClampToEdgeWrapping,THREE.ClampToEdgeWrapping,THREE.NearestFilter,THREE.NearestFilter);aA.onload=function(){az.needsUpdate=true};aA.crossOrigin="";aA.src=aB;return(MCBM.webGLenabled)?new THREE.MeshLambertMaterial({map:az}):new THREE.MeshBasicMaterial({map:az})}function aj(){var aC=0,aG=0,aB=0;m=[];for(aC=0;aC<=av;aC++){m[aC]=[];for(aG=0;aG<an;aG++){m[aC][aG]=[]}}aC=0;for(aG=0;aG<an;aG++){for(aB=0;aB<B;aB++){m[aC][aG][aB]="grassDirt"}}aC=1;for(aG=0;aG<an;aG++){for(aB=0;aB<B;aB++){m[aC][aG][aB]="dirt"}}for(aC=2;aC<av;aC++){for(aG=0;aG<an;aG++){for(aB=0;aB<B;aB++){m[aC][aG][aB]="stone"}}}var aE=0;rRow=0,rCol=0,aC=0;var aA=30;for(i=0;i<aA;i++){rRow=MCBM.randomInRange(0,an-aE)|0;rCol=MCBM.randomInRange(aE,B-aE)|0;aC=2;z("dirt",rRow,rCol,aC,MCBM.randomInRange(2,5)|0)}var aD=15;for(i=0;i<aD;i++){rRow=MCBM.randomInRange(aE,an-aE)|0;rCol=MCBM.randomInRange(aE,B-aE)|0;aC=2;z("coal",rRow,rCol,aC,MCBM.randomInRange(2,4)|0)}for(i=0;i<aD;i++){rRow=MCBM.randomInRange(aE,an-aE)|0;rCol=MCBM.randomInRange(aE,B-aE)|0;aC=3;z("coal",rRow,rCol,aC,MCBM.randomInRange(2,4)|0)}var aF=5;for(i=0;i<aF;i++){rRow=MCBM.randomInRange(aE,an-aE)|0;rCol=MCBM.randomInRange(aE,B-aE)|0;aC=3;z("iron",rRow,rCol,aC,MCBM.randomInRange(2,4)|0)}aF=7;for(i=0;i<aF;i++){rRow=MCBM.randomInRange(aE,an-aE)|0;rCol=MCBM.randomInRange(aE,B-aE)|0;aC=4;z("iron",rRow,rCol,aC,MCBM.randomInRange(2,4)|0)}var az=3;for(i=0;i<az;i++){rRow=MCBM.randomInRange(aE,an-aE)|0;rCol=MCBM.randomInRange(aE,B-aE)|0;aC=5;z("gold",rRow,rCol,aC,MCBM.randomInRange(1,3)|0)}var az=2;for(i=0;i<az;i++){rRow=MCBM.randomInRange(aE,an-aE)|0;rCol=MCBM.randomInRange(aE,B-aE)|0;aC=6;z("gold",rRow,rCol,aC,2|0)}}function z(aF,aE,az,aB,aD){var aC=(Math.random()>=0.5)?"x":"y";for(var aA=0;aA<=aD;aA++){if(aC=="x"){az++;if(az>=B){az=B-1}}else{aE++;if(aE>=an){aE=an-1}}m[aB][aE][az]=aF}}function w(aB){var aF=aB.x,aI=aB.y,aQ=aB.z;try{var aM=(aF<B-1)?aF+1:aF;var aH=(aF>0)?aF-1:aF;var aG=Q[m[aQ][aI][aM]];var aA=Q[m[aQ][aI][aH]];var aO=(aI<an-1)?aI+1:aI;var aL=(aI>0)?aI-1:aI;var aK=Q[m[aQ][aO][aF]];var aE=(aI>0)?Q[m[aQ][aL][aF]]:Q.bedrock;var az=(aQ>0)?aQ-1:aQ;var aC=(aQ<av-1)?aQ+1:aQ;var aN=Q[m[az][aI][aF]];var aJ=(aQ!=av-1)?Q[m[aC][aI][aF]]:Q.lava;var aD=[aG,aA,aK,aE,aN,aJ,];return aD}catch(aP){return undefined}}function F(){var az=new THREE.MeshLambertMaterial({color:65280,opacity:(U)?1:0,shading:THREE.FlatShading});az.wireframe=true;P=new THREE.Mesh(new THREE.PlaneGeometry(aq,k,B,an),az);P.name="refPlane";P.position.z=-1;S.addObject(P)}function ar(aA){var az=aA.x+aq*0.5;var aD=aA.y+k*0.5;var aB=(az/aw)|0;var aC=(aD/aw)|0;return new THREE.Vector3(aB,aC,0)}function D(aA){var az=aw*0.5+(aA.x*aw)-aq*0.5;var aC=aw*0.5+(aA.y*aw)-k*0.5;var aB=-aA.z*aw-aw*0.5;return new THREE.Vector3(az,aC,aB)}function W(az){return"voxel:"+az.x+","+az.y+","+az.z}function n(aE){var aG=D(aE);if(aE.z==0&&!t.hasPos(aE)){M(aG)}var aO=w(aE);var aH=t.getSharedSidesForPos(aE);var aD=h(aH);var az=u(aO,aD,aG);az.name=W(aE);S.addObject(az);t.addVoxel(aE,az);var aL=new THREE.Vector3();for(side in aH){if(aH[side]){aL.copy(aE);var aN=side.split("");var aF=(aN[0]=="p")?1:-1;var aB=aN[1];aL[aB]+=aF;var aK=w(aL);if(aK!==undefined){var aJ=h(t.getSharedSidesForPos(aL));var aA=false;for(side in aJ){aA=aJ[side];if(aA){break}}var aC=t.getVoxelByPos(aL);if(aC){var aM=new THREE.Vector3();aM.copy(aC.position);S.removeObject(aC)}var aI=(aA)?u(aK,aJ,aM):null;if(aI){aI.name=W(aL);S.addObject(aI)}t.addVoxel(aL,aI)}}}v.isDirty=true}function u(aA,aC,az){var aB=new THREE.Mesh(new THREE.CustomCubeGeometry(aw,aw,aw,1,1,1,aA,true,aC),new THREE.MeshFaceMaterial());aB.position.x=az.x;aB.position.y=az.y;aB.position.z=az.z;aB.name=name;aB.matrixAutoUpdate=false;aB.updateMatrix();aB.overdraw=true;return aB}function h(az){var aA={px:!az.px,nx:!az.nx,py:!az.py,ny:!az.ny,pz:!az.nz,nz:!az.pz};return aA}function M(az){var aA=new THREE.MeshLambertMaterial({color:16777215,opacity:1,shading:THREE.FlatShading});var aB=new THREE.Mesh(new THREE.PlaneGeometry(aw+1,aw+1,1,1),aA);aB.position.x=az.x;aB.position.y=az.y;aB.position.z=0;R.addObject(aB)}function ac(aM,aK){L.x=(aM/ad)*2-1;L.y=-(aK/ap)*2+1;o=N.unprojectVector(L.clone(),V);ak.direction=o.subSelf(V.position).normalize();var aH=ak.intersectScene(S);var aF=aH.length;if(aF>0){var aE=aH[0].face.centroid.clone();var aL=ar(aE);if(t.hasPos(aL)&&(aF>1)){var aG=aH[1].object;if(typeof aG.name!=="undefined"){var aB=aH[1].face.centroid.clone();var aN=aG.name.split(":")[1].split(",");var az=new THREE.Vector3(parseInt(aN[0],10),parseInt(aN[1],10),parseInt(aN[2],10))}else{debug.log("Error: unable to resolve intersectedVoxel name");debug.log(aG);return}aL.x=az.x;aL.y=az.y;aL.z=az.z;var aD=(aB.x!=0)?aB.x/Math.abs(aB.x):0;aL.x+=aD;var aC=(aB.y!=0)?aB.y/Math.abs(aB.y):0;aL.y+=aC;var aA=(aB.z!=0)?-aB.z/Math.abs(aB.z):0;aL.z+=aA}if(aL.z<av){var aJ=undefined;try{aJ=m[aL.z][aL.y][aL.x]}catch(aI){}if(aJ!==undefined){n(aL)}return aJ}else{return"lava"}}}function ae(aM){var aI=new THREE.Vector3(0,0,0);aI.x=(aM.x/ad)*2-1;aI.y=-(aM.y/ap)*2+1;var aB=N.unprojectVector(aI.clone(),V);ak.direction=aB.subSelf(V.position).normalize();var aJ=ak.intersectScene(S);var aC=aJ.length;if(aC>0){var aL=aJ[0].face.centroid.clone(),aG=ar(aL),aA=[],aF,aD,aK=0,az=0,aE=0;aK=(Math.random()>0.5)?3:2;az=(aK==3)?-1:(Math.random()>0.5)?-1:0;aF=aG.clone();aF.y+=2;aF.x+=az;for(aE=0;aE<aK;aE++){aD=aF.clone();aD.x+=aE;aA.push(aD.clone())}aK=MCBM.randomInRange(aK+1,5)|0;az=(aK==5)?-2:(Math.random()>0.5)?-2:-1;az=(aK==3)?-1:az;aF=aG.clone();aF.y+=1;aF.x+=az;for(aE=0;aE<aK;aE++){aD=aF.clone();aD.x+=aE;aA.push(aD.clone())}aK=5;az=-2;aF=aG.clone();aF.x+=az;for(aE=0;aE<aK;aE++){aD=aF.clone();aD.x+=aE;aA.push(aD.clone())}aK=MCBM.randomInRange(3,5)|0;az=(aK==5)?-2:(Math.random()>0.5)?-2:-1;az=(aK==3)?-1:az;aF=aG.clone();aF.y-=1;aF.x+=az;for(aE=0;aE<aK;aE++){aD=aF.clone();aD.x+=aE;aA.push(aD.clone())}aK=(aK==3)?2:(Math.random()>0.5)?3:2;az=(aK==3)?-1:(Math.random()>0.5)?-1:0;aF=aG.clone();aF.y-=2;aF.x+=az;for(aE=0;aE<aK;aE++){aD=aF.clone();aD.x+=aE;aA.push(aD.clone())}aK=3;aF=aG.clone();aF.y+=1;aF.x-=1;aF.z+=1;for(aE=0;aE<aK;aE++){aD=aF.clone();aD.x+=aE;aA.push(aD.clone())}aK=3;aF=aG.clone();aF.x-=1;aF.z+=1;for(aE=0;aE<aK;aE++){aD=aF.clone();aD.x+=aE;aA.push(aD.clone())}aK=3;aF=aG.clone();aF.y-=1;aF.x-=1;aF.z+=1;for(aE=0;aE<aK;aE++){aD=aF.clone();aD.x+=aE;aA.push(aD.clone())}aK=1;aF=aG.clone();aF.y+=1;aF.z+=2;for(aE=0;aE<aK;aE++){aD=aF.clone();aD.x+=aE;aA.push(aD.clone())}aK=3;aF=aG.clone();aF.x-=1;aF.z+=2;for(aE=0;aE<aK;aE++){aD=aF.clone();aD.x+=aE;aA.push(aD.clone())}aK=1;aF=aG.clone();aF.y-=1;aF.z+=2;for(aE=0;aE<aK;aE++){aD=aF.clone();aD.x+=aE;aA.push(aD.clone())}aF=aG.clone();aF.z+=3;aA.push(aF.clone());var aH=aA.length;for(var aE=0;aE<aH;aE++){n(aA[aE])}}}function Y(az){az.preventDefault();X.trigger(MCBM.events.MINE_END)}function ag(){A.render(R,V);p.render(S,V);H.clearRect(0,0,ad,ap);H.save();H.globalCompositeOperation="source-over";H.drawImage(G,0,0);H.globalCompositeOperation="source-in";H.drawImage(J,0,0);H.restore();v.isDirty=false}function e(){A.render(R,V);p.render(S,V);H.clearRect(0,0,ad,ap);H.save();H.drawImage(J,0,0);H.restore();v.isDirty=false}al();v.mineAtPosition=function(aA,az){return ac(aA,az)};v.render=function(){if(!U){ag()}else{e()}};v.resize=function(az){ad=az;ax()};v.reset=function(){af()};v.generateCreeperDamage=function(az){ae(az)};return v}})(jQuery);(function(b){MCBM.explosion=function(k,t){var x=b("body"),n=k,F=t,C=0,A=0,u=[],z=[],y=10,j=20,h=[],D=0,g={explosion:0.95,smoke:0.97},B=false,v=false,p=false,f=1000,e;var c={};c.isPlaying=v;function m(){var J=[MCBM.rootURI+"/img/sprites/explosion-light-gray.png",MCBM.rootURI+"/img/sprites/explosion-dark-gray.png"];var L=[MCBM.rootURI+"/img/sprites/smoke.png",MCBM.rootURI+"/img/sprites/smoke-dark-gray.png"];C=J.length+L.length;var I;for(I=0;I<J.length;I++){var H=J[I];var K=document.createElement("img");K.crossOrigin="";K.onload=E;K.src=H;u.push(K)}for(I=0;I<L.length;I++){var G=L[I];var M=document.createElement("img");M.crossOrigin="";M.onload=E;M.src=G;z.push(M)}}function o(){h=[];w()}function E(){A++;if(A==C){w()}}function w(){for(var I=0;I<y;I++){var K=MCBM.randomInRange(0.25,5);var H=MCBM.sprite(MCBM.randomFromArray(u),64,64,K);var M=new THREE.Vector3(MCBM.randomInRange(-80,80),MCBM.randomInRange(-80,80),0.5);var J=new THREE.Vector3(0,0,0);J.copy(M);J.setLength(MCBM.randomInRange(3,15));var L=MCBM.particle(M,J);var G={type:"explosion",sprite:H,particle:L,delay:MCBM.randomInRange(0,150),duration:MCBM.randomInRange(300,450),};h.push(G)}for(var I=0;I<j;I++){var K=MCBM.randomInRange(0.5,2);var H=MCBM.sprite(MCBM.randomFromArray(z),24,24,K);var M=new THREE.Vector3(MCBM.randomInRange(-100,100),MCBM.randomInRange(-100,100),0.5);var J=new THREE.Vector3(0,0,0);J.copy(M);J.setLength(MCBM.randomInRange(3,10));var L=MCBM.particle(M,J);var G={type:"smoke",sprite:H,particle:L,delay:MCBM.randomInRange(25,170),duration:MCBM.randomInRange(1000,1600),};h.push(G)}D=h.length;p=true;if(B){c.play()}}m();c.update=function(M){var S=M-e;if(!v){return}var J=D;while(J--){var L=h[J];var R=L.sprite;var K=L.particle;if(!R.getHasPlayed()){if(S>=L.delay){R.play(L.duration)}}var G=g[L.type];var N=K.getVelocity();K.setVelocity(N.multiplyScalar(G));K.update(M);var I=K.getPosition();if(0<I.z&&I.z<f){var O=f/(f-I.z);var Q=n.x+(I.x*O);var P=n.y+(I.y*O);var H=R.getBaseScale()*O;R.setScale(H);R.setPosition(new THREE.Vector2(Q,P));R.update(M)}else{}}};c.setPosition=function(G){n.copy(G)};c.render=function(){if(!v){return}v=false;var H=D;while(H--){var G=h[H].sprite;if(G.getIsPlaying()){G.draw(F);v=true}else{if(!G.getHasPlayed()){v=true}}}if(v==false){x.trigger(MCBM.events.EXPLOSION_COMPLETE)}c.isPlaying=v};c.play=function(){if(!p){B=true;return}if(v){return}B=false;c.isPlaying=v=true;e=new Date().getTime();c.update(e)};c.stop=function(){c.isPlaying=v=false};c.reset=function(){o()};return c}})(jQuery);(function(b){MCBM.creeper=function(H){var K=b(window),Q=b("body"),y=H,M=null,ae=new THREE.Vector2(55,140),v=new THREE.Vector2(0,0),Z=0,ah,ai=0,ag,P=500,w=20,Y=false,f=false,g=null,U=null,n=2500,W=50,ad={min:new THREE.Vector2(W,W),max:new THREE.Vector2(MCBM.$container.outerWidth()-W,MCBM.$container.outerHeight()-W)};var z,D,L=0,R=0,O=b("html").hasClass("audio");var A=MCBM.rootURI+"/img/sprites/creeper.png",I,ab=0,T;var p={up:{frameBounds:[1,12]},upRight:{frameBounds:[13,24]},right:{frameBounds:[25,36]},downRight:{frameBounds:[37,48]},down:{frameBounds:[49,60]},upLeft:{frameBounds:[85,96]},left:{frameBounds:[73,84]},downLeft:{frameBounds:[61,72]}};var c={walk:{duration:750,speed:0.6},run:{duration:470,speed:3}};var E=0.707106781186548;var S={up:new THREE.Vector2(0,-1),upLeft:new THREE.Vector2(-E,-E),upRight:new THREE.Vector2(E,-E),left:new THREE.Vector2(-1,0),right:new THREE.Vector2(1,0),downLeft:new THREE.Vector2(-E,E),downRight:new THREE.Vector2(E,E),down:new THREE.Vector2(0,1)};var N=["up","upLeft","upRight","left","right","downLeft","downRight","down"];var x={};x.isAlive=false;function ac(){P=P*P;w=w*w;ag=new THREE.Vector2(0,0);Q.bind(MCBM.events.CREEPER_AUDIO_LOAD_COMPLETE,t);Q.bind(MCBM.events.CREEPER_AUDIO_LOAD_ERROR,t);if(O){F()}else{u()}}function X(){M=new THREE.Vector2(MCBM.randomInRange(W*2,MCBM.$container.outerWidth()-W*2),MCBM.randomInRange(W*2,K.height()-W*2));ah=MCBM.randomFromArray(N);Z=c.walk.speed;ai=c.walk.duration;v.copy(S[ah]);v.multiplyScalar(Z);T.setPosition(M);T.setSequence(ah);Y=false}function F(){z=document.createElement("audio");D=document.createElement("audio");var ak=[{filename:"fuse",element:z},{filename:"explode",element:D}];R=ak.length;for(var am=0;am<R;am++){var an=ak[am].element;var aj=ak[am].filename;an.addEventListener("loadeddata",o,false);an.addEventListener("error",u,false);if(an.canPlayType){var al="";if(an.canPlayType('audio/ogg; codecs="vorbis"')!=""){al=".ogg"}else{if(an.canPlayType("audio/mpeg")!=""){al=".mp3"}else{u()}}}an.src=MCBM.rootURI+"/audio/"+aj+al;an.load()}}function o(aj){L++;if(L==R){Q.trigger(MCBM.events.CREEPER_AUDIO_LOAD_COMPLETE)}}function u(aj){Q.trigger(MCBM.events.LOAD_ERROR)}function k(){var aj=z.ended;if(!aj){setTimeout(k,500)}}function C(aj){z.removeEventListener("ended",C,false);V()}function t(){I=document.createElement("img");I.crossOrigin="";I.onload=J;I.src=A}function J(aj){T=MCBM.sprite(I,225,200,1,p,ae);T.setLooping(true);X();Q.trigger(MCBM.events.CREEPER_LOADED)}function m(aj){if(!x.isAlive){return}ag.x=aj.pageX-MCBM.$container.offset().left;ag.y=aj.pageY;var ak=M.distanceToSquared(ag);if(!Y){if(ak<P){if(g!==null){clearTimeout(g);g=null}Y=true;f=true;Z=c.run.speed;ai=c.run.duration;T.setDuration(ai);B(ah);if(O){k();z.addEventListener("ended",C,false);z.play()}else{U=setTimeout(V,n)}}}else{if(ak>P){af()}}}function j(){if(!x.isAlive){return}if(Y){af()}}function af(){G();f=false;g=setTimeout(e,MCBM.randomInRange(1000,3000));Z=c.walk.speed;ai=c.walk.duration;T.setDuration(ai);B(ah)}function G(){if(U!==null){clearTimeout(U);U=null}Y=false;if(O){z.currentTime=0;z.pause()}if(g!==null){clearTimeout(g);g=null}}function aa(am,al){var an=new THREE.Vector2(0,0);an.sub(al,am);var aj;if(an.x==0){aj=(an.y<0)?"up":"down"}else{var ak=Math.abs(an.y/an.x);if(ak>2.4142){aj=(an.y<0)?"up":"down"}else{if(ak<=0.4142){aj=(an.x>0)?"right":"left"}else{if(0.4142<ak&&ak<=2.4142){aj=(an.y<0)?"up":"down";aj=(an.x>0)?aj+"Right":aj+"Left"}}}}return aj}function B(aj){v.copy(S[aj]);v.multiplyScalar(Z);T.setSequence(aj);ah=aj}function e(){g=null;f=true}function V(){if(O){D.play()}x.isAlive=false;T.stop();G();Q.trigger(MCBM.events.CREEPER_EXPLODED)}function h(){return(M.x<ad.min.x||M.x>ad.max.x||M.y<ad.min.y||M.y>ad.max.y)}ac();x.getPosition=function(){return M.clone()};x.update=function(al){if(!T.getIsPlaying()){return}if(Y){var ak=M.distanceToSquared(ag);if(ak<w){V()}}if(h()){if(g!==null){clearTimeout(g);g=null}var aj=aa(M,new THREE.Vector2(K.width()*0.5,K.height()*0.5));B(aj);f=false;g=setTimeout(e,5000)}else{if(Y&&f){var aj=aa(M,ag);if(ah!=aj){B(aj);f=false;g=setTimeout(e,500)}}else{if(f){var aj=MCBM.randomFromArray(N);if(ah!=aj){B(aj);f=false;g=setTimeout(e,MCBM.randomInRange(2000,5000))}}}}M.addSelf(v);T.setPosition(M);T.update(al)};x.render=function(){if(T.getIsPlaying()){T.draw(y)}};x.play=function(){T.play(ai);f=true;x.isAlive=true;Q.bind("mousemove.creeper",m);Q.bind("mouseleave.creeper",j)};x.stop=function(){if(Y){af()}T.stop();x.isAlive=false;Q.unbind("mousemove.creeper",m);Q.unbind("mouseleave.creeper",j)};x.reset=function(){X()};x.resizeBounds=function(aj){ad.max=new THREE.Vector2(aj-W,K.height()-W)};return x}})(jQuery);(function(b){MCBM.gameCreeper=function(x){var u=b(window),v=b("body"),y,h=x,e=h.getContext(),p=null,z=null;_creeper=null,_explosion=null,_playfieldGrid=null,_gridCellSize=80,_isGameRunning=false,_queuedResize=false,_isExplosionComplete=false;var f={};f.id="gameCreeper";function o(){v.bind(MCBM.events.CREEPER_EXPLODED,g);p=MCBM.display();z=p.getContext();_playfieldGrid=MCBM.playfieldGrid(h.getCanvas(),_gridCellSize);v.bind(MCBM.events.CREEPER_LOADED,c);_creeper=MCBM.creeper(z);_explosion=MCBM.explosion(new THREE.Vector2(0,0),z)}function c(){v.trigger(MCBM.events.ITEM_LOADED)}function g(){var A=_creeper.getPosition();_playfieldGrid.generateCreeperDamage(A.clone());_explosion.setPosition(A.clone());_explosion.play()}function j(){_isExplosionComplete=true;v.trigger(MCBM.events.OPEN_UI)}function t(){v.bind(MCBM.events.EXPLOSION_COMPLETE,j);_isExplosionComplete=false;_isGameRunning=true;if(_queuedResize){k();_queuedResize=false}_creeper.reset();_creeper.play();w()}function m(){_creeper.stop();_explosion.stop();_explosion.reset();_playfieldGrid.reset();_isGameRunning=false;h.clear();p.clear()}function w(){if(!_isExplosionComplete){requestAnimationFrame(w)}n();if(typeof h.stats!="undefined"){h.stats.update()}var A=new Date().getTime();if(_creeper.isAlive){_creeper.update(A)}if(_explosion.isPlaying){_explosion.update(A)}}function n(){if(_playfieldGrid.isDirty){_playfieldGrid.render()}if(p.dirty){p.clear()}if(_creeper.isAlive){_creeper.render();p.dirty=true}if(_explosion.isPlaying){_explosion.render();p.dirty=true}}function k(){if(_isGameRunning){_creeper.resizeBounds(y);p.resize(y);_playfieldGrid.resize(y);_queuedResize=false}else{_queuedResize=true}}o();f.newGame=function(){if(_isGameRunning){m();b.doTimeout("newGame.creeper",250,t)}else{t()}};f.endGame=function(){m()};f.destroy=function(){};f.getIsRunning=function(){return !_isExplosionComplete};f.resize=function(A){y=A;k()};return f}})(jQuery);(function(b){MCBM.pickaxe=function(){var f,m=null,p=125,n=false,j=true,o=0;var e={};function k(){f=b('<div id="pickaxe"></div>');f.css({position:"absolute",top:0,left:0,width:315,height:340,cursor:"crosshair",background:"url("+MCBM.rootURI+"/img/sprites/pickaxe.png)"});MCBM.$container.append(f);f.css("display","none")}function h(){if(n){c()}else{g()}o=new Date().getTime()}function g(){n=true;f.css("background-position","0 -340px")}function c(){n=false;f.css("background-position","0 0")}k();e.start=function(){if(j){j=false;o=new Date().getTime();g()}else{return}};e.stop=function(){if(j){return}j=true;c()};e.setPosition=function(t,u){f.css({left:t-5,top:u-253});f.css("display","block")};e.update=function(t){if(j){return}if(t-o>p){h()}};e.hide=function(){f.css("display","none")};return e}})(jQuery);(function(b){MCBM.blockBreak=function(j,k){var e=j,o=k,n=0,p=0.97,m=0.71,g=MCBM.randomInRange(10,20)|0,f=[];var c={};c.running=true;function h(){var w=0;for(w;w<g;w++){var A=new THREE.Vector3(MCBM.randomInRange(-25,25),MCBM.randomInRange(-55,10),0.5);var G=new THREE.Vector3(0,0,0);G.copy(A);G.setLength(MCBM.randomInRange(3,10));var z=MCBM.particle(A,G);var C=b("<div></div>");var H=MCBM.randomInRange(5,15)|0;var E=MCBM.randomInRange(0,64-H)|0;var B=MCBM.randomInRange(0,64-H)|0;var F=o.x+A.x;var D=o.y+A.y;C.css({position:"absolute",left:F+"px",top:D+"px",width:H+"px",height:H+"px",background:"url("+MCBM.rootURI+"/img/textures/minecraft/"+e+".png) no-repeat -"+E+"px -"+B+"px",display:"none"});MCBM.$container.append(C);var v=MCBM.randomInRange(0,100)|0;var u=v+MCBM.randomInRange(500,750)|0;var t={$div:C,particle:z,delay:v,end:u};f.push(t)}n=new Date().getTime()}h();c.update=function(A){var F=A-n,z=0,v=0;for(v;v<g;v++){var t=f[v];var C=t.$div;if(t.delay<F&&F<t.end){var w=t.particle;if(C.css("display")=="none"){C.css("display","block")}var B=w.getVelocity();B.x*=p;B.y+=m;w.setVelocity(B);w.update(A);var u=w.getPosition();var E=o.x+u.x;var D=o.y+u.y;C.css({left:E+"px",top:D+"px",})}else{if(F>t.end){z++;C.css("display","none")}}if(z==g){c.running=false}}};c.destroy=function(){var t=0;for(t;t<g;t++){var u=f[t];u.$div.remove();u.$div=null;u.particle.destroy();u.particle=null}f=null;o=null};return c}})(jQuery);(function(b){MCBM.gamePickaxe=function(y){var z=b(window),F=b("body"),S=y,T=b(S.getCanvas()),u=null,k=null,Q,P,K,t=false,H=[],n=null,D=null,C=0,G=0,E=b("html").hasClass("audio"),U=false,A={},g=false,M=false,R=true;var j={};j.id="gamePickaxe";function N(){F.bind(MCBM.events.PICKAXE_AUDIO_LOAD_COMPLETE,O);u=MCBM.playfieldGrid(S.getCanvas(),80);k=MCBM.pickaxe();if(E){w()}else{h()}}function w(){n=document.createElement("audio");D=document.createElement("audio");var W=[{filename:"stone2",element:n},{filename:"grass2",element:D}];A.stone=n;A.dirt=D;G=W.length;for(var Y=0;Y<G;Y++){var Z=W[Y].element;var V=W[Y].filename;Z.addEventListener("loadeddata",J,false);Z.addEventListener("error",h,false);if(Z.canPlayType){var X="";if(Z.canPlayType('audio/ogg; codecs="vorbis"')!=""){X=".ogg"}else{if(Z.canPlayType("audio/mpeg")!=""){X=".mp3"}else{h()}}}Z.src=MCBM.rootURI+"/audio/"+V+X;Z.load()}}function J(V){C++;if(C==G){F.trigger(MCBM.events.PICKAXE_AUDIO_LOAD_COMPLETE);U=true;E=true}}function h(V){F.trigger(MCBM.events.LOAD_ERROR)}function O(){F.trigger(MCBM.events.ITEM_LOADED)}function v(){T.css("display","none");F.bind("mousemove.gamePickaxe",f);F.bind("mousedown",c);F.bind("mouseup",I);F.bind("mouseleave",I);z.bind("resize.gamePickaxe",m);M=true;if(t){B();t=false}o()}function p(){F.unbind("mousemove.gamePickaxe",f);F.unbind("mousedown",c);F.unbind("mouseup",I);F.unbind("mouseleave",I);z.unbind("resize.gamePickaxe",m);k.stop();k.hide();M=false;u.reset();S.clear()}function f(V){T.css({display:"block",cursor:"crosshair"});Q=V.pageX-MCBM.$container.offset().left;P=V.pageY;k.setPosition(Q,P)}function c(V){V.preventDefault();Q=V.pageX-MCBM.$container.offset().left;P=V.pageY;if(R){R=false;x();b.doTimeout(300,function(){R=true})}}function x(){var V=z.scrollTop();var W=z.scrollLeft();g=true;e();b.doTimeout("breakInterval",500,e);k.start()}function e(){var X=u.mineAtPosition(Q,P);if(X!="lava"&&X!==undefined){if(X=="grassDirt"||typeof X=="undefined"){X="dirt"}if(U){var W=(X=="dirt")?X:"stone",Y=A[W];Y.pause();Y.currentTime=0;Y.play()}var V=MCBM.blockBreak(X,new THREE.Vector3(Q,P,0.5));H.push(V)}if(g){return true}else{return false}}function I(V){V.preventDefault();g=false;b.doTimeout("breakInterval");k.stop()}function m(){}function o(){if(M){requestAnimationFrame(o)}L();if(typeof S.stats!="undefined"){S.stats.update()}var X=new Date().getTime();k.update(X);var W=H.length;while(W--){var V=H[W];if(V.running){V.update(X)}else{V.destroy();H.splice(W,1)}}}function L(){if(u.isDirty){u.render()}}function B(){if(M){u.resize(K)}else{t=true}}N();j.newGame=function(){if(M){p();b.doTimeout("newGame.pickaxe",250,v)}else{v()}};j.endGame=function(){p()};j.destroy=function(){};j.getIsRunning=function(){return M};j.resize=function(V){K=V;B()};return j}})(jQuery);(function(b){MCBM.phoneDisplay=function(){var k='#mcbm-phone-container {position: fixed;top: 0px;left: 15px;width: 100%;height: 350px;overflow: hidden;z-index: 10002;}#mcbm-phone {position: relative;margin: -200px auto 0;width: 358px;height: 315px;}#mcbm-phone-shadow {position: absolute;top: 0px;left: 0px;width: 358px;height: 194px;}#mcbm-phone-display {position: absolute;top: 16px;left: 16px;width: 304px;height: 153px;background: url("'+MCBM.rootURI+'/img/phone/display.png") no-repeat 0 0 transparent;}#mcbm-phone-screen {position: absolute;top: 11px;left: 44px;width: 229px;height: 130px;}#mcbm-phone-controller {position: absolute;top: 40px;left: 15px;width: 306px;height: 129px;background: url("'+MCBM.rootURI+'/img/phone/controller.png") no-repeat 0 0 transparent;}';var t='<div id="mcbm-phone-container"><div id="mcbm-phone"><div id="mcbm-phone-shadow"><img src="'+MCBM.rootURI+'/img/phone/shadow.png" width="100%" height="100%"></div><div id="mcbm-phone-controller"></div><div id="mcbm-phone-display"><div id="mcbm-phone-screen"><img src="'+MCBM.rootURI+'/img/phone/minecraft-screen.jpg" width="229" height="130"></div></div></div></div>';var j=b("body"),w=b(t),o=w.find("#mcbm-phone"),h=w.find("#mcbm-phone-shadow"),g=w.find("#mcbm-phone-display"),u=w.find("#mcbm-phone-controller"),f=true;var c={};function p(){b("head").append("<style>"+k+"</style>");MCBM.$container.append(w);w=b("#mcbm-phone-container")}function x(){var z=700;w.css({visibility:"visible",display:"block"});o.stop().animate({marginTop:0},z,"easeOutBack",y);if(f){setTimeout(e,450)}else{e()}}function v(){var z=450;o.animate({marginTop:-300},z,"easeInOutExpo",n)}function e(){f=false;var z=500;u.stop().animate({top:146},z,"easeInOutExpo");h.stop().animate({height:311},z,"easeInOutExpo")}function m(){var z=400;u.animate({top:40},z,"easeInOutExpo");h.animate({height:194},z,"easeInOutExpo")}function y(){}function n(){w.css({visibility:"hidden",display:"none"})}p();c.transitionIn=function(){x()};c.transitionOut=function(){v()};return c}})(jQuery);(function(b){MCBM.ui=function(){var C='#mcbm-ui-container {position: fixed;bottom: 0px;left: 0px;width: 100%;min-width: 1224px;height: 73px;overflow: hidden;z-index: 10001;}#mcbm-ui {position: absolute;bottom: -73px;left: 0px;width: 100%;height: 73px;background: #444444;}#mcbm-ui-container a { text-indent: -9999px; overflow: hidden; }#mcbm-ui-button-area {position: relative;margin: 0 205px 0 0;overflow: hidden;height: 93px;}#mcbm-dirt-bg {position: absolute;top: 0px;left: 0px;width: 100%;height: 93px;}#mcbm-dirt-bg-left {float: left;width: 119px;height: 93px;background: url("'+MCBM.rootURI+'/img/ui/dirt-bg-sides.jpg") no-repeat 0 0;}#mcbm-dirt-bg-mid {margin: 0 122px 0 119px;height: 93px;background: url("'+MCBM.rootURI+'/img/ui/dirt-bg-repeat-x.jpg") repeat-x;}#mcbm-dirt-bg-right {position: absolute;top: 0px;right: 0px;width: 122px;height: 93px;background: url("'+MCBM.rootURI+'/img/ui/dirt-bg-sides.jpg") no-repeat -119px 0;}#mcbm-ui-button-container {position: absolute;top: 0px;left: 0px;width: 100%;height: 93px;}#mcbm-ui-buttons {margin: 21px auto 0;width: 888px;height: 40px;}.mcbm-ui-button {background: url("'+MCBM.rootURI+'/img/ui/ui-buttons.png") no-repeat;}.esp .mcbm-ui-button, .esp .mcbm-ui-button:hover {background: url("'+MCBM.rootURI+'/img/ui/ui-buttons-esp.png") no-repeat;}#mcbm-play-creeper {float:left;margin-right: 21px;width: 296px;height: 36px;background-position:0px 0px;}#mcbm-play-creeper:hover {background-position: 0px -38px;}#mcbm-play-pickaxe {float:left;margin-right: 52px;width: 296px;height: 36px;background-position: -298px 0px;}#mcbm-play-pickaxe:hover {background-position: -298px -38px;}#mcbm-exit {float:left;width: 106px;height: 36px;background-position: -596px 0px;}#mcbm-exit:hover {background-position: -596px -38px;}#mcbm-social {float:left;margin: 3px 23px 0 0;}#mcbm-fb {float:left;margin-right: 5px;width: 28px;height: 28px;background: url("'+MCBM.rootURI+'/img/ui/share-icons.png") no-repeat 0 0;}#mcbm-fb:hover {background-position: 0 -28px;}#mcbm-gplus {float:left;margin-right: 5px;width: 28px;height: 28px;}#mcbm-twitter {float:left;width: 28px;height: 28px;background: url("'+MCBM.rootURI+'/img/ui/share-icons.png") no-repeat -56px 0;}#mcbm-twitter:hover {background-position: -56px -28px;}#mcbm-xperia-logo {position: absolute;top: 0px;right: 0px;width: 205px;height: 73px;}#mcbm-show-ui {position: absolute;bottom: -31px;left: 0px;width: 203px;height: 31px;background: url("'+MCBM.rootURI+'/img/ui/show-ui-tab.png") no-repeat 0 0;}.esp #mcbm-show-ui {background: url("'+MCBM.rootURI+'/img/ui/show-ui-tab-esp.png") no-repeat 0 0;}';var j='<div id="mcbm-ui-container"><a id="mcbm-show-ui" href="#">Show Controls</a><div id="mcbm-ui"><div id="mcbm-ui-button-area"> <!-- contains dirt background, buttons, stretches to fill area to left of logo --><div id="mcbm-dirt-bg"><div id="mcbm-dirt-bg-left"></div><div id="mcbm-dirt-bg-mid"></div><div id="mcbm-dirt-bg-right"></div></div><div id="mcbm-ui-button-container"><div id="mcbm-ui-buttons"> <!-- centered in container --><a id="mcbm-play-creeper" class="mcbm-ui-button" href="#">Unleash the creeper!</a><a id="mcbm-play-pickaxe" class="mcbm-ui-button" href="#">Get you pickaxe!</a><div id="mcbm-social"><a id="mcbm-fb" href="'+MCBM.shareFbURI+'" target="_blank">Share on Facebook</a><a id="mcbm-twitter" href="'+MCBM.shareTwitterURI+'" target="_blank">Share on Twitter</a></div><a id="mcbm-exit" class="mcbm-ui-button" href="#">Exit</a></div></div></div><div id="mcbm-xperia-logo"><img src="'+MCBM.rootURI+'/img/ui/xperia-logo.png" width+"205" height="73"></div> <!-- anchored to the right --></div></div>';var z=b("body"),E=b(j),v=E.find("#mcbm-ui"),w=E.find("##mcbm-dirt-bg"),D=E.find("#mcbm-play-creeper"),o=E.find("#mcbm-play-pickaxe"),f=E.find("#mcbm-exit"),t=E.find("#mcbm-show-ui"),A=false,u=false;var g={};function n(){b("head").append("<style>"+C+"</style>");MCBM.$container.append(E);E=b("#mcbm-ui-container");D.bind("click",k);o.bind("click",e);f.bind("click",x);t.bind("click",c);v.bind("mouseenter",function(){A=true});v.bind("mouseleave",function(){A=false});v.bind("mousemove",function(){z.trigger(MCBM.events.UI_MOUSE_MOVE)});t.bind("mouseenter",function(){u=true});t.bind("mouseleave",function(){u=false});z.bind("mousedown",B);b("#mcbm-fb").bind("click",function(){MCBM.gaTrackEvent("game","share","Facebook")});b("#mcbm-twitter").bind("click",function(){MCBM.gaTrackEvent("game","share","Twitter")})}function B(F){if(A||u){F.stopImmediatePropagation()}}function y(){var F=800;t.stop().animate({bottom:-31},300,"easeOutExpo");w.stop().animate({top:0},F,"easeOutExpo");v.stop().animate({bottom:0},F,"easeOutExpo",m)}function m(){z.trigger(MCBM.events.OPEN_UI_COMPLETE)}function h(){var F=500;t.stop().animate({bottom:0},500,"easeInOutExpo");w.stop().animate({top:-32},F,"easeInOutExpo");v.stop().animate({bottom:-63},F,"easeInOutExpo",p)}function p(){z.trigger(MCBM.events.CLOSE_UI_COMPLETE)}function k(F){F.preventDefault();z.trigger(MCBM.events.PLAY_CREEPER_CLICK)}function e(F){F.preventDefault();z.trigger(MCBM.events.PLAY_PICKAXE_CLICK)}function x(F){F.preventDefault();z.trigger(MCBM.events.EXIT_CLICK)}function c(F){F.preventDefault();z.trigger(MCBM.events.OPEN_UI)}n();g.open=function(){y()};g.close=function(){h()};return g}})(jQuery);(function(b){MCBM.main=function(){var B=b(window),D=b("body"),j=null,K=null,z=null,k=null,J=null,x=null,y=null,t=false,c=false,u=1500,L=null,m=0,M=0;function o(){z=MCBM.display(false);j=MCBM.ui();K=MCBM.phoneDisplay();M=2;D.bind(MCBM.events.ITEM_LOADED,F);D.bind(MCBM.events.LOAD_ERROR,A);k=MCBM.gameCreeper(z);J=MCBM.gamePickaxe(z);D.bind(MCBM.events.PLAY_CREEPER_CLICK,e);D.bind(MCBM.events.PLAY_PICKAXE_CLICK,E);D.bind(MCBM.events.EXIT_CLICK,H);D.bind(MCBM.events.OPEN_UI,v);D.bind(MCBM.events.OPEN_UI_COMPLETE,I);D.bind(MCBM.events.CLOSE_UI_COMPLETE,G);b.doTimeout("loadTimeout",MCBM.LOAD_TIMEOUT,h)}function F(){m++;if(m===M){g()}}function h(){D.trigger(MCBM.events.LOAD_ERROR)}function A(){D.unbind(MCBM.events.ITEM_LOADED,F);D.unbind(MCBM.events.LOAD_ERROR,A);MCBM.$loading.animate({opacity:0},350,"easeOutQuad",function(){MCBM.$loading.addClass("mcbm-hidden");MCBM.$error.removeClass("mcbm-hidden");MCBM.$error.animate({opacity:1},350,"easeOutQuad")})}function g(){b.doTimeout("loadTimeout");MCBM.$loading.animate({opacity:0},350,"easeOutQuad",function(){});j.open();K.transitionIn();B.bind("resize",n)}function e(){MCBM.gaTrackEvent("game","play","Creeper Game");f(k)}function E(){MCBM.gaTrackEvent("game","play","Pickaxe Game");f(J)}function f(N){y=N;if(x!==null){x.endGame();x=null}C()}function C(){if(L!=null){clearTimeout(L);L=null}j.close();K.transitionOut()}function G(){if(y==null){return}x=y;y=null;x.newGame()}function I(){if(x!=null){c=x.getIsRunning()}if(t&&c){D.bind(MCBM.events.UI_MOUSE_MOVE,p);L=setTimeout(w,u)}else{t=true}}function p(){if(L!=null){clearTimeout(L);L=null}L=setTimeout(w,u)}function w(){D.unbind(MCBM.events.UI_MOUSE_MOVE,p);if(L!=null){clearTimeout(L);L=null}if(x!=null){if(x.getIsRunning()){C()}}}function v(){if(L!=null){clearTimeout(L);L=null}K.transitionIn();j.open()}function H(){D.unbind(MCBM.events.PLAY_CREEPER_CLICK,e);D.unbind(MCBM.events.PLAY_PICKAXE_CLICK,E);D.unbind(MCBM.events.EXIT_CLICK,H);D.unbind(MCBM.events.OPEN_UI,v);D.unbind(MCBM.events.OPEN_UI_COMPLETE,I);D.unbind(MCBM.events.CLOSE_UI_COMPLETE,G);if(L!=null){clearTimeout(L);L=null}if(x!==null){x.endGame();x=null}MCBM.$container.remove();MCBM.gaTrackEvent("game","exit",MCBM.getDuration());window.location.reload(true)}function n(){b.doTimeout("resize",250,function(){if(B.width()>MCBM.MAX_WIDTH){MCBM.$container.css({width:MCBM.MAX_WIDTH+"px",left:"50%","margin-left":Math.floor(-MCBM.MAX_WIDTH*0.5)+"px"})}else{MCBM.$container.css({width:"100%",left:"0","margin-left":"0"})}var N=MCBM.$container.outerWidth();z.resize(N);k.resize(N);J.resize(N)})}o()}})(jQuery);
